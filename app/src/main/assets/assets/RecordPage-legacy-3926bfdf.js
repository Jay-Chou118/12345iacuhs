System.register(["./Header-legacy-33add6f4.js","./Button-legacy-cab470d9.js","./index-legacy-e92e21e0.js"],(function(e,t){"use strict";var o,s,a,l,r,i,c,n,d,p,h,u,m,g,y,v,b,T,k,f,x,C;return{setters:[e=>{o=e.H},e=>{s=e.B},e=>{a=e._,l=e.k,r=e.j,i=e.e,c=e.r,n=e.l,d=e.c,p=e.h,h=e.d,u=e.F,m=e.m,g=e.i,y=e.a,v=e.w,b=e.t,T=e.v,k=e.o,f=e.n,x=e.p,C=e.b}],execute:function(){let t=0;const L={props:["store","closeFlag"],components:{Button:s,Header:o},data:()=>({pullType:"blf",chartDataLoaded:!0,directory:window.downloadPath,recList:{csv:{label:"csv",size:"",paths:"/persistence/vde/pool,/tmp/vde/pool"},asc:{label:"asc",size:"",paths:"/log/DiagMaster,/persistence/DiagMaster"},blf:{label:"blf",size:"",paths:"/log/DiagMaster,/persistence/DiagMaster"}},recLoading:!1,recLoadingProgress:"",recordTime:"00:00:00",consoleText:"",message:{visible:!1,level:"",content:""},modal:{visible:!1},onFlag:!0}),watch:{closeFlag(e){console.log("2222",e,this.onFlag),0==this.onFlag&&(this.modal.visible=!0)},chartDataLoaded(e,t){e?(document.querySelector(".back-icon").style.pointerEvents="",document.querySelector(".record-header").style.cursor=""):(document.querySelector(".back-icon").style.pointerEvents="none",document.querySelector(".record-header").style.cursor="wait")}},mounted(){r.report("trackPage",{page:"录制报文",tip:"1174.8.0.1.27758"});const e=window.driver.js.driver({doneBtnText:"知道了",closeBtnText:"关闭",nextBtnText:"继续",prevBtnText:"后退",steps:[{element:"#el-record-form",popover:{title:"配置和录制",description:"填写格式和目录信息，点击开始"}},{element:"#el-record-console",popover:{title:"进度提示",description:"此区域提示录制进度"}}]});this.$ls.get("driverRecord")||(e.drive(),this.$ls.set("driverRecord",!0))},unmounted(){},computed:{pullDataValid(){return!(!this.directory||!this.pullType)},quitConfirm(){return this.recLoading}},methods:{showInfo(){this.modal.visible=!0},choosePath(){l.choosePath({directory:this.directory,dialogType:"FOLDER_DIALOG",fileTypes:["所有文件 (*.*)"],allow_multiple:!1}).then((({data:e})=>{e.directory&&(this.directory=e.directory)}))},startRec(){r.report("track","click",{element_name:"开始录制",asset_name:this.directory+";"+this.pullType,tip:"1174.8.0.1.27759"}),this.consoleText="录制中...\n",this.onFlag=!1,this.chartDataLoaded=!1,t=setInterval((()=>{this.recordTime=""}),1e3),i.record.start({type:[this.pullType],path:this.directory}).then((e=>{console.log(e,"444444");let t=e.data;this.chartDataLoaded=!0,200==e.status&&(this.consoleText+=t+"\n",t&&(this.onFlag=!0)),console.log(t,"resp22222")})).catch((e=>{this.consoleText+="录制中断\n",this.onFlag=!0}))},endRec(){r.report("track","click",{element_name:"停止录制",asset_name:this.directory+";"+this.pullType,tip:"1174.8.0.1.27760"}),clearInterval(t),this.onFlag=!0,this.chartDataLoaded=!0,i.record.end().then((e=>{let t=e.data;200==e.status&&(this.consoleText+="停止成功\n"),console.log(t,"resp22222")})).catch((e=>{this.consoleText+="停止失败\n",this.onFlag=!1}))},cannel(){this.modal.visible=!1},submit(){this.modal.visible=!1,this.endRec(),this.onFlag=!0}}},w=e=>(x("data-v-9871c462"),e=e(),C(),e),_=["data-disabled"],D={class:"o-pul-er",id:"el-record-form"},F=w((()=>h("div",{class:"o-pul-title"},"报文录制配置",-1))),P={class:"o-pul-p"},R=w((()=>h("span",{style:{color:"red"}},"* ",-1))),q=w((()=>h("span",{class:"record-header-message"},"录制文件格式：",-1))),B=["value"],S={class:"o-pul-p"},j=w((()=>h("span",{style:{color:"red"}},"* ",-1))),I=w((()=>h("span",{class:"record-header-message"},"保存目录：",-1))),$={class:"o-pul-path"},z={key:0,class:"o-pul-p start-rec"},H=w((()=>h("i",{class:"play-icon"},null,-1))),M={key:1,class:"o-pul-p start-rec"},E=w((()=>h("i",{class:"stop-icon"},null,-1))),N=["data-empty"],O=w((()=>h("div",{class:"o-console-title"},"录制报文内容",-1))),V=["data-loading"],A={class:"o-modal-wrap"},G={class:"o-modal-header"},U={class:"o-modal-header-wrap"},J=w((()=>h("div",{class:"o-modal-title"},"提示",-1))),K=w((()=>h("div",{class:"o-modal-container"},[h("span",{class:"record-header-message"},"任务还在录制中，此时关闭TSP助手会终断此任务，确认要继续关闭吗？")],-1))),Q={class:"o-modal-footer"},W={class:"o-modal-footer-wrap"};e("default",a(L,[["render",function(e,t,o,s,a,l){const r=c("Header"),i=c("Button"),x=n("tooltip");return k(),d("div",{class:"record-page","data-disabled":!a.chartDataLoaded},[p(r,{title:"录制报文",quitConfirm:l.quitConfirm,showRight:!0,carNum:e.$props.store.connectCar.carNum,connectStatus:e.$props.store.connectCar.status,recentTest:e.$props.store.connectCar.latest},null,8,["quitConfirm","carNum","connectStatus","recentTest"]),h("div",D,[F,h("div",P,[R,q,(k(!0),d(u,null,m(a.recList,((e,o)=>(k(),d("label",{class:"o-input record-header-message-imp",key:o},[v(h("input",{name:"pull_type",type:"radio","onUpdate:modelValue":t[0]||(t[0]=e=>a.pullType=e),value:o},null,8,B),[[f,a.pullType]]),y(b(e.label)+" "+b(e.size)+" ",1)])))),128))]),h("div",S,[j,I,p(i,{onClick:l.choosePath,class:"choose-path"},{default:g((()=>[y("选择路径")])),_:1},8,["onClick"]),y("  "),v((k(),d("span",$,[y(b(a.directory),1)])),[[x,{content:a.directory,skidding:0,arrowPadding:9999},void 0,{"top-start":!0}]])]),a.onFlag?(k(),d("div",z,[p(i,{type:"primary",disabled:!1,progress:a.recLoadingProgress,loading:a.recLoading,onClick:l.startRec},{default:g((()=>[H,y(" 开始录制")])),_:1},8,["disabled","progress","loading","onClick"])])):(k(),d("div",M,[p(i,{type:"primary",disabled:!1,progress:a.recLoadingProgress,loading:a.recLoading,onClick:l.endRec},{default:g((()=>[E,y(" 暂停录制")])),_:1},8,["disabled","progress","loading","onClick"])]))]),h("div",{class:"o-console-er","data-empty":""===a.consoleText,id:"el-record-console"},[O,v(h("div",{class:"o-console-body","data-loading":!a.chartDataLoaded},b(a.consoleText),9,V),[[T,a.consoleText]])],8,N),v(h("div",A,[h("div",G,[h("div",U,[J,h("i",{class:"o-modal-title-close",onClick:t[1]||(t[1]=(...e)=>l.cannel&&l.cannel(...e))})]),K,h("div",Q,[h("div",W,[p(i,{style:{width:"52px"},onClick:l.cannel},{default:g((()=>[y("取消")])),_:1},8,["onClick"]),p(i,{type:"primary",style:{width:"52px",margin:"0 20px 0 10px"},onClick:l.submit},{default:g((()=>[y("确定")])),_:1},8,["onClick"])])])])],512),[[T,this.modal.visible]])],8,_)}],["__scopeId","data-v-9871c462"]]))}}}));
