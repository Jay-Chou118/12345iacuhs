import{H as ot}from"./Header-eef0e3af.js";import{B as G}from"./Button-f4fd5e49.js";import{M as Z}from"./Message-4d480bba.js";import{_ as E,S as X,k as J,r as w,l as H,w as v,o as h,c as u,d as a,t as b,h as g,F as T,i as S,a as C,f as k,p as j,b as q,L as rt,m as F,q as he,H as je,I as Ie,u as pt,g as Q,x as A,y as ue,B as $,s as dt,j as ye,e as D,z as $e,A as P,v as U,C as Ae,J as ct,E as ee,K as ht,M as ft,N as re,n as gt}from"./index-53885018.js";import{C as Ne}from"./Cascader-59580a5b.js";import{S as de}from"./Spin-5cd5b2de.js";import{A as bt,W as _t,P as yt}from"./ev-timeplot-9720fed5.js";import{M as wt}from"./index-6c64cced.js";import{c as vt}from"./index.es-40d4cd0f.js";import{t as we}from"./signal-577d7bc6.js";import{n as Ct}from"./index-7423e1f6.js";import{b as kt,s as St,C as ut}from"./CopyPath-8e08125d.js";import{s as Tt,a as qe}from"./time-4b339df6.js";import{B as ve}from"./ButtonGroup-c703b373.js";import{b as mt}from"./num-b2a97d52.js";let ze=0;const Dt={props:["title","curViewInx","carType","sdb","tinyBatteryFlag","loading"],emits:["cancel","importFileSubmit","treeDataChange"],components:{Button:G,Cascader:Ne,Message:Z,Spin:de},data(){return{dbcVal:[X.DEFAULT[0].value,X.DEFAULT[0].children[0].value],channelVal:{label:"(不加载)",value:0},channelValTwo:{label:"(不加载)",value:0},blfDirectory:"",dbcDirectory:"",dbcDirectoryTwo:"",channelNo:{label:1,value:1},channelNoTwo:{label:2,value:2},message:{visible:!1,level:"",content:""},filesList:["","","","","","","","","","","","","","","",""]}},watch:{dbcVal:{handler(e){this.channelVal={label:"(不加载)",value:0},this.channelValTwo={label:"(不加载)",value:0}},immediate:!0}},mounted(){},computed:{dbcVerOpts(){return[...X.DEFAULT,{label:"自定义模板",value:"自定义模板"}]},channelOptions(){var s,i;let e=[];if(this.dbcVal[0]!==""&&this.dbcVal[1]!==""){e=((i=(s=X.DEFAULT.find(l=>l.value===this.dbcVal[0]))==null?void 0:s.children.find(l=>l.value===this.dbcVal[1]))==null?void 0:i.comments)||[];let t=e.map((l,o)=>l&&"".concat(o,"-").concat(l)).filter(l=>l!=="").map((l,o)=>({label:l,value:Number(l.split("-")[0])}));return t.unshift({label:"(不加载)",value:0}),t}}},methods:{choosePath(){J.choosePath({directory:window.downloadPath,saveFilename:"tspa-Record.blf",dialogType:"SAVE_DIALOG",fileTypes:["BLF文件 (*.blf;*.BLF)"],allow_multiple:!1}).then(({data:e})=>{console.log("res>>>",e),e.directory&&(this.blfDirectory=e.directory)})},chooseDbcPath(){J.choosePath({dialogType:"OPEN_DIALOG",fileTypes:["DBC文件 (*.dbc;*.DBC)"],allow_multiple:!1}).then(({data:e})=>{e.directory&&(this.dbcDirectory=e.directory)})},chooseDbcPathTwo(){J.choosePath({dialogType:"OPEN_DIALOG",fileTypes:["DBC文件 (*.dbc;*.DBC)"],allow_multiple:!1}).then(({data:e})=>{e.directory&&(this.dbcDirectoryTwo=e.directory)})},submit(){this.dbcVal[0]!=="自定义模板"?this.channelVal.value===this.channelValTwo.value&&this.channelVal.value!==0?this.showMessage({timeout:5e3,level:"error",content:"不可重复选择相同通道"}):this.blfDirectory!==""?this.$emit("submitToShow",this.dbcVal,[this.channelVal.label,this.channelValTwo.label],["(不加载)","(不加载)"],this.blfDirectory):this.showMessage({timeout:5e3,level:"error",content:"请选择保存目录路径"}):this.channelNo===this.channelNoTwo?this.showMessage({timeout:5e3,level:"error",content:"不可重复选择相同通道"}):this.blfDirectory!==""?(console.log("自定义传参",this.channelNo),this.$emit("submitToShow",this.dbcVal,[this.channelNo.value+"-"+this.dbcDirectory,this.channelNoTwo.value+"-"+this.dbcDirectoryTwo],[],this.blfDirectory)):this.showMessage({timeout:5e3,level:"error",content:"请选择保存目录路径"})},showMessage({level:e,content:s,timeout:i}){clearTimeout(ze),e!=null&&(this.message.level=e),s!=null&&(this.message.content=s),this.message.visible=!0,i>0&&(ze=setTimeout(()=>{this.message.visible=!1},i))}}},ie=e=>(j("data-v-b63c6a22"),e=e(),q(),e),Vt={class:"o-import-dialog"},xt={class:"o-dialog-wrap"},It={class:"o-dialog-header-wrap"},Lt={class:"o-dialog-title"},Ft={class:"o-dialog-container-wrap"},Rt={class:"o-import-configuration"},Mt={class:"o-dialog-item-wrap"},Et=ie(()=>a("span",{class:"o-dialog-item"},"车型/DBC：",-1)),$t={class:"o-dialog-item-select"},At={class:"o-dialog-item-wrap edit-modal-channel"},Nt=ie(()=>a("span",{class:"o-dialog-item"},"通道1：",-1)),Ot={class:"o-dialog-item-wrap edit-modal-channel-two"},Pt=ie(()=>a("span",{class:"o-dialog-item"},"通道2：",-1)),Ut={class:"o-dialog-item-wrap"},Ht=ie(()=>a("span",{style:{color:"red"}},null,-1)),Bt=ie(()=>a("span",{class:"o-dialog-item"},"通道1：",-1)),jt={class:"o-dialog-tab"},qt={class:"o-dialog-choose-dbc"},zt=["title"],Kt={class:"o-dialog-item-wrap"},Wt=ie(()=>a("span",{style:{color:"red"}},null,-1)),Gt=ie(()=>a("span",{class:"o-dialog-item"},"通道2：",-1)),Xt={class:"o-dialog-tab"},Yt={class:"o-dialog-choose-dbc"},Jt=["title"],Qt={class:"o-dialog-item-wrap"},Zt=ie(()=>a("span",{style:{color:"red"}},"* ",-1)),es=ie(()=>a("span",{class:"o-dialog-item"},"保存目录：",-1)),ts=["title"],ss={class:"o-dialog-footer-wrap"},ls={class:"o-dialog-footer"},is={key:0,class:"o-dialog-loading"};function as(e,s,i,n,t,l){const o=w("Cascader"),r=w("v-select"),d=w("Button"),c=w("Spin"),m=w("Message"),f=H("esc");return v((h(),u("div",Vt,[a("div",xt,[a("div",It,[a("div",Lt,b(e.$props.title),1),a("i",{class:"o-dialog-title-close",onClick:s[0]||(s[0]=y=>e.$emit("cancel"))})]),a("div",Ft,[a("div",Rt,[a("div",Mt,[Et,a("div",$t,[g(o,{options:l.dbcVerOpts,modelValue:t.dbcVal,"onUpdate:modelValue":s[1]||(s[1]=y=>t.dbcVal=y)},null,8,["options","modelValue"])])]),t.dbcVal[0]!="自定义模板"?(h(),u(T,{key:0},[a("div",At,[Nt,g(r,{options:l.channelOptions,clearable:!1,label:"label",value:"value",modelValue:t.channelVal,"onUpdate:modelValue":s[2]||(s[2]=y=>t.channelVal=y),class:"chf-input-ecu"},null,8,["options","modelValue"])]),a("div",Ot,[Pt,g(r,{options:l.channelOptions,clearable:!1,label:"label",value:"value",modelValue:t.channelValTwo,"onUpdate:modelValue":s[3]||(s[3]=y=>t.channelValTwo=y),class:"chf-input-ecu"},null,8,["options","modelValue"])])],64)):(h(),u(T,{key:1},[a("div",Ut,[Ht,Bt,a("div",jt,[a("div",qt,[a("div",{class:"o-table-dbc input-overflow-sty",title:t.dbcDirectory||"--"},b(t.dbcDirectory||"--"),9,zt),a("a",{class:"chose-file chose-dbc-file",onClick:s[4]||(s[4]=y=>l.chooseDbcPath())},"选择DBC文件")])])]),a("div",Kt,[Wt,Gt,a("div",Xt,[a("div",Yt,[a("div",{class:"o-table-dbc input-overflow-sty",title:t.dbcDirectoryTwo||"--"},b(t.dbcDirectoryTwo||"--"),9,Jt),a("a",{class:"chose-file chose-dbc-file",onClick:s[5]||(s[5]=y=>l.chooseDbcPathTwo())},"选择DBC文件")])])])],64)),a("div",Qt,[Zt,es,g(d,{onClick:l.choosePath,class:"choose-path"},{default:S(()=>[C("选择路径")]),_:1},8,["onClick"]),C("    ")]),a("div",{class:"show-directory",title:t.blfDirectory},b(t.blfDirectory),9,ts)])]),a("div",ss,[a("div",ls,[g(d,{style:{width:"52px"},onClick:s[6]||(s[6]=y=>e.$emit("cancel"))},{default:S(()=>[C("取消")]),_:1}),g(d,{type:"primary",style:{width:"52px",margin:"0 20px 0 10px"},onClick:l.submit},{default:S(()=>[C("连接")]),_:1},8,["onClick"])])]),e.$props.loading?(h(),u("div",is,[g(c)])):k("",!0)]),g(m,{message:t.message},null,8,["message"])])),[[f,()=>e.$emit("cancel")]])}const ns=E(Dt,[["render",as],["__scopeId","data-v-b63c6a22"]]);let Ke=0;const os={props:["title","curViewInx","carType","sdb","tinyBatteryFlag","loading"],emits:["cancel","importFileSubmit","treeDataChange"],components:{Button:G,Cascader:Ne,Message:Z,Spin:de},data(){return{dbcVal:[X.DEFAULT[0].value,X.DEFAULT[0].children[0].value],channelVal:{label:"(不加载)",value:0},channelValTwo:{label:"(不加载)",value:0},channelValThree:{label:"(不加载)",value:0},linChannelVal:{label:"(不加载)",value:0},linChannelValTwo:{label:"(不加载)",value:0},blfDirectory:"",dbcDirectory:"",dbcDirectoryTwo:"",dbcDirectoryThree:"",linDbcDirectory:"",linDbcDirectoryTwo:"",channelNo:{label:1,value:1},channelNoTwo:{label:2,value:2},channelNoThree:{label:3,value:3},linChannelNo:{label:4,value:4},linChannelNoTwo:{label:5,value:5},message:{visible:!1,level:"",content:""},filesList:["","","","","","","","","","","","","","","",""]}},watch:{dbcVal:{handler(e){this.channelVal={label:"(不加载)",value:0},this.channelValTwo={label:"(不加载)",value:0},this.channelValThree={label:"(不加载)",value:0},this.linChannelVal={label:"(不加载)",value:0},this.linChannelValTwo={label:"(不加载)",value:0}},immediate:!0}},mounted(){},computed:{dbcVerOpts(){return[...X.DEFAULT,{label:"自定义模板",value:"自定义模板"}]},channelOptions(){var s,i;let e=[];if(this.dbcVal[0]!==""&&this.dbcVal[1]!==""){e=((i=(s=X.DEFAULT.find(l=>l.value===this.dbcVal[0]))==null?void 0:s.children.find(l=>l.value===this.dbcVal[1]))==null?void 0:i.comments)||[];let t=e.map((l,o)=>l&&"".concat(o,"-").concat(l)).filter(l=>l!=="").map((l,o)=>({label:l,value:Number(l.split("-")[0])}));return t.unshift({label:"(不加载)",value:0}),t}},linChannelOptions(){var s,i;let e=[];if(this.dbcVal[0]!==""&&this.dbcVal[1]!==""){e=((i=(s=rt.find(t=>t.value===this.dbcVal[0]))==null?void 0:s.children.find(t=>t.value===this.dbcVal[1]))==null?void 0:i.comments)||[];let n=e.map(t=>({label:t,value:Number(t.split("-")[0])-1e3}));return n.unshift({label:"(不加载)",value:0}),n}}},methods:{choosePath(){J.choosePath({directory:window.downloadPath,saveFilename:"tspa-Record.blf",dialogType:"SAVE_DIALOG",fileTypes:["BLF文件 (*.blf;*.BLF)"],allow_multiple:!1}).then(({data:e})=>{console.log("res>>>",e),e.directory&&(this.blfDirectory=e.directory)})},chooseDbcPath(){J.choosePath({dialogType:"OPEN_DIALOG",fileTypes:["DBC文件 (*.dbc;*.DBC)"],allow_multiple:!1}).then(({data:e})=>{e.directory&&(this.dbcDirectory=e.directory)})},chooseDbcPathTwo(){J.choosePath({dialogType:"OPEN_DIALOG",fileTypes:["DBC文件 (*.dbc;*.DBC)"],allow_multiple:!1}).then(({data:e})=>{e.directory&&(this.dbcDirectoryTwo=e.directory)})},chooseDbcPathThree(){J.choosePath({dialogType:"OPEN_DIALOG",fileTypes:["DBC文件 (*.dbc;*.DBC)"],allow_multiple:!1}).then(({data:e})=>{e.directory&&(this.dbcDirectoryThree=e.directory)})},chooseLinDbcPath(){J.choosePath({dialogType:"OPEN_DIALOG",fileTypes:["LDF文件 (*.ldf;*.LDF)"],allow_multiple:!1}).then(({data:e})=>{e.directory&&(this.linDbcDirectory=e.directory)})},chooseLinDbcPathTwo(){J.choosePath({dialogType:"OPEN_DIALOG",fileTypes:["LDF文件 (*.ldf;*.LDF)"],allow_multiple:!1}).then(({data:e})=>{e.directory&&(this.linDbcDirectoryTwo=e.directory)})},submit(){console.log("linChannelOptions1111",this.linChannelOptions),this.dbcVal[0]!=="自定义模板"?(console.log("提交中..123"),this.channelVal.value===this.channelValTwo.value&&this.channelVal.value!==0?this.showMessage({timeout:5e3,level:"error",content:"不可重复选择相同通道"}):this.blfDirectory!==""?this.$emit("submitFiveToShow",this.dbcVal,[this.channelVal.label,this.channelValTwo.label,this.channelValThree.label],[this.linChannelVal.label,this.linChannelValTwo.label],this.blfDirectory):this.showMessage({timeout:5e3,level:"error",content:"请选择保存目录路径"})):this.channelNo===this.channelNoTwo===this.channelNoThree?this.showMessage({timeout:5e3,level:"error",content:"不可重复选择相同通道"}):this.blfDirectory!==""?(console.log("自定义传参",this.channelNo),this.$emit("submitFiveToShow",this.dbcVal,[this.channelNo.value+"-"+this.dbcDirectory,this.channelNoTwo.value+"-"+this.dbcDirectoryTwo,this.channelNoThree.value+"-"+this.dbcDirectoryThree],[this.linChannelNo.value+"-"+this.linDbcDirectory,this.linChannelNoTwo.value+"-"+this.linDbcDirectoryTwo],this.blfDirectory)):this.showMessage({timeout:5e3,level:"error",content:"请选择保存目录路径"})},showMessage({level:e,content:s,timeout:i}){clearTimeout(Ke),e!=null&&(this.message.level=e),s!=null&&(this.message.content=s),this.message.visible=!0,i>0&&(Ke=setTimeout(()=>{this.message.visible=!1},i))}}},B=e=>(j("data-v-42953281"),e=e(),q(),e),rs={class:"o-import-dialog"},ds={class:"o-dialog-wrap"},cs={class:"o-dialog-header-wrap"},hs={class:"o-dialog-title"},us={class:"o-dialog-container-wrap"},ms={class:"o-import-configuration"},ps={class:"o-dialog-item-wrap"},fs=B(()=>a("span",{class:"o-dialog-item"},"车型/DBC：",-1)),gs={class:"o-dialog-item-select"},bs={class:"o-dialog-item-group-wrap"},_s={class:"o-dialog-item-wrap edit-modal-channel"},ys=B(()=>a("span",{class:"o-dialog-item"},"CAN通道1：",-1)),ws={class:"o-dialog-item-wrap edit-modal-channel-two"},vs=B(()=>a("span",{class:"o-dialog-item"},"CAN通道2：",-1)),Cs={class:"o-dialog-item-wrap edit-modal-channel-three"},ks=B(()=>a("span",{class:"o-dialog-item"},"CAN通道3：",-1)),Ss={class:"o-dialog-item-group-wrap"},Ts={class:"o-dialog-item-wrap edit-modal-channel"},Ds=B(()=>a("span",{class:"o-dialog-item"},"LIN通道1：",-1)),Vs={class:"o-dialog-item-wrap edit-modal-channel-two"},xs=B(()=>a("span",{class:"o-dialog-item"},"LIN通道2：",-1)),Is={class:"o-dialog-item-wrap"},Ls=B(()=>a("span",{style:{color:"red"}},null,-1)),Fs=B(()=>a("span",{class:"o-dialog-item"},"CAN通道1：",-1)),Rs={class:"o-dialog-tab"},Ms={class:"o-dialog-choose-dbc"},Es=["title"],$s={class:"o-dialog-item-wrap"},As=B(()=>a("span",{style:{color:"red"}},null,-1)),Ns=B(()=>a("span",{class:"o-dialog-item"},"CAN通道2：",-1)),Os={class:"o-dialog-tab"},Ps={class:"o-dialog-choose-dbc"},Us=["title"],Hs={class:"o-dialog-item-wrap"},Bs=B(()=>a("span",{style:{color:"red"}},null,-1)),js=B(()=>a("span",{class:"o-dialog-item"},"CAN通道3：",-1)),qs={class:"o-dialog-tab"},zs={class:"o-dialog-choose-dbc"},Ks=["title"],Ws={class:"o-dialog-item-wrap"},Gs=B(()=>a("span",{style:{color:"red"}},null,-1)),Xs=B(()=>a("span",{class:"o-dialog-item"},"LIN通道1：",-1)),Ys={class:"o-dialog-tab"},Js={class:"o-dialog-choose-dbc"},Qs=["title"],Zs={class:"o-dialog-item-wrap"},el=B(()=>a("span",{style:{color:"red"}},null,-1)),tl=B(()=>a("span",{class:"o-dialog-item"},"LIN通道2：",-1)),sl={class:"o-dialog-tab"},ll={class:"o-dialog-choose-dbc"},il=["title"],al={class:"o-dialog-item-wrap"},nl=B(()=>a("span",{style:{color:"red"}},"* ",-1)),ol=B(()=>a("span",{class:"o-dialog-item"},"保存目录：",-1)),rl=["title"],dl={class:"o-dialog-footer-wrap"},cl={class:"o-dialog-footer"},hl={key:0,class:"o-dialog-loading"};function ul(e,s,i,n,t,l){const o=w("Cascader"),r=w("v-select"),d=w("Button"),c=w("Spin"),m=w("Message"),f=H("esc");return v((h(),u("div",rs,[a("div",ds,[a("div",cs,[a("div",hs,b(e.$props.title),1),a("i",{class:"o-dialog-title-close",onClick:s[0]||(s[0]=y=>e.$emit("cancel"))})]),a("div",us,[a("div",ms,[a("div",ps,[fs,a("div",gs,[g(o,{options:l.dbcVerOpts,modelValue:t.dbcVal,"onUpdate:modelValue":s[1]||(s[1]=y=>t.dbcVal=y)},null,8,["options","modelValue"])])]),t.dbcVal[0]!="自定义模板"?(h(),u(T,{key:0},[a("div",bs,[a("div",_s,[ys,g(r,{options:l.channelOptions,clearable:!1,label:"label",value:"value",modelValue:t.channelVal,"onUpdate:modelValue":s[2]||(s[2]=y=>t.channelVal=y),class:"chf-input-ecu"},null,8,["options","modelValue"])]),a("div",ws,[vs,g(r,{options:l.channelOptions,clearable:!1,label:"label",value:"value",modelValue:t.channelValTwo,"onUpdate:modelValue":s[3]||(s[3]=y=>t.channelValTwo=y),class:"chf-input-ecu"},null,8,["options","modelValue"])])]),a("div",Cs,[ks,g(r,{options:l.channelOptions,clearable:!1,label:"label",value:"value",modelValue:t.channelValThree,"onUpdate:modelValue":s[4]||(s[4]=y=>t.channelValThree=y),class:"chf-input-ecu"},null,8,["options","modelValue"])]),a("div",Ss,[a("div",Ts,[Ds,g(r,{options:l.linChannelOptions,clearable:!1,label:"label",value:"value",modelValue:t.linChannelVal,"onUpdate:modelValue":s[5]||(s[5]=y=>t.linChannelVal=y),class:"chf-input-ecu"},null,8,["options","modelValue"])]),a("div",Vs,[xs,g(r,{options:l.linChannelOptions,clearable:!1,label:"label",value:"value",modelValue:t.linChannelValTwo,"onUpdate:modelValue":s[6]||(s[6]=y=>t.linChannelValTwo=y),class:"chf-input-ecu"},null,8,["options","modelValue"])])])],64)):(h(),u(T,{key:1},[a("div",Is,[Ls,Fs,a("div",Rs,[a("div",Ms,[a("div",{class:"o-table-dbc input-overflow-sty",title:t.dbcDirectory||"--"},b(t.dbcDirectory||"--"),9,Es),a("a",{class:"chose-file chose-dbc-file",onClick:s[7]||(s[7]=y=>l.chooseDbcPath())},"选择DBC文件")])])]),a("div",$s,[As,Ns,a("div",Os,[a("div",Ps,[a("div",{class:"o-table-dbc input-overflow-sty",title:t.dbcDirectoryTwo||"--"},b(t.dbcDirectoryTwo||"--"),9,Us),a("a",{class:"chose-file chose-dbc-file",onClick:s[8]||(s[8]=y=>l.chooseDbcPathTwo())},"选择DBC文件")])])]),a("div",Hs,[Bs,js,a("div",qs,[a("div",zs,[a("div",{class:"o-table-dbc input-overflow-sty",title:t.dbcDirectoryThree||"--"},b(t.dbcDirectoryThree||"--"),9,Ks),a("a",{class:"chose-file chose-dbc-file",onClick:s[9]||(s[9]=y=>l.chooseDbcPathThree())},"选择DBC文件")])])]),a("div",Ws,[Gs,Xs,a("div",Ys,[a("div",Js,[a("div",{class:"o-table-dbc input-overflow-sty",title:t.linDbcDirectory||"--"},b(t.linDbcDirectory||"--"),9,Qs),a("a",{class:"chose-file chose-dbc-file",onClick:s[10]||(s[10]=y=>l.chooseLinDbcPath())},"选择LDF文件")])])]),a("div",Zs,[el,tl,a("div",sl,[a("div",ll,[a("div",{class:"o-table-dbc input-overflow-sty",title:t.linDbcDirectoryTwo||"--"},b(t.linDbcDirectoryTwo||"--"),9,il),a("a",{class:"chose-file chose-dbc-file",onClick:s[11]||(s[11]=y=>l.chooseLinDbcPathTwo())},"选择LDF文件")])])])],64)),a("div",al,[nl,ol,g(d,{onClick:l.choosePath,class:"choose-path"},{default:S(()=>[C("选择路径")]),_:1},8,["onClick"]),C("    ")]),a("div",{class:"show-directory",title:t.blfDirectory},b(t.blfDirectory),9,rl)])]),a("div",dl,[a("div",cl,[g(d,{style:{width:"52px"},onClick:s[12]||(s[12]=y=>e.$emit("cancel"))},{default:S(()=>[C("取消")]),_:1}),g(d,{type:"primary",style:{width:"52px",margin:"0 20px 0 10px"},onClick:l.submit},{default:S(()=>[C("连接")]),_:1},8,["onClick"])])]),e.$props.loading?(h(),u("div",hl,[g(c)])):k("",!0)]),g(m,{message:t.message},null,8,["message"])])),[[f,()=>e.$emit("cancel")]])}const ml=E(os,[["render",ul],["__scopeId","data-v-42953281"]]);let We=0;const pl={props:["title","curViewInx","carType","sdb","tinyBatteryFlag","loading"],emits:["cancel","importFileSubmit","treeDataChange"],components:{Button:G,Cascader:Ne,Message:Z,Spin:de},data(){return{dbcVal:[X.DEFAULT[0].value,X.DEFAULT[0].children[0].value],channelValList:[{label:"(不加载)",value:0},{label:"(不加载)",value:0},{label:"(不加载)",value:0},{label:"(不加载)",value:0},{label:"(不加载)",value:0},{label:"(不加载)",value:0},{label:"(不加载)",value:0},{label:"(不加载)",value:0},{label:"(不加载)",value:0},{label:"(不加载)",value:0},{label:"(不加载)",value:0},{label:"(不加载)",value:0}],blfDirectory:"",dbcDirectoryList:["","","","","","","","","","","",""],channelNo:{label:1,value:1},channelNoTwo:{label:2,value:2},channelNoThree:{label:3,value:3},linChannelNo:{label:4,value:4},linChannelNoTwo:{label:5,value:5},message:{visible:!1,level:"",content:""},filesList:["","","","","","","","","","","","","","","",""]}},watch:{dbcVal:{handler(e){console.log("dbcVal1753",e),this.channelValList=[{label:"(不加载)",value:0},{label:"(不加载)",value:0},{label:"(不加载)",value:0},{label:"(不加载)",value:0},{label:"(不加载)",value:0},{label:"(不加载)",value:0},{label:"(不加载)",value:0},{label:"(不加载)",value:0},{label:"(不加载)",value:0},{label:"(不加载)",value:0},{label:"(不加载)",value:0},{label:"(不加载)",value:0}]},immediate:!0}},mounted(){},computed:{dbcVerOpts(){return[...X.DEFAULT,{label:"自定义模板",value:"自定义模板"}]},channelOptions(){var s,i;let e=[];if(this.dbcVal[0]!==""&&this.dbcVal[1]!==""){e=((i=(s=X.DEFAULT.find(l=>l.value===this.dbcVal[0]))==null?void 0:s.children.find(l=>l.value===this.dbcVal[1]))==null?void 0:i.comments)||[];let t=e.map((l,o)=>l&&"".concat(o,"-").concat(l)).filter(l=>l!=="").map((l,o)=>({label:l,value:Number(l.split("-")[0])}));return t.unshift({label:"(不加载)",value:0}),t}},linChannelOptions(){var s,i;let e=[];if(this.dbcVal[0]!==""&&this.dbcVal[1]!==""){e=((i=(s=rt.find(t=>t.value===this.dbcVal[0]))==null?void 0:s.children.find(t=>t.value===this.dbcVal[1]))==null?void 0:i.comments)||[];let n=e.map(t=>({label:t,value:Number(t.split("-")[0])-1e3}));return n.unshift({label:"(不加载)",value:0}),n}}},methods:{choosePath(){J.choosePath({directory:window.downloadPath,saveFilename:"tspa-Record.blf",dialogType:"SAVE_DIALOG",fileTypes:["BLF文件 (*.blf;*.BLF)"],allow_multiple:!1}).then(({data:e})=>{console.log("res>>>",e),e.directory&&(this.blfDirectory=e.directory)})},chooseDbcPath(e){console.log("inx",e),J.choosePath({dialogType:"OPEN_DIALOG",fileTypes:["DBC文件 (*.dbc;*.DBC)"],allow_multiple:!1}).then(({data:s})=>{s.directory&&(this.dbcDirectoryList[e]=s.directory)})},submit(){console.log("linChannelOptions1111",this.linChannelOptions),this.dbcVal[0]!=="自定义模板"?(console.log("提交中..123"),this.blfDirectory!==""?this.$emit("submitTwelveToShow",this.dbcVal,this.channelValList.map(e=>e.label),["(不加载)","(不加载)"],this.blfDirectory):this.showMessage({timeout:5e3,level:"error",content:"请选择保存目录路径"})):this.blfDirectory!==""?(console.log("自定义传参",this.channelValList,this.channelValList.map((e,s)=>s+1+"-"+this.dbcDirectoryList[s])),this.$emit("submitTwelveToShow",this.dbcVal,this.channelValList.map((e,s)=>s+1+"-"+this.dbcDirectoryList[s]),[],this.blfDirectory)):this.showMessage({timeout:5e3,level:"error",content:"请选择保存目录路径"})},showMessage({level:e,content:s,timeout:i}){clearTimeout(We),e!=null&&(this.message.level=e),s!=null&&(this.message.content=s),this.message.visible=!0,i>0&&(We=setTimeout(()=>{this.message.visible=!1},i))}}},Le=e=>(j("data-v-5e722cd4"),e=e(),q(),e),fl={class:"o-import-dialog"},gl={class:"o-dialog-wrap"},bl={class:"o-dialog-header-wrap"},_l={class:"o-dialog-title"},yl={class:"o-dialog-container-wrap"},wl={class:"o-import-configuration"},vl={class:"o-dialog-item-wrap"},Cl=Le(()=>a("span",{class:"o-dialog-item"},"车型/DBC：",-1)),kl={class:"o-dialog-item-select"},Sl={key:0,class:"o-dialog-item-group-wrap"},Tl={class:"o-dialog-item"},Dl=Le(()=>a("span",{style:{color:"red"}},null,-1)),Vl={class:"o-dialog-item"},xl={class:"o-dialog-tab"},Il={class:"o-dialog-choose-dbc"},Ll=["title"],Fl=["onClick"],Rl={class:"o-dialog-item-wrap"},Ml=Le(()=>a("span",{style:{color:"red"}},"* ",-1)),El=Le(()=>a("span",{class:"o-dialog-item"},"保存目录：",-1)),$l=["title"],Al={class:"o-dialog-footer-wrap"},Nl={class:"o-dialog-footer"},Ol={key:0,class:"o-dialog-loading"};function Pl(e,s,i,n,t,l){const o=w("Cascader"),r=w("v-select"),d=w("Button"),c=w("Spin"),m=w("Message"),f=H("esc");return v((h(),u("div",fl,[a("div",gl,[a("div",bl,[a("div",_l,b(e.$props.title),1),a("i",{class:"o-dialog-title-close",onClick:s[0]||(s[0]=y=>e.$emit("cancel"))})]),a("div",yl,[a("div",wl,[a("div",vl,[Cl,a("div",kl,[g(o,{options:l.dbcVerOpts,modelValue:t.dbcVal,"onUpdate:modelValue":s[1]||(s[1]=y=>t.dbcVal=y)},null,8,["options","modelValue"])])]),t.dbcVal[0]!="自定义模板"?(h(),u("div",Sl,[(h(!0),u(T,null,F(t.channelValList,(y,M)=>(h(),u("div",{class:"o-dialog-item-wrap edit-modal-channel",key:M},[a("span",Tl,"CAN通道"+b(M+1)+"：",1),g(r,{options:l.channelOptions,clearable:!1,label:"label",value:"value",modelValue:t.channelValList[M],"onUpdate:modelValue":L=>t.channelValList[M]=L,class:"chf-input-ecu"},null,8,["options","modelValue","onUpdate:modelValue"])]))),128))])):(h(!0),u(T,{key:1},F(t.dbcDirectoryList,(y,M)=>(h(),u("div",{class:"o-dialog-item-wrap",key:M},[Dl,a("span",Vl,"CAN通道"+b(M+1)+"：",1),a("div",xl,[a("div",Il,[a("div",{class:"o-table-dbc input-overflow-sty",title:t.dbcDirectoryList[M]||"--"},b(t.dbcDirectoryList[M]||"--"),9,Ll),a("a",{class:"chose-file chose-dbc-file",onClick:L=>l.chooseDbcPath(M)},"选择DBC文件",8,Fl)])])]))),128)),a("div",Rl,[Ml,El,g(d,{onClick:l.choosePath,class:"choose-path"},{default:S(()=>[C("选择路径")]),_:1},8,["onClick"]),C("    ")]),a("div",{class:"show-directory",title:t.blfDirectory},b(t.blfDirectory),9,$l)])]),a("div",Al,[a("div",Nl,[g(d,{style:{width:"52px"},onClick:s[2]||(s[2]=y=>e.$emit("cancel"))},{default:S(()=>[C("取消")]),_:1}),g(d,{type:"primary",style:{width:"52px",margin:"0 20px 0 10px"},onClick:l.submit},{default:S(()=>[C("连接")]),_:1},8,["onClick"])])]),e.$props.loading?(h(),u("div",Ol,[g(c)])):k("",!0)]),g(m,{message:t.message},null,8,["message"])])),[[f,()=>e.$emit("cancel")]])}const Ul=E(pl,[["render",Pl],["__scopeId","data-v-5e722cd4"]]);const Hl={props:{modelValue:{type:Boolean,required:!0},id:{type:String,required:!0}},computed:{checkValue:{get(){return this.modelValue},set(e){this.$emit("update:modelValue",e)}}},methods:{handleChange(e){this.checkValue=e.target.checked}}},Bl=e=>(j("data-v-c48658f3"),e=e(),q(),e),jl={class:"switch-wrap"},ql={class:"switch"},zl=["checked"],Kl=Bl(()=>a("span",null,null,-1));function Wl(e,s,i,n,t,l){return h(),u("div",jl,[a("label",ql,[a("input",{type:"checkbox",checked:l.checkValue,onChange:s[0]||(s[0]=(...o)=>l.handleChange&&l.handleChange(...o))},null,40,zl),Kl])])}const Gl=E(Hl,[["render",Wl],["__scopeId","data-v-c48658f3"]]);let le=[],Ge=0;const Xl={props:["signals","carType","sdb","dbcVal","fileType","defaultOptions","filledOptions","loading","dbcChn","ldfChn"],emits:["signalsChange","cancel"],components:{Button:G,RecycleScroller:he,Spin:de,Message:Z},data(){var s,i,n,t,l,o,r,d,c;const e=this.$ls.get("blfread_sdbData")||[];if(console.log("sdbCustom123",this.$props.dbcVal,this.sdb,this.dbcChn,this.ldfChn),this.carType==="custom"){let m=(s=e.find(f=>f.sdb===this.sdb))==null?void 0:s.comments;m&&(le=["",...m])}else if(console.log("6777",this.ldfChn,this.dbcChn),this.ldfChn.every(m=>m==0)&&this.dbcChn.some(m=>m>0)&&(le=((n=(i=je.find(m=>m.value===this.$props.carType))==null?void 0:i.children.find(m=>m.value===this.$props.sdb))==null?void 0:n.comments)||[]),this.ldfChn.some(m=>m>0)&&this.dbcChn.every(m=>m<0)&&(le=((l=(t=Ie.find(m=>m.value===this.$props.carType))==null?void 0:t.children.find(m=>m.value===this.$props.sdb))==null?void 0:l.comments)||[]),this.ldfChn.some(m=>m>0)&&this.dbcChn.some(m=>m>0)){console.log("5566");let m=((r=(o=je.find(y=>y.value===this.$props.carType))==null?void 0:o.children.find(y=>y.value===this.$props.sdb))==null?void 0:r.comments)||[],f=((c=(d=Ie.find(y=>y.value===this.$props.carType))==null?void 0:d.children.find(y=>y.value===this.$props.sdb))==null?void 0:c.comments)||[];le=m.concat(f)}return console.log("C2C123",le),le=le.map((m,f)=>"".concat("⓪①②③④⑤⑥⑦⑧⑨⑩⑪⑫⑬⑭⑮⑯⑰⑱⑲⑳㉑㉒㉓㉔㉕㉖㉗㉘㉙㉚㉛㉜㉝㉞㉟㊱㊲"[f]).concat(m)),{inputStr:"",treeData:[],checkedList:[],isFilled:!1,message:{visible:!1,level:"",content:""},showSignalsList:[]}},computed:{list(){let e=[];for(let s=0;s<this.treeData.length;s++){let i=this.treeData[s];i.id!=-1&&e.push({_id:i.id,id:i.id,node_type:i.node_type,text:i.text});for(let n=0;n<i.children.length;n++){let t=i.children[n];t.id[0]!="-"&&e.push({_id:i.id+"-"+t.id,id:t.id,node_type:t.node_type,text:t.text});for(let l=0;l<t.children.length;l++){let o=t.children[l];e.push({...o,_id:i.id+"-"+t.id+"-"+o.id})}}}return console.log(e,11111111),e}},watch:{isFilled(e,s){this.dataInit()}},async created(){this.dataInit()},mounted(){console.log(this.$props.signals),this.$refs.chsInputRef.focus(),this.checkedList=this.$props.signals,this.updateChecked(),setTimeout(()=>{document.body.addEventListener("mousedown",this.clickHandler)},300)},beforeUnmount(){},unmounted(){document.body.removeEventListener("mousedown",this.clickHandler)},methods:{onFilledChange(e){this.inputStr="",this.isFilled=!this.isFilled},title4node(e){return we(e)},clickHandler(e){var s;((s=this.$refs.root)==null?void 0:s.contains(e.target))==!1&&this.$emit("cancel")},dataInit(){let e=[];console.log(this.$props.filledOptions.data,33333333333);let s=this.$props.filledOptions.data;for(let i in s){let n={id:+i,text:le[i],node_type:"channel",children:[]};for(let t in s[i]){let l={id:i+"_"+t,text:t=="-1"?"":t,node_type:"msg",channel:n.id,children:s[i][t].map(o=>{var r;return{id:o[0],msg:t=="-1"?"-1":+((r=t.match(/\(([^)]+)\)/))==null?void 0:r[1].toUpperCase().replace(/X/g,"x"))||t,channel:n.id,text:o[0],node_type:"signal",comment:o[1],remark:o[2],maxRaw:o[5],minRaw:o[6],enums:o[9],unit:o[10]}})};n.children.push(l)}e.push(n)}this.treeData=Object.freeze(e),console.log(this.treeData)},selectNode(e){console.log(this.checkedList);let s=this.checkedList.map(i=>({...i}));s.some(i=>i._id===e._id)?(console.log("s1"),this.checkedList=s.filter(i=>i._id!==e._id)):(console.log("s2"),s.length<30?this.checkedList=[...s.filter(i=>i._id!==e._id),e]:this.showMessage({level:"error",content:"选择不能超过".concat(s.length,"项"),timeout:2e3}))},showMessage({level:e,content:s,timeout:i}){clearTimeout(Ge),e!=null&&(this.message.level=e),s!=null&&(this.message.content=s),this.message.visible=!0,i>0&&(Ge=setTimeout(()=>{this.message.visible=!1},i))},submit(){this.$emit("signalsChange",this.checkedList)},updateChecked(){},highlightWord(e){if(!e)return e;const s=this.inputStr;if(!s)return e;const i=s.split(/\s+/g);var n,t=i.length,l;for(n=0;n<t;n++)try{l=new RegExp(i[n],"gi"),l.test(e)&&(e=e.replace(l,"<strong>$&</strong>"))}catch(o){l=i[n],e=e.replace(l,"<strong>$&</strong>")}return e},onChange:pt(function(){let s=!1,i=this.inputStr.toLowerCase();i.startsWith("0x")&&(s=!0);let n;try{n=new RegExp(i,"i")}catch(o){n={test(r){return~r.toLowerCase().indexOf(r.toLowerCase())}}}let t=[],l=this.$props.filledOptions.data;for(let o in l){let r={id:+o,text:le[o],node_type:"channel",children:[]};for(let d in l[o]){let c=s&&d.includes(i),m={id:o+"_"+d,text:d=="-1"?"":d,node_type:"msg",channel:r.id,children:l[o][d].filter(f=>c||n.test(f[0])||n.test(f[1])).map(f=>{var y;return{id:f[0],msg:d=="-1"?"-1":+((y=d.match(/\(([^)]+)\)/))==null?void 0:y[1].toUpperCase().replace(/X/g,"x")),channel:r.id,text:f[0],node_type:"signal",comment:f[1],remark:f[2],maxRaw:f[5],minRaw:f[6],enums:f[9],unit:f[10]}})};m.children.length>0&&r.children.push(m)}(r.children.length>0||n.test(r.text)||n.test(r.comment))&&t.push(r)}this.treeData=t,console.log(this.treeData),this.updateChecked()},500,{leading:!1})}},Yl=e=>(j("data-v-a3e0c615"),e=e(),q(),e),Jl={class:"chs-er",ref:"root"},Ql={class:"chs-list-er"},Zl={key:0,class:"chs-node"},ei=["innerHTML"],ti=["onMousedown","for"],si=["id","checked"],li=["innerHTML"],ii=["innerHTML"],ai={key:0,class:"spin-loding-style"},ni=Yl(()=>a("div",null,null,-1));function oi(e,s,i,n,t,l){const o=w("RecycleScroller"),r=w("Spin"),d=w("Message"),c=H("tooltip"),m=H("esc");return v((h(),u("div",Jl,[v(a("input",{class:"chs-input-er",ref:"chsInputRef",placeholder:"搜索信号名称/信号描述","onUpdate:modelValue":s[0]||(s[0]=f=>t.inputStr=f),onInput:s[1]||(s[1]=(...f)=>l.onChange&&l.onChange(...f)),draggable:!1},null,544),[[Q,t.inputStr]]),a("div",Ql,[g(o,{class:"chs-list",items:l.list,"item-size":28,"key-field":"_id"},{default:S(({item:f})=>[f.node_type=="channel"?(h(),u("div",Zl,b(f.text),1)):f.node_type=="msg"?(h(),u("div",{key:1,class:"chs-node",style:{"text-indent":"1em"},innerHTML:l.highlightWord(f.text)},null,8,ei)):f.node_type=="signal"?v((h(),u("div",{key:2,onMousedown:A(y=>l.selectNode(f),["prevent","stop"]),for:f._id,style:{"text-indent":"2em"},class:"chs-node chs-node-item"},[a("input",{id:f._id,type:"checkbox",class:"chs-node-checkbox",checked:t.checkedList.some(y=>y._id===f._id)},null,8,si),a("span",{class:"chs-node-signal",innerHTML:l.highlightWord(f.text)},null,8,li),C(" "),a("span",{class:"chs-node-comment",innerHTML:l.highlightWord(f.comment)},null,8,ii)],40,ti)),[[c,{content:l.title4node(f),html:!0},void 0,{right:!0}]]):k("",!0)]),_:1},8,["items"]),a("div",{class:ue(t.checkedList.length==30?"chs-ft-label-len":"chs-ft-label")},"（"+b(t.checkedList.length)+"/30）",3),a("div",{class:"chs-btn confirm","data-cy":"chooseSignalSubmit",onClick:s[2]||(s[2]=(...f)=>l.submit&&l.submit(...f))},"确定"),a("div",{class:"chs-btn cancel",onClick:s[3]||(s[3]=f=>e.$emit("cancel"))},"取消"),e.$props.loading?(h(),u("div",ai,[ni,g(r)])):k("",!0),g(d,{message:t.message},null,8,["message"])])])),[[m,()=>e.$emit("cancel")]])}const ri=E(Xl,[["render",oi],["__scopeId","data-v-a3e0c615"]]);const di={props:["chartTableData","showSignalsList"],computed:{mergedArray(){return this.$props.chartTableData.map(e=>{const s=this.$props.showSignalsList.find(i=>i.name===e.name);return s?{...e,...s}:e})}},watch:{mergedArray:{deep:!0,handler(e,s){this.mergedArray.forEach((i,n)=>{let t=Math.trunc((i.raw_values[i.raw_values.length-1]-Math.abs(i.minRaw))/(i.maxRaw-Math.abs(i.minRaw))*100)>100?100:Math.trunc((i.raw_values[i.raw_values.length-1]-Math.abs(i.minRaw))/(i.maxRaw-Math.abs(i.minRaw))*100);this.mergedArray[n].proportion=t,console.log(this.mergedArray[n].proportion,i.raw_values[i.raw_values.length-1]-Math.abs(i.minRaw),Math.abs(i.minRaw),(i.raw_values[i.raw_values.length-1]-Math.abs(i.minRaw))/(i.maxRaw-Math.abs(i.minRaw))*100,"11111111")})}}},data(){return{}}},Oe=e=>(j("data-v-bef7743b"),e=e(),q(),e),ci={style:{"overflow-y":"auto",height:"calc(100vh - 215px)",border:"1px solid #f0f0f0",width:"calc(100% - 20px)",position:"relative"}},hi={class:"o-table"},ui=Oe(()=>a("thead",{class:"o-table-thead",style:{"background-color":"#FAFAFA"}},[a("tr",null,[a("th",{class:"o-table-cell"},[a("div",{style:{display:"flex","justify-content":"space-between","align-items":"center"}},[a("div",null,"Name"),a("div",{class:"time-line"})])]),a("th",{class:"o-table-cell"},[a("div",{style:{display:"flex","justify-content":"space-between","align-items":"center"}},[C(" Value "),a("div",{class:"time-line"})])]),a("th",{class:"o-table-cell"},[a("div",{style:{display:"flex","justify-content":"space-between","align-items":"center"}},[C(" Unit "),a("div",{class:"time-line"})])]),a("th",{class:"o-table-cell"},[a("div",{style:{display:"flex","justify-content":"space-between","align-items":"center"}},[C(" Raw Value "),a("div",{class:"time-line"})])]),a("th",{class:"o-table-cell"},[a("div",{style:{display:"flex","justify-content":"space-between","align-items":"center"}},[C(" Bar "),a("div",{class:"time-line"})])]),a("th",{class:"o-table-cell"},"Commont")])],-1)),mi={class:"o-table-tbody"},pi={key:0,class:"o-pul-button-wrap-icon"},fi=Oe(()=>a("img",{class:"text-muted-ing-data",src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAKAAAACICAMAAABX7hBEAAAAM1BMVEUAAAD////Nzc0MDAyXl5cAAAAAAAC9vb3t7e0BAQF1dXUAAAApKSkAAABBQUFXV1cAAACKKc10AAAAEXRSTlMATExMTAk1TExBTCFLF0tMKkK5GFYAAAL4SURBVHja7JntauswDIZty7Is+fP+r/Y0dUOz0BZzMKkGe35sMFh5Kr2Sndb88cd/gR2NahBAuWJolZNmxd6iz1z0KiJEGwVCMVoBsvauqLWIQaxVrZhqtHeoscqBRiY7iJRVDjSL3dkGWt+09GqtasUCWSg+FSUrm5ZQJUNuPu6STtdAF/DOkVSAKm5XbIpOaG7uDvmWAZqPyhQLkCM3oFFI726SkZRcIoKQ5NrEE9HTUShuA63ghC5ADUC27kJum+febPFRwSUCueXsx32BvNThKeLvhczef3ugE0AlqmIHMUbnpQ3P2mD7Bd9URIZKzkmN9shNc5TzwfcuER2g3aiwC548yUvLQ9FcDqIxKQyA7FuirwAczLVgCpyOu+aNHEkGDpfvQ+zMHfF8aT33V2re5C7PHyY+bzfM7ly5BkPuepC5mDPsj3J1tPU7lJc7I4gKuRuJy8s/55WZW+9nkBXI3Sic3pknDZ9+4M1PNV3To8YLEEopGjr5jgDAzOoee3ewj8egpNQQGcIjiWwUgtz3EUaNJcQQnl5B4bIJwSCjGfRutFEYN0G9FeRkNkG1GUTAg1didbu6h/vPIVYUHsgjdBg4lRQU+u3NxcSs8oN81Be6Xyeobq/sfGkzY5ilvDjbSljF+74kaDJDYxxOxxBy80uon5IdMrkZHi+CgMcnYLuEnD7Gvk0ZUu6nECKLXQJ9Xg2Fxc3gYRwiz3+ENQWMNU18PzSBAP6cr1UFBDSf6UBzhj9akfIVBRyEOhfDGtAsT6Df3/aiQdlJdVEBnyO8alAG7C8p4E6ajSHg4gRCMlP0PNfk9tjXqwu4OoYpX5bAHZyP4dICmhMr9nUxfXkBlw4K/2vfXlIABKEAikbaR7P9b7d5kxREDM5dwVGcPNS71wbm1PhmI1ZVQjn6FK7GoXx0rRNOipULj2eX4r60AteqQqcjCAgICAgICAgICAgICAgICAgICAgICAgICAgI+BdgHn3buX1/XJmr9AZus7VIkiRJD2y6ViB4C1+1AAAAAElFTkSuQmCC",alt:""},null,-1)),gi=Oe(()=>a("td",{class:"text-center text-muted-data"},"请先选择信号并确认",-1)),bi=[fi,gi],_i={class:"o-table-cell"},yi={class:"o-table-cell"},wi={class:"o-table-cell"},vi={class:"o-table-cell"},Ci={class:"o-table-cell",style:{width:"230px"}},ki={class:"o-table-cell"},Si={style:{width:"360px","white-space":"nowrap",overflow:"hidden","text-overflow":"ellipsis"}};function Ti(e,s,i,n,t,l){const o=H("tooltip");return h(),u("div",ci,[a("table",hi,[ui,a("tbody",mi,[l.mergedArray.length==0?(h(),u("div",pi,bi)):k("",!0),(h(!0),u(T,null,F(l.mergedArray,(r,d)=>(h(),u("tr",{key:d},[a("td",_i,b(r.name),1),a("td",yi,b(Object.keys(r.enums).length===0?r.values[r.values.length-1]:r.enums[r.values[r.values.length-1]]),1),a("td",wi,b(r.unit),1),a("td",vi,b(r.raw_values[r.raw_values.length-1]),1),a("td",Ci,[a("div",{style:$({width:r.proportion+"%"}),class:"proportion"},null,4)]),v((h(),u("td",ki,[a("div",Si,b(r.comment),1)])),[[o,r.comment]])]))),128))])])])}const Di=E(di,[["render",Ti],["__scopeId","data-v-bef7743b"]]);let Xe=0;const Vi={props:["store","closeFlag","getDbcData","dbcVal","sdb","dbcChn","ldfChn","chartTableData"],emits:["connect","showMessage","getCarCode"],components:{Button:G,TableChart:Di,Header:ot,ManageViewsGroup:wt,Draggable:vt,ChooseSignal:ri,AddOrSelector:bt,TimePlotMulti:_t,ProgressBar:yt,Message:Z,ButtonGroup:ve,Switch:Gl},data(){var s,i,n;let e=(s=this.$ls.get("blfread_treeData"))==null?void 0:s.map(t=>({...t,carType:t.carType||"MS11",sdb:t.sdb||"E4U1",children:t.children.map(l=>({...l,warning:!1,pid:t.id,color:l.color||"blue"}))}));return(!e||(e==null?void 0:e.length)===0)&&(e=[]),e=e.filter(t=>!(t.carType==="MS11"&&t.sdb==="E4U1"&&t.text==="默认视图"&&t.children.length===0)),e.some(t=>t.carType==="MS11"&&t.sdb==="E4U1"),this.$ls.set("blfread_treeData",e),{system:dt,modeOptions:[{label:"分散",value:"single"},{label:"对齐",value:"same"},{label:"聚合",value:"shifted"}],chartMode:"single",timeFilterOptions:[{label:"绝对时间",value:"absolute"},{label:"相对时间",value:"relative"}],timeFilterMode:{label:"绝对时间",value:"absolute"},startTime:0,showDotsFrame:!1,fileType:"blf",blfcpp:"cpp",isBigFile:!1,chooseSignalAble:!1,message:{visible:!1,level:"",content:""},modal:{title:"导入文件",visible:!1},manageModal:{title:"管理视图",manageVisible:!1},treeData:e.map(t=>(t.children.forEach(l=>{l.warning=!1}),t)),curView:{label:(i=e[0])==null?void 0:i.text,value:0,tag:(n=e[0])==null?void 0:n.sdb},C2C:[],colorList:["blue","cerulean","cyan","green","lime","purple","pink","red","orange","yellow"],directory:"",carType:"MS11",directorySize:{label:"",value:0,durationMaybe:0,durationMaybeLabel:"0秒"},backBlock:!1,chartDataLoaded:!0,waitChart:{},fileChoosed:!1,traceList:new Map,timeData:Object.freeze([]),tableList:[],channelVersion:[{label:"全部",value:""}],channelVal:"全部",ECUVersion:[{label:"全部",value:""}],ECUVal:"全部",canIdsVersion:[{label:"全部",value:""}],canIdsVal:"全部",filterTableList:[],columnDefs:[{headerName:"Time",field:"timeTabData"},{headerName:"Chn",field:"chnTabData",width:80},{headerName:"ID",field:"idTabData",width:80},{headerName:"Name",field:"nameTabData",width:300},{headerName:"Event Type",field:"eventTabData"},{headerName:"Dir",field:"dirTabData",width:80},{headerName:"DLC",field:"dlcTabData",width:80},{headerName:"文本ECU",field:"dataTabData"}],debug:window._debug,signalLoading:!1,defaultOptions:{},filledOptions:{},showSignalsList:[],objSing:{},mlistChart:[{key:"timeChart",name:" 切换为折线图",icon:"box"},{key:"tableChart",name:"切换为表格",icon:"setting"}],curChart:"timeChart",tablechartShow:!0,timechartShow:!1,timeLimit:10,minTime:0,turnTimeLimit:!1}},computed:{sdbVal(){return[this.carType,this.sdb]},quitConfirm(){return!!this.directory.trim()},treeDataDbc(){return this.treeData.map((e,s)=>({...e,label:e.text,value:s,tag:e.sdb})).filter(e=>e.carType===this.carType&&e.sdb===this.sdb)},carTypeLabel(){return this.carType&&this.carType!=="custom"?this.carType+" / ":""},view(){var e;return this.treeData[(e=this.curView)==null?void 0:e.value]},directoryLabel(){let e=this.directory.split("/").pop();return e.length>25?e.slice(0,10)+"..."+e.slice(-15):e},fileType_CarType(){return[this.fileType,this.carType]}},mounted(){this.debug=!!window._debug,this.fillEmptyTreeData(),this.curView=this.treeDataDbc[0],console.log("this.curView111",this.treeData),ye.report("trackPage",{page:"查看报文",tip:"1174.10.0.1.27765"}),window._timeData=this.timeData},beforeUnmount(){this.timeData=[]},unmounted(){D.blf.freeSpace(),D.ascReader.freeSpace(),D.logReader.freeSpace(),window._timeData.forEach(e=>{e.t.length=0})},watch:{fileType_CarType(){this.fileType==="mdf"?this.blfcpp="cpp":this.debug||(this.carType==="custom"?this.blfcpp="python":this.blfcpp="cpp")},blfcpp:{handler(e){window._blfcpp=e},immediate:!0},sdbVal:{handler(e){var n,t,l;let s=[];const i=this.$ls.get("blfread_sdbData")||[];if(this.carType==="custom"){let o=(n=i.find(r=>r.sdb===this.sdb))==null?void 0:n.comments;o&&(s=["",...o])}else s=((l=(t=SDB.DEFAULT.find(o=>o.value===this.carType))==null?void 0:t.children.find(o=>o.value===this.sdb))==null?void 0:l.comments)||[];this.C2C=s.map((o,r)=>"".concat("⓪①②③④⑤⑥⑦⑧⑨⑩⑪⑫⑬⑭⑮⑯⑰⑱⑲⑳㉑㉒㉓㉔㉕㉖㉗㉘㉙㉚㉛㉜㉝㉞㉟㊱㊲"[r]).concat(o))},immediate:!0},chartDataLoaded(e,s){e?(this.backBlock=!1,document.querySelector(".o-body").style.cursor=""):(this.backBlock=!0,document.querySelector(".o-body").style.cursor="wait")},treeData:{handler(e,s){JSON.stringify(this.$ls.get("blfread_treeData"))!==JSON.stringify(e)&&this.$ls.set("blfread_treeData",e)},deep:!0},chooseSignalAble:{handler(){this.filledOptions=this.$props.getDbcData}},directory:{async handler(e){const s=await J.getFileSize(e),i=.83*.2,n=Math.round((1678e-19*s*s+1768e-10*s+.5581)*i);this.directorySize={label:kt(s),value:s,durationMaybe:n*1e3,durationMaybeLabel:Tt(n)}}},curView:{handler(e){this.updateSignal(this.view.children)},deep:!0},dbcVal:{handler(e){this.carType=e==="自定义模板"?"custom":e.split("/")[0]},deep:!0}},beforeUpdate(){},methods:{choose(e){this.curChart=e,e=="timeChart"?(this.timechartShow=!1,this.tablechartShow=!0):e=="tableChart"&&(this.timechartShow=!0,this.tablechartShow=!1)},upTimeData(e){if(!((e==null?void 0:e.length)>0))return;let s=Date.now()/1e3-(this.turnTimeLimit?this.timeLimit:1200);console.log("minTime",s);let i=this.timeData.slice();e.forEach(n=>{var l;let t=i.find(o=>o.channel===n.busId&&o.msg===n.canId&&o.name===n.name);for(;((l=t==null?void 0:t.t)==null?void 0:l[0])<s;)t.t.shift(),t.v.shift();t&&(t.t.push(...n.times.map(o=>+o.toFixed(3))),t.v.push(...n.values))}),this.timeData=Object.freeze(i),this.loadChart(this.view)},onUpdateDefaultOptions(e){this.defaultOptions=Object.freeze(e)},title4node(e){return we(e)},showMessage({level:e,content:s,timeout:i}){clearTimeout(Xe),e!=null&&(this.message.level=e),s!=null&&(this.message.content=s),this.message.visible=!0,i>0&&(Xe=setTimeout(()=>{this.message.visible=!1},i))},hideMessage(){this.message.visible=!1},onTreeDataChange(){this.treeData=this.$ls.get("blfread_treeData")},fillEmptyTreeData(){SDB.DEFAULT.forEach(e=>{e.children.forEach(s=>{this.treeData.some(i=>i.carType===e.value&&i.sdb===s.value)||this.treeData.push({id:+Math.random().toString().replace(".",""),text:"默认视图",type:"view",editable:!1,carType:e.value,sdb:s.value,deleteConfirm:!1,children:[]})})})},deleteView(e){let s=this.treeData.filter(i=>i.id!==e.id);this.curView.value=s.findIndex(i=>i.id===this.view.id),this.treeData=s},updateView(e){this.treeData=this.treeData.map(s=>s.id===e.id?e:s)},onImportView(e){this.addView(e)},resetTimeData(){this.directory="",this.backBlock=!1,this.chartDataLoaded=!0,this.waitChart={},this.fileChoosed=!1,this.traceList=new Map},choosePath(){this.fileType==="blf"?(this.chartDataLoaded=!1,this.clearTimeData(),D.blf.getBLFdata({blfFile:this.directory,mode:this.isBigFile?"bigFile":void 0}).then(async e=>{this.startTime=e.data.startTime,this.fileChoosed=!0,this.treeData.forEach(i=>{this.waitChart[i.id]=!0});let s=this.treeData.slice();s.splice(this.curView.value,1),s.unshift(this.treeData[this.curView.value]),s=s.filter(i=>i.carType===this.carType&&i.sdb===this.sdb),D.blf.haveDataSignal({}).then(i=>{this.filledOptions=Object.freeze(i.data),this.signalLoading=!1});for(let i=0;i<s.length;i++)await this.play(s[i]),i===0&&(this.chartDataLoaded=!0)}).catch(()=>{}).finally(()=>{this.chartDataLoaded=!0,this.signalLoading=!1})):this.fileType==="mdf"?(async()=>{this.signalLoading=!1,this.chartDataLoaded=!1,this.clearTimeData(),this.fileChoosed=!0,this.treeData.forEach(s=>{this.waitChart[s.id]=!0});let e=this.treeData.slice();e.splice(this.curView.value,1),e.unshift(this.treeData[this.curView.value]),e=e.filter(s=>s.carType===this.carType&&s.sdb===this.sdb),await this.play(this.treeData[this.curView.value]);for(let s=0;s<e.length;s++)await this.play(e[s]),s===0&&(this.chartDataLoaded=!0)})():this.fileType==="asc"?(this.chartDataLoaded=!1,this.clearTimeData(),D.ascReader.getAscdata({ascFile:this.directory}).then(async e=>{var i,n;this.startTime=((n=(i=e.data)==null?void 0:i.data)==null?void 0:n.startTime)||0,this.fileChoosed=!0,this.treeData.forEach(t=>{this.waitChart[t.id]=!0});let s=this.treeData.slice();s.splice(this.curView.value,1),s.unshift(this.treeData[this.curView.value]),s=s.filter(t=>t.carType===this.carType&&t.sdb===this.sdb),D.ascReader.haveDataSignal({ascFile:this.directory}).then(t=>{this.filledOptions=Object.freeze(t.data),this.signalLoading=!1});for(let t=0;t<s.length;t++)await this.play(s[t]),t===0&&(this.chartDataLoaded=!0)}).catch(()=>{}).finally(()=>{this.chartDataLoaded=!0,this.signalLoading=!1})):this.fileType==="log"&&(this.chartDataLoaded=!1,this.clearTimeData(),D.logReader.getLogData({logFile:this.directory}).then(async e=>{var i,n;this.startTime=((n=(i=e.data)==null?void 0:i.data)==null?void 0:n.startTime)||0,this.fileChoosed=!0,this.treeData.forEach(t=>{this.waitChart[t.id]=!0});let s=this.treeData.slice();s.splice(this.curView.value,1),s.unshift(this.treeData[this.curView.value]),s=s.filter(t=>t.carType===this.carType&&t.sdb===this.sdb),D.logReader.haveDataSignal({ascFile:this.directory}).then(t=>{this.filledOptions=Object.freeze(t.data),this.signalLoading=!1});for(let t=0;t<s.length;t++)await this.play(s[t]),t===0&&(this.chartDataLoaded=!0)}).catch(()=>{}).finally(()=>{this.chartDataLoaded=!0,this.signalLoading=!1}))},clearTimeData(){this.timeData=Object.freeze([]),this.treeData.forEach(e=>{e.children.forEach(s=>{s.warning=void 0})})},hideSignal(e,s){e.hidden=!e.hidden,this.play(s,!0)},deleteSignal(e){this.treeData=this.treeData.map(s=>{if(s.id==e.pid){let i={...s,children:s.children.filter(n=>!(n.id==e.id&&n.msg==e.msg&&n.channel==e.channel))};return this.$nextTick(()=>this.play(i,!0)),i}return{...s}})},async play(e,s){console.log("this.$props.getDbcData1041",this.$props.getDbcData),this.loadChart(e)},loadChart(e){console.log("node1727",e,this.timeData);const s={blue:"#2266ff",cerulean:"#00c7f2",cyan:"#00e0b8",green:"#3fd926",lime:"#add900",purple:"#8125ff",pink:"#ff4475",red:"#ff3838",orange:"#ffad4d",yellow:"#f1d900"},i=e.children.filter(n=>!n.hidden).map((n,t)=>{const l=this.timeData.find(o=>n.channel===o.channel&&n.msg===o.msg&&n.text===o.name);return l?{...l,color:s[n.color]}:{name:n.text,enums:n.enums,channel:n.channel,msg:n.msg,color:s[this.colorList[t%9]],t:[],v:[]}});this.timeData=Object.freeze(i)},tranLinCanId(e){const s=e.match(/\(([^)]+)\)/);if(s){const i=s[1],n=parseInt(i,16);return console.log(n),n}},async updateSignal(e,s){var l;console.log("signals8899",e,(l=this.curView)==null?void 0:l.value,this.treeData),e.length==0&&(this.timeData=Object.freeze([])),this.showSignalsList=[],e.forEach(o=>{let r={};r.busId=o.channel,r.canId=o.msg,r.name=o.text,r.color=o.color,r.maxRaw=+o.maxRaw,r.minRaw=+o.minRaw,r.comment=o.comment,r.unit=o.unit,r.enums=o.enums,this.showSignalsList.push(r)});let i=this.showSignalsList.filter((o,r)=>this.showSignalsList.findIndex(d=>d.name===o.name)===r),n=await D.blfLogging.selectShowSignals(i);n.data.code!==1&&this.showMessage({timeout:2e3,level:"error",content:n.data.msg});const t=this.view;this.treeData=this.treeData.map(o=>{if(o.id==t.id){let r=e.map((c,m)=>{let f=o.children.find(y=>c.id==y.id&&c.msg==y.msg&&c.channel==y.channel);return f?{...f,pid:o.id,color:s=="1"||(c==null?void 0:c.colorEditable)==!1?c.color:this.colorList[m%9]}:{_id:c._id,pid:o.id,id:c.id,text:c.text,comment:c.comment,remark:c.remark,msg:c.msg,channel:c.channel,type:"signal",color:s=="1"||(c==null?void 0:c.colorEditable)==!1?c.color:this.colorList[m%9],colorEditable:!1,maxRaw:+c.maxRaw,minRaw:+c.minRaw,comment:c.comment,unit:c.unit,enums:c.enums}});return{...o,children:r}}return o}),this.upTimeData(),this.chooseSignalAble=!1},goBackHome(){this.$router.push({path:"/"})},importFile(){this.modal.visible=!0},addView(e){let s=e.label||"新建视图"+(this.treeData.length+1);if(this.treeData=[...this.treeData,{id:e.id||Date.now(),text:s,type:"view",editable:!1,deleteConfirm:!1,children:(e==null?void 0:e.children)||[],carType:(e==null?void 0:e.carType)||this.carType,sdb:(e==null?void 0:e.sdb)||this.sdb}],(e==null?void 0:e.from)==="AddOrSelector"){let i=this.treeData.length-1;this.curView={label:this.treeData[i].text,value:i}}},onSwitchView({fromNode:e,toNode:s}){this.view.id===e.id?this.curView.value=this.treeData.findIndex(i=>i.id===s.id):this.view.id===s.id&&(this.curView.value=this.treeData.findIndex(i=>i.id===e.id)),this.treeData=this.treeData.map(i=>i.id===e.id?s:i.id===s.id?e:i)},manageShow(){this.manageModal.manageVisible=!0},onCancelImportFile(){this.modal.visible=!1},async onCancelSelect(e){this.manageModal.manageVisible=!1;const s=this.treeData.findIndex(n=>n.id===e),i=this.treeData[s];if(console.log("view334",i),this.curView={label:this.treeData[s].text,value:s,tag:i.sdb},this.carType!==i.carType||this.sdb!==i.sdb){let n=[],t=[];if(i.carType==="custom"){const o=(this.$ls.get("blfread_sdbData")||[]).find(r=>r.sdb===i.sdb);n=o.files,t=o.comments}this.onCheckView({curId:i.id,carType:i.carType,sdb:i.sdb,directory:this.directory,files:n,comments:t})}else this.$nextTick(()=>{const n=i,t=n.id;this.waitChart[t]===void 0&&this.directory&&this.play(n)}),this.fileType=="mdf"&&this.play(this.treeData[this.curView.value])},onCheckView(e){this.signalLoading=!0,this.resetTimeData(),this.$nextTick(()=>{this.modal.visible=!1;let i=this.treeData.filter(n=>n.id===e.curId).map(n=>({label:n.text,value:this.treeData.findIndex(t=>t.id===e.curId)}));this.curView=i[0],this.carType=e.carType,this.sdb=e.sdb,this.directory=Ct(e.directory),this.files=e.files.length?e.files:void 0,this.comments=e.comments.length?e.comments:void 0,this.fileType=e.fileType,e.isBigFile!==void 0&&(this.isBigFile=e.isBigFile),e.fileType==="mdf"?D.mdf.getSignals({mdfPath:e.directory}).then(n=>{this.defaultOptions=Object.freeze(n.data.data)}).then(()=>{this.choosePath()}):this.$nextTick(async()=>{console.log("this.carType7788",this.carType),this.carType==="custom"?this.fileType==="blf"?await D.blf.getDBC({carType:this.carType,sdb:this.sdb,files:this.files,comments:this.comments}).then(n=>{this.defaultOptions=Object.freeze(n.data)}):this.fileType==="log"?await D.logReader.getDBC({carType:this.carType,sdb:this.sdb,files:this.files,comments:this.comments}).then(n=>{this.defaultOptions=Object.freeze(n.data)}):await D.ascReader.getDBC({carType:this.carType,sdb:this.sdb,files:this.files,comments:this.comments}).then(n=>{this.defaultOptions=Object.freeze(n.data)}):this.fileType==="blf"?await D.blf.reAdjust(e.sendReAdjust):this.fileType==="log"?(e.adaptedType=="noAdapted"&&await D.logReader.getDBC({carType:this.carType,sdb:this.sdb,files:this.files,comments:this.comments}).then(n=>{this.defaultOptions=Object.freeze(n.data)}),await D.logReader.reAdjust(e.sendReAdjust)):(e.adaptedType=="noAdapted"&&await D.ascReader.getDBC({carType:this.carType,sdb:this.sdb,files:this.files,comments:this.comments}).then(n=>{this.defaultOptions=Object.freeze(n.data)}),await D.ascReader.reAdjust(e.sendReAdjust)),console.log("this.defaultOptions",this.defaultOptions),this.choosePath()})}),ye.report("track","click",{element_name:"查看报文",asset_name:this.directory+";",tip:"1174.10.0.1.27766"})},onExportDotsData(e){const s=e.map(i=>i.join("	")).join("\n");St(s,"tspa-打点-"+$e()+".txt")},changeState(){this.turnTimeLimit=!this.turnTimeLimit,console.log("this.turnTimeLimit ? this.timeLimit : 1200",this.turnTimeLimit?this.timeLimit:1200)}}},W=e=>(j("data-v-10f33d12"),e=e(),q(),e),xi={class:"o-pul-er"},Ii={key:0,class:"o-column"},Li={class:"o-column-left"},Fi=W(()=>a("div",{class:"o-resize-bar"},null,-1)),Ri=W(()=>a("div",{class:"o-resize-line"},null,-1)),Mi={class:"o-resize-save"},Ei={class:"o-pul-board"},$i={class:"o-pul-select-wrap"},Ai={class:"o-pul-button-wrap"},Ni=W(()=>a("i",{class:"t-icon chooseSignal"},null,-1)),Oi=W(()=>a("span",null,"选择信号",-1)),Pi=[Ni,Oi],Ui=W(()=>a("span",{style:{color:"#D9D9D9","font-size":"18px",transform:"scaleX(0.5)"}},"|",-1)),Hi=W(()=>a("i",{class:"t-icon manageView"},null,-1)),Bi=W(()=>a("span",null,"管理视图",-1)),ji=[Hi,Bi],qi=["data-empty"],zi=["data-hidden"],Ki=["data-open","onClick"],Wi=["data-color","onClick"],Gi=["onMouseleave"],Xi=["title","data-color","onClick"],Yi={class:"t-node-text"},Ji={key:0,class:"t-node-warning"},Qi={key:1,class:"t-node-error"},Zi=["onClick"],ea=["onClick"],ta=W(()=>a("div",{class:"drag-icon"},null,-1)),sa={class:"o-column-right"},la={class:"o-menu-chart"},ia=["data-active"],aa=W(()=>a("i",{class:"o-menu-chart-it-icon"},null,-1)),na=["data-active"],oa=W(()=>a("i",{class:"o-menu-chart-it-icon"},null,-1)),ra={class:"rec-body",style:{position:"relative"}},da={class:"timechart-er"},ca={class:"tch-tool-er"},ha={class:"tch-tool-hotkey-er"},ua={class:"timechart-hotkey"},ma={class:"hotkey-more"},pa=W(()=>a("div",{class:"hotkey-icon-book"},null,-1)),fa={class:"hotkey-more-body"},ga=Ae('<li data-v-10f33d12><div class="timechart-hotkey-it" data-v-10f33d12>缩放横轴 <span class="hotkey-btn" data-v-10f33d12>ctrl+滚轮</span></div></li><li data-v-10f33d12><div class="timechart-hotkey-it" data-v-10f33d12>平移横轴 <span class="hotkey-btn" data-v-10f33d12>shift+滚轮</span></div></li><li data-v-10f33d12><div class="timechart-hotkey-it" data-v-10f33d12>缩放纵轴 <span class="hotkey-btn" data-v-10f33d12>alt+ctrl+滚轮</span></div></li><li data-v-10f33d12><div class="timechart-hotkey-it" data-v-10f33d12>平移纵轴 <span class="hotkey-btn" data-v-10f33d12>alt+shift+滚轮</span></div></li><li data-v-10f33d12><div class="timechart-hotkey-it" data-v-10f33d12>框选放大 <span class="hotkey-btn" data-v-10f33d12>左键拖拽</span></div></li><li data-v-10f33d12><div class="timechart-hotkey-it" data-v-10f33d12>复位轴 <span class="hotkey-btn" data-v-10f33d12>左键双击</span></div></li><li data-v-10f33d12><div class="timechart-hotkey-it" data-v-10f33d12>选择帧 <span class="hotkey-btn" data-v-10f33d12>左键单击</span></div></li>',7),ba={class:"timechart-hotkey-it"},_a={class:"hotkey-btn"},ya=W(()=>a("li",null,[a("div",{class:"timechart-hotkey-it"},[C("框选时段 "),a("span",{class:"hotkey-btn"},"shift+左键")])],-1)),wa={class:"tch-tool-blank-er"},va=W(()=>a("div",{class:"tch-tool-span"},null,-1)),Ca=W(()=>a("div",{class:"tch-tool-span"},null,-1)),ka=["id"],Sa={class:"filter-time"},Ta={class:"filter-time-wrap"},Da=W(()=>a("span",null,"筛选时间： 近 ",-1)),Va=["disabled"],xa={class:"rec-body-table"},Ia={class:"table-data"},La={key:1,class:"board-spin-er"},Fa={class:"board-spin-progress"},Ra={class:"board-spin-text"};function Ma(e,s,i,n,t,l){var N;const o=w("AddOrSelector"),r=w("ChooseSignal"),d=w("Draggable"),c=w("Button"),m=w("v-select"),f=w("ButtonGroup"),y=w("TimePlotMulti"),M=w("Switch"),L=w("TableChart"),z=w("ProgressBar"),_=w("ManageViewsGroup"),O=w("Message"),x=H("tooltip");return h(),u(T,null,[a("div",xi,[l.view?(h(),u("div",Ii,[a("div",Li,[Fi,Ri,a("div",Mi,[a("div",Ei,[a("div",$i,[g(o,{options:l.treeDataDbc,placeholder:"输入视图名称",modelValue:t.curView,"onUpdate:modelValue":s[0]||(s[0]=I=>t.curView=I),onAdd:l.addView},null,8,["options","modelValue","onAdd"])]),a("div",Ai,[a("div",{class:"head-btn",onClick:s[1]||(s[1]=A(()=>t.chooseSignalAble=!t.chooseSignalAble,["prevent","stop"]))},Pi),Ui,a("div",{class:"head-btn",id:"delete_module",onClick:s[2]||(s[2]=I=>l.manageShow())},ji),t.chooseSignalAble?(h(),P(r,{key:0,filledOptions:t.filledOptions,signals:l.view.children,onSignalsChange:l.updateSignal,loading:t.signalLoading,carType:t.carType,fileType:t.fileType,sdb:i.sdb,dbcVal:i.dbcVal,dbcChn:i.dbcChn,ldfChn:i.ldfChn,onCancel:s[3]||(s[3]=()=>t.chooseSignalAble=!1)},null,8,["filledOptions","signals","onSignalsChange","loading","carType","fileType","sdb","dbcVal","dbcChn","ldfChn"])):k("",!0)]),a("div",{class:"o-pul-tree-er","data-empty":l.view.children.length===0},[l.view?(h(),P(d,{key:0,onDrag:s[4]||(s[4]=A(()=>{},["stop"])),onDragstart:s[5]||(s[5]=A(()=>{},["stop"])),maxLevel:1,class:"t-list",modelValue:l.view.children,"onUpdate:modelValue":s[6]||(s[6]=I=>l.view.children=I),onAfterDrop:s[7]||(s[7]=I=>l.updateSignal(l.view.children,"1"))},{default:S(({node:I,stat:se})=>[a("div",{class:"t-node","data-type":"signal","data-hidden":I.hidden},[a("i",{class:"t-node-exp","data-open":se.open,onClick:K=>se.open=!se.open},null,8,Ki),C(),v((h(),u("i",{class:"t-node-icon","data-color":I.color,onClick:A(K=>I.colorEditable=!0,["stop","prevent"])},[v(a("div",{class:"color-picker",onMouseleave:K=>I.colorEditable=!1},[(h(!0),u(T,null,F(t.colorList,K=>(h(),u("div",{class:"color-item",title:K,"data-color":K,key:K,onClick:p=>{I.color=K,l.updateSignal(l.view.children,"1")}},null,8,Xi))),128))],40,Gi),[[U,I.colorEditable]])],8,Wi)),[[x,"更改颜色"]]),v((h(),u("span",Yi,[a("span",null,b(t.fileType!=="mdf"?I.channel>1e3?"":t.C2C[I.channel]+"-":"")+b(I.text),1),I.warning===!0?v((h(),u("div",Ji,null,512)),[[x,"信号无数据"]]):k("",!0),!I.hidden&&I.warning===null?v((h(),u("div",Qi,null,512)),[[x,"文件内无此信号"]]):k("",!0)])),[[x,{content:l.title4node(I),html:!0},void 0,{right:!0}]]),v(a("div",{class:"t-node-delete",onClick:K=>l.deleteSignal(I)},null,8,Zi),[[x,"删除"]]),v(a("div",{class:"t-node-watch",onClick:K=>{l.hideSignal(I,l.view)}},null,8,ea),[[x,"显示|隐藏"]])],8,zi)]),_:1},8,["modelValue"])):k("",!0)],8,qi)])]),ta]),a("div",sa,[a("div",la,[t.curChart!=="timeChart"?(h(),u("div",{key:0,class:"o-menu-chart-it-button","data-active":t.curChart==t.mlistChart[0].key||t.mlistChart[0].active,onClick:s[8]||(s[8]=I=>l.choose(t.mlistChart[0].key))},[aa,C(" "+b(t.mlistChart[0].name),1)],8,ia)):(h(),u("div",{key:1,class:"o-menu-chart-it-button","data-active":t.curChart==t.mlistChart[1].key||t.mlistChart[1].active,onClick:s[9]||(s[9]=I=>l.choose(t.mlistChart[1].key))},[oa,C(" "+b(t.mlistChart[1].name),1)],8,na))]),v(a("div",ra,[a("div",da,[a("div",ca,[a("div",ha,[a("div",ua,[a("div",ma,[pa,C("快捷键 "),a("div",fa,[a("ul",null,[ga,a("li",null,[a("div",ba,[C("打点 "),a("span",_a,b(t.system==="mac"?"option":"alt")+"+左键",1)])]),ya])])])])]),a("div",wa,[v((h(),P(c,{class:"tch-tool-btn",onClick:s[10]||(s[10]=I=>t.showDotsFrame=!t.showDotsFrame)},{default:S(()=>[C("打点")]),_:1})),[[x,"alt+左键"]]),va,v(g(m,{options:t.timeFilterOptions,clearable:!1,searchable:!1,label:"label",value:"value",modelValue:t.timeFilterMode,"onUpdate:modelValue":s[11]||(s[11]=I=>t.timeFilterMode=I),class:"tch-tool-select"},null,8,["options","modelValue"]),[[x,"时间显示"]]),Ca,g(f,{options:t.modeOptions,modelValue:t.chartMode,"onUpdate:modelValue":s[12]||(s[12]=I=>t.chartMode=I)},null,8,["options","modelValue"])])]),(h(),u("div",{id:"timechart_"+l.view.id,style:$("width: 100%; height: calc(100% - 137px);min-height: ".concat(t.chartMode==="single"?(((N=t.timeData)==null?void 0:N.length)||0)*40+1:1,"px;")),key:l.view.id},[t.timeData.length>0&&t.timeData.some(I=>I.t)?(h(),P(y,{key:0,"data-cy":"timePlotMulti",fileType:t.fileType,timeData:t.timeData,showEnum:!0,mode:t.chartMode,startTime:t.startTime,timeFilter:t.timeFilterMode.value,showExport:!1,showDotsFrame:t.showDotsFrame,"onUpdate:showDotsFrame":s[13]||(s[13]=I=>t.showDotsFrame=I),monitor:!0},null,8,["fileType","timeData","mode","startTime","timeFilter","showDotsFrame"])):k("",!0)],12,ka)),a("div",Sa,[g(M,{modelValue:t.turnTimeLimit,"onUpdate:modelValue":s[14]||(s[14]=I=>l.changeState()),id:t.turnTimeLimit},null,8,["modelValue","id"]),a("div",Ta,[Da,v(a("input",{class:"input",type:"number",placeholder:"输入数字",disabled:!t.turnTimeLimit,min:"0",max:"1200","onUpdate:modelValue":s[15]||(s[15]=I=>t.timeLimit=I),onInput:s[16]||(s[16]=(...I)=>e.onChange&&e.onChange(...I))},null,40,Va),[[Q,t.timeLimit,void 0,{lazy:!0}]]),C(" 秒 ")])])])],512),[[U,!t.timechartShow]]),v(a("div",xa,[a("div",Ia,[g(L,{chartTableData:this.$props.chartTableData,showSignalsList:t.showSignalsList},null,8,["chartTableData","showSignalsList"])])],512),[[U,!t.tablechartShow]])])])):k("",!0),t.chartDataLoaded?k("",!0):(h(),u("div",La,[a("div",Fa,[t.directorySize.durationMaybe?(h(),P(z,{key:0,second:t.directorySize.durationMaybe},null,8,["second"])):k("",!0)]),a("div",Ra,"正在解析文件 "+b(l.directoryLabel)+"（"+b(t.directorySize.label)+"），约"+b(t.directorySize.durationMaybeLabel)+"…",1)]))]),t.manageModal.manageVisible?(h(),P(_,{key:0,fileType:t.fileType,propTreeData:t.treeData,curViewInx:t.curView.value,title:t.manageModal.title,onCancel:l.onCancelSelect,onDelete:l.deleteView,onUpdate:l.updateView,onImport:l.onImportView,onAdd:l.addView,onSwitch:l.onSwitchView},null,8,["fileType","propTreeData","curViewInx","title","onCancel","onDelete","onUpdate","onImport","onAdd","onSwitch"])):k("",!0),g(O,{message:t.message},null,8,["message"])],64)}const Ea=E(Vi,[["render",Ma],["__scopeId","data-v-10f33d12"]]);let Se;const $a={name:"ScrollBar",props:["modelValue","start","end","disable","timeFilter","startTime"],emits:["update:modelValue","change"],data(){return{lineTop:0,scrollTop:0,lineTitle:"",scrollTitle:"",lineVisible:!1,dragging:!1,dragHover:!1}},methods:{enterHandler(){this.dragging||(this.lineVisible=!0)},leaveHandler(){this.lineVisible=!1},moveHandler(e){this.lineVisible&&(e.offsetY<0||e.offsetY>=this.$refs.root.clientHeight-28||(this.lineTop=e.offsetY,this.lineTitle=this.tooltipFormatter(this.$props.start+(this.$props.end-this.$props.start)*e.offsetY/(this.$refs.root.clientHeight-28))))},clickHandler(e){this.scrollTop=e.offsetY;const s=this.$props.start+(this.$props.end-this.$props.start)*this.scrollTop/(this.$refs.root.clientHeight-28);this.$emit("update:modelValue",s),this.$emit("change",s)},tooltipFormatter(e){return parseInt(e)/1e3},timeStrFilter(e){return this.$props.timeFilter==="absolute"?new Date(e*1e3+(this.$props.startTime||0)).toLocaleString("zh-Hans-CN",{hour:"2-digit",minute:"2-digit",second:"2-digit",fractionalSecondDigits:3,hourCycle:"h23",timeZone:"Asia/Shanghai"}):e},blockDownHandler(){this.dragging=!0,Se=void 0},blockUphandler(){if(this.dragging){this.dragging=!1;const e=this.$props.start+(this.$props.end-this.$props.start)*this.scrollTop/(this.$refs.root.clientHeight-28);this.$emit("update:modelValue",e),this.$emit("change",e)}},blockLeaveHandler(){this.enterHandler(),this.dragHover=!1},blockEnterHandler(){this.leaveHandler(),this.dragHover=!0},blockMoveHandler(e){if(this.dragging){let s=0;Se!=null&&(s=e.pageY-Se),Se=e.pageY,console.log("move",e.pageY);let i=this.scrollTop+s;const n=this.$refs.root.clientHeight;if(i<0){if(this.scrollTop===0)return;i=0}else if(i>n-28){if(this.scrollTop===n-28)return;i=n-28}this.scrollTop=i,this.scrollTitle=this.tooltipFormatter(this.$props.start+(this.$props.end-this.$props.start)*this.scrollTop/(this.$refs.root.clientHeight-28))}}},watch:{modelValue(e){if(this.dragging)return;let s=(e-this.$props.start)/(this.$props.end-this.$props.start);this.scrollTop=parseInt(s*(this.$refs.root.clientHeight-28)),this.scrollTitle=this.tooltipFormatter(e),this.dragging=!1,this.dragHover=!1},end(e){if(this.dragging)return;let s=(this.$props.modelValue-this.$props.start)/(this.$props.end-this.$props.start);this.scrollTop=parseInt(s*(this.$refs.root.clientHeight-28))}},mounted(){window.addEventListener("mouseup",this.blockUphandler),window.addEventListener("mousemove",this.blockMoveHandler)},unmounted(){window.removeEventListener("mouseup",this.blockUphandler),window.removeEventListener("mousemove",this.blockMoveHandler)}},Aa=["data-disable"],Na=["data-active"],Oa={class:"block-title"},Pa={class:"line-title"},Ua=["data-active"];function Ha(e,s,i,n,t,l){return h(),u("div",{class:"bar-er","data-disable":e.$props.disable,ref:"root",onClick:s[5]||(s[5]=A((...o)=>l.clickHandler&&l.clickHandler(...o),["prevent","stop"])),onMousemove:s[6]||(s[6]=(...o)=>l.moveHandler&&l.moveHandler(...o)),onMouseenter:s[7]||(s[7]=(...o)=>l.enterHandler&&l.enterHandler(...o)),onMouseleave:s[8]||(s[8]=(...o)=>l.leaveHandler&&l.leaveHandler(...o))},[a("div",{class:"bar-block","data-active":t.dragging,onClick:s[0]||(s[0]=A(()=>{},["prevent","stop"])),onMousedown:s[1]||(s[1]=(...o)=>l.blockDownHandler&&l.blockDownHandler(...o)),onMouseup:s[2]||(s[2]=(...o)=>l.blockUphandler&&l.blockUphandler(...o)),onMouseleave:s[3]||(s[3]=(...o)=>l.blockLeaveHandler&&l.blockLeaveHandler(...o)),onMouseenter:s[4]||(s[4]=(...o)=>l.blockEnterHandler&&l.blockEnterHandler(...o)),style:$({transform:"translateY("+t.scrollTop+"px)"})},[a("div",Oa,b(l.timeStrFilter(t.scrollTitle)),1)],44,Na),v(a("div",{class:"bar-line",style:$({transform:"translateY("+t.lineTop+"px)"})},[a("div",Pa,b(l.timeStrFilter(t.lineTitle)),1)],4),[[U,t.lineVisible]]),a("div",{class:"scroll-title","data-active":t.dragging},b(l.timeStrFilter(t.scrollTitle)),9,Ua)],40,Aa)}const Ba=E($a,[["render",Ha],["__scopeId","data-v-10031967"]]);const ja={props:["col","asyncData"],emits:["change"],data(){return{options:[],loading:!1,current:[]}},methods:{async onMouseEnter(){this.loading=!0,this.options=[];try{this.options=await this.$props.asyncData(this.$props.col)}catch(e){}this.loading=!1},onModelValueChange(e){this.current=e,this.$emit("change",e)}},watch:{col:{handler(e){this.current=e.value},deep:!0}}},qa=e=>(j("data-v-c658e29a"),e=e(),q(),e),za=["data-active"],Ka=qa(()=>a("div",null,null,-1));function Wa(e,s,i,n,t,l){var r;const o=w("v-select");return h(),u("div",{class:"select-icon","data-active":((r=t.current)==null?void 0:r.length)>0,onMouseenter:s[0]||(s[0]=(...d)=>l.onMouseEnter&&l.onMouseEnter(...d))},[a("div",{class:"flt-er",style:$({width:e.$props.col.width+40+"px"})},[g(o,{loading:t.loading,options:t.options,dropdownShouldOpen:()=>!0,searchable:!0,modelValue:t.current,"onUpdate:modelValue":l.onModelValueChange,multiple:""},{"no-options":S(()=>[Ka]),_:1},8,["loading","options","modelValue","onUpdate:modelValue"])],4)],40,za)}const Ga=E(ja,[["render",Wa],["__scopeId","data-v-c658e29a"]]);let Fe=0,Re=0;const Xa={props:["rowData","columnsDef","columnsFilter","from","filters"],emits:["toggleExpand","scrollRow","scrollAction","filterItem","colFilterChange","updatePadding","timeModeChange"],components:{RecycleScroller:he,FilterItem:Ga},created(){this.$_scrollTimer=0},data(){return{isChildTit:!1,searchVal:"",isOpenSearch:!1,selectFilterList:[],showSelect:!1,curId:-1,filterChnItem:"",filterValItem:"",formData:{},filterList:{channel:"",canId:"",name:"",canType:"",dir:"",dlc:""},left:0,timeFilterOptions:[{label:"Time 绝对时间",value:"absolute"},{label:"Time 相对时间",value:"relative"},{label:"ΔTime 时间差",value:"diff"}],timeFilterMode:{label:"Time 绝对时间",value:"absolute"},selectionActive:!1}},computed:{fullWidth(){return"calc("+this.$props.columnsDef.map(e=>typeof e.width=="number"?e.width+"px":e.width).join(" + ")+")"}},watch:{rowData:{handler(){if(this.selectionActive){this.selectionActive=!1;let e=window.getSelection();e.removeAllRanges(),e=null}setTimeout(()=>{console.log("updateVisibleItems"),this.$refs.scroller.updateVisibleItems(!0)},0)},deep:!0},timeFilterMode(e){this.onTimeModelChange(e.value)}},methods:{onScrollX(e){this.left=-e.target.scrollLeft+"px"},onTableClick(e){var s,i,n;if((n=(i=(s=e.target)==null?void 0:s.className)==null?void 0:i.includes)!=null&&n.call(i,"table-td")){this.selectionActive=!0;let t=window.getSelection();t.removeAllRanges();let l=document.createRange();l.selectNodeContents(e.target),t.addRange(l),t=l=null}},filterHex(e){return e===void 0?"":(e>=0?mt(e):e).toString().replace(/^(00)+/g,"")||"00"},update(e,s,i,n){Fe=i,Re=this.$props.rowData.length-n,this.$emit("updatePadding",{visibleStartIndex:i,visibleEndIndex:n})},searchInfo(){this.isOpenSearch=!1},onOpenSearch(){this.isOpenSearch=!0},scrollToBottom(){var e;(e=this.$refs.scroller)==null||e.scrollToItem(this.$props.rowData.length-1)},scrollToItem(e){var s;(s=this.$refs.scroller)==null||s.scrollToItem(e)},nativeScroll(){const e=this.$refs.scroller.$el;e.addEventListener("scroll",s=>{if(clearTimeout(this.$_scrollTimer),this.selectionActive){this.selectionActive=!1;let i=window.getSelection();i.removeAllRanges(),i=null}this.$_scrollTimer=setTimeout(()=>{console.log("updateVisibleItems"),this.$refs.scroller.updateVisibleItems(!0)},100)}),e.addEventListener("wheel",s=>{this.$emit("scrollAction",{topPadding:Fe,bottomPadding:Re}),s.deltaY>0||s.deltaX>0?Re<=40&&this.$emit("scrollRow","down"):(s.deltaY<0||s.deltaX<0)&&Fe<=40&&this.$emit("scrollRow","up")})},filterItem(e,s){this.filterChnItem=e,this.curId=s,this.$emit("filterItem"),this.selectFilterList=[],D.blfLogging.getFiltItems({selectItem:e,channel:"",canId:"",name:"",canType:"",dir:"",dlc:""}).then(i=>{let n=i.data.data;n.length>0&&n.forEach(t=>{t&&this.selectFilterList.push({value:t,label:t,selected:!1})})})},onChooseFilterItem(e,s){e.selected=!0,this.$emit("reDrawTable",e,s,this.selectFilterList)},onTimeModelChange(e){this.$emit("timeModeChange",e)}},mounted(){this.nativeScroll()}},Ce=e=>(j("data-v-14b568fa"),e=e(),q(),e),Ya={style:{position:"absolute",left:"0",top:"0",right:"0",bottom:"0",display:"inherit","flex-direction":"inherit","align-items":"inherit"}},Ja={key:1,class:"o-pul-time-option-warp"},Qa=Ce(()=>a("div",{class:"table-header",style:{height:"32px","line-height":"32px"}},null,-1)),Za=["data-even"],en=["onMousedown"],tn=["onMousedown"],sn=Ce(()=>a("span",{class:"container-tit",style:{width:"205px"}},"信号名",-1)),ln=Ce(()=>a("span",{class:"container-tit",style:{width:"200px"}},"信号物理值",-1)),an=Ce(()=>a("span",{class:"container-tit",style:{width:"80px"}},"HEX",-1)),nn=Ce(()=>a("span",{class:"container-tit",style:{width:"calc(100vw - 487px)"}},"信号描述",-1)),on=[sn,ln,an,nn],rn={class:"table-parent-tr o-table-expand-child"},dn={class:"table-td",style:{width:"205px"}},cn={class:"table-td",style:{width:"200px"}},hn={class:"table-td",style:{width:"80px"}},un={class:"table-td",style:{width:"calc(100vw - 487px)"}};function mn(e,s,i,n,t,l){const o=w("FilterItem"),r=w("v-select"),d=w("RecycleScroller");return h(),u("div",{class:"table",onClick:s[2]||(s[2]=(...c)=>l.onTableClick&&l.onTableClick(...c))},[a("div",{class:"table-header",style:$({height:"32px",lineHeight:"32px",transform:"translateX("+t.left+")",width:l.fullWidth,position:"absolute",zIndex:1})},[a("div",Ya,[(h(!0),u(T,null,F(e.$props.columnsDef,(c,m)=>(h(),u("div",{class:"header-tit",key:m,style:$({width:c.width>0?c.width+"px":c.width})},[a("span",null,b(c.titName),1),c.filterShow?(h(),P(o,{key:0,onChange:f=>e.$emit("colFilterChange",{keyName:c.keyName,value:f}),col:c,asyncData:e.$props.columnsFilter},null,8,["onChange","col","asyncData"])):k("",!0),c.keyName=="timestamp"||c.keyName=="diff"||c.keyName=="deltaTime"?(h(),u("div",Ja,[g(r,{options:t.timeFilterOptions,clearable:!1,searchable:!1,label:"label",value:"value",modelValue:t.timeFilterMode,"onUpdate:modelValue":s[0]||(s[0]=f=>t.timeFilterMode=f),class:"canoe-frame-vselect"},null,8,["options","modelValue"])])):k("",!0)],4))),128))])],4),Qa,g(d,{items:e.$props.rowData,"item-size":24,"key-field":"id",emitUpdate:!0,onUpdate:l.update,ref:"scroller",class:"frame-class"},{default:S(({item:c,index:m})=>[c.isParent?(h(),u("div",{key:0,class:ue(c.canId!="0"?"table-parent-tr":"table-parent-tr-error"),"data-even":m%2===0,style:$({transform:"translateX("+t.left+")",width:l.fullWidth})},[(h(!0),u(T,null,F(e.$props.columnsDef,f=>(h(),u("div",{class:"table-td",style:$({width:typeof f.width=="number"?f.width+"px":f.width}),key:f.keyName},[f.custom?(h(),u(T,{key:0},[c.isExpand&&c.isParent&&c.name?(h(),u("i",{key:0,class:"collapse-icon",onMousedown:A(y=>e.$emit("toggleExpand",m),["stop","prevent"])},null,40,en)):k("",!0),c.isExpand===!1&&c.isParent&&c.name?(h(),u("i",{key:1,class:"expand-icon",onMousedown:A(y=>e.$emit("toggleExpand",m),["stop","prevent"])},null,40,tn)):k("",!0)],64)):(h(),u(T,{key:1},[C(b(f.displayMap?f.displayMap(c[f.keyName]):c[f.keyName]),1)],64))],4))),128))],14,Za)):(h(),u(T,{key:1},[c.isChildTit?(h(),u("div",{key:0,class:"table-header o-table-expand-child",style:$({transform:"translateX("+t.left+")",width:l.fullWidth})},on,4)):(h(),u("div",{key:1,class:"table-parent",style:$({transform:"translateX("+t.left+")",width:l.fullWidth})},[a("div",rn,[a("span",dn,b(c.name),1),a("span",cn,b(c.value),1),a("span",hn,b(l.filterHex(c.hex)),1),a("span",un,b(c.comment),1)])],4))],64))]),_:1},8,["items","onUpdate"]),a("div",{class:"table-scroll-x",onScroll:s[1]||(s[1]=(...c)=>l.onScrollX&&l.onScrollX(...c))},[a("div",{class:"table-scroll-x-bar",style:$({width:l.fullWidth})},null,4)],32)])}const pn=E(Xa,[["render",mn],["__scopeId","data-v-14b568fa"]]);const fn={beforeMount(){console.log("this.params",this.params)},methods:{onExpand(){debugger;console.log("this.params.data",this.params.data),this.params.data.isExpand===!1?(this.params.node.setDataValue("isExpand",!0),this.params.api.applyTransactionAsync({add:[JSON.parse(this.params.data.parsedData)],addIndex:this.params.rowIndex+1})):(this.params.node.setDataValue("isExpand",!1),this.params.api.applyTransactionAsync({remove:this.params.api.getRowNode(this.params.rowIndex+1)})),this.params.api.redrawRows()}}};function gn(e,s,i,n,t,l){return h(),u("div",null,[e.params.data.isExpand?(h(),u("i",{key:0,class:"expand-icon",onClick:s[0]||(s[0]=(...o)=>l.onExpand&&l.onExpand(...o))})):(h(),u("i",{key:1,class:"collapse-icon",onClick:s[1]||(s[1]=(...o)=>l.onExpand&&l.onExpand(...o))})),a("span",null,b(e.params.value),1)])}const bn=E(fn,[["render",gn]]),_n={methods:{onClick(){debugger}}},yn=Ae('<table><thead class="o-table-thead"><tr><th class="o-table-cell">信号</th><th class="o-table-cell o-cell-ar">信号物理值</th><th class="o-table-cell o-cell-ar">信号描述</th></tr></thead><tbody class="o-table-tbody"></tbody></table>',1),wn=[yn];function vn(e,s,i,n,t,l){return h(),u("div",{onClick:s[0]||(s[0]=(...o)=>l.onClick&&l.onClick(...o))},wn)}const Cn=E(_n,[["render",vn]]);let Ye=0,Je=0,ce=0,pe=0,Te;const kn={props:["store","closeFlag","recentTest","connectStatus","colFilterShow","channelOne","channelTwo","channelThree","linChannelVal","linChannelValTwo","filePath","dbcVal","startTime","sn","dbcChn","ldfChn","channelValList","linChannelValList"],emits:["updateBock","updateTimeData","recordTimeChange","startTimeChange","chartTableFun"],components:{Button:G,Message:Z,ScrollBar:Ba,ExpandInfo:bn,FullWidthCellRenderer:Cn,TableRecycleScroller:pn,CopyPath:ut,ButtonGroup:ve},data(){return{expandKeys:new Set,visibleStartIndex:0,visibleEndIndex:0,bottomPadding:0,recordLoading:!1,mode:"all",sliderValue:-1,comments:["","","","","","","","","","","","","","","",""],message:{visible:!1,level:"",content:""},seconds:0,timeFilterModeVal:"absolute",rowData:[],isRecording:!1,startSqlId:0,endSqlId:0,isLock:!1,isScrollEnd:!0,isAddData:!0,secondConfirm:!1,topLock:!1,bottomLock:!1,openFlag:!1,mlist:[{key:"lookRecord",name:"帧查看",icon:"box"},{key:"supeRecord",name:"图像查看",icon:"setting"}],cur:"lookRecord",recordShow:!0,colorList:["blue","cerulean","cyan","green","lime","purple","pink","red","orange","yellow"],columnsDef:[{titName:"",width:30,keyName:"id",type:"number",value:[],filterShow:!1,custom:!0},{titName:"",width:164,keyName:this.timeFilterModeVal==="diff"?this.mode==="single"?"deltaTime":"diff":"timestamp",type:"number",value:[],filterShow:!1,displayMap:e=>{let s=parseFloat(e);switch(this.timeFilterModeVal){case"diff":return s.toFixed(6);case"absolute":return new Date(s*1e3).toLocaleString("zh-Hans-CN",{hour:"2-digit",minute:"2-digit",second:"2-digit",fractionalSecondDigits:3,hourCycle:"h23",timeZone:"Asia/Shanghai"});case"relative":return(e-this.startTime).toFixed(6);default:return e}}},{titName:"Chn",width:60,keyName:"channel",type:"number",value:[],filterShow:!0},{titName:"ID",width:60,keyName:"canId",type:"number",value:[],filterShow:!0,displayMap:e=>"0x"+e.toString(16)},{titName:"NAME",width:200,keyName:"name",type:"string",value:[],filterShow:!0},{titName:"Event",width:80,keyName:"canType",type:"string",value:[],filterShow:!0},{titName:"Dir",width:60,keyName:"dir",type:"string",value:[],filterShow:!0},{titName:"Dlc",width:60,keyName:"dlc",type:"number",value:[],filterShow:!0},{titName:"DATA",width:1380,keyName:"data",type:"string",value:[],filterShow:!1,displayMap:e=>e.map(s=>s.toString(16).padStart(2,"0")).join(" ")}]}},watch:{mode(e,s){this.topPadding=0,this.$refs.table.scrollToItem(0),this.expandKeys.clear(),this.rowData=[],this.isRecording&&this.resumeScroll()},filePath(){this.$emit("updateBock",{filePath:this.filePath,dbcVal:this.dbcVal,recordLoading:this.recordLoading,isRecording:this.isRecording})},dbcVal(){this.$emit("updateBock",{filePath:this.filePath,dbcVal:this.dbcVal,recordLoading:this.recordLoading,isRecording:this.isRecording})},recordLoading(){this.$emit("updateBock",{filePath:this.filePath,dbcVal:this.dbcVal,recordLoading:this.recordLoading,isRecording:this.isRecording})},isRecording(){this.$emit("updateBock",{filePath:this.filePath,dbcVal:this.dbcVal,recordLoading:this.recordLoading,isRecording:this.isRecording})},colComputed(){this.columnsDef[1]={titName:"",width:164,keyName:this.timeFilterModeVal==="diff"?this.mode==="single"?"deltaTime":"diff":"timestamp",type:"number",value:[],filterShow:!1,displayMap:e=>{let s=parseFloat(e);switch(this.timeFilterModeVal){case"diff":return s.toFixed(6);case"absolute":return new Date(s*1e3).toLocaleString("zh-Hans-CN",{hour:"2-digit",minute:"2-digit",second:"2-digit",hourCycle:"h23",timeZone:"Asia/Shanghai"})+"."+s.toFixed(6).split(".")[1];case"relative":return(e-this.startTime).toFixed(6);default:return e}}}}},computed:{colComputed(){return this.timeFilterModeVal+this.startTime+this.mode},recordTime(){return console.log("recordTime223",qe(parseInt((this.seconds*1e3).toString().split(".")[0]))),qe(parseInt((this.seconds*1e3).toString().split(".")[0]))},showData(){let e={mode:"all"};return this.columnsDef.forEach(s=>{s.filterShow&&(e[s.keyName]=(s.value||[]).map(i=>i.value))}),e},diffRowData(){return this.rowData.map((e,s,i)=>({...e,diff:s===0?0:i[s].timestamp-i[s-1].timestamp}))}},methods:{choose(e){this.cur=e,e=="supeRecord"?this.recordShow=!1:this.recordShow=!0},async colFilter(e){var o;const s=e.keyName==="name"?null:"";let i={selectItem:e.keyName,...this.showData,[e.keyName]:s},n;try{n=await await D.blfLogging.getFiltItems(i)}catch(r){}return(((o=n==null?void 0:n.data)==null?void 0:o.data)||[]).map(r=>({value:r,label:e.keyName==="canId"?"0x"+r.toString(16):r===""?" 空":r})).sort((r,d)=>(e.type==="number"?+r.value>+d.value:r.value>d.value)?1:-1)},startRecord(e){clearInterval(pe),this.checkHardware(e),this.isLock=!1,this.columnsDef=this.columnsDef.map(s=>({...s,value:[]}))},async endRecord(){this.recordLoading=!0,clearTimeout(ce),clearInterval(pe),D.blfLogging.stopLogging(),await ct(2e3),this.isRecording=!1,this.recordLoading=!1},async checkHardware(e){this.recordLoading=!1,this.secondConfirm=!1,console.log("调检查并连接硬件设备接口"),clearInterval(pe),this.isRecording=!0,this.startLogging(e),this.resumeScroll()},async startLogging(e){console.log("55666",e),this.seconds=0,this.rowData=[],this.$emit("startTimeChange",Date.now()/1e3),pe=setInterval(()=>{this.seconds=Date.now()/1e3-this.startTime},1e3),this.$emit("recordTimeChange",this.recordTime);let s=["","","","","","","","","","","","","","","",""];this.channelValList.forEach((l,o)=>{s[o]=l.split("-").pop()}),console.log("this.dbcChn07101822",this.dbcChn,s);let n=this.filePath.replace(".blf","-"+$e()+".blf"),t=await D.blfLogging.startLogging({path:n,type:"blf",typelin:"asc",channel:3,sdb:this.dbcVal==="自定义模板"?"":this.dbcVal.split("/")[1],carType:this.dbcVal==="自定义模板"?"custom":this.dbcVal.split("/")[0],dbcChn:this.dbcChn,ldfChn:this.ldfChn,files:this.dbcVal==="自定义模板"?s:["","","","","","","","","","","","","","","",""],comments:this.comments,mode:e});console.log("startLoggin",t)},showMessage({level:e,content:s,timeout:i}){clearTimeout(Ye),e!=null&&(this.message.level=e),s!=null&&(this.message.content=s),this.message.visible=!0,i>0&&(Ye=setTimeout(()=>{this.message.visible=!1},i))},showLoggingMessage(){clearTimeout(ce),Te=async()=>{var i;this.showData.mode=this.mode;let e;try{e=await D.blfLogging.showLoggingMessage({...this.showData}),console.log("showLogginMsg",e)}catch(n){}if(!e.data||!e)return;let s=((i=e==null?void 0:e.data)==null?void 0:i.frame_data)||[];if(!this.isLock&&(s==null?void 0:s.length)>0)if(this.mode==="all"){let n=s[0].sqlId,t=s[s.length-1].sqlId;s.forEach(l=>{l.isExpand=!1,l.isParent=!0,l.id=""+l.sqlId,l.canId=l.arbitrationId,delete l.arbitrationId}),this.startSqlId=n,this.endSqlId=t,Je=s[s.length-1].timestamp,this.rowData=s,this.$refs.table.scrollToBottom(),this.isAddData&&(this.sliderValue=n/t*(Je-this.startTime)*1e3)}else this.mode==="single"&&(s.forEach(n=>{n.isExpand=!1,n.isParent=!0,n.id=""+n.sqlId,n.canId=n.arbitrationId,delete n.arbitrationId}),s=s.sort((n,t)=>n.channel===t.channel?n.canId-t.canId:n.channel-t.channel),await this.drawExpandRows(s));this.$emit("updateTimeData",e.data.signal_data),this.isRecording?ce=setTimeout(()=>{requestAnimationFrame(Te)},200):clearTimeout(ce),this.$emit("recordTimeChange",this.recordTime)},Te()},async drawExpandRows(e){const s="-",i={};this.rowData.slice().sort((l,o)=>{const r=l.id,d=o.id;return!~r.indexOf(s)&&~d.indexOf(s)?-1:~r.indexOf(s)&&!~d.indexOf(s)?1:!~r.indexOf(s)&&!~d.indexOf(s)?l.channel<o.channel?-1:l.channel>o.channel?1:l.canId-o.canId:r>d?1:r<d?-1:0}),e.forEach(l=>{var r;const o=l.channel+"-"+l.canId;if(~l.id.indexOf(s))i[o].children.push(l);else{const d=((r=i[o])==null?void 0:r.children)||[];i[o]=l,i[o].children=this.expandKeys.has(o)?d:[]}});let n=this.rowData.slice();for(let l=this.visibleEndIndex;l>=this.visibleStartIndex;l--){if(!(n!=null&&n[l]))continue;let o=null,r=0;if(n[l].isParent)o=n[l],r=l;else if(l===this.visibleStartIndex){for(let d=l;d>=0;d--)if(n[d].isParent){o=n[d],r=d;break}}if(o){const d=o.channel+"-"+o.canId;if(this.expandKeys.has(d)){const c=await this.onToggleExpand(r,n,!0);c!=null&&c.length&&(i[d].children=c)}}}const t=[];for(let l in i){const o=i[l],r=o.children;delete o.children,r.length&&(o.isExpand=!0),t.push(o),r.forEach(d=>{t.push(d)})}this.rowData=t},getSelectData(e){let s="",i="",n="",t="";switch(e){case"up":t=this.startSqlId;break;case"down":n=this.endSqlId;break;case"pick":clearTimeout(ce),s=this.sliderValue/1e3+this.startTime;break}D.blfLogging.selectData({moreThanTimeStamp:s,lessThanTimeStamp:i,moreThanSqlID:n,lessThanSqlID:t,...this.showData,sqlId:"",numbers:100}).then(l=>{var o,r;if(((r=(o=l==null?void 0:l.data)==null?void 0:o.data)==null?void 0:r.length)>0){let d=l.data.data;switch(d.forEach(c=>{c.isExpand=!1,c.isParent=!0,c.id=c.sqlId,c.canId=c.arbitrationId,delete c.arbitrationId}),e){case"up":this.rowData=d.concat(...this.rowData),this.$refs.table.scrollToItem(l.data.data.length-1),this.sliderValue=(l.data.data[0].timestamp-this.startTime)*1e3,l.data.startSqlId&&(this.startSqlId=l.data.startSqlId);break;case"down":this.rowData=this.rowData.concat(...d),l.data.endSqlId&&(this.endSqlId=l.data.endSqlId);break;case"pick":this.startSqlId=l.data.startSqlId,this.endSqlId=l.data.endSqlId,this.rowData=d,this.sliderValue=(l.data.data[0].timestamp-this.startTime)*1e3;break}}}).finally(()=>{this.topLock=!1,this.bottomLock=!1})},onUpdatePadding(e){this.visibleStartIndex=e.visibleStartIndex,this.visibleEndIndex=e.visibleEndIndex},onTimeModeChange(e){this.timeFilterModeVal=e},onScrollAction(e){this.isLock||(this.mode==="all"?this.isLock=!0:this.isLock=!1,this.isScrollEnd=!1)},onBodyScrollEnd(e){this.mode!=="single"&&(e==="up"&&this.topLock===!1&&(this.topLock=!0,this.getSelectData(e)),e==="down"&&this.bottomLock===!1&&(this.bottomLock=!0,this.getSelectData(e)))},onClicked(){this.isLock=!1,this.isScrollEnd=!1},resumeScroll(){this.isScrollEnd=!0,this.isAddData=!0,this.isLock=!1,this.showLoggingMessage()},async onToggleExpand(e,s,i){const n=s.map(o=>({...o})),t=n[e],l=t.channel+"-"+t.canId;if(i||!t.isExpand){this.expandKeys.add(l);const o=await D.blfLogging.parsedSignal({channel:t.channel,canId:""+t.canId,canData:(t.data||[]).map(c=>c.toString(16))});let r=(o==null?void 0:o.data.sort((c,m)=>c.name<m.name?-1:1))||[],d=t.sqlId;if(r.forEach((c,m)=>{c.channel=t.channel,c.canId=""+t.canId,c.isParent=!1,c.isExpand=!0,c.isChildTit=!1,c.id=d+"-"+c.name}),r.unshift({channel:t.channel,canId:""+t.canId,isParent:!1,isExpand:!0,isChildTit:!0,id:d+"-"}),n.splice(e+1,0,...r),t.isExpand=r.length,i)return r;this.rowData=n}else this.expandKeys.delete(l),n.splice(e+1,n[e].isExpand),n[e].isExpand=!1,this.rowData=n},onSliderChange(e){this.isScrollEnd=!1,this.isAddData=!1,this.mode==="all"?this.isLock=!0:this.isLock=!1,this.getSelectData("pick")},onFilterItem(){this.openFlag=!this.openFlag},onColFilterChange(e){let s=this.columnsDef.find(i=>e.keyName===i.keyName);s&&(s.value=e.value),this.resumeScroll()}},mounted(){},unmounted(){Te=null,clearTimeout(ce),clearInterval(pe)}},me=e=>(j("data-v-27ef31c1"),e=e(),q(),e),Sn={class:"o-pul-er"},Tn={key:0},Dn=me(()=>a("div",{class:"o-pul-title"},"报文录制配置",-1)),Vn={class:"o-pul-p-wrap"},xn={class:"o-pul-p"},In={class:"record-header-message"},Ln=me(()=>a("b",null,"车型/DBC：",-1)),Fn=["v-tooltip"],Rn=me(()=>a("b",null,"保存目录：",-1)),Mn=[Rn],En={class:"o-pul-path"},$n={class:"o-pul-p-wrap",style:{"flex-wrap":"wrap"}},An={class:"record-header-message",style:{width:"20vw"}},Nn={class:"o-pul-btn-wrap"},On=me(()=>a("div",{class:"tool-btn-wrap"},[a("i",{class:"warn-icon"}),a("div",{class:"tool-picker-contianer-wrap"},"录制将覆盖文件,确认要开始录制吗?")],-1)),Pn=me(()=>a("div",{class:"tool-picker-arrow"},null,-1)),Un={class:"tool-picker-footer-wrap"},Hn={class:"o-dialog-footer"},Bn=me(()=>a("div",{class:"o-pul-hr"},null,-1)),jn={class:"o-table-wrap"};function qn(e,s,i,n,t,l){const o=w("CopyPath"),r=w("Button"),d=w("ButtonGroup"),c=w("ScrollBar"),m=w("TableRecycleScroller"),f=w("Message"),y=H("tooltip"),M=H("esc");return h(),u(T,null,[a("div",Sn,[t.recordShow?(h(),u("div",Tn,[Dn,a("div",Vn,[a("div",xn,[a("span",In,[Ln,C(b(i.dbcVal),1)]),a("span",{class:"record-header-message",style:{width:"71px"},"v-tooltip":i.filePath},Mn,8,Fn),a("span",En,[g(o,{path:i.filePath,length:60,full:!0},null,8,["path"])])])]),a("div",$n,[(h(!0),u(T,null,F(i.channelValList,(L,z)=>(h(),u("div",{class:"o-pul-p",key:z},[v((h(),u("span",An,[a("b",null,"CAN通道"+b(z+1)+"：",1),C(b(L),1)])),[[y,L]])]))),128))]),a("div",Nn,[t.secondConfirm?v((h(),u("div",{key:0,class:"tool-picker-wrap",onClick:s[1]||(s[1]=A(()=>{},["stop"]))},[On,Pn,a("div",Un,[a("div",Hn,[g(r,{class:"small-btn",style:{width:"30px"},onClick:s[0]||(s[0]=A(L=>t.secondConfirm=!1,["stop"]))},{default:S(()=>[C("取消")]),_:1}),g(r,{class:"small-btn",type:"primary",style:{width:"30px",margin:"0 0 0 10px"},onClick:A(l.checkHardware,["stop"])},{default:S(()=>[C("确定")]),_:1},8,["onClick"])])])])),[[M,()=>e.$emit("cancel")]]):k("",!0),C("   "),g(d,{options:[{label:"普通",value:"all"},{label:"单帧",value:"single"}],class:"theme-btn-group",modelValue:t.mode,"onUpdate:modelValue":s[2]||(s[2]=L=>t.mode=L)},null,8,["modelValue"])]),Bn,a("div",jn,[g(c,{modelValue:t.sliderValue,"onUpdate:modelValue":s[3]||(s[3]=L=>t.sliderValue=L),disable:t.mode!=="all",startTime:i.startTime*1e3,start:0,end:t.seconds*1e3,onChange:l.onSliderChange,timeFilter:t.timeFilterModeVal!="relative"?"absolute":"relative"},null,8,["modelValue","disable","startTime","end","onChange","timeFilter"]),g(m,{rowData:l.diffRowData,filters:l.showData,columnsDef:t.columnsDef,onToggleExpand:s[4]||(s[4]=L=>l.onToggleExpand(L,t.rowData)),onScrollRow:l.onBodyScrollEnd,onScrollAction:l.onScrollAction,onFilterItem:l.onFilterItem,onClick:l.onClicked,columnsFilter:l.colFilter,openFlag:t.openFlag,onColFilterChange:l.onColFilterChange,ref:"table",onUpdatePadding:l.onUpdatePadding,onTimeModeChange:l.onTimeModeChange,style:{height:"100%"}},null,8,["rowData","filters","columnsDef","onScrollRow","onScrollAction","onFilterItem","onClick","columnsFilter","openFlag","onColFilterChange","onUpdatePadding","onTimeModeChange"]),v(a("div",{class:"scrollToBottomBtn",onClick:s[5]||(s[5]=A(L=>l.resumeScroll(),["stop"]))},null,512),[[U,t.isLock&&t.mode==="all"],[y,"恢复向下滚动",void 0,{left:!0}]])])])):k("",!0)]),g(f,{message:t.message},null,8,["message"])],64)}const zn=E(kn,[["render",qn],["__scopeId","data-v-27ef31c1"]]);let De;const Kn={name:"ScrollBar",props:["modelValue","start","end","disable","timeFilter","startTime"],emits:["update:modelValue","change"],data(){return{lineTop:0,scrollTop:0,lineTitle:"",scrollTitle:"",lineVisible:!1,dragging:!1,dragHover:!1}},methods:{enterHandler(){this.dragging||(this.lineVisible=!0)},leaveHandler(){this.lineVisible=!1},moveHandler(e){this.lineVisible&&(e.offsetY<0||e.offsetY>=this.$refs.root.clientHeight-28||(this.lineTop=e.offsetY,this.lineTitle=this.tooltipFormatter(this.$props.start+(this.$props.end-this.$props.start)*e.offsetY/(this.$refs.root.clientHeight-28))))},clickHandler(e){this.scrollTop=e.offsetY;const s=this.$props.start+(this.$props.end-this.$props.start)*this.scrollTop/(this.$refs.root.clientHeight-28);this.$emit("update:modelValue",s),this.$emit("change",s)},tooltipFormatter(e){return parseInt(e)/1e3},timeStrFilter(e){return this.$props.timeFilter==="absolute"?new Date(e*1e3+(this.$props.startTime||0)).toLocaleString("zh-Hans-CN",{hour:"2-digit",minute:"2-digit",second:"2-digit",fractionalSecondDigits:3,hourCycle:"h23",timeZone:"Asia/Shanghai"}):e},blockDownHandler(){this.dragging=!0,De=void 0},blockUphandler(){if(this.dragging){this.dragging=!1;const e=this.$props.start+(this.$props.end-this.$props.start)*this.scrollTop/(this.$refs.root.clientHeight-28);this.$emit("update:modelValue",e),this.$emit("change",e)}},blockLeaveHandler(){this.enterHandler(),this.dragHover=!1},blockEnterHandler(){this.leaveHandler(),this.dragHover=!0},blockMoveHandler(e){if(this.dragging){let s=0;De!=null&&(s=e.pageY-De),De=e.pageY,console.log("move",e.pageY);let i=this.scrollTop+s;const n=this.$refs.root.clientHeight;if(i<0){if(this.scrollTop===0)return;i=0}else if(i>n-28){if(this.scrollTop===n-28)return;i=n-28}this.scrollTop=i,this.scrollTitle=this.tooltipFormatter(this.$props.start+(this.$props.end-this.$props.start)*this.scrollTop/(this.$refs.root.clientHeight-28))}}},watch:{modelValue(e){if(this.dragging)return;let s=(e-this.$props.start)/(this.$props.end-this.$props.start);this.scrollTop=parseInt(s*(this.$refs.root.clientHeight-28)),this.scrollTitle=this.tooltipFormatter(e),this.dragging=!1,this.dragHover=!1},end(e){if(this.dragging)return;let s=(this.$props.modelValue-this.$props.start)/(this.$props.end-this.$props.start);this.scrollTop=parseInt(s*(this.$refs.root.clientHeight-28))}},mounted(){window.addEventListener("mouseup",this.blockUphandler),window.addEventListener("mousemove",this.blockMoveHandler)},unmounted(){window.removeEventListener("mouseup",this.blockUphandler),window.removeEventListener("mousemove",this.blockMoveHandler)}},Wn=["data-disable"],Gn=["data-active"],Xn={class:"block-title"},Yn={class:"line-title"},Jn=["data-active"];function Qn(e,s,i,n,t,l){return h(),u("div",{class:"bar-er","data-disable":e.$props.disable,ref:"root",onClick:s[5]||(s[5]=A((...o)=>l.clickHandler&&l.clickHandler(...o),["prevent","stop"])),onMousemove:s[6]||(s[6]=(...o)=>l.moveHandler&&l.moveHandler(...o)),onMouseenter:s[7]||(s[7]=(...o)=>l.enterHandler&&l.enterHandler(...o)),onMouseleave:s[8]||(s[8]=(...o)=>l.leaveHandler&&l.leaveHandler(...o))},[a("div",{class:"bar-block","data-active":t.dragging,onClick:s[0]||(s[0]=A(()=>{},["prevent","stop"])),onMousedown:s[1]||(s[1]=(...o)=>l.blockDownHandler&&l.blockDownHandler(...o)),onMouseup:s[2]||(s[2]=(...o)=>l.blockUphandler&&l.blockUphandler(...o)),onMouseleave:s[3]||(s[3]=(...o)=>l.blockLeaveHandler&&l.blockLeaveHandler(...o)),onMouseenter:s[4]||(s[4]=(...o)=>l.blockEnterHandler&&l.blockEnterHandler(...o)),style:$({transform:"translateY("+t.scrollTop+"px)"})},[a("div",Xn,b(l.timeStrFilter(t.scrollTitle)),1)],44,Gn),v(a("div",{class:"bar-line",style:$({transform:"translateY("+t.lineTop+"px)"})},[a("div",Yn,b(l.timeStrFilter(t.lineTitle)),1)],4),[[U,t.lineVisible]]),a("div",{class:"scroll-title","data-active":t.dragging},b(l.timeStrFilter(t.scrollTitle)),9,Jn)],40,Wn)}const Zn=E(Kn,[["render",Qn],["__scopeId","data-v-fd6b53fa"]]);const eo={props:["col","asyncData"],emits:["change"],data(){return{options:[],loading:!1,current:[]}},methods:{async onMouseEnter(){this.loading=!0,this.options=[];try{this.options=await this.$props.asyncData(this.$props.col)}catch(e){}this.loading=!1},onModelValueChange(e){this.current=e,this.$emit("change",e)}},watch:{col:{handler(e){this.current=e.value},deep:!0}}},to=e=>(j("data-v-38fe99af"),e=e(),q(),e),so=["data-active"],lo=to(()=>a("div",null,null,-1));function io(e,s,i,n,t,l){var r;const o=w("v-select");return h(),u("div",{class:"select-icon","data-active":((r=t.current)==null?void 0:r.length)>0,onMouseenter:s[0]||(s[0]=(...d)=>l.onMouseEnter&&l.onMouseEnter(...d))},[a("div",{class:"flt-er",style:$({width:e.$props.col.width+40+"px"})},[g(o,{loading:t.loading,options:t.options,dropdownShouldOpen:()=>!0,searchable:!0,modelValue:t.current,"onUpdate:modelValue":l.onModelValueChange,multiple:""},{"no-options":S(()=>[lo]),_:1},8,["loading","options","modelValue","onUpdate:modelValue"])],4)],40,so)}const ao=E(eo,[["render",io],["__scopeId","data-v-38fe99af"]]);let Me=0,Ee=0;const no={props:["rowData","columnsDef","columnsFilter","from","filters"],emits:["toggleExpand","scrollRow","scrollAction","filterItem","colFilterChange","updatePadding","timeModeChange"],components:{RecycleScroller:he,FilterItem:ao},created(){this.$_scrollTimer=0},data(){return{isChildTit:!1,searchVal:"",isOpenSearch:!1,selectFilterList:[],showSelect:!1,curId:-1,filterChnItem:"",filterValItem:"",formData:{},filterList:{channel:"",canId:"",name:"",canType:"",dir:"",dlc:""},left:0,timeFilterOptions:[{label:"Time 绝对时间",value:"absolute"},{label:"Time 相对时间",value:"relative"},{label:"ΔTime 时间差",value:"diff"}],timeFilterMode:{label:"Time 绝对时间",value:"absolute"},selectionActive:!1}},computed:{fullWidth(){return"calc("+this.$props.columnsDef.map(e=>typeof e.width=="number"?e.width+"px":e.width).join(" + ")+")"}},watch:{rowData:{handler(){if(this.selectionActive){this.selectionActive=!1;let e=window.getSelection();e.removeAllRanges(),e=null}setTimeout(()=>{console.log("updateVisibleItems"),this.$refs.scroller.updateVisibleItems(!0)},0)},deep:!0},timeFilterMode(e){this.onTimeModelChange(e.value)}},methods:{onScrollX(e){this.left=-e.target.scrollLeft+"px"},onTableClick(e){var s,i,n;if((n=(i=(s=e.target)==null?void 0:s.className)==null?void 0:i.includes)!=null&&n.call(i,"table-td")){this.selectionActive=!0;let t=window.getSelection();t.removeAllRanges();let l=document.createRange();l.selectNodeContents(e.target),t.addRange(l),t=l=null}},filterHex(e){return e===void 0?"":(e>=0?mt(e):e).toString().replace(/^(00)+/g,"")||"00"},update(e,s,i,n){Me=i,Ee=this.$props.rowData.length-n,this.$emit("updatePadding",{visibleStartIndex:i,visibleEndIndex:n})},searchInfo(){this.isOpenSearch=!1},onOpenSearch(){this.isOpenSearch=!0},scrollToBottom(){var e;(e=this.$refs.scroller)==null||e.scrollToItem(this.$props.rowData.length-1)},scrollToItem(e){var s;(s=this.$refs.scroller)==null||s.scrollToItem(e)},nativeScroll(){const e=this.$refs.scroller.$el;e.addEventListener("scroll",s=>{if(clearTimeout(this.$_scrollTimer),this.selectionActive){this.selectionActive=!1;let i=window.getSelection();i.removeAllRanges(),i=null}this.$_scrollTimer=setTimeout(()=>{console.log("updateVisibleItems"),this.$refs.scroller.updateVisibleItems(!0)},100)}),e.addEventListener("wheel",s=>{this.$emit("scrollAction",{topPadding:Me,bottomPadding:Ee}),s.deltaY>0||s.deltaX>0?Ee<=40&&this.$emit("scrollRow","down"):(s.deltaY<0||s.deltaX<0)&&Me<=40&&this.$emit("scrollRow","up")})},filterItem(e,s){this.filterChnItem=e,this.curId=s,this.$emit("filterItem"),this.selectFilterList=[],D.blfLogging.getFiltItems({selectItem:e,channel:"",canId:"",name:"",canType:"",dir:"",dlc:""}).then(i=>{let n=i.data.data;n.length>0&&n.forEach(t=>{t&&this.selectFilterList.push({value:t,label:t,selected:!1})})})},onChooseFilterItem(e,s){e.selected=!0,this.$emit("reDrawTable",e,s,this.selectFilterList)},onTimeModelChange(e){this.$emit("timeModeChange",e)}},mounted(){this.nativeScroll()}},ke=e=>(j("data-v-c5c2dfce"),e=e(),q(),e),oo={style:{position:"absolute",left:"0",top:"0",right:"0",bottom:"0",display:"inherit","flex-direction":"inherit","align-items":"inherit"}},ro={key:1,class:"o-pul-time-option-warp"},co=ke(()=>a("div",{class:"table-header",style:{height:"32px","line-height":"32px"}},null,-1)),ho=["data-even"],uo=["onMousedown"],mo=["onMousedown"],po=ke(()=>a("span",{class:"container-tit",style:{width:"205px"}},"信号名",-1)),fo=ke(()=>a("span",{class:"container-tit",style:{width:"200px"}},"信号物理值",-1)),go=ke(()=>a("span",{class:"container-tit",style:{width:"80px"}},"HEX",-1)),bo=ke(()=>a("span",{class:"container-tit",style:{width:"calc(100vw - 487px)"}},"信号描述",-1)),_o=[po,fo,go,bo],yo={class:"table-parent-tr o-table-expand-child"},wo={class:"table-td",style:{width:"205px"}},vo={class:"table-td",style:{width:"200px"}},Co={class:"table-td",style:{width:"80px"}},ko={class:"table-td",style:{width:"calc(100vw - 487px)"}};function So(e,s,i,n,t,l){const o=w("FilterItem"),r=w("v-select"),d=w("RecycleScroller");return h(),u("div",{class:"table",onClick:s[2]||(s[2]=(...c)=>l.onTableClick&&l.onTableClick(...c))},[a("div",{class:"table-header",style:$({height:"32px",lineHeight:"32px",transform:"translateX("+t.left+")",width:l.fullWidth,position:"absolute",zIndex:1})},[a("div",oo,[(h(!0),u(T,null,F(e.$props.columnsDef,(c,m)=>(h(),u("div",{class:"header-tit",key:m,style:$({width:c.width>0?c.width+"px":c.width})},[a("span",null,b(c.titName),1),c.filterShow?(h(),P(o,{key:0,onChange:f=>e.$emit("colFilterChange",{keyName:c.keyName,value:f}),col:c,asyncData:e.$props.columnsFilter},null,8,["onChange","col","asyncData"])):k("",!0),c.keyName=="timestamp"||c.keyName=="diff"||c.keyName=="deltaTime"?(h(),u("div",ro,[g(r,{options:t.timeFilterOptions,clearable:!1,searchable:!1,label:"label",value:"value",modelValue:t.timeFilterMode,"onUpdate:modelValue":s[0]||(s[0]=f=>t.timeFilterMode=f),class:"canoe-frame-vselect"},null,8,["options","modelValue"])])):k("",!0)],4))),128))])],4),co,g(d,{items:e.$props.rowData,"item-size":24,"key-field":"id",emitUpdate:!0,onUpdate:l.update,ref:"scroller",class:"frame-class"},{default:S(({item:c,index:m})=>[c.isParent?(h(),u("div",{key:0,class:"table-parent-tr","data-even":m%2===0,style:$({transform:"translateX("+t.left+")",width:l.fullWidth})},[(h(!0),u(T,null,F(e.$props.columnsDef,f=>(h(),u("div",{class:"table-td",style:$({width:typeof f.width=="number"?f.width+"px":f.width}),key:f.keyName},[f.custom?(h(),u(T,{key:0},[c.isExpand&&c.isParent&&c.name?(h(),u("i",{key:0,class:"collapse-icon",onMousedown:A(y=>e.$emit("toggleExpand",m),["stop","prevent"])},null,40,uo)):k("",!0),c.isExpand===!1&&c.isParent&&c.name?(h(),u("i",{key:1,class:"expand-icon",onMousedown:A(y=>e.$emit("toggleExpand",m),["stop","prevent"])},null,40,mo)):k("",!0)],64)):(h(),u(T,{key:1},[C(b(f.displayMap?f.displayMap(c[f.keyName]):c[f.keyName]),1)],64))],4))),128))],12,ho)):(h(),u(T,{key:1},[c.isChildTit?(h(),u("div",{key:0,class:"table-header o-table-expand-child",style:$({transform:"translateX("+t.left+")",width:l.fullWidth})},_o,4)):(h(),u("div",{key:1,class:"table-parent",style:$({transform:"translateX("+t.left+")",width:l.fullWidth})},[a("div",yo,[a("span",wo,b(c.name),1),a("span",vo,b(c.value),1),a("span",Co,b(l.filterHex(c.hex)),1),a("span",ko,b(c.comment),1)])],4))],64))]),_:1},8,["items","onUpdate"]),a("div",{class:"table-scroll-x",onScroll:s[1]||(s[1]=(...c)=>l.onScrollX&&l.onScrollX(...c))},[a("div",{class:"table-scroll-x-bar",style:$({width:l.fullWidth})},null,4)],32)])}const To=E(no,[["render",So],["__scopeId","data-v-c5c2dfce"]]);const Do={beforeMount(){console.log("this.params",this.params)},methods:{onExpand(){debugger;console.log("this.params.data",this.params.data),this.params.data.isExpand===!1?(this.params.node.setDataValue("isExpand",!0),this.params.api.applyTransactionAsync({add:[JSON.parse(this.params.data.parsedData)],addIndex:this.params.rowIndex+1})):(this.params.node.setDataValue("isExpand",!1),this.params.api.applyTransactionAsync({remove:this.params.api.getRowNode(this.params.rowIndex+1)})),this.params.api.redrawRows()}}};function Vo(e,s,i,n,t,l){return h(),u("div",null,[e.params.data.isExpand?(h(),u("i",{key:0,class:"expand-icon",onClick:s[0]||(s[0]=(...o)=>l.onExpand&&l.onExpand(...o))})):(h(),u("i",{key:1,class:"collapse-icon",onClick:s[1]||(s[1]=(...o)=>l.onExpand&&l.onExpand(...o))})),a("span",null,b(e.params.value),1)])}const xo=E(Do,[["render",Vo]]),Io={methods:{onClick(){debugger}}},Lo=Ae('<table><thead class="o-table-thead"><tr><th class="o-table-cell">信号</th><th class="o-table-cell o-cell-ar">信号物理值</th><th class="o-table-cell o-cell-ar">信号描述</th></tr></thead><tbody class="o-table-tbody"></tbody></table>',1),Fo=[Lo];function Ro(e,s,i,n,t,l){return h(),u("div",{onClick:s[0]||(s[0]=(...o)=>l.onClick&&l.onClick(...o))},Fo)}const Mo=E(Io,[["render",Ro]]);let Qe=0,Ze=0,fe=0,Ve=0,xe;const Eo={props:["store","closeFlag","recentTest","connectStatus","colFilterShow","channelOne","channelTwo","channelThree","linChannelVal","linChannelValTwo","filePath","dbcVal","startTime"],emits:["updateBock","updateTimeData","recordTimeChange","startTimeChange"],components:{Button:G,Message:Z,ScrollBar:Zn,ExpandInfo:xo,FullWidthCellRenderer:Mo,TableRecycleScroller:To,CopyPath:ut,ButtonGroup:ve},data(){return{expandKeys:new Set,visibleStartIndex:0,visibleEndIndex:0,bottomPadding:0,recordLoading:!1,mode:"all",sliderValue:-1,comments:["","","","","","","","","","","","","","","",""],message:{visible:!1,level:"",content:""},seconds:0,timeFilterModeVal:"absolute",rowData:[],isRecording:!1,startSqlId:0,endSqlId:0,isLock:!1,isScrollEnd:!0,isAddData:!0,secondConfirm:!1,topLock:!1,bottomLock:!1,openFlag:!1,mlist:[{key:"lookRecord",name:"帧查看",icon:"box"},{key:"supeRecord",name:"图像查看",icon:"setting"}],cur:"lookRecord",recordShow:!0,colorList:["blue","cerulean","cyan","green","lime","purple","pink","red","orange","yellow"],columnsDef:[{titName:"",width:30,keyName:"id",type:"number",value:[],filterShow:!1,custom:!0},{titName:"",width:164,keyName:this.timeFilterModeVal==="diff"?this.mode==="single"?"deltaTime":"diff":"timestamp",type:"number",value:[],filterShow:!1,displayMap:e=>{let s=parseFloat(e);switch(this.timeFilterModeVal){case"diff":return s.toFixed(6);case"absolute":return new Date(s*1e3).toLocaleString("zh-Hans-CN",{hour:"2-digit",minute:"2-digit",second:"2-digit",fractionalSecondDigits:3,hourCycle:"h23",timeZone:"Asia/Shanghai"});case"relative":return(e-this.startTime).toFixed(6);default:return e}}},{titName:"Chn",width:60,keyName:"channel",type:"number",value:[],filterShow:!0},{titName:"ID",width:60,keyName:"linId",type:"number",value:[],filterShow:!0,displayMap:e=>"0x"+e.toString(16)},{titName:"NAME",width:200,keyName:"name",type:"string",value:[],filterShow:!0},{titName:"checksum",width:80,keyName:"checksum",type:"string",value:[],filterShow:!1,displayMap:e=>"0x"+e.toString(16)},{titName:"Dir",width:60,keyName:"dir",type:"string",value:[],filterShow:!0},{titName:"Dlc",width:60,keyName:"dlc",type:"number",value:[],filterShow:!0},{titName:"DATA",width:1380,keyName:"data",type:"string",value:[],filterShow:!1,displayMap:e=>e.map(s=>s.toString(16).padStart(2,"0")).join(" ")}]}},watch:{mode(e,s){this.topPadding=0,this.$refs.table.scrollToItem(0),this.expandKeys.clear(),this.rowData=[],this.isRecording&&this.resumeScroll()},filePath(){this.$emit("updateBock",{filePath:this.filePath,dbcVal:this.dbcVal,recordLoading:this.recordLoading,isRecording:this.isRecording})},dbcVal(){this.$emit("updateBock",{filePath:this.filePath,dbcVal:this.dbcVal,recordLoading:this.recordLoading,isRecording:this.isRecording})},recordLoading(){this.$emit("updateBock",{filePath:this.filePath,dbcVal:this.dbcVal,recordLoading:this.recordLoading,isRecording:this.isRecording})},isRecording(){this.$emit("updateBock",{filePath:this.filePath,dbcVal:this.dbcVal,recordLoading:this.recordLoading,isRecording:this.isRecording})},colComputed(){this.columnsDef[1]={titName:"",width:164,keyName:this.timeFilterModeVal==="diff"?this.mode==="single"?"deltaTime":"diff":"timestamp",type:"number",value:[],filterShow:!1,displayMap:e=>{let s=parseFloat(e);switch(this.timeFilterModeVal){case"diff":return s.toFixed(6);case"absolute":return new Date(s*1e3).toLocaleString("zh-Hans-CN",{hour:"2-digit",minute:"2-digit",second:"2-digit",hourCycle:"h23",timeZone:"Asia/Shanghai"})+"."+s.toFixed(6).split(".")[1];case"relative":return(e-this.startTime).toFixed(6);default:return e}}}}},computed:{colComputed(){return this.timeFilterModeVal+this.startTime+this.mode},recordTime(){return new Date(0,0,0,0,0,this.seconds).toLocaleTimeString()},showData(){let e={mode:"all"};return this.columnsDef.forEach(s=>{s.filterShow&&(e[s.keyName]=(s.value||[]).map(i=>i.value))}),e},diffRowData(){return this.rowData.map((e,s,i)=>({...e,diff:s===0?0:i[s].timestamp-i[s-1].timestamp}))}},methods:{choose(e){this.cur=e,e=="supeRecord"?this.recordShow=!1:this.recordShow=!0},async colFilter(e){var o;console.log("col111",e);const s=e.keyName==="name"?null:"";let i={selectItem:e.keyName,...this.showData,[e.keyName]:s};console.log("params222",i);let n;try{n=await await D.blfLogging.getFiltItemsLin(i)}catch(r){}return(((o=n==null?void 0:n.data)==null?void 0:o.data)||[]).map(r=>({value:r,label:e.keyName==="linId"?"0x"+r.toString(16):r===""?" 空":r})).sort((r,d)=>(e.type==="number"?+r.value>+d.value:r.value>d.value)?1:-1)},startRecord(){clearInterval(Ve),this.checkHardware(),this.isLock=!1,this.columnsDef=this.columnsDef.map(e=>({...e,value:[]}))},async checkHardware(){this.recordLoading=!1,this.secondConfirm=!1,clearInterval(Ve),this.isRecording=!0,this.resumeScroll()},async startLogging(){this.seconds=0,this.rowData=[],this.$emit("startTimeChange",Date.now()/1e3),Ve=setInterval(()=>{this.seconds=Date.now()/1e3-this.startTime},1e3),this.$emit("recordTimeChange",this.recordTime),parseInt(this.channelOne),parseInt(this.channelTwo),parseInt(this.channelThree),parseInt(this.linChannelVal),parseInt(this.linChannelValTwo),this.channelOne.split("-").pop(),this.channelTwo.split("-").pop(),this.channelThree.split("-").pop();let s=this.filePath.replace(".blf","-"+$e()+".blf");console.log(s)},showMessage({level:e,content:s,timeout:i}){clearTimeout(Qe),e!=null&&(this.message.level=e),s!=null&&(this.message.content=s),this.message.visible=!0,i>0&&(Qe=setTimeout(()=>{this.message.visible=!1},i))},showLoggingMessage(){console.log("23333"),clearTimeout(fe),xe=async()=>{var i;this.showData.mode=this.mode;let e;try{e=await D.blfLogging.showLoggingMessageLin({...this.showData})}catch(n){}if(!e)return;let s=((i=e==null?void 0:e.data)==null?void 0:i.frame_data)||[];if(console.log("eventData",s),!this.isLock&&(s==null?void 0:s.length)>0)if(this.mode==="all"){let n=s[0].sqlId,t=s[s.length-1].sqlId;s.forEach(l=>{l.isExpand=!1,l.isParent=!0,l.id=""+l.sqlId,l.canId=l.arbitrationId,delete l.arbitrationId}),this.startSqlId=n,this.endSqlId=t,Ze=s[s.length-1].timestamp,this.rowData=s,this.$refs.table.scrollToBottom(),this.isAddData&&(this.sliderValue=n/t*(Ze-this.startTime)*1e3)}else this.mode==="single"&&(s.forEach(n=>{console.log("ele111",n),n.isExpand=!1,n.isParent=!0,n.id=""+n.sqlId,n.canId=n.arbitrationId,delete n.arbitrationId}),s=s.sort((n,t)=>n.channel===t.channel?n.linId-t.linId:n.channel-t.channel),console.log("finevent",s),await this.drawExpandRows(s),this.rowData=s);this.$emit("updateTimeData",e.data.signal_data),this.isRecording?fe=setTimeout(()=>{requestAnimationFrame(xe)},400):clearTimeout(fe),this.$emit("recordTimeChange",this.recordTime)},xe()},async drawExpandRows(e){const s="-",i={};console.log("1233event"),this.rowData.slice().sort((l,o)=>{const r=l.id,d=o.id;return!~r.indexOf(s)&&~d.indexOf(s)?-1:~r.indexOf(s)&&!~d.indexOf(s)?1:!~r.indexOf(s)&&!~d.indexOf(s)?l.channel<o.channel?-1:l.channel>o.channel?1:l.canId-o.canId:r>d?1:r<d?-1:0}),e.forEach(l=>{var r;const o=l.channel+"-"+l.canId;if(~l.id.indexOf(s))i[o].children.push(l);else{const d=((r=i[o])==null?void 0:r.children)||[];i[o]=l,i[o].children=this.expandKeys.has(o)?d:[]}});let n=this.rowData.slice();for(let l=this.visibleEndIndex;l>=this.visibleStartIndex;l--){if(!(n!=null&&n[l]))continue;let o=null,r=0;if(n[l].isParent)o=n[l],r=l;else if(l===this.visibleStartIndex){for(let d=l;d>=0;d--)if(n[d].isParent){o=n[d],r=d;break}}if(o){const d=o.channel+"-"+o.canId;if(this.expandKeys.has(d)){const c=await this.onToggleExpand(r,n,!0);c!=null&&c.length&&(i[d].children=c)}}}const t=[];for(let l in i){const o=i[l],r=o.children;delete o.children,r.length&&(o.isExpand=!0),t.push(o),r.forEach(d=>{t.push(d)})}this.rowData=t},getSelectData(e){let s="",i="",n="",t="";switch(console.log("向下"),e){case"up":t=this.startSqlId;break;case"down":n=this.endSqlId;break;case"pick":clearTimeout(fe),s=this.sliderValue/1e3+this.startTime;break}D.blfLogging.selectDataLin({moreThanTimeStamp:s,lessThanTimeStamp:i,moreThanSqlID:n,lessThanSqlID:t,...this.showData,sqlId:"",numbers:100}).then(l=>{var o,r;if(((r=(o=l==null?void 0:l.data)==null?void 0:o.data)==null?void 0:r.length)>0){let d=l.data.data;switch(d.forEach(c=>{c.isExpand=!1,c.isParent=!0,c.id=c.sqlId,c.canId=c.arbitrationId,delete c.arbitrationId}),e){case"up":this.rowData=d.concat(...this.rowData),this.$refs.table.scrollToItem(l.data.data.length-1),this.sliderValue=(l.data.data[0].timestamp-this.startTime)*1e3,l.data.startSqlId&&(this.startSqlId=l.data.startSqlId);break;case"down":this.rowData=this.rowData.concat(...d),l.data.endSqlId&&(this.endSqlId=l.data.endSqlId);break;case"pick":this.startSqlId=l.data.startSqlId,this.endSqlId=l.data.endSqlId,this.rowData=d,this.sliderValue=(l.data.data[0].timestamp-this.startTime)*1e3;break}}}).finally(()=>{this.topLock=!1,this.bottomLock=!1})},onUpdatePadding(e){this.visibleStartIndex=e.visibleStartIndex,this.visibleEndIndex=e.visibleEndIndex},onTimeModeChange(e){this.timeFilterModeVal=e},onScrollAction(e){this.isLock||(this.mode==="all"?this.isLock=!0:this.isLock=!1,this.isScrollEnd=!1)},onBodyScrollEnd(e){this.mode!=="single"&&(e==="up"&&this.topLock===!1&&(this.topLock=!0,this.getSelectData(e)),e==="down"&&this.bottomLock===!1&&(this.bottomLock=!0,this.getSelectData(e)))},onClicked(){this.isLock=!1,this.isScrollEnd=!1},resumeScroll(){this.isScrollEnd=!0,this.isAddData=!0,this.isLock=!1,this.showLoggingMessage()},async onToggleExpand(e,s,i){const n=s.map(d=>({...d})),t=n[e],l=t.channel+"-"+t.canId;let o=parseInt(this.linChannelVal)||0,r=parseInt(this.linChannelValTwo)||0;if(i||!t.isExpand){this.expandKeys.add(l);const d=await D.blfLogging.parsedSignalLin({channel:t.channel,linId:""+t.linId,ldfChn:[o,r],linData:(t.data||[]).map(f=>f.toString(16))});let c=(d==null?void 0:d.data.sort((f,y)=>f.name<y.name?-1:1))||[],m=t.sqlId;if(c.forEach((f,y)=>{f.channel=t.channel,f.canId=""+t.canId,f.isParent=!1,f.isExpand=!0,f.isChildTit=!1,f.id=m+"-"+f.name}),c.unshift({channel:t.channel,canId:""+t.canId,isParent:!1,isExpand:!0,isChildTit:!0,id:m+"-"}),n.splice(e+1,0,...c),t.isExpand=c.length,i)return c;this.rowData=n}else this.expandKeys.delete(l),n.splice(e+1,n[e].isExpand),n[e].isExpand=!1,this.rowData=n},onSliderChange(e){this.isScrollEnd=!1,this.isAddData=!1,this.isLock=!0,this.getSelectData("pick")},onFilterItem(){this.openFlag=!this.openFlag},onColFilterChange(e){let s=this.columnsDef.find(i=>e.keyName===i.keyName);s&&(s.value=e.value),this.resumeScroll()}},mounted(){},unmounted(){xe=null,clearTimeout(fe),clearInterval(Ve)}},oe=e=>(j("data-v-3aaf4f1e"),e=e(),q(),e),$o={class:"o-pul-er"},Ao={key:0},No=oe(()=>a("div",{class:"o-pul-title"},"报文录制配置",-1)),Oo={class:"o-pul-p-wrap"},Po={class:"o-pul-p"},Uo={class:"record-header-message"},Ho=oe(()=>a("b",null,"车型/DBC：",-1)),Bo=["v-tooltip"],jo=oe(()=>a("b",null,"保存目录：",-1)),qo=[jo],zo={class:"o-pul-path"},Ko={class:"o-pul-p-wrap"},Wo={class:"o-pul-p"},Go={class:"record-header-message"},Xo=oe(()=>a("b",null,"Lin通道1：",-1)),Yo={class:"record-header-message"},Jo=oe(()=>a("b",null,"Lin通道2：",-1)),Qo={class:"o-pul-btn-wrap"},Zo=oe(()=>a("div",{class:"tool-btn-wrap"},[a("i",{class:"warn-icon"}),a("div",{class:"tool-picker-contianer-wrap"},"录制将覆盖文件,确认要开始录制吗?")],-1)),er=oe(()=>a("div",{class:"tool-picker-arrow"},null,-1)),tr={class:"tool-picker-footer-wrap"},sr={class:"o-dialog-footer"},lr=oe(()=>a("div",{class:"o-pul-hr"},null,-1)),ir={class:"o-table-wrap"};function ar(e,s,i,n,t,l){const o=w("CopyPath"),r=w("Button"),d=w("ButtonGroup"),c=w("ScrollBar"),m=w("TableRecycleScroller"),f=w("Message"),y=H("tooltip"),M=H("esc");return h(),u(T,null,[a("div",$o,[t.recordShow?(h(),u("div",Ao,[No,a("div",Oo,[a("div",Po,[a("span",Uo,[Ho,C(b(i.dbcVal),1)]),a("span",{class:"record-header-message",style:{width:"71px"},"v-tooltip":i.filePath},qo,8,Bo),a("span",zo,[g(o,{path:i.filePath,length:60,full:!0},null,8,["path"])])])]),a("div",Ko,[a("div",Wo,[v((h(),u("span",Go,[Xo,C(b(i.linChannelVal),1)])),[[y,i.linChannelVal]]),v((h(),u("span",Yo,[Jo,C(b(i.linChannelValTwo),1)])),[[y,i.linChannelValTwo]])])]),a("div",Qo,[t.secondConfirm?v((h(),u("div",{key:0,class:"tool-picker-wrap",onClick:s[1]||(s[1]=A(()=>{},["stop"]))},[Zo,er,a("div",tr,[a("div",sr,[g(r,{class:"small-btn",style:{width:"30px"},onClick:s[0]||(s[0]=A(L=>t.secondConfirm=!1,["stop"]))},{default:S(()=>[C("取消")]),_:1}),g(r,{class:"small-btn",type:"primary",style:{width:"30px",margin:"0 0 0 10px"},onClick:A(l.checkHardware,["stop"])},{default:S(()=>[C("确定")]),_:1},8,["onClick"])])])])),[[M,()=>e.$emit("cancel")]]):k("",!0),C("   "),g(d,{options:[{label:"普通",value:"all"},{label:"单帧",value:"single"}],class:"theme-btn-group",modelValue:t.mode,"onUpdate:modelValue":s[2]||(s[2]=L=>t.mode=L)},null,8,["modelValue"])]),lr,a("div",ir,[g(c,{modelValue:t.sliderValue,"onUpdate:modelValue":s[3]||(s[3]=L=>t.sliderValue=L),disable:t.mode!=="all",startTime:i.startTime*1e3,start:0,end:t.seconds*1e3,onChange:l.onSliderChange,timeFilter:t.timeFilterModeVal!="relative"?"absolute":"relative"},null,8,["modelValue","disable","startTime","end","onChange","timeFilter"]),g(m,{rowData:l.diffRowData,filters:l.showData,columnsDef:t.columnsDef,onToggleExpand:s[4]||(s[4]=L=>l.onToggleExpand(L,t.rowData)),onScrollRow:l.onBodyScrollEnd,onScrollAction:l.onScrollAction,onFilterItem:l.onFilterItem,onClick:l.onClicked,columnsFilter:l.colFilter,openFlag:t.openFlag,onColFilterChange:l.onColFilterChange,ref:"table",onUpdatePadding:l.onUpdatePadding,onTimeModeChange:l.onTimeModeChange,style:{height:"100%"}},null,8,["rowData","filters","columnsDef","onScrollRow","onScrollAction","onFilterItem","onClick","columnsFilter","openFlag","onColFilterChange","onUpdatePadding","onTimeModeChange"]),v(a("div",{class:"scrollToBottomBtn",onClick:s[5]||(s[5]=A(L=>l.resumeScroll(),["stop"]))},null,512),[[U,t.isLock&&t.mode==="all"],[y,"恢复向下滚动",void 0,{left:!0}]])])])):k("",!0)]),g(f,{message:t.message},null,8,["message"])],64)}const nr=E(Eo,[["render",ar],["__scopeId","data-v-3aaf4f1e"]]);let ge=[],et=0;const or={props:["filledOptions","checkedOptions"],emits:["connect","showMessage","getCarCode","cancel","signalsChange"],components:{Button:G,RecycleScroller:he,Spin:de,Message:Z},data(){var s,i,n;const e=this.$ls.get("blfread_sdbData")||[];if(this.carType==="custom"){let t=(s=e.find(l=>l.sdb===this.sdb))==null?void 0:s.comments;t&&(ge=["",...t])}else ge=((n=(i=X.DEFAULT.find(t=>t.value===this.$props.carType))==null?void 0:i.children.find(t=>t.value===this.$props.sdb))==null?void 0:n.comments)||[];return ge=ge.map((t,l)=>"".concat("⓪①②③④⑤⑥⑦⑧⑨⑩⑪⑫⑬⑭⑮⑯⑰⑱⑲⑳㉑㉒㉓㉔㉕㉖㉗㉘㉙㉚㉛㉜㉝㉞㉟㊱㊲"[l]).concat(t)),{inputStr:"",checkedList:[],selectNodeList:[],counter:0,sdbCustom:e,lodingSpin:!1,isFlag:1,message:{visible:!1,level:"",content:""},listOpen:[],expandKeys:new Set([])}},computed:{list(){this.checkedList=this.$props.checkedOptions;let e=[],s=this,i=this.$props.filledOptions.data;for(let t in i){let l;l={_id:+t,id:+t,text:ge[t],node_type:"channel",children:[],set checked(o){l.children.forEach(r=>{r.checked=o})},get checked(){return!l.children.some(o=>o.checked==!1)},get indeterminate(){return l.children.some(o=>o.checked)&&l.children.some(o=>!o.checked)}};for(let o in i[t]){let r;r={_id:t+"_"+o,id:t+"_"+o,text:o=="-1"?"":o,node_type:"msg",channel:l.id,set checked(d){d?s.checkedList.push(r):s.checkedList=s.checkedList.filter(c=>c._id!==r._id)},get checked(){return s.checkedList.some(d=>d._id===r._id)},children:i[t][o].map(d=>{var m;let c;return c={_id:t+"_"+o+"_"+d[0],id:d[0],msg:o=="-1"?"-1":+((m=o.match(/0x\w+/))==null?void 0:m[0])||o,channel:l.id,text:d[0],node_type:"signal",comment:d[1],remark:d[2],canId:d[3],rawValue:d[4],maxRaw:d[5],minRaw:d[6],maxPhys:d[7],minPhys:d[8],selectPhys:d[9],unit:d[10],startBit:d[11],length:d[12],physStep:d[13],dlc:d[14],canType:d[15],periodic:d[16],eteDisable:d[17]},c})},l.children.push(r)}e.push(l)}let n=[];for(let t=0;t<e.length;t++){let l=e[t];if(l.id!=-1&&n.push(l),!(!this.inputStr&&!this.expandKeys.has(l.id)))for(let o=0;o<l.children.length;o++){let r=l.children[o];r.id[0]!="-"&&n.push(r)}}if(this.inputStr.length>0){const t=this.inputStr.toLowerCase();let l;try{l=new RegExp(t,"i")}catch(o){l={test(r){return~r.toLowerCase().indexOf(r.toLowerCase())}}}n=n.filter(o=>l.test(o.text)||o.comment&&l.test(o.comment)||o.remark&&l.test(o.remark))}return n}},watch:{checkedListIndex:{handler(e){this.checkedList=[]},deep:!0}},mounted(){this.$refs.chsInputRef.focus(),setTimeout(()=>{document.body.addEventListener("mousedown",this.clickHandler)},300)},beforeUnmount(){},unmounted(){document.body.removeEventListener("mousedown",this.clickHandler)},methods:{clickHandler(e){var s;((s=this.$refs.root)==null?void 0:s.contains(e.target))==!1&&this.$emit("cancel")},showFirstChild(e){this.expandKeys.has(e.id)?this.expandKeys.delete(e.id):this.expandKeys.add(e.id)},clearTable(){this.checkedList=[]},title4node(e){return we(e)},showMessage({level:e,content:s,timeout:i}){clearTimeout(et),e!=null&&(this.message.level=e),s!=null&&(this.message.content=s),this.message.visible=!0,i>0&&(et=setTimeout(()=>{this.message.visible=!1},i))},submit(){this.checkedList.length>80?this.showMessage({level:"error",content:"信号选择不能超过80项",timeout:3e3}):this.$emit("signalsChange",this.checkedList)},highlightWord(e){if(!e)return e;const s=this.inputStr;if(!s)return e;const i=s.split(/\s+/g);var n,t=i.length,l;for(n=0;n<t;n++)try{l=new RegExp(i[n],"gi"),l.test(e)&&(e=e.replace(l,"<strong>$&</strong>"))}catch(o){l=i[n],e=e.replace(l,"<strong>$&</strong>")}return e}}},rr={class:"chs-er",ref:"root"},dr={class:"chs-list-er","data-loading":!1},cr=["onClick"],hr=["id","onUpdate:modelValue","data-indeterminate"],ur=["innerHTML"],mr=["for"],pr=["id","onUpdate:modelValue","data-indeterminate"],fr=["innerHTML"],gr={class:"footer"};function br(e,s,i,n,t,l){const o=w("RecycleScroller"),r=w("Message"),d=H("tooltip"),c=H("esc");return v((h(),u("div",rr,[v(a("input",{class:"chs-input-er",placeholder:"搜索信号名称/信号描述",ref:"chsInputRef","onUpdate:modelValue":s[0]||(s[0]=m=>t.inputStr=m),onInput:s[1]||(s[1]=(...m)=>e.onChange&&e.onChange(...m)),draggable:!1},null,544),[[Q,t.inputStr]]),a("div",dr,[g(o,{class:"chs-list",items:l.list,"item-size":28,"key-field":"_id"},{default:S(({item:m})=>[a("label",null,[m.node_type=="channel"&&m.id<=36?(h(),u("div",{key:0,style:{"margin-left":"1px"},class:ue(!t.inputStr&&t.expandKeys.has(m.id)?"switch-open":"switch-close"),onClick:A(f=>l.showFirstChild(m),["stop","prevent"])},null,10,cr)):k("",!0),m.node_type=="channel"&&m.id<=36?v((h(),u("input",{key:1,style:{"margin-left":"3px"},id:m._id,type:"checkbox","onUpdate:modelValue":f=>m.checked=f,"data-indeterminate":m.indeterminate,"click.stop":""},null,8,hr)),[[ee,m.checked]]):k("",!0),m.node_type=="channel"&&m.id<=36?(h(),u("span",{key:2,class:"chs-node",innerHTML:l.highlightWord(m._id)},null,8,ur)):m.node_type=="msg"?v((h(),u("div",{key:3,for:m.children,style:{"text-indent":"2em","margin-left":"-15px"},class:"chs-node chs-node-item"},[v(a("input",{id:m._id,type:"checkbox","onUpdate:modelValue":f=>m.checked=f,"data-indeterminate":m.indeterminate,"click.stop":""},null,8,pr),[[ee,m.checked]]),a("span",{class:"",innerHTML:l.highlightWord(m.text)},null,8,fr)],8,mr)),[[d,{content:l.title4node(m),html:!0},void 0,{right:!0}]]):k("",!0)])]),_:1},8,["items"])]),a("div",gr,[a("div",{class:"chs-btn confirm",onClick:s[2]||(s[2]=(...m)=>l.submit&&l.submit(...m))},"确认"),a("div",{class:"chs-btn cancel",onClick:s[3]||(s[3]=(...m)=>l.clearTable&&l.clearTable(...m))},"重置")]),g(r,{message:t.message},null,8,["message"])])),[[c,()=>e.$emit("cancel")]])}const _r=E(or,[["render",br],["__scopeId","data-v-f8a77322"]]);const yr={props:["disabled"],data(){return{editable:!1}},methods:{clickBody(e){var i,n;if(this.$props.disabled)return;this.editable=!0,(n=(i=e.target.children)==null?void 0:i[0])==null||n.focus(),console.log("e.target111",e.target);let s=t=>{var l;t.target&&(t.target==this.$refs.root||(l=this.$refs.root)!=null&&l.contains(t.target))?this.editable=!0:t.target&&(this.editable=!1,document.body.removeEventListener("mousedown",s))};document.body.addEventListener("mousedown",s)}},mounted(){}},wr=["data-forbidden","data-disabled"];function vr(e,s,i,n,t,l){return h(),u("div",{ref:"root",class:"ewer","data-forbidden":e.$props.disabled,"data-disabled":!t.editable,onClick:s[0]||(s[0]=(...o)=>l.clickBody&&l.clickBody(...o))},[ht(e.$slots,"default")],8,wr)}const Pe=E(yr,[["render",vr]]);const Cr={props:["modelValue","min","max","watch"],emits:["update:modelValue","change","error"],data(){return{str:"",type:16,highlight:!1}},watch:{modelValue:{handler(e,s){s!=null&&parseFloat(e)!==parseFloat(s)&&this.$props.watch&&(this.highlight=!0,setTimeout(()=>{this.highlight=!1},500));let i="0x0";try{i="0x"+(parseInt(e)||0).toString(16)}catch(n){}this.str=i,this.type=16},immediate:!0}},methods:{onChange(e){let s=e.target.value;if(!this.valid(s.toString())){this.str="0x"+(parseInt(this.$props.modelValue)||0).toString(16),this.$emit("error",s);return}let i=this.type===10?parseInt(s):parseInt("0x"+s.replace("0x",""),16);i<this.min?i=+this.min:i>this.max&&(i=+this.max),this.str="0x"+i.toString(16),this.$emit("update:modelValue",i),this.$emit("change",i)},valid(e){return this.type==16?/^(0x)?[0-9a-fA-F]+$/.test(e):/\d+/.test(e)}}},kr=["data-hi"];function Sr(e,s,i,n,t,l){return v((h(),u("input",{class:"input","data-hi":t.highlight,type:"text","onUpdate:modelValue":s[0]||(s[0]=o=>t.str=o),onChange:s[1]||(s[1]=A((...o)=>l.onChange&&l.onChange(...o),["prevent"])),onKeydown:s[2]||(s[2]=ft(A((...o)=>l.onChange&&l.onChange(...o),["stop","prevent"]),["enter"]))},null,40,kr)),[[Q,t.str,void 0,{lazy:!0}]])}const Ue=E(Cr,[["render",Sr],["__scopeId","data-v-c34f5797"]]);const Tr={props:["min","max","step","modelValue","enum","watch","class"],emits:["update:modelValue","change"],data(){return{str:"",highlight:!1}},computed:{enumOpts(){return Object.entries(this.$props.enum)}},watch:{modelValue:{handler(e,s){var i;s!=null&&parseFloat(e)!==parseFloat(s)&&this.$props.watch&&(this.highlight=!0,setTimeout(()=>{this.highlight=!1},500)),(e==null?void 0:e[0])>="A"?this.str=((i=this.enumOpts.find(n=>+n[1]==+e))==null?void 0:i[0])||"":this.str=parseFloat(e)},immediate:!0}},methods:{onChange(e){let s=parseFloat(e.target.value),i=parseFloat(this.min),n=parseFloat(this.max);console.log(s,this.min,this.max),s<i?s=i:s>n&&(s=n),this.str=s.toString(),this.$emit("update:modelValue",s),this.$emit("change",s)}}},Dr=["data-hi","min","max","step"],Vr={key:0,class:"ic-down"},xr=["data-hi","value"],Ir=["value"];function Lr(e,s,i,n,t,l){return h(),u(T,null,[v(a("input",{class:ue(["input",e.$props.class]),type:"number","data-hi":t.highlight,min:i.min,max:i.max,step:i.step,"onUpdate:modelValue":s[0]||(s[0]=o=>t.str=o),onChange:s[1]||(s[1]=(...o)=>l.onChange&&l.onChange(...o)),style:$({width:l.enumOpts.length?"40%":""})},null,46,Dr),[[Q,t.str,void 0,{lazy:!0}]]),l.enumOpts.length?(h(),u("i",Vr)):k("",!0),l.enumOpts.length?(h(),u("select",{key:1,"data-hi":t.highlight,class:"select",value:t.str,onChange:s[2]||(s[2]=(...o)=>l.onChange&&l.onChange(...o))},[(h(!0),u(T,null,F(l.enumOpts,o=>(h(),u("option",{value:o[0]},b(o[1]),9,Ir))),256))],40,xr)):k("",!0)],64)}const He=E(Tr,[["render",Lr],["__scopeId","data-v-c91a7f13"]]);let tt=0;const Fr={props:["store","setStore"],components:{Button:G,Message:Z,ChooseSignal:_r,EditWrapper:Pe,InputHex:Ue,InputOrSelect:He},data(){return{hexMultiValue:0,isHexMulti:!1,hexs:[],frames:[],listTable:{cols:[{label:"",width:"2.8em",icon:"add"},{label:"Frame Name",width:"auto"},{label:"E2E",width:"6em",type:"checkbox",checked:!1},{label:"Period (ms)",width:"9em",tooltip:{content:"1-1000ms:周期发送<br/>0:单点发送",html:!0}},{label:"ID",width:"4.5em",tooltip:"DBC导入禁止修改ID"},{label:"Channel",width:"6em"},{label:"Type",width:"6em"},{label:"DLC",width:"4em"},{label:"",width:"5em"}]},sigTable:{cols:[{label:"Signal Name",width:"auto"},{label:"Raw",width:"90px"},{label:"Phys",width:"200px"},{label:"Unit",width:"4em"}]},cur:-1,chooseSignalShow:!1,filledOptions:[],isSyncFrames:!1,addRecordShow:!1,message:{visible:!1,level:"",content:""},curChannel:0}},computed:{checkedOptions(){return this.frames.filter(e=>e.from=="dbc")},checkIndeterminate(){return this.frames.some(e=>e.e2e)&&this.frames.some(e=>!e.e2e)},allChecked(){return this.frames.some(e=>e.e2e)&&this.frames.some(e=>e.children[0].eteDisable)}},watch:{"$props.store.sendRecord.isRecording":{handler(e){e&&this.updateMultiFrame(this.frames.map((s,i)=>({...s,row:i+1})),"add")}},"$props.store.sendRecord.dbc.dbcChn":{handler(e,s){}},"$props.store.sendRecord":{handler(e,s){}},frames:{async handler(e,s){if(this.isSyncFrames)return;this.isSyncFrames=!0,this.isHexMulti=!1;for(let t=0;t<e.length;t++){let l=e[t],o=l.channel;console.log("sendframe.dbcChannel07041553",o);let r=l.canId;console.log("sendframe.dirty07041441",l.dirty),l.dirty==="raw"?(await D.blfLogging.getRawValueToPhysValue({dbcChannel:o,canId:r,signalsData:l.children}).then(d=>{this.frames[t]={...l,rawData:d.data.data.rawData,children:l.children.map(c=>{var m,f;return{...c,physValue:(f=(m=d.data.data.signalsData.find(y=>y.name===c.id))==null?void 0:m.physValue)!=null?f:c.physValue}}),dirty:!1,raw:t+1},this.updateMultiFrame([{row:t+1,...this.frames[t]}],"modify")}).catch(console.log),await ct(100)):l.dirty==="data"?(console.log("sendframes[i]07051410",l),l.from==="dbc"?await D.blfLogging.getDataToValues({dbcChannel:o,canId:r,rawData:l.rawData}).then(d=>{this.frames[t]={...l,children:l.children.map(c=>{var m,f,y,M;return{...c,physValue:(f=(m=d.data.data.signalsPhysData.find(L=>L.name===c.id))==null?void 0:m.physValue)!=null?f:c.physValue,rawValue:(M=(y=d.data.data.signalsRawData.find(L=>L.name===c.id))==null?void 0:y.rawValue)!=null?M:c.rawValue}}),dirty:!1,raw:t+1},this.updateMultiFrame([{row:t+1,...this.frames[t]}],"modify")}).catch(console.log):(this.frames[t]={...l,dirty:!1,raw:t+1},this.updateMultiFrame([{row:t+1,...this.frames[t]}],"modify"))):l.dirty==="phys"?await D.blfLogging.getPhysValueToRawValue({dbcChannel:o,canId:r,signalsData:l.children}).then(d=>{this.frames[t]={...l,rawData:d.data.data.rawData,children:l.children.map(c=>{var m,f;return{...c,rawValue:(f=(m=d.data.data.signalsData.find(y=>y.name===c.id))==null?void 0:m.rawValue)!=null?f:c.rawValue}}),dirty:!1,raw:t+1},this.updateMultiFrame([{row:t+1,...this.frames[t]}],"modify")}).catch(console.log):l.dirty==="dlc"?(this.frames[t]={...l,rawData:Array.from({length:l.dlc},(d,c)=>l.rawData[c]||0),dirty:!1,raw:t+1},this.updateMultiFrame([{row:t+1,...l}],"modify")):l.dirty==="periodic"?(this.frames[t]={...l,isSending:l.periodic==0?!1:l.isSending,dirty:!1,raw:t+1},this.updateMultiFrame([{row:t+1,...l}],"modify")):l.dirty&&(this.frames[t].dirty=!1,this.updateMultiFrame([{row:t+1,...l}],"modify"))}this.isSyncFrames=!1;let i=e.filter(t=>{var l;return((l=t.children[0])==null?void 0:l.eteDisable)===!0}),n=[];i.forEach(t=>{n.push({raw:t.raw,canId:t.canId,dbcChannel:t.channel,useE2E:t.e2e?1:0})}),D.blfLogging.setE2EConfig({e2eSlotList:n})},deep:!0},cur(e){console.log("sendCur07041058",e,this.frames[e]),this.isHexMulti=!1,this.hexs=[]}},methods:{showMessage({level:e,content:s,timeout:i}){clearTimeout(tt),e!=null&&(this.message.level=e),s!=null&&(this.message.content=s),this.message.visible=!0,i>0&&(tt=setTimeout(()=>{this.message.visible=!1},i))},onHexErr(){this.showMessage({timeout:2e3,level:"error",content:"请输入正确格式的16进制"})},updateFrame(e){let s=this.frames.slice(),i=[],n=[];for(let t=s.length-1;t>=0;t--){let l=s[t];if(l.from==="dbc"){let o=e.findIndex(r=>r.id===l.id);if(~o)e.splice(o,1);else{t===this.cur&&(this.cur=-1);let r=s.splice(t,1);n.unshift({...r,row:t+1})}}}this.updateMultiFrame(n,"delete"),i=e.map((t,l)=>{let o=t.children[0]||{};return{...t,name:t.text,from:"dbc",e2e:!1,periodic:o.periodic||0,canType:o.canType||"CAN",dlc:o.dlc||64,canId:o.msg||0,dirty:"raw",isSending:!1,children:t.children.map(r=>({...r,name:r.id}))}}),s.push(...i),this.frames=s,this.chooseSignalShow=!1,this.addRecordShow=!1},delFrame(e){e===this.cur&&(this.cur=-1);let s=this.frames.splice(e,1);this.frames.forEach((i,n)=>{this.frames[n].raw=n+1}),this.updateMultiFrame([{...s,row:e+1}],"delete")},addFrame(e){this.addRecordShow=!1;let s=[{name:"",e2e:!1,periodic:1e3,canId:e==="CAN"?111:222,channel:this.$props.store.sendRecord.dbc.dbcChn[e==="CAN"?0:1],canType:e,dlc:8,isSending:!1,from:e,rawData:[0,0,0,0,0,0,0,0],children:[{eteDisable:!1}]}],i=this.frames.length-1;this.frames.push(...s),console.log("addthis.frames",this.frames),this.updateMultiFrame(s.map((n,t)=>({...n,row:i+t})),"add")},updateMultiFrame(e,s){if(!this.$props.store.sendRecord.isRecording)return;let i=e.map(n=>({...n,channel:1+this.$props.store.sendRecord.dbc.dbcChn.indexOf(n.channel)}));i.length>0&&D.blfLogging.getPeriodicSend({data:i,behavor:s})},togglePlay(e,s){e.periodic>0?(e.isSending=!e.isSending,this.updateMultiFrame([{row:s+1,...e}],"modify")):D.blfLogging.getManualSend({row:s+1,...e,channel:1+this.$props.store.sendRecord.dbc.dbcChn.indexOf(e.channel)}).catch(console.log)},onHexMultiChange(){this.frames[this.cur].rawData=this.frames[this.cur].rawData.map((e,s)=>this.hexs.includes(s)?this.hexMultiValue:e),this.frames[this.cur].dirty="data"},clickHandler(e){var s;((s=this.$refs.root)==null?void 0:s.contains(e.target))==!1&&(this.addRecordShow=!1)},onChecked(e){this.allChecked=!e,this.allChecked?this.frames.forEach(s=>{var i;(i=s.children[0])!=null&&i.eteDisable&&(s.e2e=!0)}):this.frames.forEach(s=>{s.e2e=!1})}},mounted(){setTimeout(()=>{document.body.addEventListener("mousedown",this.clickHandler)},300)},unmounted(){document.body.removeEventListener("mousedown",this.clickHandler)}},Be=e=>(j("data-v-eda81dc0"),e=e(),q(),e),Rr={class:"body"},Mr={class:"list-er"},Er={class:"list-table"},$r={key:1,class:"ic-help"},Ar=["data-indeterminate"],Nr=["onClick","data-active"],Or=["title"],Pr=["data-from","data-cantype","data-valid"],Ur=["disabled","onUpdate:modelValue"],Hr=["onUpdate:modelValue","onChange"],Br=["disabled","onUpdate:modelValue","onChange"],jr=["value"],qr=["disabled","onUpdate:modelValue","onChange"],zr=Be(()=>a("option",{value:"CAN"},"CAN",-1)),Kr=Be(()=>a("option",{value:"CANFD"},"CANFD",-1)),Wr=[zr,Kr],Gr=["disabled","onUpdate:modelValue","onChange"],Xr=["value"],Yr=["data-disable","data-recording","data-active","onClick"],Jr=["onClick"],Qr={key:0,class:"table-empty"},Zr={class:"empty-meark"},ed={class:"sig-er"},td={class:"hex-er"},sd=Be(()=>a("th",{style:{width:"4em"}}," ",-1)),ld={style:{width:"11.8%"}},id={key:0},ad=["value"],nd={class:"hex-footer"},od={class:"hex-multi-input"},rd={class:"btn-import-er"},dd={class:"add-record",ref:"root"},cd=["data-disabled"],hd=["data-disabled"],ud=["data-disabled"];function md(e,s,i,n,t,l){var M,L,z;const o=w("EditWrapper"),r=w("InputHex"),d=w("InputOrSelect"),c=w("Button"),m=w("ChooseSignal"),f=w("Message"),y=H("tooltip");return h(),u(T,null,[a("div",Rr,[a("div",Mr,[a("table",Er,[a("tr",null,[(h(!0),u(T,null,F(t.listTable.cols,_=>(h(),u("th",{style:$({width:_.width})},[C(b(_.label)+" ",1),_.icon?(h(),u("i",{key:0,onClick:s[0]||(s[0]=O=>t.addRecordShow=!t.addRecordShow),class:"ic-add"})):k("",!0),_.tooltip?v((h(),u("i",$r,null,512)),[[y,_.tooltip]]):k("",!0),_.type?v((h(),u("input",{key:2,type:"checkbox",onChange:s[1]||(s[1]=O=>l.onChecked(l.allChecked)),"data-indeterminate":l.checkIndeterminate,"onUpdate:modelValue":s[2]||(s[2]=O=>l.allChecked=O)},null,40,Ar)),[[ee,l.allChecked]]):k("",!0)],4))),256))]),(h(!0),u(T,null,F(t.frames,(_,O)=>(h(),u("tr",{onClick:x=>t.cur=O,"data-active":t.cur===O},[a("td",null,b(O+1),1),a("td",{title:_.name},[a("i",{class:"ic-can","data-from":_.from,"data-cantype":_.canType,"data-valid":Object.values(e.$props.store.sendRecord.dbc.dbcChn).includes(_.channel)},null,8,Pr),C(" "+b(_.name),1)],8,Or),a("td",null,[g(o,{style:{"justify-content":"center"}},{default:S(()=>{var x;return[v(a("input",{type:"checkbox",disabled:!((x=_.children[0])!=null&&x.eteDisable),"onUpdate:modelValue":N=>_.e2e=N},null,8,Ur),[[ee,_.e2e,void 0,{lazy:!0}]])]}),_:2},1024)]),a("td",null,[g(o,null,{default:S(()=>[v(a("input",{class:"td-input",type:"number",min:"0",max:"1000","onUpdate:modelValue":x=>_.periodic=x,onChange:x=>_.dirty="periodic"},null,40,Hr),[[Q,_.periodic,void 0,{lazy:!0}]])]),_:2},1024)]),a("td",null,[g(o,{disabled:_.from==="dbc"},{default:S(()=>[g(r,{onError:l.onHexErr,min:0,max:2047,disabled:_.from==="dbc",class:"td-input",modelValue:_.canId,"onUpdate:modelValue":x=>_.canId=x,onChange:x=>_.dirty="canId"},null,8,["onError","disabled","modelValue","onUpdate:modelValue","onChange"])]),_:2},1032,["disabled"])]),a("td",null,[g(o,{disabled:_.from==="dbc"},{default:S(()=>[v(a("select",{disabled:_.from==="dbc",class:"td-input","onUpdate:modelValue":x=>_.channel=x,onChange:x=>_.dirty="channel"},[(h(!0),u(T,null,F(e.$props.store.sendRecord.dbc.dbcChn,(x,N)=>(h(),u("option",{value:x},"CAN"+b(N+1),9,jr))),256))],40,Br),[[re,_.channel,void 0,{lazy:!0}]])]),_:2},1032,["disabled"])]),a("td",null,[g(o,{disabled:_.from==="dbc"},{default:S(()=>[v(a("select",{disabled:_.from==="dbc",class:"td-input","onUpdate:modelValue":x=>_.canType=x,onChange:x=>_.dirty="canType"},Wr,40,qr),[[re,_.canType]])]),_:2},1032,["disabled"])]),a("td",null,[g(o,{disabled:_.canType==="CAN"||_.from==="dbc"},{default:S(()=>[v(a("select",{disabled:_.canType==="CAN"||_.from==="dbc",class:"td-input","onUpdate:modelValue":x=>_.dlc=x,onChange:x=>_.dirty="dlc"},[(h(),u(T,null,F([8,12,16,20,24,32,48,64],x=>a("option",{value:x},b(x),9,Xr)),64))],40,Gr),[[re,_.dlc]])]),_:2},1032,["disabled"])]),a("td",null,[a("i",{class:"ic-play","data-disable":Object.values(e.$props.store.sendRecord.dbc.dbcChn).includes(_.channel),"data-recording":e.$props.store.sendRecord.isRecording,"data-active":_.isSending,onClick:x=>l.togglePlay(_,O)},null,8,Yr),C("  "),a("i",{class:"ic-del",onClick:A(x=>l.delFrame(O),["stop"])},null,8,Jr)])],8,Nr))),256))]),t.frames.length==0?(h(),u("div",Qr,[a("div",Zr,[C("暂无内容，请先"),a("span",{class:"empty-btn",onClick:s[3]||(s[3]=_=>t.addRecordShow=!t.addRecordShow)},"导入帧")])])):k("",!0)]),a("div",ed,[(h(),u("table",{class:"sig-table",key:"sig"+t.cur},[a("tr",null,[(h(!0),u(T,null,F(t.sigTable.cols,_=>(h(),u("th",{style:$({width:_.width})},b(_.label),5))),256))]),((M=t.frames[t.cur])==null?void 0:M.name)!==""?(h(!0),u(T,{key:0},F((L=t.frames[t.cur])==null?void 0:L.children,_=>(h(),u("tr",null,[v((h(),u("td",null,[C(b(_.text)+" ",1)])),[[y,{content:"".concat(_.text,"<hr/>phys:").concat(_.minPhys," ~ ").concat(_.maxPhys,"<br/>raw:").concat(_.minRaw?"0x"+_.minRaw.toString(16):""," ~ ").concat(_.maxRaw?"0x"+_.maxRaw.toString(16):"","<br/>Start Bit:").concat(_.startBit,"<br>Length:").concat(_.length,"<br>Phys Step:").concat(_.physStep),html:!0},void 0,{"top-start":!0}]]),a("td",null,[g(o,null,{default:S(()=>[g(r,{watch:!0,onError:l.onHexErr,min:_.minRaw,max:_.maxRaw,class:"td-input",modelValue:_.rawValue,"onUpdate:modelValue":O=>_.rawValue=O,modelModifiers:{lazy:!0},onChange:s[4]||(s[4]=O=>t.frames[t.cur].dirty="raw")},null,8,["onError","min","max","modelValue","onUpdate:modelValue"])]),_:2},1024)]),a("td",null,[g(o,null,{default:S(()=>[g(d,{watch:!0,min:_.minPhys,max:_.maxPhys,class:"td-input",step:_.physStep,modelValue:_.physValue,"onUpdate:modelValue":O=>_.physValue=O,enum:_.selectPhys?_.selectPhys:"",onChange:s[5]||(s[5]=O=>t.frames[t.cur].dirty="phys")},null,8,["min","max","step","modelValue","onUpdate:modelValue","enum"])]),_:2},1024)]),a("td",null,b(_.unit),1)]))),256)):k("",!0)]))]),a("div",td,[(h(),u("table",{class:"hex-table",key:"hex"+t.cur},[a("tr",null,[sd,(h(),u(T,null,F([0,1,2,3,4,5,6,7],_=>a("th",ld,b(_),1)),64))]),(z=t.frames[t.cur])!=null&&z.rawData?(h(),u(T,{key:0},F([0,8,16,24,32,40,48,56,64],(_,O)=>(h(),u(T,null,[t.frames[t.cur].rawData.length>_?(h(),u("tr",id,[a("td",null,[a("b",null,b(_),1)]),(h(),u(T,null,F(8,x=>a("td",null,[t.isHexMulti&&_+x-1<t.frames[t.cur].rawData.length?v((h(),u("input",{key:0,type:"checkbox",class:"radio","onUpdate:modelValue":s[6]||(s[6]=N=>t.hexs=N),value:_+x-1},null,8,ad)),[[ee,t.hexs]]):k("",!0),_+x-1<t.frames[t.cur].rawData.length?(h(),P(o,{key:1},{default:S(()=>[g(r,{watch:!0,onError:l.onHexErr,min:0,max:255,class:"td-input",style:{width:"calc(100%)","text-indent":"20px"},modelValue:t.frames[t.cur].rawData[_+x-1],"onUpdate:modelValue":N=>t.frames[t.cur].rawData[_+x-1]=N,modelModifiers:{lazy:!0},onChange:s[7]||(s[7]=N=>t.frames[t.cur].dirty="data")},null,8,["onError","modelValue","onUpdate:modelValue"])]),_:2},1024)):k("",!0)])),64))])):k("",!0)],64))),64)):k("",!0)])),a("div",nd,[t.isHexMulti?(h(),u(T,{key:1},[C(" 批量修改:("+b(t.hexs.length)+"个)  ",1),g(c,{style:{float:"right",height:"23px","margin-left":"8px"},onClick:s[9]||(s[9]=_=>{t.hexs=[],t.isHexMulti=!1})},{default:S(()=>[C("退出")]),_:1}),g(c,{style:{float:"right",height:"23px"},type:"primary",onClick:l.onHexMultiChange},{default:S(()=>[C("修改")]),_:1},8,["onClick"]),a("div",od,[g(r,{onError:l.onHexErr,min:0,max:255,modelValue:t.hexMultiValue,"onUpdate:modelValue":s[10]||(s[10]=_=>t.hexMultiValue=_)},null,8,["onError","modelValue"])])],64)):(h(),u("div",{key:0,class:"hex-footer-full-btn",onClick:s[8]||(s[8]=_=>t.isHexMulti=!t.isHexMulti)},"进入批量修改"))])]),v(a("div",rd,[t.chooseSignalShow?(h(),P(m,{key:0,filledOptions:e.$props.store.sendRecord.frames,checkedOptions:l.checkedOptions,onSignalsChange:l.updateFrame,onCancel:s[11]||(s[11]=()=>{t.chooseSignalShow=!1})},null,8,["filledOptions","checkedOptions","onSignalsChange"])):k("",!0)],512),[[U,t.chooseSignalShow]]),v(a("div",dd,[a("div",{onClick:s[12]||(s[12]=_=>t.chooseSignalShow=!t.chooseSignalShow),"data-disabled":e.$props.store.sendRecord.frames.length===0},"从DBC中导入帧",8,cd),a("div",{onClick:s[13]||(s[13]=_=>l.addFrame("CAN")),"data-disabled":e.$props.store.sendRecord.dbc.dbcChn.length==0},"自定义CAN帧",8,hd),a("div",{onClick:s[14]||(s[14]=_=>l.addFrame("CANFD")),"data-disabled":e.$props.store.sendRecord.dbc.dbcChn.length==0},"自定义CAN FD帧",8,ud)],512),[[U,t.addRecordShow]])]),g(f,{message:t.message},null,8,["message"])],64)}const pd=E(Fr,[["render",md],["__scopeId","data-v-eda81dc0"]]);let be=[],st=0;const fd={props:["filledOptions","checkedOptions"],emits:["connect","showMessage","getCarCode","cancel","signalsChange"],components:{Button:G,RecycleScroller:he,Spin:de,Message:Z},data(){var s,i,n;const e=this.$ls.get("blfread_sdbData")||[];if(this.carType==="custom"){let t=(s=e.find(l=>l.sdb===this.sdb))==null?void 0:s.comments;t&&(be=["",...t])}else be=((n=(i=Ie.find(t=>t.value===this.$props.carType))==null?void 0:i.children.find(t=>t.value===this.$props.sdb))==null?void 0:n.comments)||[];return be=be.map((t,l)=>"".concat("⓪①②③④⑤⑥⑦⑧⑨⑩⑪⑫⑬⑭⑮⑯⑰⑱⑲⑳㉑㉒㉓㉔㉕㉖㉗㉘㉙㉚㉛㉜㉝㉞㉟㊱㊲"[l]).concat(t)),{inputStr:"",checkedList:[],selectNodeList:[],counter:0,sdbCustom:e,lodingSpin:!1,isFlag:1,message:{visible:!1,level:"",content:""},listOpen:[],expandKeys:new Set([])}},computed:{list(){this.checkedList=this.$props.checkedOptions;let e=[],s=this,i=this.$props.filledOptions.data;for(let t in i){let l;l={_id:+t,id:+t,text:be[t],node_type:"channel",children:[],set checked(o){l.children.forEach(r=>{r.checked=o})},get checked(){return!l.children.some(o=>o.checked==!1)},get indeterminate(){return l.children.some(o=>o.checked)&&l.children.some(o=>!o.checked)}};for(let o in i[t]){let r;r={_id:t+"_"+o,id:t+"_"+o,text:o=="-1"?"":o,node_type:"msg",channel:l.id,set checked(d){d?s.checkedList.push(r):s.checkedList=s.checkedList.filter(c=>c._id!==r._id)},get checked(){return s.checkedList.some(d=>d._id===r._id)},children:i[t][o].map(d=>{var m;let c;return c={_id:t+"_"+o+"_"+d[0],id:d[0],msg:o=="-1"?"-1":+((m=o.match(/0x\w+/))==null?void 0:m[0])||o,channel:l.id,text:d[0],node_type:"signal",comment:d[1],remark:d[2],canId:d[3],rawValue:d[4],maxRaw:d[5],minRaw:d[6],maxPhys:d[7],minPhys:d[8],selectPhys:d[9],unit:d[10],startBit:d[11],length:d[12],physStep:d[13],dlc:d[14],canType:d[15],periodic:d[16],eteDisable:d[17]},c})},l.children.push(r)}e.push(l)}let n=[];for(let t=0;t<e.length;t++){let l=e[t];if(l.id!=-1&&n.push(l),!(!this.inputStr&&!this.expandKeys.has(l.id)))for(let o=0;o<l.children.length;o++){let r=l.children[o];r.id[0]!="-"&&n.push(r)}}if(this.inputStr.length>0){const t=this.inputStr.toLowerCase();let l;try{l=new RegExp(t,"i")}catch(o){l={test(r){return~r.toLowerCase().indexOf(r.toLowerCase())}}}n=n.filter(o=>l.test(o.text)||o.comment&&l.test(o.comment)||o.remark&&l.test(o.remark))}return n}},watch:{checkedListIndex:{handler(e){this.checkedList=[]},deep:!0}},mounted(){this.$refs.chsInputRef.focus(),setTimeout(()=>{document.body.addEventListener("mousedown",this.clickHandler)},300)},beforeUnmount(){},unmounted(){document.body.removeEventListener("mousedown",this.clickHandler)},methods:{clickHandler(e){var s;((s=this.$refs.root)==null?void 0:s.contains(e.target))==!1&&this.$emit("cancel")},showFirstChild(e){this.expandKeys.has(e.id)?this.expandKeys.delete(e.id):this.expandKeys.add(e.id)},clearTable(){this.checkedList=[]},title4node(e){return we(e)},showMessage({level:e,content:s,timeout:i}){clearTimeout(st),e!=null&&(this.message.level=e),s!=null&&(this.message.content=s),this.message.visible=!0,i>0&&(st=setTimeout(()=>{this.message.visible=!1},i))},submit(){this.checkedList.length>80?this.showMessage({level:"error",content:"信号选择不能超过80项",timeout:3e3}):this.$emit("signalsChange",this.checkedList)},highlightWord(e){if(!e)return e;const s=this.inputStr;if(!s)return e;const i=s.split(/\s+/g);var n,t=i.length,l;for(n=0;n<t;n++)try{l=new RegExp(i[n],"gi"),l.test(e)&&(e=e.replace(l,"<strong>$&</strong>"))}catch(o){l=i[n],e=e.replace(l,"<strong>$&</strong>")}return e}}},gd={class:"chs-er",ref:"root"},bd={class:"chs-list-er","data-loading":!1},_d=["onClick"],yd=["id","onUpdate:modelValue","data-indeterminate"],wd=["innerHTML"],vd=["for"],Cd=["id","onUpdate:modelValue","data-indeterminate"],kd=["innerHTML"],Sd={class:"footer"};function Td(e,s,i,n,t,l){const o=w("RecycleScroller"),r=w("Message"),d=H("tooltip"),c=H("esc");return v((h(),u("div",gd,[v(a("input",{class:"chs-input-er",placeholder:"搜索信号名称/信号描述",ref:"chsInputRef","onUpdate:modelValue":s[0]||(s[0]=m=>t.inputStr=m),onInput:s[1]||(s[1]=(...m)=>e.onChange&&e.onChange(...m)),draggable:!1},null,544),[[Q,t.inputStr]]),a("div",bd,[g(o,{class:"chs-list",items:l.list,"item-size":28,"key-field":"_id"},{default:S(({item:m})=>[a("label",null,[m.node_type=="channel"&&m.id>=1e3?(h(),u("div",{key:0,style:{"margin-left":"1px"},class:ue(!t.inputStr&&t.expandKeys.has(m.id)?"switch-open":"switch-close"),onClick:A(f=>l.showFirstChild(m),["stop","prevent"])},null,10,_d)):k("",!0),m.node_type=="channel"&&m.id>=1e3?v((h(),u("input",{key:1,style:{"margin-left":"3px"},id:m._id,type:"checkbox","onUpdate:modelValue":f=>m.checked=f,"data-indeterminate":m.indeterminate,"click.stop":""},null,8,yd)),[[ee,m.checked]]):k("",!0),m.node_type=="channel"&&m.id>=1e3?(h(),u("span",{key:2,class:"chs-node",innerHTML:l.highlightWord(m._id)},null,8,wd)):m.node_type=="msg"?v((h(),u("div",{key:3,for:m.children,style:{"text-indent":"2em","margin-left":"-15px"},class:"chs-node chs-node-item"},[v(a("input",{id:m._id,type:"checkbox","onUpdate:modelValue":f=>m.checked=f,"data-indeterminate":m.indeterminate,"click.stop":""},null,8,Cd),[[ee,m.checked]]),a("span",{class:"",innerHTML:l.highlightWord(m.text)},null,8,kd)],8,vd)),[[d,{content:l.title4node(m),html:!0},void 0,{right:!0}]]):k("",!0)])]),_:1},8,["items"])]),a("div",Sd,[a("div",{class:"chs-btn confirm",onClick:s[2]||(s[2]=(...m)=>l.submit&&l.submit(...m))},"确认"),a("div",{class:"chs-btn cancel",onClick:s[3]||(s[3]=(...m)=>l.clearTable&&l.clearTable(...m))},"重置")]),g(r,{message:t.message},null,8,["message"])])),[[c,()=>e.$emit("cancel")]])}const Dd=E(fd,[["render",Td],["__scopeId","data-v-84227e36"]]);let lt=0;const Vd={props:["activeTab","linSendInfo","nodeOpt","ldfChn","store","setStore","curFileIdx","deployDisable"],components:{ButtonGroup:ve,Button:G,InputHex:Ue,EditWrapper:Pe,ChooseSignal:Dd,InputOrSelect:He},data(){return{nodeVal:{},mode:"schedule",cur:-1,linListTable:{cols:[{label:"",width:"2.8em",icon:"add"},{label:"Frame Name",width:"auto"},{label:"Delay (ms)",width:"9em",tooltip:{content:"1-1000ms:周期发送<br/>0:单点发送",html:!0}},{label:"ID",width:"4.5em",tooltip:"DBC导入禁止修改ID"},{label:"Channel",width:"6em"},{label:"DIR",width:"6em"},{label:"DLC",width:"3em"},{label:"",width:"5em"}]},linSigTable:{cols:[{label:"Signal Name",width:"auto"},{label:"Raw",width:"90px"},{label:"Phys",width:"200px"},{label:"Unit",width:"4em"}]},linIsHexMulti:!1,hexs:[],activeTab:0,activeChn:0,activeScheduleIndex:-1,activeTableList:new Map,chooseLinSignalShow:!1,linAddRecordShow:!1,frames:[],cur:-1,isDeploying:!1,isDeployChecked:!0,showScheduleList:!0,scheduleStyleOpt:[{label:"调度表",value:"schedule",disable:"false"},{label:"单帧",value:"single",disable:"false"}],isFilled:!0}},watch:{curFileIdx(e){this.activeTab=e},deployDisable(e){console.log("部署disable",e)},linSendInfo(e){this.activeLinData=e==null?void 0:e.data[this.activeChn],console.log("this.activeLinData07251122",this.activeLinData)},ldfChn:{handler(e){console.log("newVal07051108",e),this.nodeVal={},this.frames=[],this.scheduleList=[]},deep:!0,immediate:!0},"$props.store.sendRecord.isRecording":{handler(e){e&&this.updateMultiFrame(this.frames.map((s,i)=>({...s,row:i+1})),"add")}},"$props.store.sendRecord":{handler(e,s){}},frames:{async handler(e,s){if(console.log("nextFrames1800111",e),!this.isSyncFrames){this.isSyncFrames=!0,this.isHexMulti=!1,e.length>0&&(this.isDeployChecked=!1);for(let i=0;i<e.length;i++){let n=e[i],t=n.channel;console.log("frame07051053",t);let l=n.id;console.log("frame.dirty07041441",n.dirty,n),n.dirty==="raw"?await D.blfLogging.getRawValueToPhysValueLIN({ldfChannel:this.ldfChn[this.activeTab],linId:l,signalsData:n.children.map(o=>({name:o.text,rawValue:o.rawValue}))}).then(o=>{this.frames[i]={...n,rawData:o.data.data.rawData,children:n.children.map(r=>{var d,c;return{...r,physValue:(c=(d=o.data.data.signalsData.find(m=>m.name===r.id))==null?void 0:d.physValue)!=null?c:r.physValue}}),dirty:!1,raw:i+1},this.updateMultiFrame([{row:i+1,...this.frames[i]}],"modify"),this.isDeploying&&this.getDSServer()}).catch(console.log):n.dirty==="data"?(console.log("this.frames[i]07051410",n),n.from==="dbc"||n.from==="sch"?await D.blfLogging.getDataToValuesLIN({ldfChannel:this.ldfChn[this.activeTab],linId:l,rawData:n.rawData}).then(o=>{console.log("res07110934",o),this.frames[i]={...n,children:n.children.map(r=>{var d,c,m,f;return{...r,physValue:(c=(d=o.data.data.signalsPhysData.find(y=>y.name===r.id))==null?void 0:d.physValue)!=null?c:r.physValue,rawValue:(f=(m=o.data.data.signalsRawData.find(y=>y.name===r.id))==null?void 0:m.rawValue)!=null?f:r.rawValue}}),dirty:!1,raw:i+1},this.updateMultiFrame([{row:i+1,...this.frames[i]}],"modify")}).catch(console.log):(this.frames[i]={...n,dirty:!1,raw:i+1},this.updateMultiFrame([{row:i+1,...this.frames[i]}],"modify")),this.isDeploying&&this.getDSServer()):n.dirty==="phys"?(console.log("frame.children0710",n.children),await D.blfLogging.getPhysValueToRawValueLIN({ldfChannel:this.ldfChn[this.activeTab],linId:l,signalsData:n.children.map(o=>({name:o.text,physValue:parseInt(o.physValue)}))}).then(o=>{this.frames[i]={...n,rawData:o.data.data.rawData,children:n.children.map(r=>{var d,c;return{...r,rawValue:(c=(d=o.data.data.signalsData.find(m=>m.name===r.id))==null?void 0:d.rawValue)!=null?c:r.rawValue}}),dirty:!1,raw:i+1},this.updateMultiFrame([{row:i+1,...this.frames[i]}],"modify"),this.isDeploying&&this.getDSServer()}).catch(console.log)):n.dirty==="dlc"?(this.frames[i]={...n,rawData:Array.from({length:n.dlc},(o,r)=>n.rawData[r]||0),dirty:!1,raw:i+1},this.updateMultiFrame([{row:i+1,...n}],"modify"),this.isDeploying&&this.getDSServer()):n.dirty==="delay"?(this.frames[i]={...n,isSending:n.delay==0?!1:n.isSending,dirty:!1,raw:i+1},this.updateMultiFrame([{row:i+1,...n}],"modify"),this.isDeploying&&this.getDSServer()):n.dirty&&(this.frames[i].dirty=!1,this.updateMultiFrame([{row:i+1,...n}],"modify"),this.isDeploying&&this.getDSServer())}this.isSyncFrames=!1}},deep:!0},cur(e){console.log("cur07041051",e,this.frames[e]),this.isHexMulti=!1,this.hexs=[]}},computed:{scheduleList(){if(console.log("this.activeLinData",this.ldfChn[this.activeTab],this.activeTab,this.linSendInfo,this.ldfChn),console.log("this.nodeVal.value",this.nodeVal),Object.keys(this.nodeVal).length>0&&this.nodeVal.value!==""){let e={};if(this.nodeVal.parentNode==="master")return this.showScheduleList=!0,e=this.ldfChn[this.activeTab]!==0?this.linSendInfo.data[this.ldfChn[this.activeTab]][this.nodeVal.parentNode][this.nodeVal.value]:{},Object.keys(e||{});{this.showScheduleList=!1,console.log("this.linSendInfo.data[this.ldfChn[this.activeTab]]",this.linSendInfo.data[this.ldfChn[this.activeTab]],this.linSendInfo),e=this.ldfChn[this.activeTab]!==0?this.linSendInfo.data[this.ldfChn[this.activeTab]][this.nodeVal.parentNode]:{};let s=Object.keys(e||{});return console.log("99999",s),s.forEach((i,n)=>{i===this.nodeVal.value&&this.checkedSchedule(n,i)}),s}}},checkedOptions(){return this.frames.filter(e=>e.from=="dbc")}},mounted(){setTimeout(()=>{document.body.addEventListener("mousedown",this.clickHandler)},300)},unmounted(){document.body.removeEventListener("mousedown",this.clickHandler)},methods:{checkedSchedule(e,s){console.log("index,item",e,s);let i=[];this.nodeVal.parentNode==="master"?i=this.ldfChn[this.activeTab]!==0?this.linSendInfo.data[this.ldfChn[this.activeTab]][this.nodeVal.parentNode][this.nodeVal.value][s]:[]:i=this.ldfChn[this.activeTab]!==0?this.linSendInfo.data[this.ldfChn[this.activeTab]][this.nodeVal.parentNode][s]:[],this.activeScheduleIndex=e;let n=i.map(t=>({_id:this.nodeVal.parentNode+"_"+t[0]+"_"+this.mode,id:t[1],linId:t[1],text:t[0],name:t[0],dir:t[2],dlc:t[3],delay:t[4],channel:this.ldfChn[0],dirty:"raw",from:"sch",children:t[5].map(l=>{let o;return o={_id:l[0],id:l[0],text:l[0],node_type:"signal",comment:l[1],remark:l[2],linId:l[3],rawValue:l[4],maxRaw:l[5],minRaw:l[6],maxPhys:l[7].toString(),minPhys:l[8].toString(),selectPhys:l[9],unit:l[10],startBit:l[11],length:l[12],physStep:l[13].toString(),dlc:l[14],canType:l[15],periodic:l[16]},o})}));this.frames=[],this.frames.push(...n),this.activeTableList.set(this.nodeVal.parentNode+"-"+this.nodeVal.value+"-"+this.mode,{phone:"213-555-1234",address:"123 N 1st Ave"})},clickHandler(e){var s;((s=this.$refs.root)==null?void 0:s.contains(e.target))==!1&&(this.linAddRecordShow=!1)},showMessage({level:e,content:s,timeout:i}){clearTimeout(lt),e!=null&&(this.message.level=e),s!=null&&(this.message.content=s),this.message.visible=!0,i>0&&(lt=setTimeout(()=>{this.message.visible=!1},i))},onHexErr(){this.showMessage({timeout:2e3,level:"error",content:"请输入正确格式的16进制"})},addFrame(e){console.log("this.ldfChn[0]",this.ldfChn[0]),this.linAddRecordShow=!1;let s=[{name:"",delay:20,id:e===1,channel:this.ldfChn[0],canType:e,dir:"tx",dlc:8,isSending:!1,from:e,rawData:[0,0,0,0,0,0,0,0]}],i=this.frames.length-1;this.frames.push(...s),this.updateMultiFrame(s.map((n,t)=>({...n,row:i+t})),"add")},updateMultiFrame(e,s){console.log("list07051359",e),this.$props.store.sendRecord.isRecording&&e.map(i=>({...i,channel:1+this.$props.store.sendRecord.dbc.ldfChn.indexOf(i.channel)}))},updateFrame(e){let s=this.frames.slice(),i=[],n=[];for(let t=s.length-1;t>=0;t--){let l=s[t];if(l.from==="dbc"){let o=e.findIndex(r=>r.id===l.id);if(~o)e.splice(o,1);else{t===this.cur&&(this.cur=-1);let r=s.splice(t,1);n.unshift({...r,row:t+1})}}}this.updateMultiFrame(n,"delete"),i=e.map((t,l)=>{let o=t.children[0]||{};return console.log("it111",o),{...t,name:t.text,from:"dbc",periodic:o.periodic||0,canType:o.canType||"LIN",dlc:o.dlc||64,id:o.msg||0,linId:o.canId||0,dirty:"raw",dir:"tx",delay:10,isSending:!1,children:t.children.map(r=>({...r,name:r.id}))}}),s.push(...i),this.frames=s,console.log("this.frames07040952",this.frames),this.chooseLinSignalShow=!1,this.addRecordShow=!1},async startDeploy(){console.log("部署",this.nodeVal,this.nodeVal.parentNode),this.isDeploying=!0;for(var e=0;e<this.scheduleStyleOpt.length;e++)this.scheduleStyleOpt[e].value==="single"&&(this.scheduleStyleOpt[e].disable="true");this.getDSServer(),console.log("ldfChn11",this.ldfChn,this.frames)},async getDSServer(){await D.blfLogging.getDeployShedule({channelId:1,mode:this.nodeVal.parentNode?this.nodeVal.parentNode:this.isFilled?"master":"slave",LINFrames:this.frames.map(e=>({LINId:e.linId?"0x"+(parseInt(e.linId)||0).toString(16):"0x0",dataLength:e.rawData?e.rawData.length:0,dir:e.dir==="tx"?0:1,delay:e.delay,data:e.rawData}))}).then(e=>{}).catch(console.log)},async endDeploy(){this.isDeploying=!1;for(var e=0;e<this.scheduleStyleOpt.length;e++)this.scheduleStyleOpt[e].value==="single"&&(this.scheduleStyleOpt[e].disable="false");await D.blfLogging.getUnDeployShedule({channelId:1,mode:this.nodeVal.parentNode?this.nodeVal.parentNode:this.isFilled?"master":"slave"}).then(s=>{}).catch(console.log)},async togglePlay(e,s){console.log("raw07162036",e,s),await D.blfLogging.getManualSendLIN({channelId:1,mode:this.nodeVal.parentNode?this.nodeVal.parentNode:this.isFilled?"master":"slave",LINFrames:[{LINId:e.linId?"0x"+(parseInt(e.linId)||0).toString(16):"0x0",dataLength:e.rawData.length,dir:e.dir==="tx"?0:1,delay:e.delay,data:e.rawData}]}).then(i=>{})},delFrame(e){console.log("idx2003",e,this.frames),e===this.cur&&(this.cur=-1);let s=this.frames.splice(e,1);this.frames.forEach((i,n)=>{this.frames[n].raw=n+1}),this.updateMultiFrame([{...s,row:e+1}],"delete")}}},ae=e=>(j("data-v-8cfbd0b5"),e=e(),q(),e),xd={class:"lin-body"},Id={class:"select-er"},Ld={class:"select-left"},Fd=ae(()=>a("span",{class:"record-header-message"},[a("b",null,"节点：")],-1)),Rd={key:0,class:"chs-ft-label pointer"},Md=["checked"],Ed=ae(()=>a("i",{class:"icon-ques"},null,-1)),$d={class:"select-right"},Ad=ae(()=>a("i",{class:"play-icon"},null,-1)),Nd=ae(()=>a("i",{class:"stop-icon"},null,-1)),Od={class:"lin-list-wrap"},Pd={class:"lin-list-tree-er"},Ud=ae(()=>a("div",{class:"lin-list-tree-tit"},[a("i",{class:"lin-list-icon"}),a("b",null,"LIN调度表")],-1)),Hd={class:"lin-list-tree-body"},Bd=["data-disabled","data-active","onClick"],jd=ae(()=>a("i",{class:"lin-list-icon-sm"},null,-1)),qd=["title"],zd={class:"lin-list-er"},Kd={class:"lin-list-table"},Wd={key:1,class:"ic-help"},Gd={key:2,type:"checkbox"},Xd={class:"add-record",ref:"root"},Yd=["data-disabled"],Jd=["data-disabled"],Qd=["onClick","data-active"],Zd=["data-from","data-cantype","data-valid"],ec=["onUpdate:modelValue","onChange"],tc=["onUpdate:modelValue","onChange"],sc=["value"],lc=["onUpdate:modelValue","onChange"],ic=ae(()=>a("option",{value:"tx"},"tx",-1)),ac=ae(()=>a("option",{value:"rx"},"rx",-1)),nc=[ic,ac],oc=["disabled","onUpdate:modelValue","onChange"],rc=["data-disable","data-recording","data-active","onClick"],dc=["data-disable","onClick"],cc={key:0,class:"table-empty"},hc={class:"empty-meark"},uc={class:"btn-import-er"},mc={class:"lin-sig-er"},pc={class:"lin-hex-er"},fc=ae(()=>a("th",{style:{width:"4em"}}," ",-1)),gc={style:{width:"11.8%"}},bc={key:0},_c=["value"],yc={class:"hex-footer"},wc={class:"hex-multi-input"};function vc(e,s,i,n,t,l){var L,z,_,O,x,N,I,se,K;const o=w("v-select"),r=w("ButtonGroup"),d=w("Button"),c=w("EditWrapper"),m=w("InputHex"),f=w("ChooseSignal"),y=w("InputOrSelect"),M=H("tooltip");return h(),u("div",xd,[a("div",Id,[a("div",Ld,[Fd,g(o,{options:i.nodeOpt,clearable:!1,searchable:!1,disabled:t.isDeploying,label:"label",value:"value",modelValue:t.nodeVal,"onUpdate:modelValue":s[0]||(s[0]=p=>t.nodeVal=p),class:"tch-tool-select"},null,8,["options","disabled","modelValue"]),i.ldfChn[this.activeTab]=="0"?v((h(),u("label",Rd,[a("input",{class:"chs-node-checkboxAll",type:"checkbox",checked:t.isFilled,onClick:s[1]||(s[1]=p=>e.checkMasterMode())},null,8,Md),C("主节点模式"),Ed])),[[M,"主节点模式"]]):k("",!0)]),a("div",$d,[g(r,{options:t.scheduleStyleOpt,class:"theme-btn-group",modelValue:t.mode,"onUpdate:modelValue":s[2]||(s[2]=p=>t.mode=p)},null,8,["options","modelValue"]),C("  "),t.isDeploying?(h(),P(d,{key:1,type:"primary",class:"header-import-btn",onClick:l.endDeploy},{default:S(()=>[Nd,C("停止 ")]),_:1},8,["onClick"])):(h(),P(d,{key:0,type:"primary",class:"header-import-btn",onClick:l.startDeploy,disabled:t.isDeployChecked||t.mode=="single"||i.deployDisable,progress:"100%"},{default:S(()=>[Ad,C("部署 ")]),_:1},8,["onClick","disabled"]))])]),a("div",Od,[v(a("div",Pd,[Ud,a("div",Hd,[(h(!0),u(T,null,F(l.scheduleList,(p,R)=>(h(),u("div",{class:"lin-list-tree-item",key:R,"data-disabled":t.isDeploying,"data-active":t.activeScheduleIndex===R,onClick:V=>l.checkedSchedule(R,p)},[jd,a("span",{title:p},b(p),9,qd)],8,Bd))),128))])],512),[[U,t.showScheduleList]]),a("div",zd,[a("table",Kd,[a("tr",null,[(h(!0),u(T,null,F(t.linListTable.cols,p=>(h(),u("th",{style:$({width:p.width})},[C(b(p.label)+" ",1),p.icon?(h(),u("i",{key:0,onClick:s[3]||(s[3]=R=>t.linAddRecordShow=!t.linAddRecordShow),class:"lin-ic-add"})):k("",!0),p.tooltip?v((h(),u("i",Wd,null,512)),[[M,p.tooltip]]):k("",!0),p.type?(h(),u("input",Gd)):k("",!0)],4))),256)),v(a("div",Xd,[a("div",{onClick:s[4]||(s[4]=p=>t.chooseLinSignalShow=!t.chooseLinSignalShow),"data-disabled":((_=(z=(L=e.$props.store)==null?void 0:L.sendRecord)==null?void 0:z.frames)==null?void 0:_.length)===0||t.isDeploying},"从DBC中导入帧",8,Yd),a("div",{onClick:s[5]||(s[5]=p=>l.addFrame("LIN")),"data-disabled":((N=(x=(O=e.$props.store)==null?void 0:O.sendRecord)==null?void 0:x.frames)==null?void 0:N.length)==0||t.isDeploying},"自定义帧",8,Jd)],512),[[U,t.linAddRecordShow]])]),(h(!0),u(T,null,F(t.frames,(p,R)=>(h(),u("tr",{onClick:V=>t.cur=R,"data-active":t.cur===R},[a("td",null,b(R+1),1),a("td",null,[a("i",{class:"ic-can","data-from":p.from,"data-cantype":p.canType,"data-valid":Object.values(e.$props.store.sendRecord.dbc.ldfChn).includes(p.channel)},null,8,Zd),C(" "+b(p.name),1)]),a("td",null,[g(c,null,{default:S(()=>[v(a("input",{class:"td-input",type:"number",min:"0",max:"1000","onUpdate:modelValue":V=>p.delay=V,onChange:V=>p.dirty="delay"},null,40,ec),[[Q,p.delay,void 0,{lazy:!0}]])]),_:2},1024)]),a("td",null,[g(c,{disabled:p.from!=="LIN"},{default:S(()=>[g(m,{onError:l.onHexErr,min:0,max:2047,disabled:p.from!=="LIN",class:"td-input",modelValue:p.linId,"onUpdate:modelValue":V=>p.linId=V,onChange:V=>p.dirty="linId"},null,8,["onError","disabled","modelValue","onUpdate:modelValue","onChange"])]),_:2},1032,["disabled"])]),a("td",null,[g(c,{disabled:!0},{default:S(()=>[v(a("select",{class:"td-input",disabled:!0,"onUpdate:modelValue":V=>p.channel=V,onChange:V=>p.dirty="channel"},[(h(!0),u(T,null,F(e.$props.store.sendRecord.dbc.ldfChn,(V,Y)=>(h(),u("option",{value:V},"LIN"+b(Y+1),9,sc))),256))],40,tc),[[re,p.channel,void 0,{lazy:!0}]])]),_:2},1024)]),a("td",null,[g(c,null,{default:S(()=>[v(a("select",{class:"td-input","onUpdate:modelValue":V=>p.dir=V,onChange:V=>p.dirty="dir"},nc,40,lc),[[re,p.dir]])]),_:2},1024)]),a("td",null,[g(c,{disabled:p.from!=="LIN"},{default:S(()=>[v(a("input",{disabled:p.from!=="LIN",class:"td-input",type:"number",min:"0",max:"8","onUpdate:modelValue":V=>p.dlc=V,onChange:V=>p.dirty="dlc"},null,40,oc),[[Q,p.dlc,void 0,{lazy:!0}]])]),_:2},1032,["disabled"])]),a("td",null,[t.mode!=="schedule"?(h(),u("i",{key:0,class:"ic-play","data-disable":Object.values(e.$props.store.sendRecord.dbc.ldfChn).includes(p.channel),"data-recording":e.$props.store.sendRecord.isRecording,"data-active":p.isSending,onClick:V=>l.togglePlay(p,R)},null,8,rc)):k("",!0),C("  "),a("i",{class:"ic-del","data-disable":t.isDeploying,onClick:A(V=>l.delFrame(R),["stop"])},null,8,dc)])],8,Qd))),256))]),t.frames.length==0?(h(),u("div",cc,[a("div",hc,[C("暂无内容，请先"),a("span",{class:"empty-btn",onClick:s[6]||(s[6]=p=>t.linAddRecordShow=!t.linAddRecordShow)},"导入帧")])])):k("",!0)]),v(a("div",uc,[t.chooseLinSignalShow?(h(),P(f,{key:0,filledOptions:e.$props.store.sendRecord.frames,checkedOptions:l.checkedOptions,onSignalsChange:l.updateFrame,onCancel:s[7]||(s[7]=()=>{t.chooseLinSignalShow=!1})},null,8,["filledOptions","checkedOptions","onSignalsChange"])):k("",!0)],512),[[U,t.chooseLinSignalShow]])]),a("div",mc,[(h(),u("table",{class:"sig-table",key:"sig"+t.cur},[a("tr",null,[(h(!0),u(T,null,F(t.linSigTable.cols,p=>(h(),u("th",{style:$({width:p.width})},b(p.label),5))),256))]),((I=t.frames[t.cur])==null?void 0:I.name)!==""?(h(!0),u(T,{key:0},F((se=t.frames[t.cur])==null?void 0:se.children,p=>(h(),u("tr",null,[v((h(),u("td",null,[C(b(p.text)+" ",1)])),[[M,{content:"".concat(p.text,"<hr/>phys:").concat(p.minPhys," ~ ").concat(p.maxPhys,"<br/>raw:").concat(p.minRaw?"0x"+p.minRaw.toString(16):""," ~ ").concat(p.maxRaw?"0x"+p.maxRaw.toString(16):"","<br/>Start Bit:").concat(p.startBit,"<br>Length:").concat(p.length,"<br>Phys Step:").concat(p.physStep),html:!0},void 0,{"top-start":!0}]]),a("td",null,[g(c,null,{default:S(()=>[g(m,{watch:!0,onError:l.onHexErr,min:p.minRaw,max:p.maxRaw,class:"td-input",modelValue:p.rawValue,"onUpdate:modelValue":R=>p.rawValue=R,modelModifiers:{lazy:!0},onChange:s[8]||(s[8]=R=>t.frames[t.cur].dirty="raw")},null,8,["onError","min","max","modelValue","onUpdate:modelValue"])]),_:2},1024)]),a("td",null,[g(c,null,{default:S(()=>[g(y,{watch:!0,min:p.minPhys,max:p.maxPhys,class:"td-input",step:p.physStep,modelValue:p.physValue,"onUpdate:modelValue":R=>p.physValue=R,enum:p.selectPhys?p.selectPhys:"",onChange:s[9]||(s[9]=R=>t.frames[t.cur].dirty="phys")},null,8,["min","max","step","modelValue","onUpdate:modelValue","enum"])]),_:2},1024)]),a("td",null,b(p.unit),1)]))),256)):k("",!0)]))]),a("div",pc,[(h(),u("table",{class:"lin-hex-table",key:"hex"+t.cur},[a("tr",null,[fc,(h(),u(T,null,F([0,1,2,3,4,5,6,7],p=>a("th",gc,b(p),1)),64))]),(K=t.frames[t.cur])!=null&&K.rawData?(h(),u(T,{key:0},F([0,8,16,24,32,40,48,56,64],(p,R)=>(h(),u(T,null,[t.frames[t.cur].rawData.length>p?(h(),u("tr",bc,[a("td",null,[a("b",null,b(p),1)]),(h(),u(T,null,F(8,V=>a("td",null,[e.isHexMulti&&p+V-1<t.frames[t.cur].rawData.length?v((h(),u("input",{key:0,type:"checkbox",class:"radio","onUpdate:modelValue":s[10]||(s[10]=Y=>t.hexs=Y),value:p+V-1},null,8,_c)),[[ee,t.hexs]]):k("",!0),p+V-1<t.frames[t.cur].rawData.length?(h(),P(c,{key:1},{default:S(()=>[g(m,{watch:!0,onError:l.onHexErr,min:0,max:255,class:"td-input",style:{width:"calc(100%)","text-indent":"20px"},modelValue:t.frames[t.cur].rawData[p+V-1],"onUpdate:modelValue":Y=>t.frames[t.cur].rawData[p+V-1]=Y,modelModifiers:{lazy:!0},onChange:s[11]||(s[11]=Y=>t.frames[t.cur].dirty="data")},null,8,["onError","modelValue","onUpdate:modelValue"])]),_:2},1024)):k("",!0)])),64))])):k("",!0)],64))),64)):k("",!0)])),a("div",yc,[t.linIsHexMulti?(h(),u(T,{key:1},[C(" 批量修改:("+b(t.hexs.length)+"个)  ",1),g(d,{style:{float:"right",height:"23px","margin-left":"8px"},onClick:s[13]||(s[13]=p=>{t.hexs=[],t.linIsHexMulti=!1})},{default:S(()=>[C("退出")]),_:1}),g(d,{style:{float:"right",height:"23px"},type:"primary"},{default:S(()=>[C("修改")]),_:1}),a("div",wc,[g(m,{onError:l.onHexErr,min:0,max:255,modelValue:e.hexMultiValue,"onUpdate:modelValue":s[14]||(s[14]=p=>e.hexMultiValue=p)},null,8,["onError","modelValue"])])],64)):(h(),u("div",{key:0,class:"hex-footer-full-btn",onClick:s[12]||(s[12]=p=>t.linIsHexMulti=!t.linIsHexMulti)},"进入批量修改"))])])])}const Cc=E(Vd,[["render",vc],["__scopeId","data-v-8cfbd0b5"]]);let _e=[],it=0;const kc={props:["filledOptions","checkedOptions"],emits:["connect","showMessage","getCarCode","cancel","signalsChange"],components:{Button:G,RecycleScroller:he,Spin:de,Message:Z},data(){var s,i,n;const e=this.$ls.get("blfread_sdbData")||[];if(this.carType==="custom"){let t=(s=e.find(l=>l.sdb===this.sdb))==null?void 0:s.comments;t&&(_e=["",...t])}else _e=((n=(i=Ie.find(t=>t.value===this.$props.carType))==null?void 0:i.children.find(t=>t.value===this.$props.sdb))==null?void 0:n.comments)||[];return _e=_e.map((t,l)=>"".concat("⓪①②③④⑤⑥⑦⑧⑨⑩⑪⑫⑬⑭⑮⑯⑰⑱⑲⑳㉑㉒㉓㉔㉕㉖㉗㉘㉙㉚㉛㉜㉝㉞㉟㊱㊲"[l]).concat(t)),{inputStr:"",checkedList:[],selectNodeList:[],counter:0,sdbCustom:e,lodingSpin:!1,isFlag:1,message:{visible:!1,level:"",content:""},listOpen:[],expandKeys:new Set([])}},computed:{list(){this.checkedList=this.$props.checkedOptions;let e=[],s=this,i=this.$props.filledOptions.data;for(let t in i){let l;l={_id:+t,id:+t,text:_e[t],node_type:"channel",children:[],set checked(o){l.children.forEach(r=>{r.checked=o})},get checked(){return!l.children.some(o=>o.checked==!1)},get indeterminate(){return l.children.some(o=>o.checked)&&l.children.some(o=>!o.checked)}};for(let o in i[t]){let r;r={_id:t+"_"+o,id:t+"_"+o,text:o=="-1"?"":o,node_type:"msg",channel:l.id,set checked(d){d?s.checkedList.push(r):s.checkedList=s.checkedList.filter(c=>c._id!==r._id)},get checked(){return s.checkedList.some(d=>d._id===r._id)},children:i[t][o].map(d=>{var m;let c;return c={_id:t+"_"+o+"_"+d[0],id:d[0],msg:o=="-1"?"-1":+((m=o.match(/0x\w+/))==null?void 0:m[0])||o,channel:l.id,text:d[0],node_type:"signal",comment:d[1],remark:d[2],canId:d[3],rawValue:d[4],maxRaw:d[5],minRaw:d[6],maxPhys:d[7],minPhys:d[8],selectPhys:d[9],unit:d[10],startBit:d[11],length:d[12],physStep:d[13],dlc:d[14],canType:d[15],periodic:d[16],eteDisable:d[17]},c})},l.children.push(r)}e.push(l)}let n=[];for(let t=0;t<e.length;t++){let l=e[t];if(l.id!=-1&&n.push(l),!(!this.inputStr&&!this.expandKeys.has(l.id)))for(let o=0;o<l.children.length;o++){let r=l.children[o];r.id[0]!="-"&&n.push(r)}}if(this.inputStr.length>0){const t=this.inputStr.toLowerCase();let l;try{l=new RegExp(t,"i")}catch(o){l={test(r){return~r.toLowerCase().indexOf(r.toLowerCase())}}}n=n.filter(o=>l.test(o.text)||o.comment&&l.test(o.comment)||o.remark&&l.test(o.remark))}return n}},watch:{checkedListIndex:{handler(e){this.checkedList=[]},deep:!0}},mounted(){this.$refs.chsInputRef.focus(),setTimeout(()=>{document.body.addEventListener("mousedown",this.clickHandler)},300)},beforeUnmount(){},unmounted(){document.body.removeEventListener("mousedown",this.clickHandler)},methods:{clickHandler(e){var s;((s=this.$refs.root)==null?void 0:s.contains(e.target))==!1&&this.$emit("cancel")},showFirstChild(e){this.expandKeys.has(e.id)?this.expandKeys.delete(e.id):this.expandKeys.add(e.id)},clearTable(){this.checkedList=[]},title4node(e){return we(e)},showMessage({level:e,content:s,timeout:i}){clearTimeout(it),e!=null&&(this.message.level=e),s!=null&&(this.message.content=s),this.message.visible=!0,i>0&&(it=setTimeout(()=>{this.message.visible=!1},i))},submit(){this.checkedList.length>80?this.showMessage({level:"error",content:"信号选择不能超过80项",timeout:3e3}):this.$emit("signalsChange",this.checkedList)},highlightWord(e){if(!e)return e;const s=this.inputStr;if(!s)return e;const i=s.split(/\s+/g);var n,t=i.length,l;for(n=0;n<t;n++)try{l=new RegExp(i[n],"gi"),l.test(e)&&(e=e.replace(l,"<strong>$&</strong>"))}catch(o){l=i[n],e=e.replace(l,"<strong>$&</strong>")}return e}}},Sc={class:"chs-er",ref:"root"},Tc={class:"chs-list-er","data-loading":!1},Dc=["onClick"],Vc=["id","onUpdate:modelValue","data-indeterminate"],xc=["innerHTML"],Ic=["for"],Lc=["id","onUpdate:modelValue","data-indeterminate"],Fc=["innerHTML"],Rc={class:"footer"};function Mc(e,s,i,n,t,l){const o=w("RecycleScroller"),r=w("Message"),d=H("tooltip"),c=H("esc");return v((h(),u("div",Sc,[v(a("input",{class:"chs-input-er",placeholder:"搜索信号名称/信号描述",ref:"chsInputRef","onUpdate:modelValue":s[0]||(s[0]=m=>t.inputStr=m),onInput:s[1]||(s[1]=(...m)=>e.onChange&&e.onChange(...m)),draggable:!1},null,544),[[Q,t.inputStr]]),a("div",Tc,[g(o,{class:"chs-list",items:l.list,"item-size":28,"key-field":"_id"},{default:S(({item:m})=>[a("label",null,[m.node_type=="channel"&&m.id>=1e3?(h(),u("div",{key:0,style:{"margin-left":"1px"},class:ue(!t.inputStr&&t.expandKeys.has(m.id)?"switch-open":"switch-close"),onClick:A(f=>l.showFirstChild(m),["stop","prevent"])},null,10,Dc)):k("",!0),m.node_type=="channel"&&m.id>=1e3?v((h(),u("input",{key:1,style:{"margin-left":"3px"},id:m._id,type:"checkbox","onUpdate:modelValue":f=>m.checked=f,"data-indeterminate":m.indeterminate,"click.stop":""},null,8,Vc)),[[ee,m.checked]]):k("",!0),m.node_type=="channel"&&m.id>=1e3?(h(),u("span",{key:2,class:"chs-node",innerHTML:l.highlightWord(m._id)},null,8,xc)):m.node_type=="msg"?v((h(),u("div",{key:3,for:m.children,style:{"text-indent":"2em","margin-left":"-15px"},class:"chs-node chs-node-item"},[v(a("input",{id:m._id,type:"checkbox","onUpdate:modelValue":f=>m.checked=f,"data-indeterminate":m.indeterminate,"click.stop":""},null,8,Lc),[[ee,m.checked]]),a("span",{class:"",innerHTML:l.highlightWord(m.text)},null,8,Fc)],8,Ic)),[[d,{content:l.title4node(m),html:!0},void 0,{right:!0}]]):k("",!0)])]),_:1},8,["items"])]),a("div",Rc,[a("div",{class:"chs-btn confirm",onClick:s[2]||(s[2]=(...m)=>l.submit&&l.submit(...m))},"确认"),a("div",{class:"chs-btn cancel",onClick:s[3]||(s[3]=(...m)=>l.clearTable&&l.clearTable(...m))},"重置")]),g(r,{message:t.message},null,8,["message"])])),[[c,()=>e.$emit("cancel")]])}const Ec=E(kc,[["render",Mc],["__scopeId","data-v-29de65dd"]]);let at=0;const $c={props:["activeTab","linSendInfo","nodeOpt","ldfChn","store","setStore","curFileIdx","deployDisable"],components:{ButtonGroup:ve,Button:G,InputHex:Ue,EditWrapper:Pe,ChooseSignal:Ec,InputOrSelect:He},data(){return{nodeVal:{},mode:"schedule",cur:-1,linListTable:{cols:[{label:"",width:"2.8em",icon:"add"},{label:"Frame Name",width:"auto"},{label:"Delay (ms)",width:"9em",tooltip:{content:"1-1000ms:周期发送<br/>0:单点发送",html:!0}},{label:"ID",width:"4.5em",tooltip:"DBC导入禁止修改ID"},{label:"Channel",width:"6em"},{label:"DIR",width:"6em"},{label:"DLC",width:"3em"},{label:"",width:"5em"}]},linSigTable:{cols:[{label:"Signal Name",width:"auto"},{label:"Raw",width:"90px"},{label:"Phys",width:"200px"},{label:"Unit",width:"4em"}]},linIsHexMulti:!1,hexs:[],activeTab:0,activeChn:0,activeScheduleIndex:-1,activeTableList:new Map,chooseLinSignalShow:!1,linAddRecordShow:!1,otherFrames:[],cur:-1,isDeploying:!1,isDeployChecked:!0,showScheduleList:!0,scheduleStyleOpt:[{label:"调度表",value:"schedule",disable:"false"},{label:"单帧",value:"single",disable:"false"}],isFilled:!0}},watch:{curFileIdx(e){this.activeTab=e,console.log("this.activeChn",this.activeChn,this.ldfChn)},deployDisable(e){console.log("部署disable",e)},linSendInfo(e){console.log("val111111",e),this.activeLinData=e==null?void 0:e.data[this.activeChn]},ldfChn:{handler(e){console.log("newVal07051108",e),this.nodeVal={},this.otherFrames=[],this.scheduleList=[]},deep:!0,immediate:!0},"$props.store.sendRecord.isRecording":{handler(e){e&&this.updateMultiFrame(this.otherFrames.map((s,i)=>({...s,row:i+1})),"add")}},"$props.store.sendRecord":{handler(e,s){}},otherFrames:{async handler(e,s){if(console.log("nextFrames1800",e),!this.isSyncFrames){this.isSyncFrames=!0,this.isHexMulti=!1;for(let i=0;i<e.length;i++){this.isDeployChecked=!1;let n=e[i],t=n.channel;console.log("frame07051053",t);let l=n.id;console.log("frame.dirty07041441",n.dirty,n),n.dirty==="raw"?await D.blfLogging.getRawValueToPhysValueLIN({ldfChannel:this.ldfChn[this.activeTab],linId:l,signalsData:n.children.map(o=>({name:o.text,rawValue:o.rawValue}))}).then(o=>{this.otherFrames[i]={...n,rawData:o.data.data.rawData,children:n.children.map(r=>{var d,c;return{...r,physValue:(c=(d=o.data.data.signalsData.find(m=>m.name===r.id))==null?void 0:d.physValue)!=null?c:r.physValue}}),dirty:!1,raw:i+1},this.updateMultiFrame([{row:i+1,...this.otherFrames[i]}],"modify"),this.isDeploying&&this.getDSServer()}).catch(console.log):n.dirty==="data"?(console.log("this.otherFrames[i]07051410",n),n.from==="dbc"||n.from==="sch"?await D.blfLogging.getDataToValuesLIN({ldfChannel:this.ldfChn[this.activeTab],linId:l,rawData:n.rawData}).then(o=>{console.log("res07110934",o),this.otherFrames[i]={...n,children:n.children.map(r=>{var d,c,m,f;return{...r,physValue:(c=(d=o.data.data.signalsPhysData.find(y=>y.name===r.id))==null?void 0:d.physValue)!=null?c:r.physValue,rawValue:(f=(m=o.data.data.signalsRawData.find(y=>y.name===r.id))==null?void 0:m.rawValue)!=null?f:r.rawValue}}),dirty:!1,raw:i+1},this.updateMultiFrame([{row:i+1,...this.otherFrames[i]}],"modify")}).catch(console.log):(this.otherFrames[i]={...n,dirty:!1,raw:i+1},this.updateMultiFrame([{row:i+1,...this.otherFrames[i]}],"modify")),this.isDeploying&&this.getDSServer()):n.dirty==="phys"?(console.log("frame.children0710",n.children),await D.blfLogging.getPhysValueToRawValueLIN({ldfChannel:this.ldfChn[this.activeTab],linId:l,signalsData:n.children.map(o=>({name:o.text,physValue:parseInt(o.physValue)}))}).then(o=>{this.otherFrames[i]={...n,rawData:o.data.data.rawData,children:n.children.map(r=>{var d,c;return{...r,rawValue:(c=(d=o.data.data.signalsData.find(m=>m.name===r.id))==null?void 0:d.rawValue)!=null?c:r.rawValue}}),dirty:!1,raw:i+1},this.updateMultiFrame([{row:i+1,...this.otherFrames[i]}],"modify"),this.isDeploying&&this.getDSServer()}).catch(console.log)):n.dirty==="dlc"?(this.otherFrames[i]={...n,rawData:Array.from({length:n.dlc},(o,r)=>n.rawData[r]||0),dirty:!1,raw:i+1},this.updateMultiFrame([{row:i+1,...n}],"modify"),this.isDeploying&&this.getDSServer()):n.dirty==="delay"?(this.otherFrames[i]={...n,isSending:n.delay==0?!1:n.isSending,dirty:!1,raw:i+1},this.updateMultiFrame([{row:i+1,...n}],"modify"),this.isDeploying&&this.getDSServer()):n.dirty&&(this.otherFrames[i].dirty=!1,this.updateMultiFrame([{row:i+1,...n}],"modify"),this.isDeploying&&this.getDSServer())}this.isSyncFrames=!1}},deep:!0},cur(e){console.log("cur07041051",e,this.otherFrames[e]),this.isHexMulti=!1,this.hexs=[]}},computed:{scheduleList(){if(console.log("this.nodeVal",Object.keys(this.nodeVal),this.nodeVal,this.linSendInfo,this.ldfChn[this.activeTab]),Object.keys(this.nodeVal).length>0&&this.nodeVal.value!==""){let e={};if(this.nodeVal.parentNode==="master")return this.showScheduleList=!0,e=this.ldfChn[this.activeTab]!==0?this.linSendInfo.data[this.ldfChn[this.activeTab]][this.nodeVal.parentNode][this.nodeVal.value]:{},Object.keys(e||{});{this.showScheduleList=!1,e=this.ldfChn[this.activeTab]!==0?this.linSendInfo.data[this.ldfChn[this.activeTab]][this.nodeVal.parentNode]:{};let s=Object.keys(e||{});return console.log("99999",s),s.forEach((i,n)=>{i===this.nodeVal.value&&this.checkedSchedule(n,i)}),s}}},checkedOptions(){return this.otherFrames.filter(e=>e.from=="dbc")}},mounted(){setTimeout(()=>{document.body.addEventListener("mousedown",this.clickHandler)},300)},unmounted(){document.body.removeEventListener("mousedown",this.clickHandler)},methods:{checkedSchedule(e,s){let i=[];console.log("this.nodeVal.parentNode1749",this.nodeVal.parentNode),this.nodeVal.parentNode==="master"?i=this.ldfChn[this.activeTab]!==0?this.linSendInfo.data[this.ldfChn[this.activeTab]][this.nodeVal.parentNode][this.nodeVal.value][s]:[]:i=this.ldfChn[this.activeTab]!==0?this.linSendInfo.data[this.ldfChn[this.activeTab]][this.nodeVal.parentNode][s]:[],this.activeScheduleIndex=e;let n=i.map(t=>({_id:this.nodeVal.parentNode+"_"+t[0]+"_"+this.mode,id:t[1],linId:t[1],text:t[0],name:t[0],dir:t[2],dlc:t[3],delay:t[4],channel:this.ldfChn[1],dirty:"raw",from:"sch",children:t[5].map(l=>{let o;return o={_id:l[0],id:l[0],text:l[0],node_type:"signal",comment:l[1],remark:l[2],linId:l[3],rawValue:l[4],maxRaw:l[5],minRaw:l[6],maxPhys:l[7].toString(),minPhys:l[8].toString(),selectPhys:l[9],unit:l[10],startBit:l[11],length:l[12],physStep:l[13].toString(),dlc:l[14],canType:l[15],periodic:l[16]},o})}));this.otherFrames=[],this.otherFrames.push(...n),this.activeTableList.set(this.nodeVal.parentNode+"-"+this.nodeVal.value+"-"+this.mode,{phone:"213-555-1234",address:"123 N 1st Ave"})},clickHandler(e){var s;((s=this.$refs.root)==null?void 0:s.contains(e.target))==!1&&(this.linAddRecordShow=!1)},showMessage({level:e,content:s,timeout:i}){clearTimeout(at),e!=null&&(this.message.level=e),s!=null&&(this.message.content=s),this.message.visible=!0,i>0&&(at=setTimeout(()=>{this.message.visible=!1},i))},onHexErr(){this.showMessage({timeout:2e3,level:"error",content:"请输入正确格式的16进制"})},addFrame(e){this.linAddRecordShow=!1;let s=[{name:"",delay:20,id:e===1,channel:this.ldfChn[1],canType:e,dir:"tx",dlc:8,isSending:!1,from:e,rawData:[0,0,0,0,0,0,0,0]}],i=this.otherFrames.length-1;this.otherFrames.push(...s),this.updateMultiFrame(s.map((n,t)=>({...n,row:i+t})),"add")},updateMultiFrame(e,s){console.log("list07051359",e),this.$props.store.sendRecord.isRecording&&e.map(i=>({...i,channel:this.$props.store.sendRecord.dbc.ldfChn.indexOf(i.channel)+1}))},updateFrame(e){let s=this.otherFrames.slice(),i=[],n=[];for(let t=s.length-1;t>=0;t--){let l=s[t];if(l.from==="dbc"){let o=e.findIndex(r=>r.id===l.id);if(~o)e.splice(o,1);else{t===this.cur&&(this.cur=-1);let r=s.splice(t,1);n.unshift({...r,row:t+1})}}}this.updateMultiFrame(n,"delete"),i=e.map((t,l)=>{let o=t.children[0]||{};return console.log("it2222",o),{...t,name:t.text,from:"dbc",periodic:o.periodic||0,canType:o.canType||"LIN",dlc:o.dlc||64,id:o.msg||0,linId:o.canId||0,dirty:"raw",dir:"tx",delay:10,isSending:!1,children:t.children.map(r=>({...r,name:r.id}))}}),s.push(...i),this.otherFrames=s,console.log("this.frames07040952",this.otherFrames),this.chooseLinSignalShow=!1,this.addRecordShow=!1},async startDeploy(){console.log("部署",this.nodeVal,this.nodeVal.parentNode),this.isDeploying=!0;for(var e=0;e<this.scheduleStyleOpt.length;e++)this.scheduleStyleOpt[e].value==="single"&&(this.scheduleStyleOpt[e].disable="true");this.getDSServer(),console.log("ldfChn11",this.ldfChn,this.otherFrames)},async getDSServer(){await D.blfLogging.getDeployShedule({channelId:2,mode:this.nodeVal.parentNode?this.nodeVal.parentNode:this.isFilled?"master":"slave",LINFrames:this.otherFrames.map(e=>({LINId:e.linId?"0x"+(parseInt(e.linId)||0).toString(16):"0x0",dataLength:e.rawData?e.rawData.length:0,dir:e.dir==="tx"?0:1,delay:e.delay,data:e.rawData}))}).then(e=>{}).catch(console.log)},async endDeploy(){this.isDeploying=!1;for(var e=0;e<this.scheduleStyleOpt.length;e++)this.scheduleStyleOpt[e].value==="single"&&(this.scheduleStyleOpt[e].disable="false");await D.blfLogging.getUnDeployShedule({channelId:2,mode:this.nodeVal.parentNode?this.nodeVal.parentNode:this.isFilled?"master":"slave"}).then(s=>{}).catch(console.log)},async togglePlay(e,s){console.log("raw07162036",e,s),await D.blfLogging.getManualSendLIN({channelId:2,mode:this.nodeVal.parentNode?this.nodeVal.parentNode:this.isFilled?"master":"slave",LINFrames:[{LINId:e.linId?"0x"+(parseInt(e.linId)||0).toString(16):"0x0",dataLength:e.rawData.length,dir:e.dir==="tx"?0:1,delay:e.delay,data:e.rawData}]}).then(i=>{})},delFrame(e){console.log("idx200322222",e,this.otherFrames),e===this.cur&&(this.cur=-1);let s=this.otherFrames.splice(e,1);this.otherFrames.forEach((i,n)=>{this.otherFrames[n].raw=n+1}),this.updateMultiFrame([{...s,row:e+1}],"delete")}}},ne=e=>(j("data-v-d39bfe60"),e=e(),q(),e),Ac={class:"lin-body"},Nc={class:"select-er"},Oc={class:"select-left"},Pc=ne(()=>a("span",{class:"record-header-message"},[a("b",null,"节点：")],-1)),Uc={key:0,class:"chs-ft-label pointer"},Hc=["checked"],Bc=ne(()=>a("i",{class:"icon-ques"},null,-1)),jc={class:"select-right"},qc=ne(()=>a("i",{class:"play-icon"},null,-1)),zc=ne(()=>a("i",{class:"stop-icon"},null,-1)),Kc={class:"lin-list-wrap"},Wc={class:"lin-list-tree-er"},Gc=ne(()=>a("div",{class:"lin-list-tree-tit"},[a("i",{class:"lin-list-icon"}),a("b",null,"LIN调度表")],-1)),Xc={class:"lin-list-tree-body"},Yc=["data-disabled","data-active","onClick"],Jc=ne(()=>a("i",{class:"lin-list-icon-sm"},null,-1)),Qc=["title"],Zc={class:"lin-list-er"},eh={class:"lin-list-table"},th={key:1,class:"ic-help"},sh={key:2,type:"checkbox"},lh={class:"add-record",ref:"root"},ih=["data-disabled"],ah=["data-disabled"],nh=["onClick","data-active"],oh=["data-from","data-cantype","data-valid"],rh=["onUpdate:modelValue","onChange"],dh=["onUpdate:modelValue","onChange"],ch=["value"],hh=["onUpdate:modelValue","onChange"],uh=ne(()=>a("option",{value:"tx"},"tx",-1)),mh=ne(()=>a("option",{value:"rx"},"rx",-1)),ph=[uh,mh],fh=["disabled","onUpdate:modelValue","onChange"],gh=["data-disable","data-recording","data-active","onClick"],bh=["data-disable","onClick"],_h={key:0,class:"table-empty"},yh={class:"empty-meark"},wh={class:"btn-import-er"},vh={class:"lin-sig-er"},Ch={class:"lin-hex-er"},kh=ne(()=>a("th",{style:{width:"4em"}}," ",-1)),Sh={style:{width:"11.8%"}},Th={key:0},Dh=["value"],Vh={class:"hex-footer"},xh={class:"hex-multi-input"};function Ih(e,s,i,n,t,l){var L,z,_,O,x,N,I,se,K;const o=w("v-select"),r=w("ButtonGroup"),d=w("Button"),c=w("EditWrapper"),m=w("InputHex"),f=w("ChooseSignal"),y=w("InputOrSelect"),M=H("tooltip");return h(),u("div",Ac,[a("div",Nc,[a("div",Oc,[Pc,g(o,{options:i.nodeOpt,clearable:!1,searchable:!1,disabled:t.isDeploying,label:"label",value:"value",modelValue:t.nodeVal,"onUpdate:modelValue":s[0]||(s[0]=p=>t.nodeVal=p),class:"tch-tool-select"},null,8,["options","disabled","modelValue"]),i.ldfChn[this.activeTab]=="0"?v((h(),u("label",Uc,[a("input",{class:"chs-node-checkboxAll",type:"checkbox",checked:t.isFilled,onClick:s[1]||(s[1]=p=>e.checkMasterMode())},null,8,Hc),C("主节点模式"),Bc])),[[M,"主节点模式"]]):k("",!0)]),a("div",jc,[g(r,{options:t.scheduleStyleOpt,class:"theme-btn-group",modelValue:t.mode,"onUpdate:modelValue":s[2]||(s[2]=p=>t.mode=p)},null,8,["options","modelValue"]),C("  "),t.isDeploying?(h(),P(d,{key:1,type:"primary",class:"header-import-btn",onClick:l.endDeploy},{default:S(()=>[zc,C("停止 ")]),_:1},8,["onClick"])):(h(),P(d,{key:0,type:"primary",class:"header-import-btn",onClick:l.startDeploy,disabled:t.isDeployChecked||t.mode=="single"||i.deployDisable,progress:"100%"},{default:S(()=>[qc,C("部署 ")]),_:1},8,["onClick","disabled"]))])]),a("div",Kc,[v(a("div",Wc,[Gc,a("div",Xc,[(h(!0),u(T,null,F(l.scheduleList,(p,R)=>(h(),u("div",{class:"lin-list-tree-item",key:R,"data-disabled":t.isDeploying,"data-active":t.activeScheduleIndex===R,onClick:V=>l.checkedSchedule(R,p)},[Jc,a("span",{title:p},b(p),9,Qc)],8,Yc))),128))])],512),[[U,t.showScheduleList]]),a("div",Zc,[a("table",eh,[a("tr",null,[(h(!0),u(T,null,F(t.linListTable.cols,p=>(h(),u("th",{style:$({width:p.width})},[C(b(p.label)+" ",1),p.icon?(h(),u("i",{key:0,onClick:s[3]||(s[3]=R=>t.linAddRecordShow=!t.linAddRecordShow),class:"lin-ic-add"})):k("",!0),p.tooltip?v((h(),u("i",th,null,512)),[[M,p.tooltip]]):k("",!0),p.type?(h(),u("input",sh)):k("",!0)],4))),256)),v(a("div",lh,[a("div",{onClick:s[4]||(s[4]=p=>t.chooseLinSignalShow=!t.chooseLinSignalShow),"data-disabled":((_=(z=(L=e.$props.store)==null?void 0:L.sendRecord)==null?void 0:z.otherFrames)==null?void 0:_.length)===0||t.isDeploying},"从DBC中导入帧",8,ih),a("div",{onClick:s[5]||(s[5]=p=>l.addFrame("LIN")),"data-disabled":((N=(x=(O=e.$props.store)==null?void 0:O.sendRecord)==null?void 0:x.otherFrames)==null?void 0:N.length)==0||t.isDeploying},"自定义帧",8,ah)],512),[[U,t.linAddRecordShow]])]),(h(!0),u(T,null,F(t.otherFrames,(p,R)=>(h(),u("tr",{onClick:V=>t.cur=R,"data-active":t.cur===R},[a("td",null,b(R+1),1),a("td",null,[a("i",{class:"ic-can","data-from":p.from,"data-cantype":p.canType,"data-valid":Object.values(e.$props.store.sendRecord.dbc.ldfChn).includes(p.channel)},null,8,oh),C(" "+b(p.name),1)]),a("td",null,[g(c,null,{default:S(()=>[v(a("input",{class:"td-input",type:"number",min:"0",max:"1000","onUpdate:modelValue":V=>p.delay=V,onChange:V=>p.dirty="delay"},null,40,rh),[[Q,p.delay,void 0,{lazy:!0}]])]),_:2},1024)]),a("td",null,[g(c,{disabled:p.from!=="LIN"},{default:S(()=>[g(m,{onError:l.onHexErr,min:0,max:2047,disabled:p.from!=="LIN",class:"td-input",modelValue:p.linId,"onUpdate:modelValue":V=>p.linId=V,onChange:V=>p.dirty="linId"},null,8,["onError","disabled","modelValue","onUpdate:modelValue","onChange"])]),_:2},1032,["disabled"])]),a("td",null,[g(c,{disabled:!0},{default:S(()=>[v(a("select",{disabled:!0,class:"td-input","onUpdate:modelValue":V=>p.channel=V,onChange:V=>p.dirty="channel"},[(h(!0),u(T,null,F(e.$props.store.sendRecord.dbc.ldfChn,(V,Y)=>(h(),u("option",{value:V},"LIN2",8,ch))),256))],40,dh),[[re,p.channel,void 0,{lazy:!0}]])]),_:2},1024)]),a("td",null,[g(c,null,{default:S(()=>[v(a("select",{class:"td-input","onUpdate:modelValue":V=>p.dir=V,onChange:V=>p.dirty="dir"},ph,40,hh),[[re,p.dir]])]),_:2},1024)]),a("td",null,[g(c,{disabled:p.from!=="LIN"},{default:S(()=>[v(a("input",{disabled:p.from!=="LIN",class:"td-input",type:"number",min:"0",max:"8","onUpdate:modelValue":V=>p.dlc=V,onChange:V=>p.dirty="dlc"},null,40,fh),[[Q,p.dlc,void 0,{lazy:!0}]])]),_:2},1032,["disabled"])]),a("td",null,[t.mode!=="schedule"?(h(),u("i",{key:0,class:"ic-play","data-disable":Object.values(e.$props.store.sendRecord.dbc.ldfChn).includes(p.channel),"data-recording":e.$props.store.sendRecord.isRecording,"data-active":p.isSending,onClick:V=>l.togglePlay(p,R)},null,8,gh)):k("",!0),C("  "),a("i",{class:"ic-del","data-disable":t.isDeploying,onClick:A(V=>l.delFrame(R),["stop"])},null,8,bh)])],8,nh))),256))]),t.otherFrames.length==0?(h(),u("div",_h,[a("div",yh,[C("暂无内容，请先"),a("span",{class:"empty-btn",onClick:s[6]||(s[6]=p=>t.linAddRecordShow=!t.linAddRecordShow)},"导入帧")])])):k("",!0)]),v(a("div",wh,[t.chooseLinSignalShow?(h(),P(f,{key:0,filledOptions:e.$props.store.sendRecord.otherFrames,checkedOptions:l.checkedOptions,onSignalsChange:l.updateFrame,onCancel:s[7]||(s[7]=()=>{t.chooseLinSignalShow=!1})},null,8,["filledOptions","checkedOptions","onSignalsChange"])):k("",!0)],512),[[U,t.chooseLinSignalShow]])]),a("div",vh,[(h(),u("table",{class:"sig-table",key:"sig"+t.cur},[a("tr",null,[(h(!0),u(T,null,F(t.linSigTable.cols,p=>(h(),u("th",{style:$({width:p.width})},b(p.label),5))),256))]),((I=t.otherFrames[t.cur])==null?void 0:I.name)!==""?(h(!0),u(T,{key:0},F((se=t.otherFrames[t.cur])==null?void 0:se.children,p=>(h(),u("tr",null,[v((h(),u("td",null,[C(b(p.text)+" ",1)])),[[M,{content:"".concat(p.text,"<hr/>phys:").concat(p.minPhys," ~ ").concat(p.maxPhys,"<br/>raw:").concat(p.minRaw?"0x"+p.minRaw.toString(16):""," ~ ").concat(p.maxRaw?"0x"+p.maxRaw.toString(16):"","<br/>Start Bit:").concat(p.startBit,"<br>Length:").concat(p.length,"<br>Phys Step:").concat(p.physStep),html:!0},void 0,{"top-start":!0}]]),a("td",null,[g(c,null,{default:S(()=>[g(m,{watch:!0,onError:l.onHexErr,min:p.minRaw,max:p.maxRaw,class:"td-input",modelValue:p.rawValue,"onUpdate:modelValue":R=>p.rawValue=R,modelModifiers:{lazy:!0},onChange:s[8]||(s[8]=R=>t.otherFrames[t.cur].dirty="raw")},null,8,["onError","min","max","modelValue","onUpdate:modelValue"])]),_:2},1024)]),a("td",null,[g(c,null,{default:S(()=>[g(y,{watch:!0,min:p.minPhys,max:p.maxPhys,class:"td-input",step:p.physStep,modelValue:p.physValue,"onUpdate:modelValue":R=>p.physValue=R,enum:p.selectPhys?p.selectPhys:"",onChange:s[9]||(s[9]=R=>t.otherFrames[t.cur].dirty="phys")},null,8,["min","max","step","modelValue","onUpdate:modelValue","enum"])]),_:2},1024)]),a("td",null,b(p.unit),1)]))),256)):k("",!0)]))]),a("div",Ch,[(h(),u("table",{class:"lin-hex-table",key:"hex"+t.cur},[a("tr",null,[kh,(h(),u(T,null,F([0,1,2,3,4,5,6,7],p=>a("th",Sh,b(p),1)),64))]),(K=t.otherFrames[t.cur])!=null&&K.rawData?(h(),u(T,{key:0},F([0,8,16,24,32,40,48,56,64],(p,R)=>(h(),u(T,null,[t.otherFrames[t.cur].rawData.length>p?(h(),u("tr",Th,[a("td",null,[a("b",null,b(p),1)]),(h(),u(T,null,F(8,V=>a("td",null,[e.isHexMulti&&p+V-1<t.otherFrames[t.cur].rawData.length?v((h(),u("input",{key:0,type:"checkbox",class:"radio","onUpdate:modelValue":s[10]||(s[10]=Y=>t.hexs=Y),value:p+V-1},null,8,Dh)),[[ee,t.hexs]]):k("",!0),p+V-1<t.otherFrames[t.cur].rawData.length?(h(),P(c,{key:1},{default:S(()=>[g(m,{watch:!0,onError:l.onHexErr,min:0,max:255,class:"td-input",style:{width:"calc(100%)","text-indent":"20px"},modelValue:t.otherFrames[t.cur].rawData[p+V-1],"onUpdate:modelValue":Y=>t.otherFrames[t.cur].rawData[p+V-1]=Y,modelModifiers:{lazy:!0},onChange:s[11]||(s[11]=Y=>t.otherFrames[t.cur].dirty="data")},null,8,["onError","modelValue","onUpdate:modelValue"])]),_:2},1024)):k("",!0)])),64))])):k("",!0)],64))),64)):k("",!0)])),a("div",Vh,[t.linIsHexMulti?(h(),u(T,{key:1},[C(" 批量修改:("+b(t.hexs.length)+"个)  ",1),g(d,{style:{float:"right",height:"23px","margin-left":"8px"},onClick:s[13]||(s[13]=p=>{t.hexs=[],t.linIsHexMulti=!1})},{default:S(()=>[C("退出")]),_:1}),g(d,{style:{float:"right",height:"23px"},type:"primary"},{default:S(()=>[C("修改")]),_:1}),a("div",xh,[g(m,{onError:l.onHexErr,min:0,max:255,modelValue:e.hexMultiValue,"onUpdate:modelValue":s[14]||(s[14]=p=>e.hexMultiValue=p)},null,8,["onError","modelValue"])])],64)):(h(),u("div",{key:0,class:"hex-footer-full-btn",onClick:s[12]||(s[12]=p=>t.linIsHexMulti=!t.linIsHexMulti)},"进入批量修改"))])])])}const Lh=E($c,[["render",Ih],["__scopeId","data-v-d39bfe60"]]);const Fh={props:["theme","modelValue","options","position","closeable"],emits:["update:modelValue","close"],data(){return{value:this.$props.modelValue}},watch:{value(e){e!==this.modelValue&&this.$emit("update:modelValue",e)},modelValue(e){this.value=e}},methods:{onWheel(e){let s=0;e.deltaY>0||e.deltaX>0?s=100:s=-100;const i=this.$refs.rootRef;let n=i.scrollLeft+s;n<0?n=0:n+i.clientWidth>=i.scrollWidth&&(n=i.scrollWidth-i.clientWidth),console.log("nextD",i,n),i.scrollLeft=n}}},Rh=["data-theme","data-position"],Mh={class:"tab"},Eh=["value"],$h=["data-dirty","onClick"];function Ah(e,s,i,n,t,l){return h(),u("div",{class:"tab-er","data-theme":i.theme||"default","data-position":i.position,ref:"rootRef",onWheel:s[1]||(s[1]=(...o)=>l.onWheel&&l.onWheel(...o))},[(h(!0),u(T,null,F(i.options,o=>(h(),u("label",Mh,[a("span",null,b(o.label),1),v(a("input",{type:"radio","onUpdate:modelValue":s[0]||(s[0]=r=>t.value=r),value:o.value},null,8,Eh),[[gt,t.value]]),i.closeable?(h(),u("i",{key:0,class:"ic-close","data-dirty":o.dirty,onClick:r=>e.$emit("close",o.value)},null,8,$h)):k("",!0)]))),256)),ht(e.$slots,"default",{},void 0,!0)],40,Rh)}const Nh=E(Fh,[["render",Ah],["__scopeId","data-v-e3e22d2b"]]);let nt=0,Oh=0,Ph=0;const Uh={props:["store","setStore","closeFlag"],emits:["connect","showMessage","getCarCode"],components:{Button:G,Header:ot,FrameRecord:zn,LinRecord:nr,ChartRecord:Ea,EditModal:ns,FiveChannelEditModal:ml,TwelveChannelEditModal:Ul,SendRecord:pd,Message:Z,LinSendRecord:Cc,LinOtherSendRecord:Lh,Tabs:Nh},data(){return{system:dt,isHardwareChecked:!1,expandKeys:new Set,visibleStartIndex:0,visibleEndIndex:0,bottomPadding:0,recordLoading:!1,startTime:0,editModal:{title:"配置",editVisible:!1},mode:"all",dbcVal:"",sliderValue:-1,channelOne:"",channelTwo:"",channelThree:"",channelFour:"",channelFive:"",channelSix:"",channelSeven:"",channelEight:"",channelNine:"",channelTen:"",channelEleven:"",channelTwelve:"",linChannelVal:"",linChannelValTwo:"",filePath:"",comments:["","","","","","","","","","","","","","","",""],message:{visible:!1,level:"",content:""},seconds:0,rowData:[],isRecording:!1,startSqlId:0,endSqlId:0,isLock:!1,isScrollEnd:!0,isAddData:!0,secondConfirm:!1,topLock:!1,bottomLock:!1,openFlag:!1,mlist:[{key:"lookRecord",name:"CAN帧查看",icon:"box"},{key:"supeRecord",name:"图像查看",icon:"setting"},{key:"sendRecord",name:"CAN发送报文",icon:"send"},{key:"linSendRecord",name:"LIN发送报文",icon:"send"},{key:"linRecord",name:"LIN帧查看",icon:"box"}],cur:"lookRecord",recordShow:!1,linRecordShow:!0,colFilterShow:!1,recordChart:"RecordChart",recordTime:"00:00:00",frames:[],timeData:Object.freeze([]),showSignalsList:[],updateSignalData:{},dbcLoading:!1,sendRecordShow:!1,linSendRecordShow:!1,lookRecord:!0,isEditModalLoading:!1,sn:"--",sw:"--",frameType:"canFrame",sdb:"E4U3_1115",dbcChn:[],ldfChn:[],linSendInfo:[],channelValList:[],linChannelValList:[],chartTableData:[],btnActionStyle:"",curFileIdx:0,mainTabs:[],activeTab:0,activeLinData:{},nodeOpt:[],deployDisable:!0}},watch:{mode(e,s){this.topPadding=0,this.$refs.table.scrollToItem(0),this.expandKeys.clear(),this.rowData=[],this.isRecording&&this.resumeScroll()},frames(e){this.$props.setStore("sendRecord",{frames:e})},isRecording(e){this.$props.setStore("sendRecord",{isRecording:e})},curFileIdx(e){this.activeTab=this.ldfChn[e],console.log("newVal",e,this.ldfChn,this.activeTab),this.activeTab===0?(this.nodeOpt=[],console.log("111111")):this.changeTabOption(this.activeTab)}},computed:{quitConfirm(){return!!(this.dbcVal||this.channelOne||this.channelTwo||this.channelThree||this.filePath)}},methods:{_onConnectDevice(){JSBridge.send({method:"initDevice",data:{key:"value"}},e=>{console.log("111111111",e.sn,e.version),e.code==200&&(this.sn=e.data.sn,this.sw=e.data.version,this.dbcVal="自定义模板")})},chartTableFun(e){this.chartTableData=e==null?void 0:e.filter(s=>s.values.length>0)},updateTimeData(e){var s;(s=this.$refs.chartRecordRef)==null||s.upTimeData(e)},recordTimeChange(e){this.recordTime=e},async colFilterChange(){this.editModal.editVisible=!0,await D.blfLogging.checkHardware().then(async e=>{var s,i,n;((s=e==null?void 0:e.data)==null?void 0:s.code)===1?(this.showMessage({timeout:5e3,level:"success",content:((i=e.data)==null?void 0:i.msg)||"硬件连接成功"}),this.sn=e.data.data.sn,this.sw=e.data.data.sw,this.isHardwareChecked=!0):(this.isHardwareChecked=!1,this.showMessage({timeout:5e3,level:"error",content:((n=e.data)==null?void 0:n.msg)||"硬件连接失败"}))}).catch(e=>{this.isHardwareChecked=!1,this.showMessage({timeout:5e3,level:"error",content:"硬件连接失败"})}).finally(()=>{this.isEditModalLoading=!1})},_startRecord(){var e,s,i,n;this.updateSignalData=(e=this.$refs.chartRecordRef)==null?void 0:e.view,(i=this.$refs.chartRecordRef)==null||i.updateSignal((s=this.updateSignalData)==null?void 0:s.children,"1"),(n=this.$refs.chartRecordRef)==null||n.clearTimeData(),this.btnActionStyle="normal",this.$refs.frameRecordRef.startRecord(this.btnActionStyle),this.isRecording=!0,this.deployDisable=!1},async startRecord(){var e,s,i,n;this.updateSignalData=(e=this.$refs.chartRecordRef)==null?void 0:e.view,(i=this.$refs.chartRecordRef)==null||i.updateSignal((s=this.updateSignalData)==null?void 0:s.children,"1"),(n=this.$refs.chartRecordRef)==null||n.clearTimeData(),this.btnActionStyle="normal",this.$refs.frameRecordRef.startRecord(this.btnActionStyle),this.$refs.linRecordRef.startRecord(),this.isRecording=!0,this.deployDisable=!1,ye.report("track","click",{element_name:"开始录制",tip:"1174.18.0.1.33199"})},async startListen(){this.btnActionStyle="listen",this.$refs.frameRecordRef.startRecord(this.btnActionStyle)},_endRecord(){JSBridge.send({method:"stopDevice",data:{}},e=>{})},endRecord(){this.$refs.frameRecordRef.endRecord(),this.isRecording=!1,this.deployDisable=!0,ye.report("track","click",{element_name:"停止录制",tip:"1174.18.0.1.33203"})},choose(e){this.cur=e,e=="supeRecord"?(this.recordShow=!0,this.sendRecordShow=!0,this.linSendRecordShow=!0,this.lookRecord=!1,this.linRecordShow=!0):e=="lookRecord"?(this.recordShow=!1,this.sendRecordShow=!0,this.linSendRecordShow=!0,this.lookRecord=!0,this.frameType="canFrame",this.linRecordShow=!0):e=="sendRecord"?(this.recordShow=!0,this.lookRecord=!0,this.sendRecordShow=!1,this.linSendRecordShow=!0,this.linRecordShow=!0):e=="linRecord"?(this.linRecordShow=!1,this.recordShow=!0,this.sendRecordShow=!0,this.lookRecord=!0,this.linSendRecordShow=!0,this.frameType="linFrame"):e=="linSendRecord"&&(this.recordShow=!0,this.lookRecord=!0,this.sendRecordShow=!0,this.linSendRecordShow=!1,this.linRecordShow=!0)},updateBocks(e){this.dbcVal=e.dbcVal,this.recordLoading=e.recordLoading,this.isRecording=e.isRecording,this.filePath=e.filePath},openEditDialog(){this.editModal.editVisible=!0,this.openFlag=!1},onCancelSelect(){this.editModal.editVisible=!1},showMessage({level:e,content:s,timeout:i}){clearTimeout(nt),e!=null&&(this.message.level=e),s!=null&&(this.message.content=s),this.message.visible=!0,i>0&&(nt=setTimeout(()=>{this.message.visible=!1},i))},async onSubmitToShow(e,s,i,n){console.log("dbcVal",e,s,i,n),this.dbcVal=e[0]==="自定义模板"?this.dbcVal="自定义模板":this.dbcVal=e[0]+"/"+e[1],this.sdb=this.dbcVal==="自定义模板"?"默认视图":this.dbcVal.split("/")[1],this.filePath=n;let t=["","","","","","","","","","","","","","","",""],l=["","","","","","","","","","","","","","","",""];this.dbcChn=s.map((d,c)=>d!=="(不加载)"?(t[c]=d.split("-").pop(),parseInt(d.split("-")[0])):0-(c+1)),console.log("this.dbcChn111",this.dbcChn),this.ldfChn=i.map((d,c)=>(console.log("item111",d),l[c]=d.split("-").pop(),d!=="(不加载)"?parseInt(d):0)),this.channelValList=s,this.linChannelValList=i,this.mainTabs=[],this.linChannelValList.forEach((d,c)=>{d!=="(不加载)"?this.mainTabs.push({label:d,value:c,dirty:"tab"}):this.mainTabs.push({label:"LIN"+(c+1),value:c,dirty:"tab"})}),console.log("mainTabs",this.mainTabs,this.linChannelValList,this.linChannelValList.some(d=>d!=="(不加载)")),this.channelOne=s[0],this.channelTwo=s[1],this.channelThree=s[2],this.linChannelVal=i[0],this.linChannelValTwo=i[1];let o={sdb:this.sdb,carType:this.dbcVal==="自定义模板"?"custom":this.dbcVal.split("/")[0],dbcChn:this.dbcChn,ldfChn:this.ldfChn,files:this.dbcVal==="自定义模板"?t:["","","","","","","","","","","","","","","",""],ldfFiles:this.dbcVal==="自定义模板"?l:["","","","","","","","","","","","","","","",""],comments:this.comments,ldfComments:this.comments};this.$props.setStore("sendRecord",{dbc:o}),this.dbcLoading=!0;let r=await D.blfLogging.getDBC(o).finally(()=>{this.dbcLoading=!1});this.frames=r,console.log(this.frames),this.isEditModalLoading=!0,this.mainTabs.length>0&&(this.linSendInfo=await D.blfLogging.get_LIN_shc().then(),console.log("this.ldfChn[this.curFileIdx]",this.ldfChn[0],this.curFileIdx),this.ldfChn[0]===0?this.nodeOpt=[]:this.changeTabOption(this.ldfChn[this.curFileIdx]),console.log("linSendInfo22222",this.linSendInfo,this.curFileIdx,this.ldfChn[this.curFileIdx],this.nodeOpt)),this.editModal.editVisible=!1},changeTabOption(e){var i;let s=(i=this.linSendInfo)==null?void 0:i.data[e];if(console.log("allNodeObj",s),Object.keys(s||{}).length!==0){let n=Object.keys(s.master).map(l=>({value:l,label:l+"[主节点]",parentNode:"master"})),t=Object.keys(s.slaves).map(l=>({value:l,label:l+"[从节点]",parentNode:"slaves"}));this.nodeOpt=[...n,...t]}}},mounted(){ye.report("trackPage",{page:"报文录制",tip:"1174.18.0.1.33191"}),D.blfLogging.removeSql(),window.__this=this},unmounted(){D.blfLogging.removeSql(),clearInterval(Oh),clearInterval(Ph)}},te=e=>(j("data-v-05c304e4"),e=e(),q(),e),Hh={class:"record-page-er"},Bh={style:{position:"absolute",left:"1em",display:"flex","column-gap":"6px","align-items":"center"}},jh=te(()=>a("i",{class:"lead-icon"},null,-1)),qh={class:"o-pul-record-btn"},zh=te(()=>a("i",{class:"play-icon"},null,-1)),Kh=te(()=>a("i",{class:"stop-icon"},null,-1)),Wh={class:"o-pul-record-btn"},Gh=te(()=>a("i",{class:"play-icon"},null,-1)),Xh={key:0,class:"o-pul-record-time"},Yh={key:1,class:"o-pul-record-time"},Jh={style:{display:"flex"}},Qh={class:"record-header-message",style:{display:"flex","align-items":"center"}},Zh={class:"record-header-message-imp"},eu=te(()=>a("span",{style:{color:"#D9D9D9","font-size":"16px",margin:"0 10px"}},"|",-1)),tu={class:"record-header-message",style:{"margin-right":"8px"}},su={class:"record-header-message-imp"},lu={class:"o-pul-er"},iu={class:"o-menu"},au={style:{position:"relative"}},nu=["data-active"],ou=te(()=>a("i",{class:"supe-look-record"},null,-1)),ru=["data-active"],du=te(()=>a("i",{class:"supe-record"},null,-1)),cu=["data-active"],hu=te(()=>a("i",{class:"send-record"},null,-1)),uu=["data-active"],mu=te(()=>a("i",{class:"send-record"},null,-1)),pu=["data-active"],fu=te(()=>a("i",{class:"supe-lin-record"},null,-1)),gu=["data-hidden"],bu=["data-hidden"],_u=["data-hidden"],yu=["data-hidden"],wu=["data-hidden"],vu={key:0,class:"bdy-tabs"},Cu=te(()=>a("div",{style:{width:"54px",display:"inline-block"}},null,-1));function ku(e,s,i,n,t,l){const o=w("Button"),r=w("Header"),d=w("FrameRecord"),c=w("LinRecord"),m=w("ChartRecord"),f=w("SendRecord"),y=w("Tabs"),M=w("LinSendRecord"),L=w("LinOtherSendRecord"),z=w("EditModal"),_=w("FiveChannelEditModal"),O=w("TwelveChannelEditModal"),x=w("Message");return h(),u(T,null,[a("div",Hh,[g(r,{title:"报文录制",quitConfirm:l.quitConfirm,showRight:!1,recentTest:e.$props.store.connectCar.latest,connectStatus:e.$props.store.connectCar.status},{default:S(()=>[a("div",Bh,[g(o,{type:"primary",class:"header-import-btn",disabled:t.isRecording,onClick:l._onConnectDevice},{default:S(()=>[jh,C("连接设备")]),_:1},8,["disabled","onClick"]),a("div",qh,[t.isRecording?(h(),P(o,{key:1,type:"primary",onClick:l._endRecord,loading:t.recordLoading,progress:"100%"},{default:S(()=>[Kh,C("停止")]),_:1},8,["onClick","loading"])):(h(),P(o,{key:0,type:"primary",loading:t.recordLoading,disabled:!t.dbcVal,progress:"100%",onClick:l._startRecord},{default:S(()=>[zh,C("监控并录制 ")]),_:1},8,["loading","disabled","onClick"]))]),a("div",Wh,[t.isRecording?k("",!0):(h(),P(o,{key:0,type:"primary",loading:t.recordLoading,disabled:!t.dbcVal,progress:"100%",onClick:l.startListen},{default:S(()=>[Gh,C("仅监控 ")]),_:1},8,["loading","disabled","onClick"]))]),t.btnActionStyle=="listen"?(h(),u("div",Xh,"监控时间: "+b(t.recordTime),1)):(h(),u("div",Yh,"录制时间: "+b(t.recordTime),1))]),a("template",Jh,[a("span",Qh,[C(" 设备名称： "),a("span",Zh,b(t.sn),1)]),eu,a("span",tu,[C(" 版本号："),a("span",su,b(t.sw),1)])])]),_:1},8,["quitConfirm","recentTest","connectStatus"]),a("div",lu,[a("div",iu,[a("div",au,[a("div",{class:"o-menu-it","data-active":t.cur==t.mlist[0].key||t.mlist[0].active,onClick:s[0]||(s[0]=N=>l.choose(t.mlist[0].key))},[ou,C(" "+b(t.mlist[0].name),1)],8,nu),t.system!="mac"?(h(),u("div",{key:0,class:"o-menu-it","data-active":t.cur==t.mlist[1].key||t.mlist[1].active,onClick:s[1]||(s[1]=N=>l.choose(t.mlist[1].key))},[du,C(" "+b(t.mlist[1].name),1)],8,ru)):k("",!0),a("div",{class:"o-menu-it","data-active":t.cur==t.mlist[2].key||t.mlist[2].active,onClick:s[2]||(s[2]=N=>l.choose(t.mlist[2].key))},[hu,C(" "+b(t.mlist[2].name),1)],8,cu),t.sn.includes("CR3")?(h(),u("div",{key:1,class:"o-menu-it","data-active":t.cur==t.mlist[3].key||t.mlist[3].active,onClick:s[3]||(s[3]=N=>l.choose(t.mlist[3].key))},[mu,C(" "+b(t.mlist[3].name),1)],8,uu)):k("",!0),t.sn.includes("CR3")?(h(),u("div",{key:2,class:"o-menu-it","data-active":t.cur==t.mlist[4].key||t.mlist[4].active,onClick:s[4]||(s[4]=N=>l.choose(t.mlist[4].key))},[fu,C(" "+b(t.mlist[4].name),1)],8,pu)):k("",!0)])]),a("div",{class:"rec-body","data-hidden":t.recordShow},[g(d,{onUpdateBock:l.updateBocks,onUpdateTimeData:l.updateTimeData,ref:"frameRecordRef",onChartTableFun:l.chartTableFun,frameType:t.frameType,sn:t.sn,dbcChn:t.dbcChn,ldfChn:t.ldfChn,channelValList:t.channelValList,linChannelValList:t.linChannelValList,channelOne:t.channelOne,channelTwo:t.channelTwo,channelThree:t.channelThree,linChannelVal:t.linChannelVal,linChannelValTwo:t.linChannelValTwo,filePath:t.filePath,onRecordTimeChange:l.recordTimeChange,dbcVal:t.dbcVal,colFilterShow:t.colFilterShow,onStartTimeChange:s[5]||(s[5]=N=>{t.startTime=N}),startTime:t.startTime},null,8,["onUpdateBock","onUpdateTimeData","onChartTableFun","frameType","sn","dbcChn","ldfChn","channelValList","linChannelValList","channelOne","channelTwo","channelThree","linChannelVal","linChannelValTwo","filePath","onRecordTimeChange","dbcVal","colFilterShow","startTime"])],8,gu),t.sn.includes("CR3")?(h(),u("div",{key:0,class:"rec-body","data-hidden":t.linRecordShow},[g(c,{onUpdateBock:l.updateBocks,onUpdateTimeData:l.updateTimeData,ref:"linRecordRef",channelOne:t.channelOne,channelTwo:t.channelTwo,channelThree:t.channelThree,linChannelVal:t.linChannelVal,linChannelValTwo:t.linChannelValTwo,filePath:t.filePath,dbcVal:t.dbcVal,colFilterShow:t.colFilterShow,onStartTimeChange:s[6]||(s[6]=N=>{t.startTime=N}),startTime:t.startTime},null,8,["onUpdateBock","onUpdateTimeData","channelOne","channelTwo","channelThree","linChannelVal","linChannelValTwo","filePath","dbcVal","colFilterShow","startTime"])],8,bu)):k("",!0),t.system!=="mac"?(h(),u("div",{key:1,class:"rec-body","data-hidden":t.lookRecord},[g(m,{ref:"chartRecordRef",chartTableData:t.chartTableData,sdb:t.sdb,dbcChn:t.dbcChn,ldfChn:t.ldfChn,dbcVal:t.dbcVal,getDbcData:t.frames},null,8,["chartTableData","sdb","dbcChn","ldfChn","dbcVal","getDbcData"])],8,_u)):k("",!0),a("div",{class:"rec-body","data-hidden":t.sendRecordShow},[g(f,{store:e.$props.store,setStore:e.$props.setStore},null,8,["store","setStore"])],8,yu),t.sn.includes("CR3")?(h(),u("div",{key:2,class:"rec-body","data-hidden":t.linSendRecordShow},[t.mainTabs.length>0?(h(),u("div",vu,[g(y,{position:"top",closeable:!1,options:t.mainTabs,modelValue:t.curFileIdx,"onUpdate:modelValue":s[7]||(s[7]=N=>t.curFileIdx=N)},{default:S(()=>[Cu]),_:1},8,["options","modelValue"])])):k("",!0),v(g(M,{activeTab:t.activeTab,linSendInfo:t.linSendInfo,nodeOpt:t.nodeOpt,curFileIdx:t.curFileIdx,ldfChn:t.ldfChn,deployDisable:t.deployDisable,store:e.$props.store,setStore:e.$props.setStore},null,8,["activeTab","linSendInfo","nodeOpt","curFileIdx","ldfChn","deployDisable","store","setStore"]),[[U,t.curFileIdx===0]]),v(g(L,{activeTab:t.activeTab,linSendInfo:t.linSendInfo,nodeOpt:t.nodeOpt,curFileIdx:t.curFileIdx,ldfChn:t.ldfChn,deployDisable:t.deployDisable,store:e.$props.store,setStore:e.$props.setStore},null,8,["activeTab","linSendInfo","nodeOpt","curFileIdx","ldfChn","deployDisable","store","setStore"]),[[U,t.curFileIdx===1]])],8,wu)):k("",!0),v(g(z,{loading:t.isEditModalLoading,title:t.editModal.title,onCancel:l.onCancelSelect,onSubmitToShow:l.onSubmitToShow},null,8,["loading","title","onCancel","onSubmitToShow"]),[[U,t.editModal.editVisible&&t.sn.includes("CR2")]]),v(g(_,{loading:t.isEditModalLoading,title:t.editModal.title,onCancel:l.onCancelSelect,onSubmitFiveToShow:l.onSubmitToShow},null,8,["loading","title","onCancel","onSubmitFiveToShow"]),[[U,t.editModal.editVisible&&t.sn.includes("CR3")]]),v(g(O,{loading:t.isEditModalLoading,title:t.editModal.title,onCancel:l.onCancelSelect,onSubmitTwelveToShow:l.onSubmitToShow},null,8,["loading","title","onCancel","onSubmitTwelveToShow"]),[[U,t.editModal.editVisible&&t.sn.includes("DR4")]])])]),g(x,{message:t.message},null,8,["message"])],64)}const Pu=E(Uh,[["render",ku],["__scopeId","data-v-05c304e4"]]);export{Pu as default};
