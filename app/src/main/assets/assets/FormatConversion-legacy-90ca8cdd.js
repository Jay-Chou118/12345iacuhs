System.register(["./Header-legacy-ac26f6bc.js","./Button-legacy-ad9dd781.js","./Cascader-legacy-fe5849bf.js","./index-legacy-5d16f695.js","./index-legacy-a73211b3.js"],(function(e,t){"use strict";var s,o,a,l,c,i,r,d,n,p,h,u,y,b,m,f,g,v,T,D,C,L,V,F,S,_;return{setters:[e=>{s=e.H},e=>{o=e.B},e=>{a=e.C},e=>{l=e._,c=e.S,i=e.k,r=e.j,d=e.e,n=e.r,p=e.l,h=e.c,u=e.h,y=e.d,b=e.i,m=e.a,f=e.w,g=e.t,v=e.f,T=e.F,D=e.m,C=e.v,L=e.o,V=e.n,F=e.p,S=e.b},e=>{_=e.n}],execute:function(){const t={props:["store","closeFlag"],components:{Button:o,Header:s,Cascader:a},data(){return{pullType:"mdf",chartDataLoaded:!0,recLoading:!1,recList:{mdf:{label:"mdf",size:"",paths:""},csv:{label:"csv",size:"",paths:"/persistence/vde/pool,/tmp/vde/pool"},asc:{label:"asc",size:"",paths:"/log/DiagMaster,/persistence/DiagMaster"}},consoleText:"",blfDirectory:"",outputDirectory:"",onFlag:!0,recLoadingProgress:"",dbcVal:[c.DEFAULT[0].value,c.DEFAULT[0].children[0].value],sdbCustom:this.$ls.get("blfread_sdbData")||[],fileType:"",dbcShow:!0}},watch:{pullType(e){console.log("dacval",e),e&&(this.outputDirectory="")},chartDataLoaded(e,t){e?(document.querySelector("body").style.cursor="",document.querySelector("#app").style.pointerEvents=""):(document.querySelector("body").style.cursor="wait",document.querySelector("#app").style.pointerEvents="none")}},computed:{pullDataValid(){return!!(this.blfDirectory&&this.outputDirectory&&this.onFlag)},quitConfirm(){return this.recLoading},dbcVerOpts(){return[...c.DEFAULT,{label:"自定义模板",value:"自定义模板",children:this.sdbCustom.length>0?this.sdbCustom.map((e=>({label:e.sdb,value:e.sdb,files:e.files,comments:e.comments}))):null}]},curTpl(){if("自定义模板"===this.dbcVal[0]){console.log("this.dbcVal",this.dbcVal);let e=this.sdbCustom.find((e=>e.sdb===this.dbcVal[1]));return{carType:"custom",sdb:this.dbcVal[1],files:e?.files,comments:e?.comments}}return{carType:this.dbcVal[0],sdb:this.dbcVal[1]}},endRec(){}},mounted(){r.report("trackPage",{page:"BLF文件格式转换",tip:"1174.11.0.1.29255"})},methods:{chooseBlfPath(){i.choosePath({directory:this.blfDirectory,dialogType:"OPEN_DIALOG",fileTypes:["支持的文件类型 (*.blf;*.BLF;*.asc;*.ASC)","BLF文件 (*.blf;*.BLF)","ASC文件 (*.asc;*.ASC)"],allow_multiple:!1}).then((e=>{e.data.directory&&(/\.dat$|\.mf4$|\.mdf$/i.test(e.data.directory)?this.fileType="mdf":/\.asc$/i.test(e.data.directory)?(this.fileType="asc",this.recList={blf:{label:"blf",size:"",paths:""}},this.dbcShow=!1,this.pullType="blf"):(this.fileType="blf",this.recList={mdf:{label:"mdf",size:"",paths:""},csv:{label:"csv",size:"",paths:"/persistence/vde/pool,/tmp/vde/pool"},asc:{label:"asc",size:"",paths:"/log/DiagMaster,/persistence/DiagMaster"}},this.dbcShow=!0,this.pullType="mdf"),this.blfDirectory=_(e.data.directory))}))},chooseOutputPath(){let e="",t="",s="",o="";"mdf"===this.pullType?(s=["MF4文件 (*.mf4;*.MF4)"],o="mf4"):"csv"===this.pullType?(s=["CSV文件 (*.csv;*.CSV)"],o="csv"):"blf"===this.pullType?(s=["BLF文件 (*.blf;*.BLF)"],o="blf"):(s=["ASC文件 (*.asc;*.ASC)"],o="asc"),console.log("fileTypes",s),console.log("fileTypes222",o),this.blfDirectory?(e=this.blfDirectory.replace(/[^\/]+$/,""),t=this.blfDirectory.split("/").pop().replace(/\.blf|\.asc$/,"."+o)):(e=window.downloadPath,t="tspa-convert."+o),console.log(1627,e,t),i.choosePath({directory:e,saveFilename:t,dialogType:"SAVE_DIALOG",fileTypes:s,allow_multiple:!1}).then((({data:e})=>{console.log("res>>>2",e),e.directory&&(this.outputDirectory=_(e.directory))}))},async startFormat(){this.onFlag=!1,this.chartDataLoaded=!1,this.consoleText="转换中...",r.report("track","click",{element_name:"开始转换",asset_name:this.directory+";"+this.dbcVal.join(),tip:"1174.11.0.1.29256"}),console.log("this.dbcVal>>>11",this.dbcVal),console.log("this.sdbCustom>>>11",this.sdbCustom),console.log("...this.curTpl>>>11",this.curTpl),"mdf"===this.pullType?await d.blfConvert.getDBC({...this.curTpl}).then((e=>{console.log("获取dbc信息",e.data);let t=e.data;0==t.code?this.startConvert():(this.consoleText+=t.msg+"\n",this.onFlag=!0,this.chartDataLoaded=!0)})).finally((()=>{this.consoleText=this.consoleText.replace(/^\s+/g,"")})):this.startConvert()},async startConvert(){await d.blfConvert.start_convert({in_path:_(this.blfDirectory),fmt:this.pullType,out_path:_(this.outputDirectory)}).then((e=>{let t=e.data;this.consoleText="",t.code,this.consoleText+="\n"+t.msg+"\n",console.log("开始转换",e.data)})).catch((e=>{this.consoleText+="\n转换中断\n"})).finally((()=>{this.onFlag=!0,this.consoleText=this.consoleText.replace(/^\s+/g,"")})),this.chartDataLoaded=!0}}},w=e=>(F("data-v-af588396"),e=e(),S(),e),x=["data-disabled"],k={class:"o-pul-er",id:"el-record-form"},B=w((()=>y("div",{class:"o-pul-title"},"格式转换配置",-1))),P={class:"o-pul-p choose-cation"},A=w((()=>y("span",{style:{color:"red"}},"* ",-1))),$=w((()=>y("span",{class:"record-header-message"},"源 文 件：",-1))),q={class:"o-pul-path"},z={key:0,class:"o-pul-p input-dbc-cation"},j=w((()=>y("span",{style:{color:"red"}},"* ",-1))),E=w((()=>y("span",{class:"record-header-message"},"DBC 版本：",-1))),O={class:"o-che-input"},M={class:"o-pul-p input-cation"},U=w((()=>y("span",{style:{color:"red"}},"* ",-1))),H=w((()=>y("span",{class:"record-header-message"},"输出格式：",-1))),N=["value"],I={class:"o-pul-p choose-out-cation"},G=w((()=>y("span",{style:{color:"red"}},"* ",-1))),R=w((()=>y("span",{class:"record-header-message"},"输出路径：",-1))),J={class:"o-pul-path"},K={class:"o-pul-p start-rec"},Q=w((()=>y("i",{class:"play-icon"},null,-1))),W=["data-empty"],X=w((()=>y("div",{class:"o-console-title"},"文件格式转换结果",-1))),Y=["data-loading"];e("default",l(t,[["render",function(e,t,s,o,a,l){const c=n("Header"),i=n("Button"),r=n("Cascader"),d=p("tooltip");return L(),h("div",{class:"format-conversion","data-disabled":!a.chartDataLoaded},[u(c,{title:"格式转换",quitConfirm:l.quitConfirm,showRight:!0,carNum:e.$props.store.connectCar.carNum,connectStatus:e.$props.store.connectCar.status,recentTest:e.$props.store.connectCar.latest},null,8,["quitConfirm","carNum","connectStatus","recentTest"]),y("div",k,[B,y("div",P,[A,$,u(i,{onClick:l.chooseBlfPath,class:"choose-path"},{default:b((()=>[m("选择文件（*.blf,*.asc）")])),_:1},8,["onClick"]),m("  "),f((L(),h("span",q,[m(g(a.blfDirectory),1)])),[[d,{content:a.blfDirectory,skidding:0,arrowPadding:9999},void 0,{"top-start":!0}]])]),"mdf"===a.pullType&&"blf"===a.fileType?(L(),h("div",z,[j,E,y("div",O,[u(r,{options:l.dbcVerOpts,modelValue:a.dbcVal,"onUpdate:modelValue":t[0]||(t[0]=e=>a.dbcVal=e)},null,8,["options","modelValue"])])])):v("",!0),y("div",M,[U,H,(L(!0),h(T,null,D(a.recList,((e,s)=>(L(),h("label",{class:"o-input record-header-message-imp",key:s},[f(y("input",{name:"pull_type",type:"radio","onUpdate:modelValue":t[1]||(t[1]=e=>a.pullType=e),value:s},null,8,N),[[V,a.pullType]]),m(g(e.label)+" "+g(e.size)+" ",1)])))),128))]),y("div",I,[G,R,u(i,{onClick:l.chooseOutputPath},{default:b((()=>[m("选择路径")])),_:1},8,["onClick"]),m("  "),f((L(),h("span",J,[m(g(a.outputDirectory),1)])),[[d,{content:a.outputDirectory,skidding:0,arrowPadding:9999},void 0,{"top-start":!0}]])]),y("div",K,[u(i,{type:"primary",disabled:!l.pullDataValid,progress:a.recLoadingProgress,loading:a.recLoading,onClick:l.startFormat},{default:b((()=>[Q,m(" 开始转换")])),_:1},8,["disabled","progress","loading","onClick"])])]),y("div",{class:"o-console-er","data-empty":""===a.consoleText,id:"el-record-console"},[X,f(y("div",{class:"o-console-body","data-loading":!a.chartDataLoaded},g(a.consoleText),9,Y),[[C,a.consoleText]])],8,W)],8,x)}],["__scopeId","data-v-af588396"]]))}}}));
