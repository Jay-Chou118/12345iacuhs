System.register(["./Header-legacy-d59e5bfc.js","./Button-legacy-f621dafe.js","./index-legacy-59a8d9a2.js"],(function(e,t){"use strict";var a,s,r,o,l,i,c,d,n,p,y,h,u,g,m,b,v,D,k,f,S;return{setters:[e=>{a=e.H},e=>{s=e.B},e=>{r=e._,o=e.k,l=e.j,i=e.e,c=e.r,d=e.l,n=e.c,p=e.h,y=e.d,h=e.i,u=e.a,g=e.w,m=e.t,b=e.v,v=e.F,D=e.m,k=e.o,f=e.p,S=e.b}],execute:function(){const t={props:["store"],components:{Button:s,Header:a},data:()=>({consoleText:"",errorNumber:0,directory:"",typeDirectory:"",onFlag:!0,resData:[],displayFlag:!0,chartDataLoaded:!0}),watch:{chartDataLoaded(e,t){e?(document.querySelector("#app").style.cursor="",document.querySelector(".back-icon").style.pointerEvents="",document.querySelector(".record-header").style.cursor="",document.querySelector(".o-pul-er").style.pointerEvents="",document.querySelector(".o-menu").style.pointerEvents=""):(document.querySelector("#app").style.cursor="wait",document.querySelector(".back-icon").style.pointerEvents="none",document.querySelector(".o-pul-er").style.pointerEvents="none",document.querySelector(".o-menu").style.pointerEvents="none")}},computed:{pullDataValid(){if(this.directory&&this.typeDirectory&&this.displayFlag)return console.log("this.displayFlag",this.displayFlag),!0;console.log("this.displayFlag222",this.displayFlag),this.$nextTick((()=>!1))}},mounted(){l.report("trackPage",{page:"诊断数据表检查",tip:"1174.12.0.1.29257"})},methods:{choosePath(){o.choosePath({directory:this.directory,dialogType:"OPEN_DIALOG",fileTypes:["XlSX文件 (*.xlsx;*.XlSX)"],allow_multiple:!1}).then((({data:e})=>{e.directory&&(this.directory=e.directory)}))},chooseType(){let e=this.directory||window.downloadPath+"/check.xlsx",t=e.replace(/[^\\]+$/,""),a=e.replace(t,"").replace(/\.xlsx/,".csv");o.choosePath({directory:t,saveFilename:a,dialogType:"SAVE_DIALOG",fileTypes:["CSV文件 (*.csv;*.CSV)"],allow_multiple:!1}).then((({data:e})=>{console.log("res>>>2",e),e.directory&&(this.typeDirectory=e.directory)}))},async startCheck(){this.resData=[],this.displayFlag=!1,this.chartDataLoaded=!1,l.report("track","click",{element_name:"开始检查",asset_name:this.directory+";",tip:"1174.12.0.1.29258"}),await i.ddbCheck.start_check({xlsx_path:this.directory,log_path:this.typeDirectory}).then((e=>{console.log("诊断数据表结果>>",e);let t=[];t=e.data,this.errorNumber=t.data.count,console.log("resp.data.err_info.split",t.data.err_info.split("\n"));let a=JSON.parse(JSON.stringify(t.data.err_info.split("\n"))),s=[],r={};a.length>0&&(s=a.map((e=>e.split(","))),s.forEach((e=>{r={errTit:e[0],servicesTit:e[1],issueTit:e[2],errTag:e[3],errSid:e[4],errSub:e[5]},this.resData.push(JSON.parse(JSON.stringify(r)))})),this.resData=Array.from(this.resData),this.displayFlag=!0,this.chartDataLoaded=!0,console.log("this.resData>>>",this.resData))})).finally((()=>{this.displayFlag=!0,this.chartDataLoaded=!0}))}}},C=e=>(f("data-v-f3030e13"),e=e(),S(),e),_={class:"diagnostics-data"},T={class:"o-pul-er",id:"el-record-form"},w=C((()=>y("div",{class:"o-pul-title"},"文件导入配置",-1))),F={class:"o-pul-p"},q=C((()=>y("span",{style:{color:"red"}},"* ",-1))),x=C((()=>y("span",{class:"record-header-message"},"对象文件：",-1))),L={class:"o-pul-path"},N={class:"o-pul-p"},P=C((()=>y("span",{style:{color:"red"}},"* ",-1))),E=C((()=>y("span",{class:"record-header-message"},"检查结果：",-1))),O={class:"o-pul-path"},V={key:0,class:"o-pul-p start-rec"},$=C((()=>y("i",{class:"play-icon"},null,-1))),j={key:1,class:"o-pul-p start-rec"},A=C((()=>y("i",{class:"stop-icon"},null,-1))),B=["data-empty"],H={class:"o-console-title"},J=["data-loading"],X={class:"o-table"},I={class:"o-table-tbody"},G={class:"o-table-cell o-width-short"},R={class:"o-table-cell o-width-short"},z={class:"o-table-cell o-width-short"},K={class:"o-table-cell o-width-short"},M={class:"o-table-cell"};e("default",r(t,[["render",function(e,t,a,s,r,o){const l=c("Header"),i=c("Button"),f=d("tooltip");return k(),n("div",_,[p(l,{title:"诊断数据表检查",quitConfirm:e.quitConfirm,showRight:!0,carNum:e.$props.store.connectCar.carNum,connectStatus:e.$props.store.connectCar.status,recentTest:e.$props.store.connectCar.latest},null,8,["quitConfirm","carNum","connectStatus","recentTest"]),y("div",T,[w,y("div",F,[q,x,p(i,{onClick:o.choosePath,disabled:!r.displayFlag,class:"choose-path"},{default:h((()=>[u("选择文件")])),_:1},8,["onClick","disabled"]),u("  "),g((k(),n("span",L,[u(m(r.directory),1)])),[[f,{content:r.directory,skidding:0,arrowPadding:9999},void 0,{"top-start":!0}]])]),y("div",N,[P,E,p(i,{onClick:o.chooseType,disabled:!r.displayFlag,class:"choose-path"},{default:h((()=>[u("保存到文件")])),_:1},8,["onClick","disabled"]),u("  "),g((k(),n("span",O,[u(m(r.typeDirectory),1)])),[[f,{content:r.typeDirectory,skidding:0,arrowPadding:9999},void 0,{"top-start":!0}]])]),r.onFlag?(k(),n("div",V,[p(i,{type:"primary",disabled:!o.pullDataValid,progress:e.recLoadingProgress,loading:e.recLoading,onClick:o.startCheck},{default:h((()=>[$,u("开始检查")])),_:1},8,["disabled","progress","loading","onClick"])])):(k(),n("div",j,[p(i,{type:"primary",disabled:!o.pullDataValid,progress:e.recLoadingProgress,loading:e.recLoading,onClick:e.endCheck},{default:h((()=>[A,u(" 暂停检查")])),_:1},8,["disabled","progress","loading","onClick"])]))]),y("div",{class:"o-console-er","data-empty":0===r.resData.length,id:"el-record-console"},[y("div",H,"检查结果: "+m(r.errorNumber)+" Error",1),g(y("div",{class:"o-console-body","data-loading":!r.chartDataLoaded},[y("table",X,[y("tbody",I,[(k(!0),n(v,null,D(r.resData,((e,t)=>(k(),n("tr",{key:t},[y("td",G,m(e.errTit),1),y("td",R,m(e.servicesTit),1),y("td",z,m(e.issueTit),1),y("td",K,m(e.errTag),1),y("td",M,m(e.errSid),1)])))),128))])])],8,J),[[b,r.resData.length>0]])],8,B)])}],["__scopeId","data-v-f3030e13"]]))}}}));
