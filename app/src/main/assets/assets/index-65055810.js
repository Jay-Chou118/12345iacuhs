import{S as G}from"./Spin-aacbc13d.js";import{B as z}from"./Button-42824390.js";import{A as J,W as Z,P as W}from"./ev-timeplot-8d96d7e1.js";import{M as K}from"./Message-31fb9a5a.js";import{H as q}from"./Header-2ae2bdc1.js";import{I as Y}from"./ImportFileDialog-3f6a0097.js";import{c as $}from"./index.es-d4006e13.js";import{_ as Q,q as ee,S as j,r as b,l as I,w as y,o as u,c as m,d as l,g as te,h as k,i as B,y as F,x as se,f,E as M,a as w,t as C,e as _,k as V,G as ie,j as U,A as T,F as E,m as le,n as N,v as ae,p as ne,b as oe}from"./index-165ba0b9.js";import{t as H}from"./signal-577d7bc6.js";import{n as L}from"./index-941f8b70.js";import{b as re}from"./CopyPath-44090f93.js";import{s as ce}from"./time-4b339df6.js";import{b as de}from"./num-b2a97d52.js";import{D as he}from"./DownloadMessage-ae523e7a.js";import{B as ue}from"./ButtonGroup-67e3e320.js";import"./Cascader-3eef8cdf.js";let P=0;const me={props:["signals","carType","sdb","isFilled","fileType","getDbcList","checkedListIndex"],emits:["connect","showMessage","getCarCode","cancel"],components:{Button:z,RecycleScroller:ee,Spin:G,Message:K},data(){return{inputStr:"",checkedList:[],selectNodeList:[],counter:0,lodingSpin:!1,isFlag:1,message:{visible:!1,level:"",content:""},listOpen:[],expandKeys:new Set([]),C2C:[]}},computed:{list(){let e=[],s=this,o=this.getDbcList;for(let t in o){let i;i={_id:+t,id:+t,text:this.C2C[t],node_type:"channel",children:[],set checked(a){i.children.forEach(c=>{c.checked=a})},get checked(){return!i.children.some(a=>a.checked==!1)},get indeterminate(){return i.children.some(a=>a.checked)&&i.children.some(a=>!a.checked)}};for(let a in o[t]){let c;c={_id:t+"_"+a,id:t+"_"+a,text:a=="-1"?"":a,node_type:"msg",channel:i.id,set checked(d){c.children.forEach(p=>{p.checked=d})},get checked(){return!c.children.some(d=>d.checked==!1)},get indeterminate(){return c.children.some(d=>d.checked)&&c.children.some(d=>!d.checked)},children:o[t][a].map(d=>{var n;let p;return p={_id:t+"_"+a+"_"+d[0],id:d[0],msg:a=="-1"?"-1":+((n=a.match(/0x\w+/))==null?void 0:n[0])||a,channel:i.id,text:d[0],node_type:"signal",comment:d[1],remark:d[2],set checked(g){g?s.checkedList.push(p):s.checkedList=s.checkedList.filter(D=>D._id!==p._id)},get checked(){return s.checkedList.some(g=>g._id===p._id)}},p})},i.children.push(c)}e.push(i)}let r=[];for(let t=0;t<e.length;t++){let i=e[t];if(i.id!=-1&&r.push(i),!(!this.inputStr&&!this.expandKeys.has(i.id)))for(let a=0;a<i.children.length;a++){let c=i.children[a];c.id[0]!="-"&&r.push(c);for(let d=0;d<c.children.length;d++){let p=c.children[d];r.push(p)}}}if(this.inputStr.length>0){const t=this.inputStr.toLowerCase();let i;try{i=new RegExp(t,"i")}catch(a){i={test(c){return~c.toLowerCase().indexOf(c.toLowerCase())}}}r=r.filter(a=>i.test(a.text)||a.comment&&i.test(a.comment)||a.remark&&i.test(a.remark))}return r},sdbVal(){return[this.carType,this.sdb]}},watch:{checkedListIndex:{handler(e){this.checkedList=[]},deep:!0},sdbVal:{handler(e){var r,t,i;let s=[];const o=this.$ls.get("blfread_sdbData")||[];if(this.carType==="custom"){let a=(r=o.find(c=>c.sdb===this.sdb))==null?void 0:r.comments;a&&(s=["",...a])}else s=((i=(t=j.DEFAULT.find(a=>a.value===this.$props.carType))==null?void 0:t.children.find(a=>a.value===this.$props.sdb))==null?void 0:i.comments)||[];this.C2C=s.map((a,c)=>"".concat("⓪①②③④⑤⑥⑦⑧⑨⑩⑪⑫⑬⑭⑮⑯⑰⑱⑲⑳㉑㉒㉓㉔㉕㉖㉗㉘㉙㉚㉛㉜㉝㉞㉟㊱"[c]).concat(a))},immediate:!0}},mounted(){},beforeUnmount(){},unmounted(){},methods:{showFirstChild(e){this.expandKeys.has(e.id)?this.expandKeys.delete(e.id):this.expandKeys.add(e.id)},clearTable(){this.checkedList=[],this.$emit("clearTable")},title4node(e){return H(e)},showMessage({level:e,content:s,timeout:o}){clearTimeout(P),e!=null&&(this.message.level=e),s!=null&&(this.message.content=s),this.message.visible=!0,o>0&&(P=setTimeout(()=>{this.message.visible=!1},o))},submit(){this.checkedList.length>80?this.showMessage({level:"error",content:"信号选择不能超过80项",timeout:3e3}):this.$emit("choose",this.checkedList)},highlightWord(e){if(!e)return e;const s=this.inputStr;if(!s)return e;const o=s.split(/\s+/g);var r,t=o.length,i;for(r=0;r<t;r++)try{i=new RegExp(o[r],"gi"),i.test(e)&&(e=e.replace(i,"<strong>$&</strong>"))}catch(a){i=o[r],e=e.replace(i,"<strong>$&</strong>")}return e}}},pe={class:"chs-er",ref:"root"},ge={class:"chs-list-er","data-loading":!1},fe=["onClick"],Ae=["id","onUpdate:modelValue","data-indeterminate"],Ce=["innerHTML"],be=["for"],_e=["id","onUpdate:modelValue","data-indeterminate"],ye=["innerHTML"],ke=["for"],we=["id","onUpdate:modelValue"],De=["innerHTML"],Se=["innerHTML"],ve={style:{position:"fixed",left:"89px","background-color":"#fff",height:"70px","line-height":"70px","border-top":"1px solid #e8e8e8"}};function xe(e,s,o,r,t,i){const a=b("RecycleScroller"),c=b("Message"),d=I("tooltip"),p=I("esc");return y((u(),m("div",pe,[y(l("input",{class:"chs-input-er",placeholder:"搜索信号名称/信号描述","onUpdate:modelValue":s[0]||(s[0]=n=>t.inputStr=n),onInput:s[1]||(s[1]=(...n)=>e.onChange&&e.onChange(...n)),draggable:!1},null,544),[[te,t.inputStr]]),l("div",ge,[k(a,{class:"chs-list",items:i.list,"item-size":28,"key-field":"_id"},{default:B(({item:n})=>[l("label",null,[n.node_type=="channel"&&n.id<=16?(u(),m("div",{key:0,style:{"margin-left":"1px"},class:F(!t.inputStr&&t.expandKeys.has(n.id)?"switch-open":"switch-close"),onClick:se(g=>i.showFirstChild(n),["stop","prevent"])},null,10,fe)):f("",!0),n.node_type=="channel"&&n.id<=16?y((u(),m("input",{key:1,style:{"margin-left":"3px"},id:n._id,type:"checkbox","onUpdate:modelValue":g=>n.checked=g,"data-indeterminate":n.indeterminate,"click.stop":""},null,8,Ae)),[[M,n.checked]]):f("",!0),n.node_type=="channel"&&n.id<=16?(u(),m("span",{key:2,class:"chs-node",innerHTML:i.highlightWord(n.text)},null,8,Ce)):n.node_type=="msg"?(u(),m("div",{key:3,for:n.children,style:{"text-indent":"2em","margin-left":"-15px"},class:"chs-node chs-node-item"},[y(l("input",{id:n._id,type:"checkbox","onUpdate:modelValue":g=>n.checked=g,"data-indeterminate":n.indeterminate,"click.stop":""},null,8,_e),[[M,n.checked]]),l("span",{class:"",innerHTML:i.highlightWord(n.text)},null,8,ye)],8,be)):n.node_type=="signal"?y((u(),m("div",{key:4,for:n._id,style:{"text-indent":"2em","margin-left":"-5px"},class:"chs-node chs-node-item"},[y(l("input",{id:n._id,type:"checkbox",class:"chs-node-checkbox","onUpdate:modelValue":g=>n.checked=g,"click.stop":""},null,8,we),[[M,n.checked]]),l("span",{class:"chs-node-signal",innerHTML:i.highlightWord(n.text)},null,8,De),w(" "),l("span",{class:"chs-node-comment",innerHTML:i.highlightWord(n.comment)},null,8,Se)],8,ke)),[[d,{content:i.title4node(n),html:!0},void 0,{right:!0}]]):f("",!0)])]),_:1},8,["items"])]),l("div",null,[l("div",ve,[l("div",{class:F(t.checkedList.length>80?"chs-ft-label-len":"chs-ft-label"),style:{"text-align":"center","line-height":"70px"}},"（"+C(t.checkedList.length)+"/80）",3),l("div",{class:"chs-btn confirm",onClick:s[2]||(s[2]=(...n)=>i.submit&&i.submit(...n))},"确认"),l("div",{class:"chs-btn cancel",onClick:s[3]||(s[3]=(...n)=>i.clearTable&&i.clearTable(...n))},"重置")])]),k(c,{message:t.message},null,8,["message"])])),[[p,()=>e.$emit("cancel")]])}const Te=Q(me,[["render",xe],["__scopeId","data-v-320e6286"]]);let X=[];window.rowData=X;let R=0;const Be={props:["store","closeFlag"],emits:["connect","showMessage","getCarCode"],components:{Button:z,Header:q,ImportFileDialog:Y,Spin:G,ButtonGroup:ue,Draggable:$,ChooseSignal:Te,AddOrSelector:J,TimePlotMulti:Z,ProgressBar:W,Message:K,DownloadMessage:he},data(){var s,o,r;let e=(s=this.$ls.get("blfread_treeData"))==null?void 0:s.map(t=>({...t,checkedListIndex:[],carType:t.carType||"MS11",sdb:t.sdb||"E4",children:t.children.map(i=>({...i,warning:!1,pid:t.id,color:i.color||"blue"})),signals:{}}));if((!e||(e==null?void 0:e.length)===0)&&(e=[]),e=e.filter(t=>!(t.carType==="MS11"&&t.sdb==="E4U1"&&t.text==="默认视图"&&t.children.length===0)),!e.some(t=>t.carType==="MS11"&&t.sdb==="E4U1")){let t=Date.now();e.push({id:t,text:"默认视图",type:"view",editable:!1,carType:"MS11",sdb:"E4U1",deleteConfirm:!1,children:[{id:"PwrModSts",msg:198,channel:3,text:"PwrModSts",node_type:"signal",comment:"PowerMode Status",remark:"VCCD::BCP/BCS/EPS/SCUC/SWM::VCCD_ChassisCANFD_0xC6::PwrModSts::CANFD signal",checked:!0,_id:"3-3_VCCD_ChassisCANFD_0xC6(0xc6)-PwrModSts",pid:t,color:"purple"},{id:"VCUActGearLvr",msg:198,channel:3,text:"VCUActGearLvr",node_type:"signal",comment:"Actual gear level 车辆实际档位\\\\nP R N D挡位",remark:"VCCD::BCP/BCS/EPS/SCUC/SWM::VCCD_ChassisCANFD_0xC6::VCUActGearLvr::CANFD signal",checked:!0,_id:"3-3_VCCD_ChassisCANFD_0xC6(0xc6)-VCUActGearLvr",pid:t,color:"blue",warning:!1},{id:"VCUAccrPedlRat",msg:198,channel:3,text:"VCUAccrPedlRat",node_type:"signal",comment:"加速油门踏板开度",remark:"VCCD::BCP/BCS/EPS/SCUC/SWM::VCCD_ChassisCANFD_0xC6::VCUAccrPedlRat::CANFD signal",checked:!0,_id:"3-3_VCCD_ChassisCANFD_0xC6(0xc6)-VCUAccrPedlRat",pid:t,color:"cerulean",warning:!1},{id:"HvBattSoCAct",msg:449,channel:5,text:"HvBattSoCAct",node_type:"signal",comment:"HV battery SoC actual",remark:"BMS::VCCD/VECU::BMS_PTCANFD_0x1C1::HvBattSoCAct::CANFD signal",checked:!0,_id:"5-5_BMS_PTCANFD_0x1C1(0x1c1)-HvBattSoCAct",pid:t,color:"cyan",warning:!1},{id:"VehSpd",msg:179,channel:3,text:"VehSpd",node_type:"signal",comment:"Vehicle speed",remark:"BCS::ADD/VCCD/BCP/EPS/SCUC/SWM::BCS_ChassisCANFD_0xB3::VehSpd::CANFD signal",checked:!0,_id:"3-3_BCS_ChassisCANFD_0xB3(0xb3)-VehSpd",pid:t,color:"green",warning:!1},{id:"SwtHiBeam",msg:419,channel:3,text:"SwtHiBeam",node_type:"signal",comment:"组合开关远光灯请求命令",remark:"SWM::BCP/BCS/VCCD::SWM_ChassisCANFD_0x1A3::SwtHiBeam::CANFD signal",checked:!0,_id:"3-3_SWM_ChassisCANFD_0x1A3(0x1a3)-SwtHiBeam",pid:t,color:"lime",warning:!1}]})}return this.$ls.set("blfread_treeData",e),{filteredItems:[],filteredList:[],fileType:"blf",blfcpp:"cpp",downloadMessage:{show:!1,path:""},message:{visible:!1,level:"",content:""},modal:{title:"导入文件",visible:!1},treeData:e.map(t=>(t.children.forEach(i=>{i.warning=!1}),t)),curView:{label:(o=e[0])==null?void 0:o.text,value:0,tag:(r=e[0])==null?void 0:r.sdb},C2C:[],sdb:"E4U2",directory:"",carType:"MS11",directorySize:{label:"",value:0,durationMaybe:0,durationMaybeLabel:"0秒"},backBlock:!1,chartDataLoaded:!0,timeDataShow:!1,waitChart:{},fileChoosed:!1,traceList:new Map,timeData:[],changeTabs:!0,tableList:[],channelVersion:[{label:"全部",value:""}],channelVal:"全部",ECUVersion:[{label:"全部",value:""}],ECUVal:"全部",canIdsVersion:[{label:"全部",value:""}],canIdsVal:"全部",filterTableList:[],showDotsFrame:!1,modeOptions:[{label:"分散",value:"single"},{label:"对齐",value:"same"},{label:"聚合",value:"shifted"}],chartMode:"single",startTime:0,rowData:[],barChartData:[],count:0,tableDataFlag:!1,debug:window._debug,saerchList:[],flag:!1,chooseSignalAble:!1,signObj:{},signList:[],sigGrpValList:[],getDbcList:{},isFilled:!1,timeDataVisiable:!0,paramsSig:[],initAreas:[],initPots:[],timeShow:!1,tableLoading:!1,chooseLoading:!1}},computed:{sdbVal(){return[this.carType,this.sdb]},quitConfirm(){return!!this.directory.trim()},carTypeLabel(){return this.carType&&this.carType!=="custom"?this.carType+" / ":""},view(){return this.treeData[this.curView.value]},directoryLabel(){let e=this.directory.split("/").pop();return e.length>25?e.slice(0,10)+"..."+e.slice(-15):e},fileType_CarType(){return[this.fileType,this.carType]}},mounted(){U.report("trackPage",{page:"E2E校验",tip:"1174.15.0.1.31310"}),this.chooseSignalAble=!0,this.debug=!!window._debug,X=[],this.SDBLoading=!0,_.ete.getDBC({carType:this.carType,sdb:this.sdb}).then(e=>{window._sdb=e.data}).finally(()=>{this.SDBLoading=!1})},beforeUnmount(){this.timeData={}},unmounted(){_.blf.freeSpace()},watch:{saerchList:{handler(e){window._sdb=e},deep:!0},fileType_CarType(){this.fileType==="mdf"?this.blfcpp="cpp":this.debug||(this.carType==="custom"?this.blfcpp="python":this.blfcpp="cpp")},blfcpp:{handler(e){window._blfcpp=e},immediate:!0},sdbVal:{handler(e){var r,t,i;let s=[];const o=this.$ls.get("blfread_sdbData")||[];if(this.carType==="custom"){let a=(r=o.find(c=>c.sdb===this.sdb))==null?void 0:r.comments;a&&(s=["",...a])}else s=((i=(t=j.DEFAULT.find(a=>a.value===this.carType))==null?void 0:t.children.find(a=>a.value===this.sdb))==null?void 0:i.comments)||[];this.C2C=s.map((a,c)=>"".concat("⓪①②③④⑤⑥⑦⑧⑨⑩⑪⑫⑬⑭⑮⑯⑰⑱⑲⑳㉑㉒㉓㉔㉕㉖㉗㉘㉙㉚㉛㉜㉝㉞㉟㊱"[c]).concat(a))},immediate:!0},treeData:{handler(e,s){JSON.stringify(this.$ls.get("blfread_treeData"))!==JSON.stringify(e)&&this.$ls.set("blfread_treeData",e)},deep:!0},directory:{async handler(e){const s=await V.getFileSize(e),o=.83*.2,r=Math.round((1678e-19*s*s+1768e-10*s+.5581)*o);this.directorySize={label:re(s),value:s,durationMaybe:r*1e3,durationMaybeLabel:ce(r)}}}},methods:{onUpdateDefaultOptions(e){console.log("getDBC",e),window._sdb=e},onFilledChange(e){e==!0?(this.fileType==="asc"?window._sdb=this.ascHaveDataList:window._sdb=this.haveDataList,this.isFilled=!0):e==!1&&(this.carType!="custom"?this.fileType==="asc"?window._sdb=this.getDbcList:window._sdb=this.getDbcList:this.fileType==="asc"?window._sdb=this.getDbcList:window._sdb=this.getDbcList,this.isFilled=!1)},timeCheck:ie(function(s,o){this.traceList=new Map,this.timeData=[],this.timeShow=!0,this.timeDataShow=!0,this.paramsSig=s,this.timeDataVisiable=!1,o=="time"&&(this.initAreas=[{name:"startTime",key:"startValue",color:"#ff557a",value:[s[3][0],s[3][1]]}],this.initPots=[{name:s[4],key:"end",color:"#ff557a",value:s[3][1]}],this.play())},1e3,{leading:!0}),title4node(e){return H(e)},showMessage({level:e,content:s,timeout:o}){clearTimeout(R),e!=null&&(this.message.level=e),s!=null&&(this.message.content=s),this.message.visible=!0,o>0&&(R=setTimeout(()=>{this.message.visible=!1},o))},hideMessage(){this.message.visible=!1},onTreeDataChange(){this.treeData=this.$ls.get("blfread_treeData")},resetTimeData(){this.directory="",this.backBlock=!1,this.chartDataLoaded=!0,this.waitChart={},this.fileChoosed=!1,this.traceList=new Map,this.timeData={},this.filteredItems=[],this.timeDataVisiable=!0},clearTableData(){this.timeData={},this.traceList=new Map,this.timeDataVisiable=!0,this.filteredItems=[]},choosePath(){/\.blf$/i.test(this.directory)?(this.chartDataLoaded=!1,this.clearTimeData(),_.blf.getBLFdata({blfFile:this.directory}).then(async e=>{this.fileChoosed=!0,this.treeData.forEach(o=>{this.waitChart[o.id]=!0});let s=this.treeData.slice();s.splice(this.curView.value,1),s.unshift(this.treeData[this.curView.value]),s=s.filter(o=>o.carType===this.carType&&o.sdb===this.sdb);for(let o=0;o<s.length;o++)await this.play(s[o]),o===0&&(this.chartDataLoaded=!0)}).catch(()=>{}).finally(()=>{this.chartDataLoaded=!0})):/\.mf4$|\.dat$|\.mdf$/i.test(this.directory)&&(async()=>{this.chartDataLoaded=!1,this.clearTimeData(),this.fileChoosed=!0,this.treeData.forEach(s=>{this.waitChart[s.id]=!0});let e=this.treeData.slice();e.splice(this.curView.value,1),e.unshift(this.treeData[this.curView.value]),e=e.filter(s=>s.carType===this.carType&&s.sdb===this.sdb),await this.play(this.treeData[this.curView.value]);for(let s=0;s<e.length;s++)await this.play(e[s]),s===0&&(this.chartDataLoaded=!0)})()},clearTimeData(){for(let e in this.timeData)this.timeData[e]=[];this.treeData.forEach(e=>{e.children.forEach(s=>{s.warning=void 0})})},async play(e,s){if(this.blfcpp="python",this.blfcpp==="python"){if(s){this.loadChart(e,s);return}let o;try{let t=[];t.push({busId:+this.paramsSig[0],canId:+this.paramsSig[1],name:this.paramsSig[2]}),o=await _.ete.getSigGrpVal({params:t}),this.timeDataShow=!1,o.data.data.length==0&&this.showMessage({level:"success",content:"表格信号为空",timeout:5e3})}catch(t){this.waitChart[e.id]=!1;return}const r={};for(let t in o.data.data){const i=o.data.data[t];let a=!0,c=Object.freeze(i[3].map(d=>{if(Number.isSafeInteger(parseInt(d[1])))return parseFloat(d[1]);{a=!1;let p=parseFloat(d[1]),n=new Number(p);return n.valueOf=()=>p,n.toString=()=>"0x"+de(d[1]),n}}));this.traceList.set(i[0]+"_"+i[2],{name:this.C2C[+i[0]]+"-"+i[2],t:Object.freeze(i[3].map(d=>Math.round(d[0][0]*1e3)/1e3)),v:c,enums:i[4],cycle:i[5],safe:a,color:"#2266ff"}),r[i[0]+"_"+i[2]]=i[3].length}this.loadChart();return}},loadChart(){let e=this.traceList.values();for(let s of e)this.timeData.push(s)},updateSignal(e,s){this.tableLoading=!0,this.signals=e,e.forEach((o,r)=>{let t={};const i=/\((.*?)\)/g;let d=(+e[r]._id.match(i).map(n=>n.replace(/\(|\)/g,""))).toString(16);t.busId=e[r].channel;let p="0x".concat(d);t.canId=p,t.name=e[r].text,this.signList.push(t)}),_.ete.getAnalysisByParams(this.signList).then(o=>{this.filteredItems=o.data.data,this.tableLoading=!1,o.data.data.length==0&&this.showMessage({level:"success",content:"信号检查结果暂无错误",timeout:5e3}),this.signList=[]})},formatTime(e){const s=new Date(e),o=s.getHours().toString().padStart(2,"0"),r=s.getMinutes().toString().padStart(2,"0"),t=s.getSeconds().toString().padStart(2,"0");return"".concat(o,":").concat(r,":").concat(t)},goBackHome(){this.$router.push({path:"/"})},importFile(){this.modal.visible=!0},onCancelImportFile(){this.modal.visible=!1},onCheckView(e){this.checkedListIndex=[],this.resetTimeData(),this.chooseLoading=!0,this.modal.visible=!1;let o=this.treeData.filter(r=>r.id===e.curId).map(r=>({label:r.text,value:this.treeData.findIndex(t=>t.id===e.curId)}));this.curView=o[0],this.carType=e.carType,this.sdb=e.sdb,this.directory=L(e.directory),this.files=e.files.length?e.files:void 0,this.comments=e.comments.length?e.comments:void 0,this.fileType=e.fileType,this.$nextTick(async()=>{this.carType==="custom"?_.ete.getDBC({carType:this.carType,sdb:this.sdb,files:this.files,comments:this.comments}).then(r=>{window._sdb=r.data,this.getDbcList=window._sdb,console.log("this.getDbcList1111",this.getDbcList),Object.keys(this.getDbcList).length==0&&this.showMessage({level:"success",content:"导入文件暂无信号",timeout:5e3}),this.flag=!0,this.chooseSignalAble=!1,_.ete.getBlfdata({blfFile:e.directory}).then(t=>{this.chooseLoading=!1})}).finally(()=>{this.SDBLoading=!1}):(this.getDbcList=window._sdb,console.log("this.getDbcList22222",this.getDbcList),Object.keys(this.getDbcList).length==0&&this.showMessage({level:"success",content:"导入文件暂无信号",timeout:5e3}),this.getDbcList=window._sdb,this.flag=!0,this.chooseSignalAble=!1,await _.ete.reAdjust(e.sendReAdjust),await _.ete.getBlfdata({blfFile:e.directory}).then(r=>{this.chooseLoading=!1})),this.modal.visible=!1}),U.report("track","click",{element_name:"E2E校验",asset_name:this.directory+";",tip:"1174.15.0.1.31311"})},tenTosixteen(e){return"0x"+e.toString(16)},onExportArea(e,s){const o=this.view.children.filter(a=>a.warning===!1),r=this.timeData[this.view.id];let t="csv",i="CSV文件 (*.csv;*.CSV)";switch(e.type){case"blf":t="blf",i="BLF文件 (*.blf;*.BLF)";break;case"mdf":t="mf4",i="MDF文件 (*.mf4;*.MF4)";break;case"mat":t="mat",i="MAT文件 (*.mat;*.MAT)";break}V.choosePath({directory:this.directory.replace(/\/[^\/]+$/,""),saveFilename:this.directory.match(/\/([^\/]+)$/)[1].replace(/.blf|.dat|.mf4/i,"_cut-".concat(e.start,"-").concat(e.end,".").concat(t)),dialogType:"SAVE_DIALOG",fileTypes:[i],allow_multiple:!1}).then(a=>{if(a.data.directory){const c=L(a.data.directory),d=L(this.directory),p=r.map((n,g)=>{const D=n.t.findIndex(S=>S>=e.start),x=n.t.length-n.t.slice().reverse().findIndex(S=>S<=e.end);return{busId:s==="blf"?o[g].channel:null,busName:s==="blf"?this.C2C[+o[g].channel].slice(1):null,canId:s==="blf"?o[g].msg:null,cycle:s==="blf"?n.cycle:null,enums:n.enums,name:o[g].text,times:n.t.slice(D,x),values:n.v.slice(D,x)}});this.showMessage({level:"loading",content:"导出中..."}),_.blf.exportFile({filePath:d,outputFilePath:c,type:e.type,resampleRate:e.resampleRate,startTime:e.startTime,endTime:e.endTime,data:p}).then(n=>{this.showMessage({level:"success",content:"导出成功",timeout:2e3}),this.downloadMessage.path=c,this.downloadMessage.show=!0}).catch(n=>{this.showMessage({level:"error",content:"导出失败",timeout:2e3})})}})}}},A=e=>(ne("data-v-490f6254"),e=e(),oe(),e),Me={class:"blf-check"},Le=A(()=>l("i",{class:"lead-icon"},null,-1)),Ie={key:0},Fe={key:1},Ve={class:"record-header-message"},Ue={class:"record-header-message-imp"},Ee={class:"record-header-message-imp"},Ne={class:"o-pul-er"},Pe={class:"o-column"},Re={class:"o-column-left"},Ge=A(()=>l("div",{class:"o-resize-bar"},null,-1)),ze=A(()=>l("div",{class:"o-resize-line"},null,-1)),Ke={class:"o-resize-save"},Qe={key:0,class:"o-pul-button-wrap-icon"},je=A(()=>l("img",{class:"text-muted-ing-data",src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAKAAAACICAMAAABX7hBEAAAAM1BMVEUAAAD////Nzc0MDAyXl5cAAAAAAAC9vb3t7e0BAQF1dXUAAAApKSkAAABBQUFXV1cAAACKKc10AAAAEXRSTlMATExMTAk1TExBTCFLF0tMKkK5GFYAAAL4SURBVHja7JntauswDIZty7Is+fP+r/Y0dUOz0BZzMKkGe35sMFh5Kr2Sndb88cd/gR2NahBAuWJolZNmxd6iz1z0KiJEGwVCMVoBsvauqLWIQaxVrZhqtHeoscqBRiY7iJRVDjSL3dkGWt+09GqtasUCWSg+FSUrm5ZQJUNuPu6STtdAF/DOkVSAKm5XbIpOaG7uDvmWAZqPyhQLkCM3oFFI726SkZRcIoKQ5NrEE9HTUShuA63ghC5ADUC27kJum+febPFRwSUCueXsx32BvNThKeLvhczef3ugE0AlqmIHMUbnpQ3P2mD7Bd9URIZKzkmN9shNc5TzwfcuER2g3aiwC548yUvLQ9FcDqIxKQyA7FuirwAczLVgCpyOu+aNHEkGDpfvQ+zMHfF8aT33V2re5C7PHyY+bzfM7ly5BkPuepC5mDPsj3J1tPU7lJc7I4gKuRuJy8s/55WZW+9nkBXI3Sic3pknDZ9+4M1PNV3To8YLEEopGjr5jgDAzOoee3ewj8egpNQQGcIjiWwUgtz3EUaNJcQQnl5B4bIJwSCjGfRutFEYN0G9FeRkNkG1GUTAg1didbu6h/vPIVYUHsgjdBg4lRQU+u3NxcSs8oN81Be6Xyeobq/sfGkzY5ilvDjbSljF+74kaDJDYxxOxxBy80uon5IdMrkZHi+CgMcnYLuEnD7Gvk0ZUu6nECKLXQJ9Xg2Fxc3gYRwiz3+ENQWMNU18PzSBAP6cr1UFBDSf6UBzhj9akfIVBRyEOhfDGtAsT6Df3/aiQdlJdVEBnyO8alAG7C8p4E6ajSHg4gRCMlP0PNfk9tjXqwu4OoYpX5bAHZyP4dICmhMr9nUxfXkBlw4K/2vfXlIABKEAikbaR7P9b7d5kxREDM5dwVGcPNS71wbm1PhmI1ZVQjn6FK7GoXx0rRNOipULj2eX4r60AteqQqcjCAgICAgICAgICAgICAgICAgICAgICAgICAgI+BdgHn3buX1/XJmr9AZus7VIkiRJD2y6ViB4C1+1AAAAAElFTkSuQmCC",alt:""},null,-1)),He=A(()=>l("td",{class:"text-center text-muted-data"},"请先导入文件",-1)),Xe=[je,He],Oe={key:1,class:"spin-loding-Choose"},Je={key:2,class:"spin-Choose-style"},Ze=A(()=>l("div",{class:"spin-import-style"},"文件导入中",-1)),We={class:"o-pul-button-wrap"},qe={class:"o-column-right"},Ye=A(()=>l("div",{class:"timechart-hotkey"},[l("div",{class:"hotkey-more"}," 信号检查结果 "),l("div",{style:{"margin-right":"20px",color:"#F38709"}})],-1)),$e={style:{display:"flex","flex-direction":"column",height:"calc(100vh - 220px)"}},et={style:{margin:"0 20px"}},tt={class:"hotkey-more-table",style:{width:"100%",height:"230px"}},st={style:{width:"100%",height:"200px"}},it={key:0,class:"spin-loding-bc"},lt={key:1,class:"spin-loding-style"},at=A(()=>l("thead",{style:{"background-color":"#FAFAFA"}},[l("tr",{class:"check-table"},[l("th",{style:{width:"5%"}},[l("div",{style:{"min-width":"100px"}},"通道名")]),l("th",{style:{width:"8%"}},[l("div",{style:{"min-width":"100px"}},"canID")]),l("th",{style:{width:"15%"}},[l("div",{style:{"min-width":"150px"}},"信号组名")]),l("div",{class:"time-line"}),l("th",{style:{width:"15%"}},[l("div",{style:{"min-width":"150px"}},"时间戳/时间段")]),l("div",{class:"time-line"}),l("th",{style:{width:"10%"}},[l("div",{style:{"min-width":"150px"}},"错误类型")]),l("div",{class:"time-line"}),l("th",{style:{width:"50%"}},[l("div",{style:{"min-width":"200px"}},"错误描述")])])],-1)),nt={key:0,class:"o-pul-button-wrap-icon"},ot=A(()=>l("img",{class:"text-muted-ing-data",src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAKAAAACICAMAAABX7hBEAAAAM1BMVEUAAAD////Nzc0MDAyXl5cAAAAAAAC9vb3t7e0BAQF1dXUAAAApKSkAAABBQUFXV1cAAACKKc10AAAAEXRSTlMATExMTAk1TExBTCFLF0tMKkK5GFYAAAL4SURBVHja7JntauswDIZty7Is+fP+r/Y0dUOz0BZzMKkGe35sMFh5Kr2Sndb88cd/gR2NahBAuWJolZNmxd6iz1z0KiJEGwVCMVoBsvauqLWIQaxVrZhqtHeoscqBRiY7iJRVDjSL3dkGWt+09GqtasUCWSg+FSUrm5ZQJUNuPu6STtdAF/DOkVSAKm5XbIpOaG7uDvmWAZqPyhQLkCM3oFFI726SkZRcIoKQ5NrEE9HTUShuA63ghC5ADUC27kJum+febPFRwSUCueXsx32BvNThKeLvhczef3ugE0AlqmIHMUbnpQ3P2mD7Bd9URIZKzkmN9shNc5TzwfcuER2g3aiwC548yUvLQ9FcDqIxKQyA7FuirwAczLVgCpyOu+aNHEkGDpfvQ+zMHfF8aT33V2re5C7PHyY+bzfM7ly5BkPuepC5mDPsj3J1tPU7lJc7I4gKuRuJy8s/55WZW+9nkBXI3Sic3pknDZ9+4M1PNV3To8YLEEopGjr5jgDAzOoee3ewj8egpNQQGcIjiWwUgtz3EUaNJcQQnl5B4bIJwSCjGfRutFEYN0G9FeRkNkG1GUTAg1didbu6h/vPIVYUHsgjdBg4lRQU+u3NxcSs8oN81Be6Xyeobq/sfGkzY5ilvDjbSljF+74kaDJDYxxOxxBy80uon5IdMrkZHi+CgMcnYLuEnD7Gvk0ZUu6nECKLXQJ9Xg2Fxc3gYRwiz3+ENQWMNU18PzSBAP6cr1UFBDSf6UBzhj9akfIVBRyEOhfDGtAsT6Df3/aiQdlJdVEBnyO8alAG7C8p4E6ajSHg4gRCMlP0PNfk9tjXqwu4OoYpX5bAHZyP4dICmhMr9nUxfXkBlw4K/2vfXlIABKEAikbaR7P9b7d5kxREDM5dwVGcPNS71wbm1PhmI1ZVQjn6FK7GoXx0rRNOipULj2eX4r60AteqQqcjCAgICAgICAgICAgICAgICAgICAgICAgICAgI+BdgHn3buX1/XJmr9AZus7VIkiRJD2y6ViB4C1+1AAAAAElFTkSuQmCC",alt:""},null,-1)),rt=A(()=>l("td",{class:"text-center text-muted-data"},"请先选择信号并确认",-1)),ct=[ot,rt],dt=["onClick"],ht=["onClick"],ut=["onClick"],mt=["onClick"],pt=A(()=>l("i",{class:"home-icon home-icon-ete-move"},null,-1)),gt=["onClick"],ft=["onClick"],At={class:"hotkey-more-table",style:{"margin-left":"0","margin-right":"0","margin-top":"15px",height:"100%","flex-grow":"1",border:"0 solid"}},Ct={key:0,class:"board-spin-er"},bt=A(()=>l("div",{class:"board-spin-text"},"正在解析文件…",-1)),_t=[bt],yt={style:{width:"100%",height:"100%"}},kt=A(()=>l("div",{class:"check-table-line"},[l("i",{class:"signal-analyse"}),w(" 信号回放 ")],-1)),wt={class:"timechart-er",style:{width:"100%",height:"100%",display:"flex","flex-direction":"column"}},Dt={class:"tch-tool-blank-er"},St=A(()=>l("div",{class:"tch-tool-span"},null,-1)),vt=A(()=>l("div",{class:"tch-tool-span"},null,-1)),xt=["id"],Tt={key:0,class:"o-pul-button-wrap-icon",style:{top:"20%"}},Bt=A(()=>l("img",{class:"text-muted-ing-data",src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAKAAAACICAMAAABX7hBEAAAAM1BMVEUAAAD////Nzc0MDAyXl5cAAAAAAAC9vb3t7e0BAQF1dXUAAAApKSkAAABBQUFXV1cAAACKKc10AAAAEXRSTlMATExMTAk1TExBTCFLF0tMKkK5GFYAAAL4SURBVHja7JntauswDIZty7Is+fP+r/Y0dUOz0BZzMKkGe35sMFh5Kr2Sndb88cd/gR2NahBAuWJolZNmxd6iz1z0KiJEGwVCMVoBsvauqLWIQaxVrZhqtHeoscqBRiY7iJRVDjSL3dkGWt+09GqtasUCWSg+FSUrm5ZQJUNuPu6STtdAF/DOkVSAKm5XbIpOaG7uDvmWAZqPyhQLkCM3oFFI726SkZRcIoKQ5NrEE9HTUShuA63ghC5ADUC27kJum+febPFRwSUCueXsx32BvNThKeLvhczef3ugE0AlqmIHMUbnpQ3P2mD7Bd9URIZKzkmN9shNc5TzwfcuER2g3aiwC548yUvLQ9FcDqIxKQyA7FuirwAczLVgCpyOu+aNHEkGDpfvQ+zMHfF8aT33V2re5C7PHyY+bzfM7ly5BkPuepC5mDPsj3J1tPU7lJc7I4gKuRuJy8s/55WZW+9nkBXI3Sic3pknDZ9+4M1PNV3To8YLEEopGjr5jgDAzOoee3ewj8egpNQQGcIjiWwUgtz3EUaNJcQQnl5B4bIJwSCjGfRutFEYN0G9FeRkNkG1GUTAg1didbu6h/vPIVYUHsgjdBg4lRQU+u3NxcSs8oN81Be6Xyeobq/sfGkzY5ilvDjbSljF+74kaDJDYxxOxxBy80uon5IdMrkZHi+CgMcnYLuEnD7Gvk0ZUu6nECKLXQJ9Xg2Fxc3gYRwiz3+ENQWMNU18PzSBAP6cr1UFBDSf6UBzhj9akfIVBRyEOhfDGtAsT6Df3/aiQdlJdVEBnyO8alAG7C8p4E6ajSHg4gRCMlP0PNfk9tjXqwu4OoYpX5bAHZyP4dICmhMr9nUxfXkBlw4K/2vfXlIABKEAikbaR7P9b7d5kxREDM5dwVGcPNS71wbm1PhmI1ZVQjn6FK7GoXx0rRNOipULj2eX4r60AteqQqcjCAgICAgICAgICAgICAgICAgICAgICAgICAgI+BdgHn3buX1/XJmr9AZus7VIkiRJD2y6ViB4C1+1AAAAAElFTkSuQmCC",alt:""},null,-1)),Mt=A(()=>l("div",{class:"text-center text-muted-data"},"请先选中表格内信号",-1)),Lt=[Bt,Mt];function It(e,s,o,r,t,i){const a=b("Button"),c=b("Header"),d=b("Spin"),p=b("ChooseSignal"),n=b("ButtonGroup"),g=b("TimePlotMulti"),D=b("ImportFileDialog"),x=b("Message"),S=b("DownloadMessage"),O=I("tooltip");return u(),m(E,null,[l("div",Me,[k(c,{title:"E2ECheck",quitConfirm:i.quitConfirm,backBlock:t.backBlock},{default:B(()=>[k(a,{type:"primary",class:"header-import-btn",onClick:i.importFile},{default:B(()=>[Le,w("导入文件")]),_:1},8,["onClick"]),t.debug?(u(),m("label",Ie,[y(l("input",{type:"radio","onUpdate:modelValue":s[0]||(s[0]=h=>t.blfcpp=h),value:"python"},null,512),[[N,t.blfcpp]]),w("python")])):f("",!0),t.debug?(u(),m("label",Fe,[y(l("input",{type:"radio","onUpdate:modelValue":s[1]||(s[1]=h=>t.blfcpp=h),value:"cpp"},null,512),[[N,t.blfcpp]]),w("cpp")])):f("",!0),l("span",Ve,[w(" BLF文件："),l("span",Ue,C(i.directoryLabel||"--"),1),y(l("span",{style:{color:"#333","text-shadow":"0 0.3px currentColor"}},"（"+C(t.directorySize.label)+"）",513),[[ae,t.directorySize.value]]),w("  DBC配置："),l("span",Ee,C(i.carTypeLabel)+C(t.sdb||"--"),1)])]),_:1},8,["quitConfirm","backBlock"]),l("div",Ne,[l("div",Pe,[l("div",Re,[Ge,ze,l("div",Ke,[Object.keys(t.getDbcList).length===0?(u(),m("div",Qe,Xe)):f("",!0),t.chooseLoading?(u(),m("div",Oe)):f("",!0),t.chooseLoading?(u(),m("div",Je,[k(d,{style:{"z-index":"150"}}),Ze])):f("",!0),l("div",We,[t.flag?(u(),T(p,{key:0,signals:i.view.children,onClearTable:i.clearTableData,onFilledChange:s[2]||(s[2]=h=>i.onFilledChange(h)),checkedListIndex:e.checkedListIndex,getDbcList:t.getDbcList,isFilled:t.isFilled,onChoose:s[3]||(s[3]=h=>i.updateSignal(h,i.view)),carType:t.carType,fileType:t.fileType,sdb:t.sdb},null,8,["signals","onClearTable","checkedListIndex","getDbcList","isFilled","carType","fileType","sdb"])):f("",!0)])])]),l("div",qe,[Ye,l("div",$e,[l("div",et,[l("div",tt,[l("table",st,[t.tableLoading?(u(),m("div",it)):f("",!0),t.tableLoading?(u(),m("div",lt,[k(d,{style:{"z-index":"1500"}})])):f("",!0),at,l("tbody",{class:F(t.filteredItems.length==0?"":"tbody-scoll")},[t.filteredItems.length==0?(u(),m("div",nt,ct)):f("",!0),(u(!0),m(E,null,le(t.filteredItems,h=>(u(),m("tr",{key:h.id,class:"check-table"},[l("td",{style:{width:"5%"},onClick:v=>i.timeCheck(h,"time"),class:"errListStykl"},C(h[0]),9,dt),l("td",{style:{width:"8%"},onClick:v=>i.timeCheck(h,"time")},C(h[1]),9,ht),l("td",{style:{width:"15%"},onClick:v=>i.timeCheck(h,"time")},C(h[2]),9,ut),y((u(),m("td",{style:{width:"15%"},onClick:v=>i.timeCheck(h,"time"),class:"errListStyklClic"},[pt,w(C(h[3]==-1?"":"".concat(this.formatTime(Math.trunc(h[3][0]*1e3))," ~ ").concat(this.formatTime(Math.trunc(h[3][1]*1e3))," ")),1)],8,mt)),[[O,"点击回放该时刻"]]),l("td",{style:{width:"10%"},onClick:v=>i.timeCheck(h,"time")},C(h[4]),9,gt),l("td",{style:{width:"50%"},onClick:v=>i.timeCheck(h,"time")},C(h[5]),9,ft)]))),128))],2)])])]),l("div",At,[t.timeDataShow?(u(),m("div",Ct,_t)):f("",!0),l("div",yt,[kt,l("div",wt,[l("div",Dt,[k(a,{class:"tch-tool-btn",onClick:s[4]||(s[4]=h=>t.showDotsFrame=!t.showDotsFrame),title:"alt+左键"},{default:B(()=>[w("打点")]),_:1}),St,vt,k(n,{options:t.modeOptions,modelValue:t.chartMode,"onUpdate:modelValue":s[5]||(s[5]=h=>t.chartMode=h)},null,8,["options","modelValue"])]),(u(),m("div",{id:"timechart_"+i.view.id,style:{width:"100%",height:"100%","margin-bottom":"15px"},key:i.view.id},[t.timeShow&&t.timeData.length>0?(u(),T(g,{key:0,fileType:t.fileType,timeData:t.timeData,onExportAreaData:i.onExportArea,mode:t.chartMode,showExport:!1,startTime:t.startTime,showDotsFrame:t.showDotsFrame,"onUpdate:showDotsFrame":s[6]||(s[6]=h=>t.showDotsFrame=h),initAreas:t.initAreas,initPots:t.initPots},null,8,["fileType","timeData","onExportAreaData","mode","startTime","showDotsFrame","initAreas","initPots"])):f("",!0)],8,xt))]),t.timeDataVisiable?(u(),m("div",Tt,Lt)):f("",!0)])])])])])]),t.modal.visible?(u(),T(D,{key:0,ref:"homeDel",curViewInx:t.curView.value,from:"eteReader",title:t.modal.title,onCancel:i.onCancelImportFile,onImportFileSubmit:i.onCheckView,carType:t.carType,hisDirectory:t.directory,sdb:t.sdb,onTreeDataChange:i.onTreeDataChange,onUpdateDefaultOptions:i.onUpdateDefaultOptions},null,8,["curViewInx","title","onCancel","onImportFileSubmit","carType","hisDirectory","sdb","onTreeDataChange","onUpdateDefaultOptions"])):f("",!0)]),k(x,{message:t.message},null,8,["message"]),t.downloadMessage.show?(u(),T(S,{key:0,path:t.downloadMessage.path,onClose:s[7]||(s[7]=h=>t.downloadMessage.show=!1)},null,8,["path"])):f("",!0)],64)}const Zt=Q(Be,[["render",It],["__scopeId","data-v-490f6254"]]);export{Zt as default};
