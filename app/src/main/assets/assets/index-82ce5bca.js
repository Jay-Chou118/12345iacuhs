import{H as rt}from"./Header-fc7e859e.js";import{B as K}from"./Button-db865340.js";import{M as J}from"./Message-539bae3f.js";import{_ as E,S as W,k as ee,s as ue,r as w,l as U,w as C,o as h,c as u,d as a,t as b,h as g,F as D,i as T,a as k,f as v,p as B,b as j,L as dt,m as L,q as me,H as qe,I as Ie,u as pt,g as Y,x as N,y as pe,B as $,j as he,e as x,z as Ae,A as O,v as P,C as Ne,J as ct,E as Q,K as ht,M as ft,N as ne,n as gt}from"./index-56f1676f.js";import{C as Oe}from"./Cascader-03a90a71.js";import{S as oe}from"./Spin-563ddef8.js";import{A as bt,W as _t,P as yt}from"./ev-timeplot-fef79010.js";import{M as wt}from"./index-459c74c3.js";import{c as vt}from"./index.es-7095b961.js";import{t as we}from"./signal-577d7bc6.js";import{n as Ct}from"./index-b6c1714d.js";import{b as kt,s as St,C as ut}from"./CopyPath-3588adec.js";import{s as Tt,a as ze}from"./time-4b339df6.js";import{B as ve}from"./ButtonGroup-80493969.js";import{b as mt}from"./num-b2a97d52.js";let Ke=0;const Dt={props:["title","curViewInx","carType","sdb","tinyBatteryFlag","loading"],emits:["cancel","importFileSubmit","treeDataChange"],components:{Button:K,Cascader:Oe,Message:J,Spin:oe},data(){return window.messageHandlers={},{dbcVal:[W.DEFAULT[0].value,W.DEFAULT[0].children[0].value],channelVal:{label:"(不加载)",value:0},channelValTwo:{label:"(不加载)",value:0},blfDirectory:"",dbcDirectory:"",dbcDirectoryTwo:"",filePath1:"",filePath2:"",channelNo:{label:1,value:1},channelNoTwo:{label:2,value:2},message:{visible:!1,level:"",content:""},filesList:["","","","","","","","","","","","","","","",""]}},watch:{dbcVal:{handler(e){this.channelVal={label:"(不加载)",value:0},this.channelValTwo={label:"(不加载)",value:0}},immediate:!0}},mounted(){},computed:{dbcVerOpts(){return[...W.DEFAULT,{label:"自定义模板",value:"自定义模板"}]},channelOptions(){var s,i;let e=[];if(this.dbcVal[0]!==""&&this.dbcVal[1]!==""){e=((i=(s=W.DEFAULT.find(l=>l.value===this.dbcVal[0]))==null?void 0:s.children.find(l=>l.value===this.dbcVal[1]))==null?void 0:i.comments)||[];let t=e.map((l,n)=>l&&"".concat(n,"-").concat(l)).filter(l=>l!=="").map((l,n)=>({label:l,value:Number(l.split("-")[0])}));return t.unshift({label:"(不加载)",value:0}),t}}},methods:{choosePath(){ee.choosePath({directory:window.downloadPath,saveFilename:"tspa-Record.blf",dialogType:"SAVE_DIALOG",fileTypes:["BLF文件 (*.blf;*.BLF)"],allow_multiple:!1}).then(({data:e})=>{console.log("res>>>",e),e.directory&&(this.blfDirectory=e.filename)})},chooseDbcPath(){JSBridge.send({method:"getUserDBC"},e=>{console.log("res",e),this.filePath1=e.data;const s=e.data.split("/").pop();console.log("fileName",s),this.dbcDirectory=s}),ee.choosePath({dialogType:"OPEN_DIALOG",fileTypes:["DBC文件 (*.dbc;*.DBC)"],allow_multiple:!1}).then(({data:e})=>{e.directory&&(this.blfDirectory=e.filename)})},chooseDbcPathTwo(){JSBridge.send({method:"getUserDBC"},e=>{console.log("res",e),this.filePath2=e.data;const s=e.data.split("/").pop();console.log("fileName",s),this.dbcDirectoryTwo=s}),ee.choosePath({dialogType:"OPEN_DIALOG",fileTypes:["DBC文件 (*.dbc;*.DBC)"],allow_multiple:!1}).then(({data:e})=>{e.directory&&(this.dbcDirectoryTwo=e.filename)})},submit(){ue==="android"&&(this.dbcVal[0]!=="自定义模板"?this.channelVal.value===this.channelValTwo.value&&this.channelVal.value!==0?this.showMessage({timeout:5e3,level:"error",content:"不可重复选择相同通道"}):this.$emit("submitToShow",this.dbcVal,[this.channelVal.label,this.channelValTwo.label],["(不加载)","(不加载)"],this.blfDirectory):this.channelNo===this.channelNoTwo?this.showMessage({timeout:5e3,level:"error",content:"不可重复选择相同通道"}):this.$emit("submitToShow",this.dbcVal,[this.channelNo.value+"-"+this.filePath1,this.channelNoTwo.value+"-"+this.filePath2],[],this.blfDirectory),console.log("android"))},showMessage({level:e,content:s,timeout:i}){clearTimeout(Ke),e!=null&&(this.message.level=e),s!=null&&(this.message.content=s),this.message.visible=!0,i>0&&(Ke=setTimeout(()=>{this.message.visible=!1},i))}}},re=e=>(B("data-v-3be75f85"),e=e(),j(),e),Vt={class:"o-import-dialog"},xt={class:"o-dialog-wrap"},It={class:"o-dialog-header-wrap"},Lt={class:"o-dialog-title"},Ft={class:"o-dialog-container-wrap"},Rt={class:"o-import-configuration"},Mt={class:"o-dialog-item-wrap"},Et=re(()=>a("span",{class:"o-dialog-item"},"车型/DBC：",-1)),$t={class:"o-dialog-item-select"},At={class:"o-dialog-item-wrap edit-modal-channel"},Nt=re(()=>a("span",{class:"o-dialog-item"},"通道1：",-1)),Ot={class:"o-dialog-item-wrap edit-modal-channel-two"},Pt=re(()=>a("span",{class:"o-dialog-item"},"通道2：",-1)),Ut={class:"o-dialog-item-wrap"},Ht=re(()=>a("span",{style:{color:"red"}},null,-1)),Bt=re(()=>a("span",{class:"o-dialog-item"},"通道1：",-1)),jt={class:"o-dialog-tab"},qt={class:"o-dialog-choose-dbc"},zt=["title"],Kt={class:"o-dialog-item-wrap"},Wt=re(()=>a("span",{style:{color:"red"}},null,-1)),Xt=re(()=>a("span",{class:"o-dialog-item"},"通道2：",-1)),Gt={class:"o-dialog-tab"},Yt={class:"o-dialog-choose-dbc"},Jt=["title"],Qt={class:"o-dialog-footer-wrap"},Zt={class:"o-dialog-footer"},es={key:0,class:"o-dialog-loading"};function ts(e,s,i,o,t,l){const n=w("Cascader"),r=w("v-select"),d=w("Button"),c=w("Spin"),m=w("Message"),f=U("esc");return C((h(),u("div",Vt,[a("div",xt,[a("div",It,[a("div",Lt,b(e.$props.title),1),a("i",{class:"o-dialog-title-close",onClick:s[0]||(s[0]=y=>e.$emit("cancel"))})]),a("div",Ft,[a("div",Rt,[a("div",Mt,[Et,a("div",$t,[g(n,{options:l.dbcVerOpts,modelValue:t.dbcVal,"onUpdate:modelValue":s[1]||(s[1]=y=>t.dbcVal=y)},null,8,["options","modelValue"])])]),t.dbcVal[0]!="自定义模板"?(h(),u(D,{key:0},[a("div",At,[Nt,g(r,{options:l.channelOptions,clearable:!1,label:"label",value:"value",modelValue:t.channelVal,"onUpdate:modelValue":s[2]||(s[2]=y=>t.channelVal=y),class:"chf-input-ecu"},null,8,["options","modelValue"])]),a("div",Ot,[Pt,g(r,{options:l.channelOptions,clearable:!1,label:"label",value:"value",modelValue:t.channelValTwo,"onUpdate:modelValue":s[3]||(s[3]=y=>t.channelValTwo=y),class:"chf-input-ecu"},null,8,["options","modelValue"])])],64)):(h(),u(D,{key:1},[a("div",Ut,[Ht,Bt,a("div",jt,[a("div",qt,[a("div",{class:"o-table-dbc input-overflow-sty",title:t.dbcDirectory||"--"},b(t.dbcDirectory||"--"),9,zt),a("a",{class:"chose-file chose-dbc-file",onClick:s[4]||(s[4]=y=>l.chooseDbcPath())},"选择DBC文件")])])]),a("div",Kt,[Wt,Xt,a("div",Gt,[a("div",Yt,[a("div",{class:"o-table-dbc input-overflow-sty",title:t.dbcDirectoryTwo||"--"},b(t.dbcDirectoryTwo||"--"),9,Jt),a("a",{class:"chose-file chose-dbc-file",onClick:s[5]||(s[5]=y=>l.chooseDbcPathTwo())},"选择DBC文件")])])])],64))])]),a("div",Qt,[a("div",Zt,[g(d,{style:{width:"52px"},onClick:s[6]||(s[6]=y=>e.$emit("cancel"))},{default:T(()=>[k("取消")]),_:1}),g(d,{type:"primary",style:{width:"52px",margin:"0 20px 0 10px"},onClick:l.submit},{default:T(()=>[k("连接")]),_:1},8,["onClick"])])]),e.$props.loading?(h(),u("div",es,[g(c)])):v("",!0)]),g(m,{message:t.message},null,8,["message"])])),[[f,()=>e.$emit("cancel")]])}const ss=E(Dt,[["render",ts],["__scopeId","data-v-3be75f85"]]);let We=0;const ls={props:["title","curViewInx","carType","sdb","tinyBatteryFlag","loading"],emits:["cancel","importFileSubmit","treeDataChange"],components:{Button:K,Cascader:Oe,Message:J,Spin:oe},data(){return{dbcVal:[W.DEFAULT[0].value,W.DEFAULT[0].children[0].value],channelVal:{label:"(不加载)",value:0},channelValTwo:{label:"(不加载)",value:0},channelValThree:{label:"(不加载)",value:0},linChannelVal:{label:"(不加载)",value:0},linChannelValTwo:{label:"(不加载)",value:0},blfDirectory:"",dbcDirectory:"",dbcDirectoryTwo:"",dbcDirectoryThree:"",linDbcDirectory:"",linDbcDirectoryTwo:"",channelNo:{label:1,value:1},channelNoTwo:{label:2,value:2},channelNoThree:{label:3,value:3},linChannelNo:{label:4,value:4},linChannelNoTwo:{label:5,value:5},message:{visible:!1,level:"",content:""},filesList:["","","","","","","","","","","","","","","",""]}},watch:{dbcVal:{handler(e){this.channelVal={label:"(不加载)",value:0},this.channelValTwo={label:"(不加载)",value:0},this.channelValThree={label:"(不加载)",value:0},this.linChannelVal={label:"(不加载)",value:0},this.linChannelValTwo={label:"(不加载)",value:0}},immediate:!0}},mounted(){},computed:{dbcVerOpts(){return[...W.DEFAULT,{label:"自定义模板",value:"自定义模板"}]},channelOptions(){var s,i;let e=[];if(this.dbcVal[0]!==""&&this.dbcVal[1]!==""){e=((i=(s=W.DEFAULT.find(l=>l.value===this.dbcVal[0]))==null?void 0:s.children.find(l=>l.value===this.dbcVal[1]))==null?void 0:i.comments)||[];let t=e.map((l,n)=>l&&"".concat(n,"-").concat(l)).filter(l=>l!=="").map((l,n)=>({label:l,value:Number(l.split("-")[0])}));return t.unshift({label:"(不加载)",value:0}),t}},linChannelOptions(){var s,i;let e=[];if(this.dbcVal[0]!==""&&this.dbcVal[1]!==""){e=((i=(s=dt.find(t=>t.value===this.dbcVal[0]))==null?void 0:s.children.find(t=>t.value===this.dbcVal[1]))==null?void 0:i.comments)||[];let o=e.map(t=>({label:t,value:Number(t.split("-")[0])-1e3}));return o.unshift({label:"(不加载)",value:0}),o}}},methods:{choosePath(){ee.choosePath({directory:window.downloadPath,saveFilename:"tspa-Record.blf",dialogType:"SAVE_DIALOG",fileTypes:["BLF文件 (*.blf;*.BLF)"],allow_multiple:!1}).then(({data:e})=>{console.log("res>>>",e),e.directory&&(this.blfDirectory=e.directory)})},chooseDbcPath(){JSBridge.send({method:"getUserDBC"},e=>{console.log("res",e),this.dbcDirectory=e.data}),res.directory&&(this.blfDirectory=res.filename)},chooseDbcPathTwo(){JSBridge.send({method:"getUserDBC"},e=>{console.log("res",e),this.dbcDirectory=e.data}),res.directory&&(this.blfDirectory=res.filename)},chooseDbcPathThree(){ee.choosePath({dialogType:"OPEN_DIALOG",fileTypes:["DBC文件 (*.dbc;*.DBC)"],allow_multiple:!1}).then(({data:e})=>{e.directory&&(this.linDbcDirectory=e.directory)})},chooseLinDbcPath(){ee.choosePath({dialogType:"OPEN_DIALOG",fileTypes:["LDF文件 (*.ldf;*.LDF)"],allow_multiple:!1}).then(({data:e})=>{e.directory&&(this.linDbcDirectory=e.directory)})},chooseLinDbcPathTwo(){ee.choosePath({dialogType:"OPEN_DIALOG",fileTypes:["LDF文件 (*.ldf;*.LDF)"],allow_multiple:!1}).then(({data:e})=>{e.directory&&(this.linDbcDirectoryTwo=e.directory)})},submit(){ue==="android"?this.dbcVal[0]!=="自定义模板"?this.channelVal.value===this.channelValTwo.value&&this.channelVal.value!==0?this.showMessage({timeout:5e3,level:"error",content:"不可重复选择相同通道"}):this.$emit("submitFiveToShow",this.dbcVal,[this.channelVal.label,this.channelValTwo.label,this.channelValThree.label],[this.linChannelVal.label,this.linChannelValTwo.label],this.blfDirectory):this.channelNo===this.channelNoTwo===this.channelNoThree?this.showMessage({timeout:5e3,level:"error",content:"不可重复选择相同通道"}):this.$emit("submitFiveToShow",this.dbcVal,[this.channelNo.value+"-"+this.dbcDirectory,this.channelNoTwo.value+"-"+this.dbcDirectoryTwo,this.channelNoThree.value+"-"+this.dbcDirectoryThree],[this.linChannelNo.value+"-"+this.linDbcDirectory,this.linChannelNoTwo.value+"-"+this.linDbcDirectoryTwo],this.blfDirectory):this.dbcVal[0]!=="自定义模板"?(console.log("提交中..123"),this.channelVal.value===this.channelValTwo.value&&this.channelVal.value!==0?this.showMessage({timeout:5e3,level:"error",content:"不可重复选择相同通道"}):this.blfDirectory!==""?this.$emit("submitFiveToShow",this.dbcVal,[this.channelVal.label,this.channelValTwo.label,this.channelValThree.label],[this.linChannelVal.label,this.linChannelValTwo.label],this.blfDirectory):this.showMessage({timeout:5e3,level:"error",content:"请选择保存目录路径"})):this.channelNo===this.channelNoTwo===this.channelNoThree?this.showMessage({timeout:5e3,level:"error",content:"不可重复选择相同通道"}):this.blfDirectory!==""?(console.log("自定义传参",this.channelNo),this.$emit("submitFiveToShow",this.dbcVal,[this.channelNo.value+"-"+this.dbcDirectory,this.channelNoTwo.value+"-"+this.dbcDirectoryTwo,this.channelNoThree.value+"-"+this.dbcDirectoryThree],[this.linChannelNo.value+"-"+this.linDbcDirectory,this.linChannelNoTwo.value+"-"+this.linDbcDirectoryTwo],this.blfDirectory)):this.showMessage({timeout:5e3,level:"error",content:"请选择保存目录路径"})},showMessage({level:e,content:s,timeout:i}){clearTimeout(We),e!=null&&(this.message.level=e),s!=null&&(this.message.content=s),this.message.visible=!0,i>0&&(We=setTimeout(()=>{this.message.visible=!1},i))}}},H=e=>(B("data-v-3b5d5c72"),e=e(),j(),e),is={class:"o-import-dialog"},as={class:"o-dialog-wrap"},ns={class:"o-dialog-header-wrap"},os={class:"o-dialog-title"},rs={class:"o-dialog-container-wrap"},ds={class:"o-import-configuration"},cs={class:"o-dialog-item-wrap"},hs=H(()=>a("span",{class:"o-dialog-item"},"车型/DBC：",-1)),us={class:"o-dialog-item-select"},ms={class:"o-dialog-item-group-wrap"},ps={class:"o-dialog-item-wrap edit-modal-channel"},fs=H(()=>a("span",{class:"o-dialog-item"},"CAN通道1：",-1)),gs={class:"o-dialog-item-wrap edit-modal-channel-two"},bs=H(()=>a("span",{class:"o-dialog-item"},"CAN通道2：",-1)),_s={class:"o-dialog-item-wrap edit-modal-channel-three"},ys=H(()=>a("span",{class:"o-dialog-item"},"CAN通道3：",-1)),ws={class:"o-dialog-item-group-wrap"},vs={class:"o-dialog-item-wrap edit-modal-channel"},Cs=H(()=>a("span",{class:"o-dialog-item"},"LIN通道1：",-1)),ks={class:"o-dialog-item-wrap edit-modal-channel-two"},Ss=H(()=>a("span",{class:"o-dialog-item"},"LIN通道2：",-1)),Ts={class:"o-dialog-item-wrap"},Ds=H(()=>a("span",{style:{color:"red"}},null,-1)),Vs=H(()=>a("span",{class:"o-dialog-item"},"CAN通道1：",-1)),xs={class:"o-dialog-tab"},Is={class:"o-dialog-choose-dbc"},Ls=["title"],Fs={class:"o-dialog-item-wrap"},Rs=H(()=>a("span",{style:{color:"red"}},null,-1)),Ms=H(()=>a("span",{class:"o-dialog-item"},"CAN通道2：",-1)),Es={class:"o-dialog-tab"},$s={class:"o-dialog-choose-dbc"},As=["title"],Ns={class:"o-dialog-item-wrap"},Os=H(()=>a("span",{style:{color:"red"}},null,-1)),Ps=H(()=>a("span",{class:"o-dialog-item"},"CAN通道3：",-1)),Us={class:"o-dialog-tab"},Hs={class:"o-dialog-choose-dbc"},Bs=["title"],js={class:"o-dialog-item-wrap"},qs=H(()=>a("span",{style:{color:"red"}},null,-1)),zs=H(()=>a("span",{class:"o-dialog-item"},"LIN通道1：",-1)),Ks={class:"o-dialog-tab"},Ws={class:"o-dialog-choose-dbc"},Xs=["title"],Gs={class:"o-dialog-item-wrap"},Ys=H(()=>a("span",{style:{color:"red"}},null,-1)),Js=H(()=>a("span",{class:"o-dialog-item"},"LIN通道2：",-1)),Qs={class:"o-dialog-tab"},Zs={class:"o-dialog-choose-dbc"},el=["title"],tl={key:2,class:"o-dialog-item-wrap"},sl=H(()=>a("span",{style:{color:"red"}},"* ",-1)),ll=H(()=>a("span",{class:"o-dialog-item"},"保存目录：",-1)),il=["title"],al={class:"o-dialog-footer-wrap"},nl={class:"o-dialog-footer"},ol={key:0,class:"o-dialog-loading"};function rl(e,s,i,o,t,l){const n=w("Cascader"),r=w("v-select"),d=w("Button"),c=w("Spin"),m=w("Message"),f=U("esc");return C((h(),u("div",is,[a("div",as,[a("div",ns,[a("div",os,b(e.$props.title),1),a("i",{class:"o-dialog-title-close",onClick:s[0]||(s[0]=y=>e.$emit("cancel"))})]),a("div",rs,[a("div",ds,[a("div",cs,[hs,a("div",us,[g(n,{options:l.dbcVerOpts,modelValue:t.dbcVal,"onUpdate:modelValue":s[1]||(s[1]=y=>t.dbcVal=y)},null,8,["options","modelValue"])])]),t.dbcVal[0]!="自定义模板"?(h(),u(D,{key:0},[a("div",ms,[a("div",ps,[fs,g(r,{options:l.channelOptions,clearable:!1,label:"label",value:"value",modelValue:t.channelVal,"onUpdate:modelValue":s[2]||(s[2]=y=>t.channelVal=y),class:"chf-input-ecu"},null,8,["options","modelValue"])]),a("div",gs,[bs,g(r,{options:l.channelOptions,clearable:!1,label:"label",value:"value",modelValue:t.channelValTwo,"onUpdate:modelValue":s[3]||(s[3]=y=>t.channelValTwo=y),class:"chf-input-ecu"},null,8,["options","modelValue"])])]),a("div",_s,[ys,g(r,{options:l.channelOptions,clearable:!1,label:"label",value:"value",modelValue:t.channelValThree,"onUpdate:modelValue":s[4]||(s[4]=y=>t.channelValThree=y),class:"chf-input-ecu"},null,8,["options","modelValue"])]),a("div",ws,[a("div",vs,[Cs,g(r,{options:l.linChannelOptions,clearable:!1,label:"label",value:"value",modelValue:t.linChannelVal,"onUpdate:modelValue":s[5]||(s[5]=y=>t.linChannelVal=y),class:"chf-input-ecu"},null,8,["options","modelValue"])]),a("div",ks,[Ss,g(r,{options:l.linChannelOptions,clearable:!1,label:"label",value:"value",modelValue:t.linChannelValTwo,"onUpdate:modelValue":s[6]||(s[6]=y=>t.linChannelValTwo=y),class:"chf-input-ecu"},null,8,["options","modelValue"])])])],64)):(h(),u(D,{key:1},[a("div",Ts,[Ds,Vs,a("div",xs,[a("div",Is,[a("div",{class:"o-table-dbc input-overflow-sty",title:t.dbcDirectory||"--"},b(t.dbcDirectory||"--"),9,Ls),a("a",{class:"chose-file chose-dbc-file",onClick:s[7]||(s[7]=y=>l.chooseDbcPath())},"选择DBC文件")])])]),a("div",Fs,[Rs,Ms,a("div",Es,[a("div",$s,[a("div",{class:"o-table-dbc input-overflow-sty",title:t.dbcDirectoryTwo||"--"},b(t.dbcDirectoryTwo||"--"),9,As),a("a",{class:"chose-file chose-dbc-file",onClick:s[8]||(s[8]=y=>l.chooseDbcPathTwo())},"选择DBC文件")])])]),a("div",Ns,[Os,Ps,a("div",Us,[a("div",Hs,[a("div",{class:"o-table-dbc input-overflow-sty",title:t.dbcDirectoryThree||"--"},b(t.dbcDirectoryThree||"--"),9,Bs),a("a",{class:"chose-file chose-dbc-file",onClick:s[9]||(s[9]=y=>l.chooseDbcPathThree())},"选择DBC文件")])])]),a("div",js,[qs,zs,a("div",Ks,[a("div",Ws,[a("div",{class:"o-table-dbc input-overflow-sty",title:t.linDbcDirectory||"--"},b(t.linDbcDirectory||"--"),9,Xs),a("a",{class:"chose-file chose-dbc-file",onClick:s[10]||(s[10]=y=>l.chooseLinDbcPath())},"选择LDF文件")])])]),a("div",Gs,[Ys,Js,a("div",Qs,[a("div",Zs,[a("div",{class:"o-table-dbc input-overflow-sty",title:t.linDbcDirectoryTwo||"--"},b(t.linDbcDirectoryTwo||"--"),9,el),a("a",{class:"chose-file chose-dbc-file",onClick:s[11]||(s[11]=y=>l.chooseLinDbcPathTwo())},"选择LDF文件")])])])],64)),e.system!=="android"?(h(),u("div",tl,[sl,ll,g(d,{onClick:l.choosePath,class:"choose-path"},{default:T(()=>[k("选择路径")]),_:1},8,["onClick"]),k("    ")])):v("",!0),e.system!=="android"?(h(),u("div",{key:3,class:"show-directory",title:t.blfDirectory},b(t.blfDirectory),9,il)):v("",!0)])]),a("div",al,[a("div",nl,[g(d,{style:{width:"52px"},onClick:s[12]||(s[12]=y=>e.$emit("cancel"))},{default:T(()=>[k("取消")]),_:1}),g(d,{type:"primary",style:{width:"52px",margin:"0 20px 0 10px"},onClick:l.submit},{default:T(()=>[k("连接")]),_:1},8,["onClick"])])]),e.$props.loading?(h(),u("div",ol,[g(c)])):v("",!0)]),g(m,{message:t.message},null,8,["message"])])),[[f,()=>e.$emit("cancel")]])}const dl=E(ls,[["render",rl],["__scopeId","data-v-3b5d5c72"]]);let Xe=0;const cl={props:["title","curViewInx","carType","sdb","tinyBatteryFlag","loading"],emits:["cancel","importFileSubmit","treeDataChange"],components:{Button:K,Cascader:Oe,Message:J,Spin:oe},data(){return{dbcVal:[W.DEFAULT[0].value,W.DEFAULT[0].children[0].value],channelValList:[{label:"(不加载)",value:0},{label:"(不加载)",value:0},{label:"(不加载)",value:0},{label:"(不加载)",value:0},{label:"(不加载)",value:0},{label:"(不加载)",value:0},{label:"(不加载)",value:0},{label:"(不加载)",value:0},{label:"(不加载)",value:0},{label:"(不加载)",value:0},{label:"(不加载)",value:0},{label:"(不加载)",value:0}],blfDirectory:"",dbcDirectoryList:["","","","","","","","","","","",""],channelNo:{label:1,value:1},channelNoTwo:{label:2,value:2},channelNoThree:{label:3,value:3},linChannelNo:{label:4,value:4},linChannelNoTwo:{label:5,value:5},message:{visible:!1,level:"",content:""},filesList:["","","","","","","","","","","","","","","",""]}},watch:{dbcVal:{handler(e){console.log("dbcVal1753",e),this.channelValList=[{label:"(不加载)",value:0},{label:"(不加载)",value:0},{label:"(不加载)",value:0},{label:"(不加载)",value:0},{label:"(不加载)",value:0},{label:"(不加载)",value:0},{label:"(不加载)",value:0},{label:"(不加载)",value:0},{label:"(不加载)",value:0},{label:"(不加载)",value:0},{label:"(不加载)",value:0},{label:"(不加载)",value:0}]},immediate:!0}},mounted(){},computed:{dbcVerOpts(){return[...W.DEFAULT,{label:"自定义模板",value:"自定义模板"}]},channelOptions(){var s,i;let e=[];if(this.dbcVal[0]!==""&&this.dbcVal[1]!==""){e=((i=(s=W.DEFAULT.find(l=>l.value===this.dbcVal[0]))==null?void 0:s.children.find(l=>l.value===this.dbcVal[1]))==null?void 0:i.comments)||[];let t=e.map((l,n)=>l&&"".concat(n,"-").concat(l)).filter(l=>l!=="").map((l,n)=>({label:l,value:Number(l.split("-")[0])}));return t.unshift({label:"(不加载)",value:0}),t}},linChannelOptions(){var s,i;let e=[];if(this.dbcVal[0]!==""&&this.dbcVal[1]!==""){e=((i=(s=dt.find(t=>t.value===this.dbcVal[0]))==null?void 0:s.children.find(t=>t.value===this.dbcVal[1]))==null?void 0:i.comments)||[];let o=e.map(t=>({label:t,value:Number(t.split("-")[0])-1e3}));return o.unshift({label:"(不加载)",value:0}),o}}},methods:{choosePath(){ee.choosePath({directory:window.downloadPath,saveFilename:"tspa-Record.blf",dialogType:"SAVE_DIALOG",fileTypes:["BLF文件 (*.blf;*.BLF)"],allow_multiple:!1}).then(({data:e})=>{console.log("res>>>",e),e.directory&&(this.blfDirectory=e.directory)})},chooseDbcPath(e){console.log("inx",e),ee.choosePath({dialogType:"OPEN_DIALOG",fileTypes:["DBC文件 (*.dbc;*.DBC)"],allow_multiple:!1}).then(({data:s})=>{s.directory&&(this.dbcDirectoryList[e]=s.directory)})},submit(){console.log("linChannelOptions1111",this.linChannelOptions),ue==="android"?this.dbcVal[0]!=="自定义模板"?this.$emit("submitTwelveToShow",this.dbcVal,this.channelValList.map(e=>e.label),["(不加载)","(不加载)"],this.blfDirectory):this.$emit("submitTwelveToShow",this.dbcVal,this.channelValList.map((e,s)=>s+1+"-"+this.dbcDirectoryList[s]),[],this.blfDirectory):this.dbcVal[0]!=="自定义模板"?this.blfDirectory!==""?this.$emit("submitTwelveToShow",this.dbcVal,this.channelValList.map(e=>e.label),["(不加载)","(不加载)"],this.blfDirectory):this.showMessage({timeout:5e3,level:"error",content:"请选择保存目录路径"}):this.blfDirectory!==""?(console.log("自定义传参",this.channelValList,this.channelValList.map((e,s)=>s+1+"-"+this.dbcDirectoryList[s])),this.$emit("submitTwelveToShow",this.dbcVal,this.channelValList.map((e,s)=>s+1+"-"+this.dbcDirectoryList[s]),[],this.blfDirectory)):this.showMessage({timeout:5e3,level:"error",content:"请选择保存目录路径"})},showMessage({level:e,content:s,timeout:i}){clearTimeout(Xe),e!=null&&(this.message.level=e),s!=null&&(this.message.content=s),this.message.visible=!0,i>0&&(Xe=setTimeout(()=>{this.message.visible=!1},i))}}},Le=e=>(B("data-v-8256cc54"),e=e(),j(),e),hl={class:"o-import-dialog"},ul={class:"o-dialog-wrap"},ml={class:"o-dialog-header-wrap"},pl={class:"o-dialog-title"},fl={class:"o-dialog-container-wrap"},gl={class:"o-import-configuration"},bl={class:"o-dialog-item-wrap"},_l=Le(()=>a("span",{class:"o-dialog-item"},"车型/DBC：",-1)),yl={class:"o-dialog-item-select"},wl={key:0,class:"o-dialog-item-group-wrap"},vl={class:"o-dialog-item"},Cl=Le(()=>a("span",{style:{color:"red"}},null,-1)),kl={class:"o-dialog-item"},Sl={class:"o-dialog-tab"},Tl={class:"o-dialog-choose-dbc"},Dl=["title"],Vl=["onClick"],xl={key:2,class:"o-dialog-item-wrap"},Il=Le(()=>a("span",{style:{color:"red"}},"* ",-1)),Ll=Le(()=>a("span",{class:"o-dialog-item"},"保存目录：",-1)),Fl=["title"],Rl={class:"o-dialog-footer-wrap"},Ml={class:"o-dialog-footer"},El={key:0,class:"o-dialog-loading"};function $l(e,s,i,o,t,l){const n=w("Cascader"),r=w("v-select"),d=w("Button"),c=w("Spin"),m=w("Message"),f=U("esc");return C((h(),u("div",hl,[a("div",ul,[a("div",ml,[a("div",pl,b(e.$props.title),1),a("i",{class:"o-dialog-title-close",onClick:s[0]||(s[0]=y=>e.$emit("cancel"))})]),a("div",fl,[a("div",gl,[a("div",bl,[_l,a("div",yl,[g(n,{options:l.dbcVerOpts,modelValue:t.dbcVal,"onUpdate:modelValue":s[1]||(s[1]=y=>t.dbcVal=y)},null,8,["options","modelValue"])])]),t.dbcVal[0]!="自定义模板"?(h(),u("div",wl,[(h(!0),u(D,null,L(t.channelValList,(y,R)=>(h(),u("div",{class:"o-dialog-item-wrap edit-modal-channel",key:R},[a("span",vl,"CAN通道"+b(R+1)+"：",1),g(r,{options:l.channelOptions,clearable:!1,label:"label",value:"value",modelValue:t.channelValList[R],"onUpdate:modelValue":A=>t.channelValList[R]=A,class:"chf-input-ecu"},null,8,["options","modelValue","onUpdate:modelValue"])]))),128))])):(h(!0),u(D,{key:1},L(t.dbcDirectoryList,(y,R)=>(h(),u("div",{class:"o-dialog-item-wrap",key:R},[Cl,a("span",kl,"CAN通道"+b(R+1)+"：",1),a("div",Sl,[a("div",Tl,[a("div",{class:"o-table-dbc input-overflow-sty",title:t.dbcDirectoryList[R]||"--"},b(t.dbcDirectoryList[R]||"--"),9,Dl),a("a",{class:"chose-file chose-dbc-file",onClick:A=>l.chooseDbcPath(R)},"选择DBC文件",8,Vl)])])]))),128)),e.system!=="android"?(h(),u("div",xl,[Il,Ll,g(d,{onClick:l.choosePath,class:"choose-path"},{default:T(()=>[k("选择路径")]),_:1},8,["onClick"]),k("    ")])):v("",!0),e.system!=="android"?(h(),u("div",{key:3,class:"show-directory",title:t.blfDirectory},b(t.blfDirectory),9,Fl)):v("",!0)])]),a("div",Rl,[a("div",Ml,[g(d,{style:{width:"52px"},onClick:s[2]||(s[2]=y=>e.$emit("cancel"))},{default:T(()=>[k("取消")]),_:1}),g(d,{type:"primary",style:{width:"52px",margin:"0 20px 0 10px"},onClick:l.submit},{default:T(()=>[k("连接")]),_:1},8,["onClick"])])]),e.$props.loading?(h(),u("div",El,[g(c)])):v("",!0)]),g(m,{message:t.message},null,8,["message"])])),[[f,()=>e.$emit("cancel")]])}const Al=E(cl,[["render",$l],["__scopeId","data-v-8256cc54"]]);const Nl={props:{modelValue:{type:Boolean,required:!0},id:{type:String,required:!0}},computed:{checkValue:{get(){return this.modelValue},set(e){this.$emit("update:modelValue",e)}}},methods:{handleChange(e){this.checkValue=e.target.checked}}},Ol=e=>(B("data-v-3935df67"),e=e(),j(),e),Pl={class:"switch-wrap"},Ul={class:"switch"},Hl=["checked"],Bl=Ol(()=>a("span",null,null,-1));function jl(e,s,i,o,t,l){return h(),u("div",Pl,[a("label",Ul,[a("input",{type:"checkbox",checked:l.checkValue,onChange:s[0]||(s[0]=(...n)=>l.handleChange&&l.handleChange(...n))},null,40,Hl),Bl])])}const ql=E(Nl,[["render",jl],["__scopeId","data-v-3935df67"]]);let se=[],Ge=0;const zl={props:["signals","carType","sdb","dbcVal","fileType","defaultOptions","filledOptions","loading","dbcChn","ldfChn"],emits:["signalsChange","cancel"],components:{Button:K,RecycleScroller:me,Spin:oe,Message:J},data(){var s,i,o,t,l,n,r,d,c;const e=this.$ls.get("blfread_sdbData")||[];if(console.log("sdbCustom123",this.$props.dbcVal,this.sdb,this.dbcChn,this.ldfChn),this.carType==="custom"){let m=(s=e.find(f=>f.sdb===this.sdb))==null?void 0:s.comments;m&&(se=["",...m])}else if(console.log("6777",this.ldfChn,this.dbcChn),this.ldfChn.every(m=>m==0)&&this.dbcChn.some(m=>m>0)&&(se=((o=(i=qe.find(m=>m.value===this.$props.carType))==null?void 0:i.children.find(m=>m.value===this.$props.sdb))==null?void 0:o.comments)||[]),this.ldfChn.some(m=>m>0)&&this.dbcChn.every(m=>m<0)&&(se=((l=(t=Ie.find(m=>m.value===this.$props.carType))==null?void 0:t.children.find(m=>m.value===this.$props.sdb))==null?void 0:l.comments)||[]),this.ldfChn.some(m=>m>0)&&this.dbcChn.some(m=>m>0)){console.log("5566");let m=((r=(n=qe.find(y=>y.value===this.$props.carType))==null?void 0:n.children.find(y=>y.value===this.$props.sdb))==null?void 0:r.comments)||[],f=((c=(d=Ie.find(y=>y.value===this.$props.carType))==null?void 0:d.children.find(y=>y.value===this.$props.sdb))==null?void 0:c.comments)||[];se=m.concat(f)}return console.log("C2C123",se),se=se.map((m,f)=>"".concat("⓪①②③④⑤⑥⑦⑧⑨⑩⑪⑫⑬⑭⑮⑯⑰⑱⑲⑳㉑㉒㉓㉔㉕㉖㉗㉘㉙㉚㉛㉜㉝㉞㉟㊱㊲"[f]).concat(m)),{inputStr:"",treeData:[],checkedList:[],isFilled:!1,message:{visible:!1,level:"",content:""},showSignalsList:[]}},computed:{list(){let e=[];for(let s=0;s<this.treeData.length;s++){let i=this.treeData[s];i.id!=-1&&e.push({_id:i.id,id:i.id,node_type:i.node_type,text:i.text});for(let o=0;o<i.children.length;o++){let t=i.children[o];t.id[0]!="-"&&e.push({_id:i.id+"-"+t.id,id:t.id,node_type:t.node_type,text:t.text});for(let l=0;l<t.children.length;l++){let n=t.children[l];e.push({...n,_id:i.id+"-"+t.id+"-"+n.id})}}}return console.log(e,11111111),e}},watch:{isFilled(e,s){this.dataInit()}},async created(){this.dataInit()},mounted(){console.log(this.$props.signals),this.$refs.chsInputRef.focus(),this.checkedList=this.$props.signals,this.updateChecked(),setTimeout(()=>{document.body.addEventListener("mousedown",this.clickHandler)},300)},beforeUnmount(){},unmounted(){document.body.removeEventListener("mousedown",this.clickHandler)},methods:{onFilledChange(e){this.inputStr="",this.isFilled=!this.isFilled},title4node(e){return we(e)},clickHandler(e){var s;((s=this.$refs.root)==null?void 0:s.contains(e.target))==!1&&this.$emit("cancel")},dataInit(){let e=[];console.log(this.$props.filledOptions.data,33333333333);let s=this.$props.filledOptions.data;for(let i in s){let o={id:+i,text:se[i],node_type:"channel",children:[]};for(let t in s[i]){let l={id:i+"_"+t,text:t=="-1"?"":t,node_type:"msg",channel:o.id,children:s[i][t].map(n=>{var r;return{id:n[0],msg:t=="-1"?"-1":+((r=t.match(/\(([^)]+)\)/))==null?void 0:r[1].toUpperCase().replace(/X/g,"x"))||t,channel:o.id,text:n[0],node_type:"signal",comment:n[1],remark:n[2],maxRaw:n[5],minRaw:n[6],enums:n[9],unit:n[10],androidId:n[18]}})};o.children.push(l)}e.push(o)}this.treeData=Object.freeze(e),console.log(this.treeData)},selectNode(e){console.log(this.checkedList);let s=this.checkedList.map(i=>({...i}));s.some(i=>i._id===e._id)?(console.log("s1"),this.checkedList=s.filter(i=>i._id!==e._id)):(console.log("s2"),s.length<30?this.checkedList=[...s.filter(i=>i._id!==e._id),e]:this.showMessage({level:"error",content:"选择不能超过".concat(s.length,"项"),timeout:2e3}))},showMessage({level:e,content:s,timeout:i}){clearTimeout(Ge),e!=null&&(this.message.level=e),s!=null&&(this.message.content=s),this.message.visible=!0,i>0&&(Ge=setTimeout(()=>{this.message.visible=!1},i))},submit(){this.$emit("signalsChange",this.checkedList)},updateChecked(){},highlightWord(e){if(!e)return e;const s=this.inputStr;if(!s)return e;const i=s.split(/\s+/g);var o,t=i.length,l;for(o=0;o<t;o++)try{l=new RegExp(i[o],"gi"),l.test(e)&&(e=e.replace(l,"<strong>$&</strong>"))}catch(n){l=i[o],e=e.replace(l,"<strong>$&</strong>")}return e},onChange:pt(function(){let s=!1,i=this.inputStr.toLowerCase();i.startsWith("0x")&&(s=!0);let o;try{o=new RegExp(i,"i")}catch(n){o={test(r){return~r.toLowerCase().indexOf(r.toLowerCase())}}}let t=[],l=this.$props.filledOptions.data;for(let n in l){let r={id:+n,text:se[n],node_type:"channel",children:[]};for(let d in l[n]){let c=s&&d.includes(i),m={id:n+"_"+d,text:d=="-1"?"":d,node_type:"msg",channel:r.id,children:l[n][d].filter(f=>c||o.test(f[0])||o.test(f[1])).map(f=>{var y;return{id:f[0],msg:d=="-1"?"-1":+((y=d.match(/\(([^)]+)\)/))==null?void 0:y[1].toUpperCase().replace(/X/g,"x")),channel:r.id,text:f[0],node_type:"signal",comment:f[1],remark:f[2],maxRaw:f[5],minRaw:f[6],enums:f[9],unit:f[10],androidId:f[18]}})};m.children.length>0&&r.children.push(m)}(r.children.length>0||o.test(r.text)||o.test(r.comment))&&t.push(r)}this.treeData=t,console.log(this.treeData),this.updateChecked()},500,{leading:!1})}},Kl=e=>(B("data-v-82c5920a"),e=e(),j(),e),Wl={class:"chs-er",ref:"root"},Xl={class:"chs-list-er"},Gl={key:0,class:"chs-node"},Yl=["innerHTML"],Jl=["onMousedown","for"],Ql=["id","checked"],Zl=["innerHTML"],ei=["innerHTML"],ti={key:0,class:"spin-loding-style"},si=Kl(()=>a("div",null,null,-1));function li(e,s,i,o,t,l){const n=w("RecycleScroller"),r=w("Spin"),d=w("Message"),c=U("tooltip"),m=U("esc");return C((h(),u("div",Wl,[C(a("input",{class:"chs-input-er",ref:"chsInputRef",placeholder:"搜索信号名称/信号描述","onUpdate:modelValue":s[0]||(s[0]=f=>t.inputStr=f),onInput:s[1]||(s[1]=(...f)=>l.onChange&&l.onChange(...f)),draggable:!1},null,544),[[Y,t.inputStr]]),a("div",Xl,[g(n,{class:"chs-list",items:l.list,"item-size":28,"key-field":"_id"},{default:T(({item:f})=>[f.node_type=="channel"?(h(),u("div",Gl,b(f.text),1)):f.node_type=="msg"?(h(),u("div",{key:1,class:"chs-node",style:{"text-indent":"1em"},innerHTML:l.highlightWord(f.text)},null,8,Yl)):f.node_type=="signal"?C((h(),u("div",{key:2,onMousedown:N(y=>l.selectNode(f),["prevent","stop"]),for:f._id,style:{"text-indent":"2em"},class:"chs-node chs-node-item"},[a("input",{id:f._id,type:"checkbox",class:"chs-node-checkbox",checked:t.checkedList.some(y=>y._id===f._id)},null,8,Ql),a("span",{class:"chs-node-signal",innerHTML:l.highlightWord(f.text)},null,8,Zl),k(" "),a("span",{class:"chs-node-comment",innerHTML:l.highlightWord(f.comment)},null,8,ei)],40,Jl)),[[c,{content:l.title4node(f),html:!0},void 0,{right:!0}]]):v("",!0)]),_:1},8,["items"]),a("div",{class:pe(t.checkedList.length==30?"chs-ft-label-len":"chs-ft-label")},"（"+b(t.checkedList.length)+"/30）",3),a("div",{class:"chs-btn confirm","data-cy":"chooseSignalSubmit",onClick:s[2]||(s[2]=(...f)=>l.submit&&l.submit(...f))},"确定"),a("div",{class:"chs-btn cancel",onClick:s[3]||(s[3]=f=>e.$emit("cancel"))},"取消"),e.$props.loading?(h(),u("div",ti,[si,g(r)])):v("",!0),g(d,{message:t.message},null,8,["message"])])])),[[m,()=>e.$emit("cancel")]])}const ii=E(zl,[["render",li],["__scopeId","data-v-82c5920a"]]);const ai={props:["chartTableData","showSignalsList"],computed:{mergedArray(){return this.$props.chartTableData.map(e=>{const s=this.$props.showSignalsList.find(i=>i.name===e.name);return s?{...e,...s}:e})}},watch:{mergedArray:{deep:!0,handler(e,s){this.mergedArray.forEach((i,o)=>{var l,n,r,d;let t=Math.trunc((i.raw_values[((l=i.raw_values)==null?void 0:l.length)-1]-Math.abs(i.minRaw))/(i.maxRaw-Math.abs(i.minRaw))*100)>100?100:Math.trunc((i.raw_values[((n=i.raw_values)==null?void 0:n.length)-1]-Math.abs(i.minRaw))/(i.maxRaw-Math.abs(i.minRaw))*100);this.mergedArray[o].proportion=t,console.log(this.mergedArray[o].proportion,i.raw_values[((r=i.raw_values)==null?void 0:r.length)-1]-Math.abs(i.minRaw),Math.abs(i.minRaw),(i.raw_values[((d=i.raw_values)==null?void 0:d.length)-1]-Math.abs(i.minRaw))/(i.maxRaw-Math.abs(i.minRaw))*100,"11111111")})}}},data(){return{}}},Pe=e=>(B("data-v-170cda80"),e=e(),j(),e),ni={style:{"overflow-y":"auto",height:"calc(100vh - 215px)",border:"1px solid #f0f0f0",width:"calc(100% - 20px)",position:"relative"}},oi={class:"o-table"},ri=Pe(()=>a("thead",{class:"o-table-thead",style:{"background-color":"#FAFAFA"}},[a("tr",null,[a("th",{class:"o-table-cell"},[a("div",{style:{display:"flex","justify-content":"space-between","align-items":"center"}},[a("div",null,"Name"),a("div",{class:"time-line"})])]),a("th",{class:"o-table-cell"},[a("div",{style:{display:"flex","justify-content":"space-between","align-items":"center"}},[k(" Value "),a("div",{class:"time-line"})])]),a("th",{class:"o-table-cell"},[a("div",{style:{display:"flex","justify-content":"space-between","align-items":"center"}},[k(" Unit "),a("div",{class:"time-line"})])]),a("th",{class:"o-table-cell"},[a("div",{style:{display:"flex","justify-content":"space-between","align-items":"center"}},[k(" Raw Value "),a("div",{class:"time-line"})])]),a("th",{class:"o-table-cell"},[a("div",{style:{display:"flex","justify-content":"space-between","align-items":"center"}},[k(" Bar "),a("div",{class:"time-line"})])]),a("th",{class:"o-table-cell"},"Commont")])],-1)),di={class:"o-table-tbody"},ci={key:0,class:"o-pul-button-wrap-icon"},hi=Pe(()=>a("img",{class:"text-muted-ing-data",src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAKAAAACICAMAAABX7hBEAAAAM1BMVEUAAAD////Nzc0MDAyXl5cAAAAAAAC9vb3t7e0BAQF1dXUAAAApKSkAAABBQUFXV1cAAACKKc10AAAAEXRSTlMATExMTAk1TExBTCFLF0tMKkK5GFYAAAL4SURBVHja7JntauswDIZty7Is+fP+r/Y0dUOz0BZzMKkGe35sMFh5Kr2Sndb88cd/gR2NahBAuWJolZNmxd6iz1z0KiJEGwVCMVoBsvauqLWIQaxVrZhqtHeoscqBRiY7iJRVDjSL3dkGWt+09GqtasUCWSg+FSUrm5ZQJUNuPu6STtdAF/DOkVSAKm5XbIpOaG7uDvmWAZqPyhQLkCM3oFFI726SkZRcIoKQ5NrEE9HTUShuA63ghC5ADUC27kJum+febPFRwSUCueXsx32BvNThKeLvhczef3ugE0AlqmIHMUbnpQ3P2mD7Bd9URIZKzkmN9shNc5TzwfcuER2g3aiwC548yUvLQ9FcDqIxKQyA7FuirwAczLVgCpyOu+aNHEkGDpfvQ+zMHfF8aT33V2re5C7PHyY+bzfM7ly5BkPuepC5mDPsj3J1tPU7lJc7I4gKuRuJy8s/55WZW+9nkBXI3Sic3pknDZ9+4M1PNV3To8YLEEopGjr5jgDAzOoee3ewj8egpNQQGcIjiWwUgtz3EUaNJcQQnl5B4bIJwSCjGfRutFEYN0G9FeRkNkG1GUTAg1didbu6h/vPIVYUHsgjdBg4lRQU+u3NxcSs8oN81Be6Xyeobq/sfGkzY5ilvDjbSljF+74kaDJDYxxOxxBy80uon5IdMrkZHi+CgMcnYLuEnD7Gvk0ZUu6nECKLXQJ9Xg2Fxc3gYRwiz3+ENQWMNU18PzSBAP6cr1UFBDSf6UBzhj9akfIVBRyEOhfDGtAsT6Df3/aiQdlJdVEBnyO8alAG7C8p4E6ajSHg4gRCMlP0PNfk9tjXqwu4OoYpX5bAHZyP4dICmhMr9nUxfXkBlw4K/2vfXlIABKEAikbaR7P9b7d5kxREDM5dwVGcPNS71wbm1PhmI1ZVQjn6FK7GoXx0rRNOipULj2eX4r60AteqQqcjCAgICAgICAgICAgICAgICAgICAgICAgICAgI+BdgHn3buX1/XJmr9AZus7VIkiRJD2y6ViB4C1+1AAAAAElFTkSuQmCC",alt:""},null,-1)),ui=Pe(()=>a("td",{class:"text-center text-muted-data"},"请先选择信号并确认",-1)),mi=[hi,ui],pi={class:"o-table-cell"},fi={class:"o-table-cell"},gi={class:"o-table-cell"},bi={class:"o-table-cell"},_i={class:"o-table-cell",style:{width:"230px"}},yi={class:"o-table-cell"},wi={style:{width:"360px","white-space":"nowrap",overflow:"hidden","text-overflow":"ellipsis"}};function vi(e,s,i,o,t,l){var r;const n=U("tooltip");return h(),u("div",ni,[a("table",oi,[ri,a("tbody",di,[((r=l.mergedArray)==null?void 0:r.length)==0?(h(),u("div",ci,mi)):v("",!0),(h(!0),u(D,null,L(l.mergedArray,(d,c)=>{var m,f,y,R;return h(),u("tr",{key:c},[a("td",pi,b(d.name),1),a("td",fi,b(((m=Object.keys(d.enums))==null?void 0:m.length)===0?d.values[((f=d.values)==null?void 0:f.length)-1]:d.enums[d.values[((y=d.values)==null?void 0:y.length)-1]]),1),a("td",gi,b(d.unit),1),a("td",bi,b(d.raw_values[((R=d.raw_values)==null?void 0:R.length)-1]),1),a("td",_i,[a("div",{style:$({width:d.proportion+"%"}),class:"proportion"},null,4)]),C((h(),u("td",yi,[a("div",wi,b(d.comment),1)])),[[n,d.comment]])])}),128))])])])}const Ci=E(ai,[["render",vi],["__scopeId","data-v-170cda80"]]);let Ye=0;const ki={props:["store","closeFlag","getDbcData","dbcVal","sdb","dbcChn","ldfChn","chartTableData"],emits:["connect","showMessage","getCarCode"],components:{Button:K,TableChart:Ci,Header:rt,ManageViewsGroup:wt,Draggable:vt,ChooseSignal:ii,AddOrSelector:bt,TimePlotMulti:_t,ProgressBar:yt,Message:J,ButtonGroup:ve,Switch:ql},data(){var s,i,o;let e=(s=this.$ls.get("blfread_treeData"))==null?void 0:s.map(t=>({...t,carType:t.carType||"MS11",sdb:t.sdb||"E4U1",children:t.children.map(l=>({...l,warning:!1,pid:t.id,color:l.color||"blue"}))}));return(!e||(e==null?void 0:e.length)===0)&&(e=[]),e=e.filter(t=>!(t.carType==="MS11"&&t.sdb==="E4U1"&&t.text==="默认视图"&&t.children.length===0)),e.some(t=>t.carType==="MS11"&&t.sdb==="E4U1"),this.$ls.set("blfread_treeData",e),{system:ue,modeOptions:[{label:"分散",value:"single"},{label:"对齐",value:"same"},{label:"聚合",value:"shifted"}],chartMode:"single",timeFilterOptions:[{label:"绝对时间",value:"absolute"},{label:"相对时间",value:"relative"}],timeFilterMode:{label:"绝对时间",value:"absolute"},startTime:0,showDotsFrame:!1,fileType:"blf",blfcpp:"cpp",isBigFile:!1,chooseSignalAble:!1,message:{visible:!1,level:"",content:""},modal:{title:"导入文件",visible:!1},manageModal:{title:"管理视图",manageVisible:!1},treeData:e.map(t=>(t.children.forEach(l=>{l.warning=!1}),t)),curView:{label:(i=e[0])==null?void 0:i.text,value:0,tag:(o=e[0])==null?void 0:o.sdb},C2C:[],colorList:["blue","cerulean","cyan","green","lime","purple","pink","red","orange","yellow"],sdb:"E4U3_1115",directory:"",carType:"MS11",directorySize:{label:"",value:0,durationMaybe:0,durationMaybeLabel:"0秒"},backBlock:!1,chartDataLoaded:!0,waitChart:{},fileChoosed:!1,traceList:new Map,timeData:Object.freeze([]),tableList:[],channelVersion:[{label:"全部",value:""}],channelVal:"全部",ECUVersion:[{label:"全部",value:""}],ECUVal:"全部",canIdsVersion:[{label:"全部",value:""}],canIdsVal:"全部",filterTableList:[],columnDefs:[{headerName:"Time",field:"timeTabData"},{headerName:"Chn",field:"chnTabData",width:80},{headerName:"ID",field:"idTabData",width:80},{headerName:"Name",field:"nameTabData",width:300},{headerName:"Event Type",field:"eventTabData"},{headerName:"Dir",field:"dirTabData",width:80},{headerName:"DLC",field:"dlcTabData",width:80},{headerName:"文本ECU",field:"dataTabData"}],debug:window._debug,signalLoading:!1,defaultOptions:{},filledOptions:{},showSignalsList:[],objSing:{},mlistChart:[{key:"timeChart",name:" 切换为折线图",icon:"box"},{key:"tableChart",name:"切换为表格",icon:"setting"}],curChart:"timeChart",tablechartShow:!0,timechartShow:!1,timeLimit:10,minTime:0,turnTimeLimit:!1}},computed:{sdbVal(){return[this.carType,this.$props.sdb]},quitConfirm(){return!!this.directory.trim()},treeDataDbc(){return this.treeData.map((e,s)=>({...e,label:e.text,value:s,tag:e.sdb})).filter(e=>e.carType===this.carType&&e.sdb===this.sdb)},carTypeLabel(){return this.carType&&this.carType!=="custom"?this.carType+" / ":""},view(){var e;return this.treeData[(e=this.curView)==null?void 0:e.value]},directoryLabel(){let e=this.directory.split("/").pop();return e.length>25?e.slice(0,10)+"..."+e.slice(-15):e},fileType_CarType(){return[this.fileType,this.carType]}},mounted(){this.debug=!!window._debug,this.fillEmptyTreeData(),this.curView=this.treeDataDbc[0],he.report("trackPage",{page:"查看报文",tip:"1174.10.0.1.27765"}),window._timeData=this.timeData},beforeUnmount(){this.timeData=[]},unmounted(){x.blf.freeSpace(),x.ascReader.freeSpace(),x.logReader.freeSpace(),window._timeData.forEach(e=>{e.t.length=0})},watch:{fileType_CarType(){this.fileType==="mdf"?this.blfcpp="cpp":this.debug||(this.carType==="custom"?this.blfcpp="python":this.blfcpp="cpp")},blfcpp:{handler(e){window._blfcpp=e},immediate:!0},sdbVal:{handler(e){var o,t,l;this.sdb=this.$props.sdb;let s=[];this.curView=this.treeDataDbc[0];const i=this.$ls.get("blfread_sdbData")||[];if(this.carType==="custom"){let n=(o=i.find(r=>r.sdb===this.sdb))==null?void 0:o.comments;n&&(s=["",...n])}else s=((l=(t=SDB.DEFAULT.find(n=>n.value===this.carType))==null?void 0:t.children.find(n=>n.value===this.sdb))==null?void 0:l.comments)||[];this.C2C=s.map((n,r)=>"".concat("⓪①②③④⑤⑥⑦⑧⑨⑩⑪⑫⑬⑭⑮⑯⑰⑱⑲⑳㉑㉒㉓㉔㉕㉖㉗㉘㉙㉚㉛㉜㉝㉞㉟㊱㊲"[r]).concat(n))},immediate:!0},chartDataLoaded(e,s){e?(this.backBlock=!1,document.querySelector(".o-body").style.cursor=""):(this.backBlock=!0,document.querySelector(".o-body").style.cursor="wait")},treeData:{handler(e,s){JSON.stringify(this.$ls.get("blfread_treeData"))!==JSON.stringify(e)&&this.$ls.set("blfread_treeData",e)},deep:!0},chooseSignalAble:{handler(){this.filledOptions=this.$props.getDbcData}},directory:{async handler(e){const s=await ee.getFileSize(e),i=.83*.2,o=Math.round((1678e-19*s*s+1768e-10*s+.5581)*i);this.directorySize={label:kt(s),value:s,durationMaybe:o*1e3,durationMaybeLabel:Tt(o)}}},curView:{handler(e){this.updateSignal(this.view.children)},deep:!0},dbcVal:{handler(e){this.carType=e==="自定义模板"?"custom":e.split("/")[0]},deep:!0}},beforeUpdate(){},methods:{choose(e){this.curChart=e,e=="timeChart"?(this.timechartShow=!1,this.tablechartShow=!0):e=="tableChart"&&(this.timechartShow=!0,this.tablechartShow=!1)},upTimeData(e){if(!((e==null?void 0:e.length)>0))return;let s=Date.now()/1e3-(this.turnTimeLimit?this.timeLimit:1200);console.log("minTime",s),console.log("this.timeData1111",this.timeData);let i=this.timeData.slice();console.log("pieceData1850",e,i),e.forEach(o=>{var l;let t=i.find(n=>n.channel===o.busId&&n.name===o.name);for(;((l=t==null?void 0:t.t)==null?void 0:l[0])<s;)t.t.shift(),t.v.shift();t&&(t.t.push(...o.times.map(n=>+n.toFixed(3))),t.v.push(...o.values))}),this.timeData=Object.freeze(i),console.log("this.timeData",this.timeData,this.view),this.loadChart(this.view)},onUpdateDefaultOptions(e){this.defaultOptions=Object.freeze(e)},title4node(e){return we(e)},showMessage({level:e,content:s,timeout:i}){clearTimeout(Ye),e!=null&&(this.message.level=e),s!=null&&(this.message.content=s),this.message.visible=!0,i>0&&(Ye=setTimeout(()=>{this.message.visible=!1},i))},hideMessage(){this.message.visible=!1},onTreeDataChange(){this.treeData=this.$ls.get("blfread_treeData")},fillEmptyTreeData(){SDB.DEFAULT.forEach(e=>{e.children.forEach(s=>{this.treeData.some(i=>i.carType===e.value&&i.sdb===s.value)||this.treeData.push({id:+Math.random().toString().replace(".",""),text:"默认视图",type:"view",editable:!1,carType:e.value,sdb:s.value,deleteConfirm:!1,children:[]})})})},deleteView(e){let s=this.treeData.filter(i=>i.id!==e.id);this.curView.value=s.findIndex(i=>i.id===this.view.id),this.treeData=s},updateView(e){this.treeData=this.treeData.map(s=>s.id===e.id?e:s)},onImportView(e){this.addView(e)},resetTimeData(){this.directory="",this.backBlock=!1,this.chartDataLoaded=!0,this.waitChart={},this.fileChoosed=!1,this.traceList=new Map},choosePath(){this.fileType==="blf"?(this.chartDataLoaded=!1,this.clearTimeData(),x.blf.getBLFdata({blfFile:this.directory,mode:this.isBigFile?"bigFile":void 0}).then(async e=>{this.startTime=e.data.startTime,this.fileChoosed=!0,this.treeData.forEach(i=>{this.waitChart[i.id]=!0});let s=this.treeData.slice();s.splice(this.curView.value,1),s.unshift(this.treeData[this.curView.value]),s=s.filter(i=>i.carType===this.carType&&i.sdb===this.sdb),x.blf.haveDataSignal({}).then(i=>{this.filledOptions=Object.freeze(i.data),this.signalLoading=!1});for(let i=0;i<s.length;i++)await this.play(s[i]),i===0&&(this.chartDataLoaded=!0)}).catch(()=>{}).finally(()=>{this.chartDataLoaded=!0,this.signalLoading=!1})):this.fileType==="mdf"?(async()=>{this.signalLoading=!1,this.chartDataLoaded=!1,this.clearTimeData(),this.fileChoosed=!0,this.treeData.forEach(s=>{this.waitChart[s.id]=!0});let e=this.treeData.slice();e.splice(this.curView.value,1),e.unshift(this.treeData[this.curView.value]),e=e.filter(s=>s.carType===this.carType&&s.sdb===this.sdb),await this.play(this.treeData[this.curView.value]);for(let s=0;s<e.length;s++)await this.play(e[s]),s===0&&(this.chartDataLoaded=!0)})():this.fileType==="asc"?(this.chartDataLoaded=!1,this.clearTimeData(),x.ascReader.getAscdata({ascFile:this.directory}).then(async e=>{var i,o;this.startTime=((o=(i=e.data)==null?void 0:i.data)==null?void 0:o.startTime)||0,this.fileChoosed=!0,this.treeData.forEach(t=>{this.waitChart[t.id]=!0});let s=this.treeData.slice();s.splice(this.curView.value,1),s.unshift(this.treeData[this.curView.value]),s=s.filter(t=>t.carType===this.carType&&t.sdb===this.sdb),x.ascReader.haveDataSignal({ascFile:this.directory}).then(t=>{this.filledOptions=Object.freeze(t.data),this.signalLoading=!1});for(let t=0;t<s.length;t++)await this.play(s[t]),t===0&&(this.chartDataLoaded=!0)}).catch(()=>{}).finally(()=>{this.chartDataLoaded=!0,this.signalLoading=!1})):this.fileType==="log"&&(this.chartDataLoaded=!1,this.clearTimeData(),x.logReader.getLogData({logFile:this.directory}).then(async e=>{var i,o;this.startTime=((o=(i=e.data)==null?void 0:i.data)==null?void 0:o.startTime)||0,this.fileChoosed=!0,this.treeData.forEach(t=>{this.waitChart[t.id]=!0});let s=this.treeData.slice();s.splice(this.curView.value,1),s.unshift(this.treeData[this.curView.value]),s=s.filter(t=>t.carType===this.carType&&t.sdb===this.sdb),x.logReader.haveDataSignal({ascFile:this.directory}).then(t=>{this.filledOptions=Object.freeze(t.data),this.signalLoading=!1});for(let t=0;t<s.length;t++)await this.play(s[t]),t===0&&(this.chartDataLoaded=!0)}).catch(()=>{}).finally(()=>{this.chartDataLoaded=!0,this.signalLoading=!1}))},clearTimeData(){this.timeData=Object.freeze([]),this.treeData.forEach(e=>{e.children.forEach(s=>{s.warning=void 0})})},hideSignal(e,s){e.hidden=!e.hidden,this.play(s,!0)},deleteSignal(e){this.treeData=this.treeData.map(s=>{if(s.id==e.pid){let i={...s,children:s.children.filter(o=>!(o.id==e.id&&o.msg==e.msg&&o.channel==e.channel))};return this.$nextTick(()=>this.play(i,!0)),i}return{...s}})},async play(e,s){console.log("this.$props.getDbcData1041",this.$props.getDbcData),this.loadChart(e)},loadChart(e){console.log("node1727",e,this.timeData);const s={blue:"#2266ff",cerulean:"#00c7f2",cyan:"#00e0b8",green:"#3fd926",lime:"#add900",purple:"#8125ff",pink:"#ff4475",red:"#ff3838",orange:"#ffad4d",yellow:"#f1d900"},i=e.children.filter(o=>!o.hidden).map((o,t)=>{const l=this.timeData.find(n=>o.channel===n.channel&&o.text===n.name);return l?{...l,color:s[o.color]}:{name:o.text,enums:o.enums,channel:o.channel,msg:o.msg,color:s[this.colorList[t%9]],t:[],v:[]}});this.timeData=Object.freeze(i)},tranLinCanId(e){const s=e.match(/\(([^)]+)\)/);if(s){const i=s[1],o=parseInt(i,16);return console.log(o),o}},async updateSignal(e,s){var l;console.log("signals8899",e,(l=this.curView)==null?void 0:l.value,this.treeData),e.length==0&&(this.timeData=Object.freeze([])),this.showSignalsList=[],e.forEach(n=>{let r={};r.busId=n.channel,r.canId=n.msg,r.name=n.text,r.color=n.color,r.maxRaw=+n.maxRaw,r.minRaw=+n.minRaw,r.comment=n.comment,r.unit=n.unit,r.enums=n.enums,r.id=n.androidId,this.showSignalsList.push(r)});let i=this.showSignalsList.filter((n,r)=>this.showSignalsList.findIndex(d=>d.name===n.name)===r),o=await x.blfLogging.selectShowSignals(i);o.data.code!==1&&this.showMessage({timeout:2e3,level:"error",content:o.data.msg});const t=this.view;this.treeData=this.treeData.map(n=>{if(n.id==t.id){console.log("signals99",e);let r=e.map((c,m)=>{let f=n.children.find(y=>c.id==y.id&&c.msg==y.msg&&c.channel==y.channel);return f?{...f,pid:n.id,color:s=="1"||(c==null?void 0:c.colorEditable)==!1?c.color:this.colorList[m%9]}:{_id:c._id,pid:n.id,id:c.id,text:c.text,comment:c.comment,remark:c==null?void 0:c.remark,msg:c.msg,channel:c.channel,type:"signal",color:s=="1"||(c==null?void 0:c.colorEditable)==!1?c.color:this.colorList[m%9],colorEditable:!1,maxRaw:+c.maxRaw,minRaw:+c.minRaw,comment:c.comment,unit:c.unit,enums:c.enums}});return{...n,children:r}}return n}),this.upTimeData(),this.chooseSignalAble=!1},goBackHome(){this.$router.push({path:"/"})},importFile(){this.modal.visible=!0},addView(e){let s=e.label||"新建视图"+(this.treeData.length+1);if(this.treeData=[...this.treeData,{id:e.id||Date.now(),text:s,type:"view",editable:!1,deleteConfirm:!1,children:(e==null?void 0:e.children)||[],carType:(e==null?void 0:e.carType)||this.carType,sdb:(e==null?void 0:e.sdb)||this.sdb}],(e==null?void 0:e.from)==="AddOrSelector"){let i=this.treeData.length-1;this.curView={label:this.treeData[i].text,value:i}}},onSwitchView({fromNode:e,toNode:s}){this.view.id===e.id?this.curView.value=this.treeData.findIndex(i=>i.id===s.id):this.view.id===s.id&&(this.curView.value=this.treeData.findIndex(i=>i.id===e.id)),this.treeData=this.treeData.map(i=>i.id===e.id?s:i.id===s.id?e:i)},manageShow(){this.manageModal.manageVisible=!0},onCancelImportFile(){this.modal.visible=!1},async onCancelSelect(e){this.manageModal.manageVisible=!1;const s=this.treeData.findIndex(o=>o.id===e),i=this.treeData[s];if(console.log("view334",i),this.curView={label:this.treeData[s].text,value:s,tag:i.sdb},this.carType!==i.carType||this.sdb!==i.sdb){let o=[],t=[];if(i.carType==="custom"){const n=(this.$ls.get("blfread_sdbData")||[]).find(r=>r.sdb===i.sdb);o=n.files,t=n.comments}this.onCheckView({curId:i.id,carType:i.carType,sdb:i.sdb,directory:this.directory,files:o,comments:t})}else this.$nextTick(()=>{const o=i,t=o.id;this.waitChart[t]===void 0&&this.directory&&this.play(o)}),this.fileType=="mdf"&&this.play(this.treeData[this.curView.value])},onCheckView(e){this.signalLoading=!0,this.resetTimeData(),this.$nextTick(()=>{this.modal.visible=!1;let i=this.treeData.filter(o=>o.id===e.curId).map(o=>({label:o.text,value:this.treeData.findIndex(t=>t.id===e.curId)}));this.curView=i[0],this.carType=e.carType,console.log("data1725",e),this.sdb=e==null?void 0:e.sdb,this.directory=Ct(e.directory),this.files=e.files.length?e.files:void 0,this.comments=e.comments.length?e.comments:void 0,this.fileType=e.fileType,e.isBigFile!==void 0&&(this.isBigFile=e.isBigFile),e.fileType==="mdf"?x.mdf.getSignals({mdfPath:e.directory}).then(o=>{this.defaultOptions=Object.freeze(o.data.data)}).then(()=>{this.choosePath()}):this.$nextTick(async()=>{console.log("this.carType7788",this.carType),this.carType==="custom"?this.fileType==="blf"?await x.blf.getDBC({carType:this.carType,sdb:this.sdb,files:this.files,comments:this.comments}).then(o=>{this.defaultOptions=Object.freeze(o.data)}):this.fileType==="log"?await x.logReader.getDBC({carType:this.carType,sdb:this.sdb,files:this.files,comments:this.comments}).then(o=>{this.defaultOptions=Object.freeze(o.data)}):await x.ascReader.getDBC({carType:this.carType,sdb:this.sdb,files:this.files,comments:this.comments}).then(o=>{this.defaultOptions=Object.freeze(o.data)}):this.fileType==="blf"?await x.blf.reAdjust(e.sendReAdjust):this.fileType==="log"?(e.adaptedType=="noAdapted"&&await x.logReader.getDBC({carType:this.carType,sdb:this.sdb,files:this.files,comments:this.comments}).then(o=>{this.defaultOptions=Object.freeze(o.data)}),await x.logReader.reAdjust(e.sendReAdjust)):(e.adaptedType=="noAdapted"&&await x.ascReader.getDBC({carType:this.carType,sdb:this.sdb,files:this.files,comments:this.comments}).then(o=>{this.defaultOptions=Object.freeze(o.data)}),await x.ascReader.reAdjust(e.sendReAdjust)),console.log("this.defaultOptions",this.defaultOptions),this.choosePath()})}),he.report("track","click",{element_name:"查看报文",asset_name:this.directory+";",tip:"1174.10.0.1.27766"})},onExportDotsData(e){const s=e.map(i=>i.join("	")).join("\n");St(s,"tspa-打点-"+Ae()+".txt")},changeState(){this.turnTimeLimit=!this.turnTimeLimit,console.log("this.turnTimeLimit ? this.timeLimit : 1200",this.turnTimeLimit?this.timeLimit:1200)}}},q=e=>(B("data-v-57624029"),e=e(),j(),e),Si={class:"o-pul-er"},Ti={key:0,class:"o-column"},Di={class:"o-column-left"},Vi=q(()=>a("div",{class:"o-resize-bar"},null,-1)),xi=q(()=>a("div",{class:"o-resize-line"},null,-1)),Ii={class:"o-resize-save"},Li={class:"o-pul-board"},Fi={class:"o-pul-select-wrap"},Ri={class:"o-pul-button-wrap"},Mi=q(()=>a("i",{class:"t-icon chooseSignal"},null,-1)),Ei=q(()=>a("span",null,"选择信号",-1)),$i=[Mi,Ei],Ai=q(()=>a("span",{style:{color:"#D9D9D9","font-size":"18px",transform:"scaleX(0.5)"}},"|",-1)),Ni=q(()=>a("i",{class:"t-icon manageView"},null,-1)),Oi=q(()=>a("span",null,"管理视图",-1)),Pi=[Ni,Oi],Ui=["data-empty"],Hi=["data-hidden"],Bi=["data-open","onClick"],ji=["data-color","onClick"],qi=["onMouseleave"],zi=["title","data-color","onClick"],Ki={class:"t-node-text"},Wi={key:0,class:"t-node-warning"},Xi={key:1,class:"t-node-error"},Gi=["onClick"],Yi=["onClick"],Ji=q(()=>a("div",{class:"drag-icon"},null,-1)),Qi={class:"o-column-right"},Zi={class:"o-menu-chart"},ea=["data-active"],ta=q(()=>a("i",{class:"o-menu-chart-it-icon"},null,-1)),sa=["data-active"],la=q(()=>a("i",{class:"o-menu-chart-it-icon"},null,-1)),ia={class:"rec-body",style:{position:"relative"}},aa={class:"timechart-er"},na={class:"tch-tool-er"},oa={class:"tch-tool-hotkey-er"},ra={class:"timechart-hotkey"},da={class:"hotkey-more"},ca=q(()=>a("div",{class:"hotkey-icon-book"},null,-1)),ha={class:"hotkey-more-body"},ua=Ne('<li data-v-57624029><div class="timechart-hotkey-it" data-v-57624029>缩放横轴 <span class="hotkey-btn" data-v-57624029>ctrl+滚轮</span></div></li><li data-v-57624029><div class="timechart-hotkey-it" data-v-57624029>平移横轴 <span class="hotkey-btn" data-v-57624029>shift+滚轮</span></div></li><li data-v-57624029><div class="timechart-hotkey-it" data-v-57624029>缩放纵轴 <span class="hotkey-btn" data-v-57624029>alt+ctrl+滚轮</span></div></li><li data-v-57624029><div class="timechart-hotkey-it" data-v-57624029>平移纵轴 <span class="hotkey-btn" data-v-57624029>alt+shift+滚轮</span></div></li><li data-v-57624029><div class="timechart-hotkey-it" data-v-57624029>框选放大 <span class="hotkey-btn" data-v-57624029>左键拖拽</span></div></li><li data-v-57624029><div class="timechart-hotkey-it" data-v-57624029>复位轴 <span class="hotkey-btn" data-v-57624029>左键双击</span></div></li><li data-v-57624029><div class="timechart-hotkey-it" data-v-57624029>选择帧 <span class="hotkey-btn" data-v-57624029>左键单击</span></div></li>',7),ma={class:"timechart-hotkey-it"},pa={class:"hotkey-btn"},fa=q(()=>a("li",null,[a("div",{class:"timechart-hotkey-it"},[k("框选时段 "),a("span",{class:"hotkey-btn"},"shift+左键")])],-1)),ga={class:"tch-tool-blank-er"},ba=q(()=>a("div",{class:"tch-tool-span"},null,-1)),_a=q(()=>a("div",{class:"tch-tool-span"},null,-1)),ya=["id"],wa={class:"filter-time"},va={class:"filter-time-wrap"},Ca=q(()=>a("span",null,"筛选时间： 近 ",-1)),ka=["disabled"],Sa={class:"rec-body-table"},Ta=q(()=>a("div",{class:"table-data"},null,-1)),Da=[Ta],Va={key:1,class:"board-spin-er"},xa={class:"board-spin-progress"},Ia={class:"board-spin-text"};function La(e,s,i,o,t,l){var I;const n=w("AddOrSelector"),r=w("ChooseSignal"),d=w("Draggable"),c=w("Button"),m=w("v-select"),f=w("ButtonGroup"),y=w("TimePlotMulti"),R=w("Switch"),A=w("ProgressBar"),X=w("ManageViewsGroup"),_=w("Message"),M=U("tooltip");return h(),u(D,null,[a("div",Si,[l.view?(h(),u("div",Ti,[a("div",Di,[Vi,xi,a("div",Ii,[a("div",Li,[a("div",Fi,[g(n,{options:l.treeDataDbc,placeholder:"输入视图名称",modelValue:t.curView,"onUpdate:modelValue":s[0]||(s[0]=S=>t.curView=S),onAdd:l.addView},null,8,["options","modelValue","onAdd"])]),a("div",Ri,[a("div",{class:"head-btn",onClick:s[1]||(s[1]=N(()=>t.chooseSignalAble=!t.chooseSignalAble,["prevent","stop"]))},$i),Ai,a("div",{class:"head-btn",id:"delete_module",onClick:s[2]||(s[2]=S=>l.manageShow())},Pi),t.chooseSignalAble?(h(),O(r,{key:0,filledOptions:t.filledOptions,signals:l.view.children,onSignalsChange:l.updateSignal,loading:t.signalLoading,carType:t.carType,fileType:t.fileType,sdb:t.sdb,dbcVal:i.dbcVal,dbcChn:i.dbcChn,ldfChn:i.ldfChn,onCancel:s[3]||(s[3]=()=>t.chooseSignalAble=!1)},null,8,["filledOptions","signals","onSignalsChange","loading","carType","fileType","sdb","dbcVal","dbcChn","ldfChn"])):v("",!0)]),a("div",{class:"o-pul-tree-er","data-empty":l.view.children.length===0},[l.view?(h(),O(d,{key:0,onDrag:s[4]||(s[4]=N(()=>{},["stop"])),onDragstart:s[5]||(s[5]=N(()=>{},["stop"])),maxLevel:1,class:"t-list",modelValue:l.view.children,"onUpdate:modelValue":s[6]||(s[6]=S=>l.view.children=S),onAfterDrop:s[7]||(s[7]=S=>l.updateSignal(l.view.children,"1"))},{default:T(({node:S,stat:te})=>[a("div",{class:"t-node","data-type":"signal","data-hidden":S.hidden},[a("i",{class:"t-node-exp","data-open":te.open,onClick:z=>te.open=!te.open},null,8,Bi),k(),C((h(),u("i",{class:"t-node-icon","data-color":S.color,onClick:N(z=>S.colorEditable=!0,["stop","prevent"])},[C(a("div",{class:"color-picker",onMouseleave:z=>S.colorEditable=!1},[(h(!0),u(D,null,L(t.colorList,z=>(h(),u("div",{class:"color-item",title:z,"data-color":z,key:z,onClick:de=>{S.color=z,l.updateSignal(l.view.children,"1")}},null,8,zi))),128))],40,qi),[[P,S.colorEditable]])],8,ji)),[[M,"更改颜色"]]),C((h(),u("span",Ki,[a("span",null,b(t.fileType!=="mdf"?S.channel>1e3?"":t.C2C[S.channel]+"-":"")+b(S.text),1),S.warning===!0?C((h(),u("div",Wi,null,512)),[[M,"信号无数据"]]):v("",!0),!S.hidden&&S.warning===null?C((h(),u("div",Xi,null,512)),[[M,"文件内无此信号"]]):v("",!0)])),[[M,{content:l.title4node(S),html:!0},void 0,{right:!0}]]),C(a("div",{class:"t-node-delete",onClick:z=>l.deleteSignal(S)},null,8,Gi),[[M,"删除"]]),C(a("div",{class:"t-node-watch",onClick:z=>{l.hideSignal(S,l.view)}},null,8,Yi),[[M,"显示|隐藏"]])],8,Hi)]),_:1},8,["modelValue"])):v("",!0)],8,Ui)])]),Ji]),a("div",Qi,[a("div",Zi,[t.curChart!=="timeChart"?(h(),u("div",{key:0,class:"o-menu-chart-it-button","data-active":t.curChart==t.mlistChart[0].key||t.mlistChart[0].active,onClick:s[8]||(s[8]=S=>l.choose(t.mlistChart[0].key))},[ta,k(" "+b(t.mlistChart[0].name),1)],8,ea)):(h(),u("div",{key:1,class:"o-menu-chart-it-button","data-active":t.curChart==t.mlistChart[1].key||t.mlistChart[1].active,onClick:s[9]||(s[9]=S=>l.choose(t.mlistChart[1].key))},[la,k(" "+b(t.mlistChart[1].name),1)],8,sa))]),C(a("div",ia,[a("div",aa,[a("div",na,[a("div",oa,[a("div",ra,[a("div",da,[ca,k("快捷键 "),a("div",ha,[a("ul",null,[ua,a("li",null,[a("div",ma,[k("打点 "),a("span",pa,b(t.system==="mac"?"option":"alt")+"+左键",1)])]),fa])])])])]),a("div",ga,[C((h(),O(c,{class:"tch-tool-btn",onClick:s[10]||(s[10]=S=>t.showDotsFrame=!t.showDotsFrame)},{default:T(()=>[k("打点")]),_:1})),[[M,"alt+左键"]]),ba,C(g(m,{options:t.timeFilterOptions,clearable:!1,searchable:!1,label:"label",value:"value",modelValue:t.timeFilterMode,"onUpdate:modelValue":s[11]||(s[11]=S=>t.timeFilterMode=S),class:"tch-tool-select"},null,8,["options","modelValue"]),[[M,"时间显示"]]),_a,g(f,{options:t.modeOptions,modelValue:t.chartMode,"onUpdate:modelValue":s[12]||(s[12]=S=>t.chartMode=S)},null,8,["options","modelValue"])])]),(h(),u("div",{id:"timechart_"+l.view.id,style:$("width: 100%; height: calc(100% - 93px);min-height: ".concat(t.chartMode==="single"?(((I=t.timeData)==null?void 0:I.length)||0)*40+1:1,"px;")),key:l.view.id},[t.timeData.length>0&&t.timeData.some(S=>S.t)?(h(),O(y,{key:0,"data-cy":"timePlotMulti",fileType:t.fileType,timeData:t.timeData,showEnum:!0,mode:t.chartMode,startTime:t.startTime,timeFilter:t.timeFilterMode.value,showExport:!1,showDotsFrame:t.showDotsFrame,"onUpdate:showDotsFrame":s[13]||(s[13]=S=>t.showDotsFrame=S),monitor:!0},null,8,["fileType","timeData","mode","startTime","timeFilter","showDotsFrame"])):v("",!0)],12,ya)),a("div",wa,[g(R,{modelValue:t.turnTimeLimit,"onUpdate:modelValue":s[14]||(s[14]=S=>l.changeState()),id:t.turnTimeLimit},null,8,["modelValue","id"]),a("div",va,[Ca,C(a("input",{class:"input",type:"number",placeholder:"输入数字",disabled:!t.turnTimeLimit,min:"0",max:"1200","onUpdate:modelValue":s[15]||(s[15]=S=>t.timeLimit=S),onInput:s[16]||(s[16]=(...S)=>e.onChange&&e.onChange(...S))},null,40,ka),[[Y,t.timeLimit,void 0,{lazy:!0}]]),k(" 秒 ")])])])],512),[[P,!t.timechartShow]]),C(a("div",Sa,Da,512),[[P,!t.tablechartShow]])])])):v("",!0),t.chartDataLoaded?v("",!0):(h(),u("div",Va,[a("div",xa,[t.directorySize.durationMaybe?(h(),O(A,{key:0,second:t.directorySize.durationMaybe},null,8,["second"])):v("",!0)]),a("div",Ia,"正在解析文件 "+b(l.directoryLabel)+"（"+b(t.directorySize.label)+"），约"+b(t.directorySize.durationMaybeLabel)+"…",1)]))]),t.manageModal.manageVisible?(h(),O(X,{key:0,fileType:t.fileType,propTreeData:t.treeData,curViewInx:t.curView.value,title:t.manageModal.title,onCancel:l.onCancelSelect,onDelete:l.deleteView,onUpdate:l.updateView,onImport:l.onImportView,onAdd:l.addView,onSwitch:l.onSwitchView},null,8,["fileType","propTreeData","curViewInx","title","onCancel","onDelete","onUpdate","onImport","onAdd","onSwitch"])):v("",!0),g(_,{message:t.message},null,8,["message"])],64)}const Fa=E(ki,[["render",La],["__scopeId","data-v-57624029"]]);let Se;const Ra={name:"ScrollBar",props:["modelValue","start","end","disable","timeFilter","startTime"],emits:["update:modelValue","change"],data(){return{lineTop:0,scrollTop:0,lineTitle:"",scrollTitle:"",lineVisible:!1,dragging:!1,dragHover:!1}},methods:{enterHandler(){this.dragging||(this.lineVisible=!0)},leaveHandler(){this.lineVisible=!1},moveHandler(e){this.lineVisible&&(e.offsetY<0||e.offsetY>=this.$refs.root.clientHeight-28||(this.lineTop=e.offsetY,this.lineTitle=this.tooltipFormatter(this.$props.start+(this.$props.end-this.$props.start)*e.offsetY/(this.$refs.root.clientHeight-28))))},clickHandler(e){this.scrollTop=e.offsetY;const s=this.$props.start+(this.$props.end-this.$props.start)*this.scrollTop/(this.$refs.root.clientHeight-28);this.$emit("update:modelValue",s),this.$emit("change",s)},tooltipFormatter(e){return parseInt(e)/1e3},timeStrFilter(e){return this.$props.timeFilter==="absolute"?new Date(e*1e3+(this.$props.startTime||0)).toLocaleString("zh-Hans-CN",{hour:"2-digit",minute:"2-digit",second:"2-digit",fractionalSecondDigits:3,hourCycle:"h23",timeZone:"Asia/Shanghai"}):e},blockDownHandler(){this.dragging=!0,Se=void 0},blockUphandler(){if(this.dragging){this.dragging=!1;const e=this.$props.start+(this.$props.end-this.$props.start)*this.scrollTop/(this.$refs.root.clientHeight-28);this.$emit("update:modelValue",e),this.$emit("change",e)}},blockLeaveHandler(){this.enterHandler(),this.dragHover=!1},blockEnterHandler(){this.leaveHandler(),this.dragHover=!0},blockMoveHandler(e){if(this.dragging){let s=0;Se!=null&&(s=e.pageY-Se),Se=e.pageY,console.log("move",e.pageY);let i=this.scrollTop+s;const o=this.$refs.root.clientHeight;if(i<0){if(this.scrollTop===0)return;i=0}else if(i>o-28){if(this.scrollTop===o-28)return;i=o-28}this.scrollTop=i,this.scrollTitle=this.tooltipFormatter(this.$props.start+(this.$props.end-this.$props.start)*this.scrollTop/(this.$refs.root.clientHeight-28))}}},watch:{modelValue(e){if(this.dragging)return;let s=(e-this.$props.start)/(this.$props.end-this.$props.start);this.scrollTop=parseInt(s*(this.$refs.root.clientHeight-28)),this.scrollTitle=this.tooltipFormatter(e),this.dragging=!1,this.dragHover=!1},end(e){if(this.dragging)return;let s=(this.$props.modelValue-this.$props.start)/(this.$props.end-this.$props.start);this.scrollTop=parseInt(s*(this.$refs.root.clientHeight-28))}},mounted(){window.addEventListener("mouseup",this.blockUphandler),window.addEventListener("mousemove",this.blockMoveHandler)},unmounted(){window.removeEventListener("mouseup",this.blockUphandler),window.removeEventListener("mousemove",this.blockMoveHandler)}},Ma=["data-disable"],Ea=["data-active"],$a={class:"block-title"},Aa={class:"line-title"},Na=["data-active"];function Oa(e,s,i,o,t,l){return h(),u("div",{class:"bar-er","data-disable":e.$props.disable,ref:"root",onClick:s[5]||(s[5]=N((...n)=>l.clickHandler&&l.clickHandler(...n),["prevent","stop"])),onMousemove:s[6]||(s[6]=(...n)=>l.moveHandler&&l.moveHandler(...n)),onMouseenter:s[7]||(s[7]=(...n)=>l.enterHandler&&l.enterHandler(...n)),onMouseleave:s[8]||(s[8]=(...n)=>l.leaveHandler&&l.leaveHandler(...n))},[a("div",{class:"bar-block","data-active":t.dragging,onClick:s[0]||(s[0]=N(()=>{},["prevent","stop"])),onMousedown:s[1]||(s[1]=(...n)=>l.blockDownHandler&&l.blockDownHandler(...n)),onMouseup:s[2]||(s[2]=(...n)=>l.blockUphandler&&l.blockUphandler(...n)),onMouseleave:s[3]||(s[3]=(...n)=>l.blockLeaveHandler&&l.blockLeaveHandler(...n)),onMouseenter:s[4]||(s[4]=(...n)=>l.blockEnterHandler&&l.blockEnterHandler(...n)),style:$({transform:"translateY("+t.scrollTop+"px)"})},[a("div",$a,b(l.timeStrFilter(t.scrollTitle)),1)],44,Ea),C(a("div",{class:"bar-line",style:$({transform:"translateY("+t.lineTop+"px)"})},[a("div",Aa,b(l.timeStrFilter(t.lineTitle)),1)],4),[[P,t.lineVisible]]),a("div",{class:"scroll-title","data-active":t.dragging},b(l.timeStrFilter(t.scrollTitle)),9,Na)],40,Ma)}const Pa=E(Ra,[["render",Oa],["__scopeId","data-v-af35b704"]]);const Ua={props:["col","asyncData"],emits:["change"],data(){return{options:[],loading:!1,current:[]}},methods:{async onMouseEnter(){this.loading=!0,this.options=[];try{this.options=await this.$props.asyncData(this.$props.col)}catch(e){}this.loading=!1},onModelValueChange(e){this.current=e,this.$emit("change",e)}},watch:{col:{handler(e){this.current=e.value},deep:!0}}},Ha=e=>(B("data-v-f346e8e4"),e=e(),j(),e),Ba=["data-active"],ja=Ha(()=>a("div",null,null,-1));function qa(e,s,i,o,t,l){var r;const n=w("v-select");return h(),u("div",{class:"select-icon","data-active":((r=t.current)==null?void 0:r.length)>0,onMouseenter:s[0]||(s[0]=(...d)=>l.onMouseEnter&&l.onMouseEnter(...d))},[a("div",{class:"flt-er",style:$({width:e.$props.col.width+40+"px"})},[g(n,{loading:t.loading,options:t.options,dropdownShouldOpen:()=>!0,searchable:!0,modelValue:t.current,"onUpdate:modelValue":l.onModelValueChange,multiple:""},{"no-options":T(()=>[ja]),_:1},8,["loading","options","modelValue","onUpdate:modelValue"])],4)],40,Ba)}const za=E(Ua,[["render",qa],["__scopeId","data-v-f346e8e4"]]);let Re=0,Me=0;const Ka={props:["rowData","columnsDef","columnsFilter","from","filters"],emits:["toggleExpand","scrollRow","scrollAction","filterItem","colFilterChange","updatePadding","timeModeChange"],components:{RecycleScroller:me,FilterItem:za},created(){this.$_scrollTimer=0},data(){return{isChildTit:!1,searchVal:"",isOpenSearch:!1,selectFilterList:[],showSelect:!1,curId:-1,filterChnItem:"",filterValItem:"",formData:{},filterList:{channel:"",canId:"",name:"",canType:"",dir:"",dlc:""},left:0,timeFilterOptions:[{label:"Time 绝对时间",value:"absolute"},{label:"Time 相对时间",value:"relative"},{label:"ΔTime 时间差",value:"diff"}],timeFilterMode:{label:"Time 绝对时间",value:"absolute"},selectionActive:!1}},computed:{fullWidth(){return"calc("+this.$props.columnsDef.map(e=>typeof e.width=="number"?e.width+"px":e.width).join(" + ")+")"}},watch:{rowData:{},timeFilterMode(e){this.onTimeModelChange(e.value)}},methods:{onScrollX(e){this.left=-e.target.scrollLeft+"px"},onTableClick(e){var s,i,o;if((o=(i=(s=e.target)==null?void 0:s.className)==null?void 0:i.includes)!=null&&o.call(i,"table-td")){this.selectionActive=!0;let t=window.getSelection();t.removeAllRanges();let l=document.createRange();l.selectNodeContents(e.target),t.addRange(l),t=l=null}},filterHex(e){return e===void 0?"":(e>=0?mt(e):e).toString().replace(/^(00)+/g,"")||"00"},update(e,s,i,o){Re=i,Me=this.$props.rowData.length-o,this.$emit("updatePadding",{visibleStartIndex:i,visibleEndIndex:o})},searchInfo(){this.isOpenSearch=!1},onOpenSearch(){this.isOpenSearch=!0},scrollToBottom(){var e;(e=this.$refs.scroller)==null||e.scrollToItem(this.$props.rowData.length-1)},scrollToItem(e){var s;(s=this.$refs.scroller)==null||s.scrollToItem(e)},nativeScroll(){const e=this.$refs.scroller.$el;e.addEventListener("scroll",s=>{if(clearTimeout(this.$_scrollTimer),this.selectionActive){this.selectionActive=!1;let i=window.getSelection();i.removeAllRanges(),i=null}}),e.addEventListener("wheel",s=>{this.$emit("scrollAction",{topPadding:Re,bottomPadding:Me}),s.deltaY>0||s.deltaX>0?Me<=40&&this.$emit("scrollRow","down"):(s.deltaY<0||s.deltaX<0)&&Re<=40&&this.$emit("scrollRow","up")})},filterItem(e,s){this.filterChnItem=e,this.curId=s,this.$emit("filterItem"),this.selectFilterList=[],x.blfLogging.getFiltItems({selectItem:e,channel:"",canId:"",name:"",canType:"",dir:"",dlc:""}).then(i=>{let o=i.data.data;o.length>0&&o.forEach(t=>{t&&this.selectFilterList.push({value:t,label:t,selected:!1})})})},onChooseFilterItem(e,s){e.selected=!0,this.$emit("reDrawTable",e,s,this.selectFilterList)},onTimeModelChange(e){this.$emit("timeModeChange",e)}},mounted(){this.nativeScroll()}},Ce=e=>(B("data-v-5dfe2c35"),e=e(),j(),e),Wa={style:{position:"absolute",left:"0",top:"0",right:"0",bottom:"0",display:"inherit","flex-direction":"inherit","align-items":"inherit"}},Xa={key:1,class:"o-pul-time-option-warp"},Ga=Ce(()=>a("div",{class:"table-header",style:{height:"32px","line-height":"32px"}},null,-1)),Ya=["data-even"],Ja=["onMousedown"],Qa=["onMousedown"],Za=Ce(()=>a("span",{class:"container-tit",style:{width:"205px"}},"信号名",-1)),en=Ce(()=>a("span",{class:"container-tit",style:{width:"200px"}},"信号物理值",-1)),tn=Ce(()=>a("span",{class:"container-tit",style:{width:"80px"}},"HEX",-1)),sn=Ce(()=>a("span",{class:"container-tit",style:{width:"calc(100vw - 487px)"}},"信号描述",-1)),ln=[Za,en,tn,sn],an={class:"table-parent-tr o-table-expand-child"},nn={class:"table-td",style:{width:"205px"}},on={class:"table-td",style:{width:"200px"}},rn={class:"table-td",style:{width:"80px"}},dn={class:"table-td",style:{width:"calc(100vw - 487px)"}};function cn(e,s,i,o,t,l){const n=w("FilterItem"),r=w("v-select"),d=w("RecycleScroller");return h(),u("div",{class:"table",onClick:s[2]||(s[2]=(...c)=>l.onTableClick&&l.onTableClick(...c))},[a("div",{class:"table-header",style:$({height:"32px",lineHeight:"32px",transform:"translateX("+t.left+")",width:l.fullWidth,position:"absolute",zIndex:1})},[a("div",Wa,[(h(!0),u(D,null,L(e.$props.columnsDef,(c,m)=>(h(),u("div",{class:"header-tit",key:m,style:$({width:c.width>0?c.width+"px":c.width})},[a("span",null,b(c.titName),1),c.filterShow?(h(),O(n,{key:0,onChange:f=>e.$emit("colFilterChange",{keyName:c.keyName,value:f}),col:c,asyncData:e.$props.columnsFilter},null,8,["onChange","col","asyncData"])):v("",!0),c.keyName=="timestamp"||c.keyName=="diff"||c.keyName=="deltaTime"?(h(),u("div",Xa,[g(r,{options:t.timeFilterOptions,clearable:!1,searchable:!1,label:"label",value:"value",modelValue:t.timeFilterMode,"onUpdate:modelValue":s[0]||(s[0]=f=>t.timeFilterMode=f),class:"canoe-frame-vselect"},null,8,["options","modelValue"])])):v("",!0)],4))),128))])],4),Ga,g(d,{items:e.$props.rowData,"item-size":24,"key-field":"id",emitUpdate:!0,onUpdate:l.update,ref:"scroller",class:"frame-class"},{default:T(({item:c,index:m})=>[c.isParent?(h(),u("div",{key:0,class:pe(c.canId!="0"?"table-parent-tr":"table-parent-tr-error"),"data-even":m%2===0,style:$({transform:"translateX("+t.left+")",width:l.fullWidth})},[(h(!0),u(D,null,L(e.$props.columnsDef,f=>(h(),u("div",{class:"table-td",style:$({width:typeof f.width=="number"?f.width+"px":f.width}),key:f.keyName},[f.custom?(h(),u(D,{key:0},[c.isExpand&&c.isParent&&c.name?(h(),u("i",{key:0,class:"collapse-icon",onMousedown:N(y=>e.$emit("toggleExpand",m),["stop","prevent"])},null,40,Ja)):v("",!0),c.isExpand===!1&&c.isParent&&c.name?(h(),u("i",{key:1,class:"expand-icon",onMousedown:N(y=>e.$emit("toggleExpand",m),["stop","prevent"])},null,40,Qa)):v("",!0)],64)):(h(),u(D,{key:1},[k(b(f.displayMap?f.displayMap(c[f.keyName]):c[f.keyName]),1)],64))],4))),128))],14,Ya)):(h(),u(D,{key:1},[c.isChildTit?(h(),u("div",{key:0,class:"table-header o-table-expand-child",style:$({transform:"translateX("+t.left+")",width:l.fullWidth})},ln,4)):(h(),u("div",{key:1,class:"table-parent",style:$({transform:"translateX("+t.left+")",width:l.fullWidth})},[a("div",an,[a("span",nn,b(c.name),1),a("span",on,b(c.value),1),a("span",rn,b(l.filterHex(c.hex)),1),a("span",dn,b(c.comment),1)])],4))],64))]),_:1},8,["items","onUpdate"]),a("div",{class:"table-scroll-x",onScroll:s[1]||(s[1]=(...c)=>l.onScrollX&&l.onScrollX(...c))},[a("div",{class:"table-scroll-x-bar",style:$({width:l.fullWidth})},null,4)],32)])}const hn=E(Ka,[["render",cn],["__scopeId","data-v-5dfe2c35"]]);const un={beforeMount(){console.log("this.params",this.params)},methods:{onExpand(){debugger;console.log("this.params.data",this.params.data),this.params.data.isExpand===!1?(this.params.node.setDataValue("isExpand",!0),this.params.api.applyTransactionAsync({add:[JSON.parse(this.params.data.parsedData)],addIndex:this.params.rowIndex+1})):(this.params.node.setDataValue("isExpand",!1),this.params.api.applyTransactionAsync({remove:this.params.api.getRowNode(this.params.rowIndex+1)})),this.params.api.redrawRows()}}};function mn(e,s,i,o,t,l){return h(),u("div",null,[e.params.data.isExpand?(h(),u("i",{key:0,class:"expand-icon",onClick:s[0]||(s[0]=(...n)=>l.onExpand&&l.onExpand(...n))})):(h(),u("i",{key:1,class:"collapse-icon",onClick:s[1]||(s[1]=(...n)=>l.onExpand&&l.onExpand(...n))})),a("span",null,b(e.params.value),1)])}const pn=E(un,[["render",mn]]),fn={methods:{onClick(){debugger}}},gn=Ne('<table><thead class="o-table-thead"><tr><th class="o-table-cell">信号</th><th class="o-table-cell o-cell-ar">信号物理值</th><th class="o-table-cell o-cell-ar">信号描述</th></tr></thead><tbody class="o-table-tbody"></tbody></table>',1),bn=[gn];function _n(e,s,i,o,t,l){return h(),u("div",{onClick:s[0]||(s[0]=(...n)=>l.onClick&&l.onClick(...n))},bn)}const yn=E(fn,[["render",_n]]);let Je=0,Qe=0,ce=0,fe=0,Te;const wn={props:["store","closeFlag","recentTest","connectStatus","colFilterShow","channelOne","channelTwo","channelThree","linChannelVal","linChannelValTwo","filePath","dbcVal","startTime","sn","dbcChn","ldfChn","channelValList","linChannelValList"],emits:["updateBock","updateTimeData","recordTimeChange","startTimeChange","chartTableFun"],components:{Button:K,Message:J,ScrollBar:Pa,ExpandInfo:pn,FullWidthCellRenderer:yn,TableRecycleScroller:hn,CopyPath:ut,ButtonGroup:ve},data(){return{expandKeys:new Set,visibleStartIndex:0,visibleEndIndex:0,bottomPadding:0,recordLoading:!1,mode:"all",sliderValue:-1,comments:["","","","","","","","","","","","","","","",""],message:{visible:!1,level:"",content:""},seconds:0,timeFilterModeVal:"absolute",rowData:[],isRecording:!1,startSqlId:0,endSqlId:0,isLock:!1,isScrollEnd:!0,isAddData:!0,secondConfirm:!1,topLock:!1,bottomLock:!1,openFlag:!1,mlist:[{key:"lookRecord",name:"帧查看",icon:"box"},{key:"supeRecord",name:"图像查看",icon:"setting"}],cur:"lookRecord",recordShow:!0,colorList:["blue","cerulean","cyan","green","lime","purple","pink","red","orange","yellow"],columnsDef:[{titName:"",width:30,keyName:"id",type:"number",value:[],filterShow:!1,custom:!0},{titName:"",width:164,keyName:this.timeFilterModeVal==="diff"?this.mode==="single"?"deltaTime":"diff":"timestamp",type:"number",value:[],filterShow:!1,displayMap:e=>{let s=parseFloat(e);switch(this.timeFilterModeVal){case"diff":return s.toFixed(6);case"absolute":return new Date(s*1e3).toLocaleString("zh-Hans-CN",{hour:"2-digit",minute:"2-digit",second:"2-digit",fractionalSecondDigits:3,hourCycle:"h23",timeZone:"Asia/Shanghai"});case"relative":return(e-this.startTime).toFixed(6);default:return e}}},{titName:"Chn",width:60,keyName:"channel",type:"number",value:[],filterShow:!0},{titName:"ID",width:60,keyName:"canId",type:"number",value:[],filterShow:!0,displayMap:e=>"0x"+e.toString(16)},{titName:"NAME",width:200,keyName:"name",type:"string",value:[],filterShow:!0},{titName:"Event",width:80,keyName:"canType",type:"string",value:[],filterShow:!0},{titName:"Dir",width:60,keyName:"dir",type:"string",value:[],filterShow:!0},{titName:"Dlc",width:60,keyName:"dlc",type:"number",value:[],filterShow:!0},{titName:"DATA",width:1380,keyName:"data",type:"string",value:[],filterShow:!1,displayMap:e=>e.map(s=>s.toString(16).padStart(2,"0")).join(" ")}]}},watch:{mode(e,s){this.topPadding=0,this.$refs.table.scrollToItem(0),this.expandKeys.clear(),this.rowData=[],this.isRecording&&this.resumeScroll()},filePath(){this.$emit("updateBock",{filePath:this.filePath,dbcVal:this.dbcVal,recordLoading:this.recordLoading,isRecording:this.isRecording})},dbcVal(){this.$emit("updateBock",{filePath:this.filePath,dbcVal:this.dbcVal,recordLoading:this.recordLoading,isRecording:this.isRecording})},recordLoading(){this.$emit("updateBock",{filePath:this.filePath,dbcVal:this.dbcVal,recordLoading:this.recordLoading,isRecording:this.isRecording})},isRecording(){this.$emit("updateBock",{filePath:this.filePath,dbcVal:this.dbcVal,recordLoading:this.recordLoading,isRecording:this.isRecording})},colComputed(){this.columnsDef[1]={titName:"",width:164,keyName:this.timeFilterModeVal==="diff"?this.mode==="single"?"deltaTime":"diff":"timestamp",type:"number",value:[],filterShow:!1,displayMap:e=>{let s=parseFloat(e);switch(this.timeFilterModeVal){case"diff":return s.toFixed(6);case"absolute":return new Date(s*1e3).toLocaleString("zh-Hans-CN",{hour:"2-digit",minute:"2-digit",second:"2-digit",hourCycle:"h23",timeZone:"Asia/Shanghai"})+"."+s.toFixed(6).split(".")[1];case"relative":return(e-this.startTime).toFixed(6);default:return e}}}}},computed:{colComputed(){return this.timeFilterModeVal+this.startTime+this.mode},recordTime(){return console.log("recordTime223",ze(parseInt((this.seconds*1e3).toString().split(".")[0]))),ze(parseInt((this.seconds*1e3).toString().split(".")[0]))},showData(){let e={mode:"all"};return this.columnsDef.forEach(s=>{s.filterShow&&(e[s.keyName]=(s.value||[]).map(i=>i.value))}),e},diffRowData(){return this.rowData.map((e,s,i)=>({...e,diff:s===0?0:i[s].timestamp-i[s-1].timestamp}))}},methods:{choose(e){this.cur=e,e=="supeRecord"?this.recordShow=!1:this.recordShow=!0},async colFilter(e){var n;const s=e.keyName==="name"?null:"";let i={selectItem:e.keyName,...this.showData,[e.keyName]:s},o;try{o=await await x.blfLogging.getFiltItems(i)}catch(r){}return(((n=o==null?void 0:o.data)==null?void 0:n.data)||[]).map(r=>({value:r,label:e.keyName==="canId"?"0x"+r.toString(16):r===""?" 空":r})).sort((r,d)=>(e.type==="number"?+r.value>+d.value:r.value>d.value)?1:-1)},startRecord(e){clearInterval(fe),this.checkHardware(e),this.isLock=!1,this.columnsDef=this.columnsDef.map(s=>({...s,value:[]}))},async endRecord(){this.recordLoading=!0,clearTimeout(ce),clearInterval(fe),x.blfLogging.stopLogging(),await ct(2e3),this.isRecording=!1,this.recordLoading=!1},async checkHardware(e){this.recordLoading=!1,this.secondConfirm=!1,console.log("调检查并连接硬件设备接口"),clearInterval(fe),this.isRecording=!0,this.startLogging(e),this.resumeScroll()},async startLogging(e){console.log("55666",e),this.seconds=0,this.rowData=[],this.$emit("startTimeChange",Date.now()/1e3),fe=setInterval(()=>{this.seconds=Date.now()/1e3-this.startTime},1e3),this.$emit("recordTimeChange",this.recordTime);let s=["","","","","","","","","","","","","","","",""];this.channelValList.forEach((l,n)=>{s[n]=l.split("-").pop()}),console.log("this.dbcChn07101822",this.dbcChn,s);let o=this.filePath.replace(".blf","-"+Ae()+".blf"),t=await x.blfLogging.startLogging({path:o,type:"blf",typelin:"asc",channel:3,sdb:this.dbcVal==="自定义模板"?"":this.dbcVal.split("/")[1],carType:this.dbcVal==="自定义模板"?"custom":this.dbcVal.split("/")[0],dbcChn:this.dbcChn,ldfChn:this.ldfChn,files:this.dbcVal==="自定义模板"?s:["","","","","","","","","","","","","","","",""],comments:this.comments,mode:e});console.log("startLoggin",t)},showMessage({level:e,content:s,timeout:i}){clearTimeout(Je),e!=null&&(this.message.level=e),s!=null&&(this.message.content=s),this.message.visible=!0,i>0&&(Je=setTimeout(()=>{this.message.visible=!1},i))},showLoggingMessage(){clearTimeout(ce),Te=async()=>{var i;this.showData.mode=this.mode;let e;try{e=await x.blfLogging.showLoggingMessage({...this.showData}),console.log("showLogginMsg",e)}catch(o){console.log("error",o)}if(this.$emit("chartTableFun",e.data.signal_data),console.log(e.data.signal_data,e.data,0x1ed6eb565788e400),!e)return;let s=((i=e==null?void 0:e.data)==null?void 0:i.frame_data)||[];if(!this.isLock&&(s==null?void 0:s.length)>0)if(this.mode==="all"){let o=s[0].sqlId,t=s[s.length-1].sqlId;s.forEach(l=>{l.isExpand=!1,l.isParent=!0,l.id=""+l.sqlId,l.canId=l.arbitrationId,delete l.arbitrationId}),this.startSqlId=o,this.endSqlId=t,Qe=s[s.length-1].timestamp,this.rowData=s,this.$refs.table.scrollToBottom(),this.isAddData&&(this.sliderValue=o/t*(Qe-this.startTime)*1e3)}else this.mode==="single"&&(s.forEach(o=>{o.isExpand=!1,o.isParent=!0,o.id=""+o.sqlId,o.canId=o.arbitrationId,delete o.arbitrationId}),s=s.sort((o,t)=>o.channel===t.channel?o.canId-t.canId:o.channel-t.channel),await this.drawExpandRows(s));this.$emit("updateTimeData",e.data.signal_data),this.isRecording?ce=setTimeout(()=>{requestAnimationFrame(Te)},200):clearTimeout(ce),this.$emit("recordTimeChange",this.recordTime)},Te()},async drawExpandRows(e){const s="-",i={};this.rowData.slice().sort((l,n)=>{const r=l.id,d=n.id;return!~r.indexOf(s)&&~d.indexOf(s)?-1:~r.indexOf(s)&&!~d.indexOf(s)?1:!~r.indexOf(s)&&!~d.indexOf(s)?l.channel<n.channel?-1:l.channel>n.channel?1:l.canId-n.canId:r>d?1:r<d?-1:0}),e.forEach(l=>{var r;const n=l.channel+"-"+l.canId;if(~l.id.indexOf(s))i[n].children.push(l);else{const d=((r=i[n])==null?void 0:r.children)||[];i[n]=l,i[n].children=this.expandKeys.has(n)?d:[]}});let o=this.rowData.slice();for(let l=this.visibleEndIndex;l>=this.visibleStartIndex;l--){if(!(o!=null&&o[l]))continue;let n=null,r=0;if(o[l].isParent)n=o[l],r=l;else if(l===this.visibleStartIndex){for(let d=l;d>=0;d--)if(o[d].isParent){n=o[d],r=d;break}}if(n){const d=n.channel+"-"+n.canId;if(this.expandKeys.has(d)){const c=await this.onToggleExpand(r,o,!0);c!=null&&c.length&&(i[d].children=c)}}}const t=[];for(let l in i){const n=i[l],r=n.children;delete n.children,r.length&&(n.isExpand=!0),t.push(n),r.forEach(d=>{t.push(d)})}this.rowData=t},getSelectData(e){let s="",i="",o="",t="";switch(e){case"up":t=this.startSqlId;break;case"down":o=this.endSqlId;break;case"pick":clearTimeout(ce),s=this.sliderValue/1e3+this.startTime;break}x.blfLogging.selectData({moreThanTimeStamp:s,lessThanTimeStamp:i,moreThanSqlID:o,lessThanSqlID:t,...this.showData,sqlId:"",numbers:100}).then(l=>{var n,r;if(((r=(n=l==null?void 0:l.data)==null?void 0:n.data)==null?void 0:r.length)>0){let d=l.data.data;switch(d.forEach(c=>{c.isExpand=!1,c.isParent=!0,c.id=c.sqlId,c.canId=c.arbitrationId,delete c.arbitrationId}),e){case"up":this.rowData=d.concat(...this.rowData),this.$refs.table.scrollToItem(l.data.data.length-1),this.sliderValue=(l.data.data[0].timestamp-this.startTime)*1e3,l.data.startSqlId&&(this.startSqlId=l.data.startSqlId);break;case"down":this.rowData=this.rowData.concat(...d),l.data.endSqlId&&(this.endSqlId=l.data.endSqlId);break;case"pick":this.startSqlId=l.data.startSqlId,this.endSqlId=l.data.endSqlId,this.rowData=d,this.sliderValue=(l.data.data[0].timestamp-this.startTime)*1e3;break}}}).finally(()=>{this.topLock=!1,this.bottomLock=!1})},onUpdatePadding(e){this.visibleStartIndex=e.visibleStartIndex,this.visibleEndIndex=e.visibleEndIndex},onTimeModeChange(e){this.timeFilterModeVal=e},onScrollAction(e){this.isLock||(this.mode==="all"?this.isLock=!0:this.isLock=!1,this.isScrollEnd=!1)},onBodyScrollEnd(e){this.mode!=="single"&&(e==="up"&&this.topLock===!1&&(this.topLock=!0,this.getSelectData(e)),e==="down"&&this.bottomLock===!1&&(this.bottomLock=!0,this.getSelectData(e)))},onClicked(){this.isLock=!1,this.isScrollEnd=!1},resumeScroll(){this.isScrollEnd=!0,this.isAddData=!0,this.isLock=!1,this.showLoggingMessage()},async onToggleExpand(e,s,i){const o=s.map(n=>({...n})),t=o[e],l=t.channel+"-"+t.canId;if(i||!t.isExpand){this.expandKeys.add(l);const n=await x.blfLogging.parsedSignal({channel:t.channel,canId:""+t.canId,canData:(t.data||[]).map(c=>c.toString(16))});let r=(n==null?void 0:n.data.sort((c,m)=>c.name<m.name?-1:1))||[],d=t.sqlId;if(r.forEach((c,m)=>{c.channel=t.channel,c.canId=""+t.canId,c.isParent=!1,c.isExpand=!0,c.isChildTit=!1,c.id=d+"-"+c.name}),r.unshift({channel:t.channel,canId:""+t.canId,isParent:!1,isExpand:!0,isChildTit:!0,id:d+"-"}),o.splice(e+1,0,...r),t.isExpand=r.length,i)return r;this.rowData=o}else this.expandKeys.delete(l),o.splice(e+1,o[e].isExpand),o[e].isExpand=!1,this.rowData=o},onSliderChange(e){this.isScrollEnd=!1,this.isAddData=!1,this.mode==="all"?this.isLock=!0:this.isLock=!1,this.getSelectData("pick")},onFilterItem(){this.openFlag=!this.openFlag},onColFilterChange(e){let s=this.columnsDef.find(i=>e.keyName===i.keyName);s&&(s.value=e.value),this.resumeScroll()}},mounted(){},unmounted(){Te=null,clearTimeout(ce),clearInterval(fe)}},Fe=e=>(B("data-v-4127f9c6"),e=e(),j(),e),vn={class:"o-pul-er"},Cn={key:0},kn=Fe(()=>a("div",{class:"o-pul-title"},"报文录制配置",-1)),Sn={class:"o-pul-p-wrap"},Tn={class:"o-pul-p"},Dn={class:"record-header-message"},Vn=Fe(()=>a("b",null,"车型/DBC：",-1)),xn=["v-tooltip"],In=Fe(()=>a("b",null,"保存目录：",-1)),Ln=[In],Fn={class:"o-pul-path"},Rn={class:"o-pul-p-wrap",style:{"flex-wrap":"wrap"}},Mn={class:"record-header-message",style:{width:"50vw"}},En=Fe(()=>a("div",{class:"o-pul-hr"},null,-1)),$n={class:"o-table-wrap"};function An(e,s,i,o,t,l){const n=w("CopyPath"),r=w("ScrollBar"),d=w("TableRecycleScroller"),c=w("Message"),m=U("tooltip");return h(),u(D,null,[a("div",vn,[t.recordShow?(h(),u("div",Cn,[kn,a("div",Sn,[a("div",Tn,[a("span",Dn,[Vn,k(b(i.dbcVal),1)]),a("span",{class:"record-header-message",style:{width:"71px"},"v-tooltip":i.filePath},Ln,8,xn),a("span",Fn,[g(n,{path:i.filePath,length:60,full:!0},null,8,["path"])])])]),a("div",Rn,[(h(!0),u(D,null,L(i.channelValList,(f,y)=>(h(),u("div",{class:"o-pul-p",key:y},[C((h(),u("span",Mn,[a("b",null,"CAN通道"+b(y+1)+"：",1),k(b(f),1)])),[[m,f]])]))),128))]),En,a("div",$n,[g(r,{modelValue:t.sliderValue,"onUpdate:modelValue":s[0]||(s[0]=f=>t.sliderValue=f),disable:t.mode!=="all",startTime:i.startTime*1e3,start:0,end:t.seconds*1e3,onChange:l.onSliderChange,timeFilter:t.timeFilterModeVal!="relative"?"absolute":"relative"},null,8,["modelValue","disable","startTime","end","onChange","timeFilter"]),g(d,{rowData:l.diffRowData,filters:l.showData,columnsDef:t.columnsDef,onToggleExpand:s[1]||(s[1]=f=>l.onToggleExpand(f,t.rowData)),onScrollRow:l.onBodyScrollEnd,onScrollAction:l.onScrollAction,onFilterItem:l.onFilterItem,onClick:l.onClicked,columnsFilter:l.colFilter,openFlag:t.openFlag,onColFilterChange:l.onColFilterChange,ref:"table",onUpdatePadding:l.onUpdatePadding,onTimeModeChange:l.onTimeModeChange,style:{height:"100%"}},null,8,["rowData","filters","columnsDef","onScrollRow","onScrollAction","onFilterItem","onClick","columnsFilter","openFlag","onColFilterChange","onUpdatePadding","onTimeModeChange"]),C(a("div",{class:"scrollToBottomBtn",onClick:s[2]||(s[2]=N(f=>l.resumeScroll(),["stop"]))},null,512),[[P,t.isLock&&t.mode==="all"],[m,"恢复向下滚动",void 0,{left:!0}]])])])):v("",!0)]),g(c,{message:t.message},null,8,["message"])],64)}const Nn=E(wn,[["render",An],["__scopeId","data-v-4127f9c6"]]);let De;const On={name:"ScrollBar",props:["modelValue","start","end","disable","timeFilter","startTime"],emits:["update:modelValue","change"],data(){return{lineTop:0,scrollTop:0,lineTitle:"",scrollTitle:"",lineVisible:!1,dragging:!1,dragHover:!1}},methods:{enterHandler(){this.dragging||(this.lineVisible=!0)},leaveHandler(){this.lineVisible=!1},moveHandler(e){this.lineVisible&&(e.offsetY<0||e.offsetY>=this.$refs.root.clientHeight-28||(this.lineTop=e.offsetY,this.lineTitle=this.tooltipFormatter(this.$props.start+(this.$props.end-this.$props.start)*e.offsetY/(this.$refs.root.clientHeight-28))))},clickHandler(e){this.scrollTop=e.offsetY;const s=this.$props.start+(this.$props.end-this.$props.start)*this.scrollTop/(this.$refs.root.clientHeight-28);this.$emit("update:modelValue",s),this.$emit("change",s)},tooltipFormatter(e){return parseInt(e)/1e3},timeStrFilter(e){return this.$props.timeFilter==="absolute"?new Date(e*1e3+(this.$props.startTime||0)).toLocaleString("zh-Hans-CN",{hour:"2-digit",minute:"2-digit",second:"2-digit",fractionalSecondDigits:3,hourCycle:"h23",timeZone:"Asia/Shanghai"}):e},blockDownHandler(){this.dragging=!0,De=void 0},blockUphandler(){if(this.dragging){this.dragging=!1;const e=this.$props.start+(this.$props.end-this.$props.start)*this.scrollTop/(this.$refs.root.clientHeight-28);this.$emit("update:modelValue",e),this.$emit("change",e)}},blockLeaveHandler(){this.enterHandler(),this.dragHover=!1},blockEnterHandler(){this.leaveHandler(),this.dragHover=!0},blockMoveHandler(e){if(this.dragging){let s=0;De!=null&&(s=e.pageY-De),De=e.pageY,console.log("move",e.pageY);let i=this.scrollTop+s;const o=this.$refs.root.clientHeight;if(i<0){if(this.scrollTop===0)return;i=0}else if(i>o-28){if(this.scrollTop===o-28)return;i=o-28}this.scrollTop=i,this.scrollTitle=this.tooltipFormatter(this.$props.start+(this.$props.end-this.$props.start)*this.scrollTop/(this.$refs.root.clientHeight-28))}}},watch:{modelValue(e){if(this.dragging)return;let s=(e-this.$props.start)/(this.$props.end-this.$props.start);this.scrollTop=parseInt(s*(this.$refs.root.clientHeight-28)),this.scrollTitle=this.tooltipFormatter(e),this.dragging=!1,this.dragHover=!1},end(e){if(this.dragging)return;let s=(this.$props.modelValue-this.$props.start)/(this.$props.end-this.$props.start);this.scrollTop=parseInt(s*(this.$refs.root.clientHeight-28))}},mounted(){window.addEventListener("mouseup",this.blockUphandler),window.addEventListener("mousemove",this.blockMoveHandler)},unmounted(){window.removeEventListener("mouseup",this.blockUphandler),window.removeEventListener("mousemove",this.blockMoveHandler)}},Pn=["data-disable"],Un=["data-active"],Hn={class:"block-title"},Bn={class:"line-title"},jn=["data-active"];function qn(e,s,i,o,t,l){return h(),u("div",{class:"bar-er","data-disable":e.$props.disable,ref:"root",onClick:s[5]||(s[5]=N((...n)=>l.clickHandler&&l.clickHandler(...n),["prevent","stop"])),onMousemove:s[6]||(s[6]=(...n)=>l.moveHandler&&l.moveHandler(...n)),onMouseenter:s[7]||(s[7]=(...n)=>l.enterHandler&&l.enterHandler(...n)),onMouseleave:s[8]||(s[8]=(...n)=>l.leaveHandler&&l.leaveHandler(...n))},[a("div",{class:"bar-block","data-active":t.dragging,onClick:s[0]||(s[0]=N(()=>{},["prevent","stop"])),onMousedown:s[1]||(s[1]=(...n)=>l.blockDownHandler&&l.blockDownHandler(...n)),onMouseup:s[2]||(s[2]=(...n)=>l.blockUphandler&&l.blockUphandler(...n)),onMouseleave:s[3]||(s[3]=(...n)=>l.blockLeaveHandler&&l.blockLeaveHandler(...n)),onMouseenter:s[4]||(s[4]=(...n)=>l.blockEnterHandler&&l.blockEnterHandler(...n)),style:$({transform:"translateY("+t.scrollTop+"px)"})},[a("div",Hn,b(l.timeStrFilter(t.scrollTitle)),1)],44,Un),C(a("div",{class:"bar-line",style:$({transform:"translateY("+t.lineTop+"px)"})},[a("div",Bn,b(l.timeStrFilter(t.lineTitle)),1)],4),[[P,t.lineVisible]]),a("div",{class:"scroll-title","data-active":t.dragging},b(l.timeStrFilter(t.scrollTitle)),9,jn)],40,Pn)}const zn=E(On,[["render",qn],["__scopeId","data-v-1c63ae6b"]]);const Kn={props:["col","asyncData"],emits:["change"],data(){return{options:[],loading:!1,current:[]}},methods:{async onMouseEnter(){this.loading=!0,this.options=[];try{this.options=await this.$props.asyncData(this.$props.col)}catch(e){}this.loading=!1},onModelValueChange(e){this.current=e,this.$emit("change",e)}},watch:{col:{handler(e){this.current=e.value},deep:!0}}},Wn=e=>(B("data-v-0c66c0da"),e=e(),j(),e),Xn=["data-active"],Gn=Wn(()=>a("div",null,null,-1));function Yn(e,s,i,o,t,l){var r;const n=w("v-select");return h(),u("div",{class:"select-icon","data-active":((r=t.current)==null?void 0:r.length)>0,onMouseenter:s[0]||(s[0]=(...d)=>l.onMouseEnter&&l.onMouseEnter(...d))},[a("div",{class:"flt-er",style:$({width:e.$props.col.width+40+"px"})},[g(n,{loading:t.loading,options:t.options,dropdownShouldOpen:()=>!0,searchable:!0,modelValue:t.current,"onUpdate:modelValue":l.onModelValueChange,multiple:""},{"no-options":T(()=>[Gn]),_:1},8,["loading","options","modelValue","onUpdate:modelValue"])],4)],40,Xn)}const Jn=E(Kn,[["render",Yn],["__scopeId","data-v-0c66c0da"]]);let Ee=0,$e=0;const Qn={props:["rowData","columnsDef","columnsFilter","from","filters"],emits:["toggleExpand","scrollRow","scrollAction","filterItem","colFilterChange","updatePadding","timeModeChange"],components:{RecycleScroller:me,FilterItem:Jn},created(){this.$_scrollTimer=0},data(){return{isChildTit:!1,searchVal:"",isOpenSearch:!1,selectFilterList:[],showSelect:!1,curId:-1,filterChnItem:"",filterValItem:"",formData:{},filterList:{channel:"",canId:"",name:"",canType:"",dir:"",dlc:""},left:0,timeFilterOptions:[{label:"Time 绝对时间",value:"absolute"},{label:"Time 相对时间",value:"relative"},{label:"ΔTime 时间差",value:"diff"}],timeFilterMode:{label:"Time 绝对时间",value:"absolute"},selectionActive:!1}},computed:{fullWidth(){return"calc("+this.$props.columnsDef.map(e=>typeof e.width=="number"?e.width+"px":e.width).join(" + ")+")"}},watch:{rowData:{handler(){if(this.selectionActive){this.selectionActive=!1;let e=window.getSelection();e.removeAllRanges(),e=null}setTimeout(()=>{console.log("updateVisibleItems"),this.$refs.scroller.updateVisibleItems(!0)},0)},deep:!0},timeFilterMode(e){this.onTimeModelChange(e.value)}},methods:{onScrollX(e){this.left=-e.target.scrollLeft+"px"},onTableClick(e){var s,i,o;if((o=(i=(s=e.target)==null?void 0:s.className)==null?void 0:i.includes)!=null&&o.call(i,"table-td")){this.selectionActive=!0;let t=window.getSelection();t.removeAllRanges();let l=document.createRange();l.selectNodeContents(e.target),t.addRange(l),t=l=null}},filterHex(e){return e===void 0?"":(e>=0?mt(e):e).toString().replace(/^(00)+/g,"")||"00"},update(e,s,i,o){Ee=i,$e=this.$props.rowData.length-o,this.$emit("updatePadding",{visibleStartIndex:i,visibleEndIndex:o})},searchInfo(){this.isOpenSearch=!1},onOpenSearch(){this.isOpenSearch=!0},scrollToBottom(){var e;(e=this.$refs.scroller)==null||e.scrollToItem(this.$props.rowData.length-1)},scrollToItem(e){var s;(s=this.$refs.scroller)==null||s.scrollToItem(e)},nativeScroll(){const e=this.$refs.scroller.$el;e.addEventListener("scroll",s=>{if(clearTimeout(this.$_scrollTimer),this.selectionActive){this.selectionActive=!1;let i=window.getSelection();i.removeAllRanges(),i=null}this.$_scrollTimer=setTimeout(()=>{console.log("updateVisibleItems"),this.$refs.scroller.updateVisibleItems(!0)},100)}),e.addEventListener("wheel",s=>{this.$emit("scrollAction",{topPadding:Ee,bottomPadding:$e}),s.deltaY>0||s.deltaX>0?$e<=40&&this.$emit("scrollRow","down"):(s.deltaY<0||s.deltaX<0)&&Ee<=40&&this.$emit("scrollRow","up")})},filterItem(e,s){this.filterChnItem=e,this.curId=s,this.$emit("filterItem"),this.selectFilterList=[],x.blfLogging.getFiltItems({selectItem:e,channel:"",canId:"",name:"",canType:"",dir:"",dlc:""}).then(i=>{let o=i.data.data;o.length>0&&o.forEach(t=>{t&&this.selectFilterList.push({value:t,label:t,selected:!1})})})},onChooseFilterItem(e,s){e.selected=!0,this.$emit("reDrawTable",e,s,this.selectFilterList)},onTimeModelChange(e){this.$emit("timeModeChange",e)}},mounted(){this.nativeScroll()}},ke=e=>(B("data-v-906464b1"),e=e(),j(),e),Zn={style:{position:"absolute",left:"0",top:"0",right:"0",bottom:"0",display:"inherit","flex-direction":"inherit","align-items":"inherit"}},eo={key:1,class:"o-pul-time-option-warp"},to=ke(()=>a("div",{class:"table-header",style:{height:"32px","line-height":"32px"}},null,-1)),so=["data-even"],lo=["onMousedown"],io=["onMousedown"],ao=ke(()=>a("span",{class:"container-tit",style:{width:"205px"}},"信号名",-1)),no=ke(()=>a("span",{class:"container-tit",style:{width:"200px"}},"信号物理值",-1)),oo=ke(()=>a("span",{class:"container-tit",style:{width:"80px"}},"HEX",-1)),ro=ke(()=>a("span",{class:"container-tit",style:{width:"calc(100vw - 487px)"}},"信号描述",-1)),co=[ao,no,oo,ro],ho={class:"table-parent-tr o-table-expand-child"},uo={class:"table-td",style:{width:"205px"}},mo={class:"table-td",style:{width:"200px"}},po={class:"table-td",style:{width:"80px"}},fo={class:"table-td",style:{width:"calc(100vw - 487px)"}};function go(e,s,i,o,t,l){const n=w("FilterItem"),r=w("v-select"),d=w("RecycleScroller");return h(),u("div",{class:"table",onClick:s[2]||(s[2]=(...c)=>l.onTableClick&&l.onTableClick(...c))},[a("div",{class:"table-header",style:$({height:"32px",lineHeight:"32px",transform:"translateX("+t.left+")",width:l.fullWidth,position:"absolute",zIndex:1})},[a("div",Zn,[(h(!0),u(D,null,L(e.$props.columnsDef,(c,m)=>(h(),u("div",{class:"header-tit",key:m,style:$({width:c.width>0?c.width+"px":c.width})},[a("span",null,b(c.titName),1),c.filterShow?(h(),O(n,{key:0,onChange:f=>e.$emit("colFilterChange",{keyName:c.keyName,value:f}),col:c,asyncData:e.$props.columnsFilter},null,8,["onChange","col","asyncData"])):v("",!0),c.keyName=="timestamp"||c.keyName=="diff"||c.keyName=="deltaTime"?(h(),u("div",eo,[g(r,{options:t.timeFilterOptions,clearable:!1,searchable:!1,label:"label",value:"value",modelValue:t.timeFilterMode,"onUpdate:modelValue":s[0]||(s[0]=f=>t.timeFilterMode=f),class:"canoe-frame-vselect"},null,8,["options","modelValue"])])):v("",!0)],4))),128))])],4),to,g(d,{items:e.$props.rowData,"item-size":24,"key-field":"id",emitUpdate:!0,onUpdate:l.update,ref:"scroller",class:"frame-class"},{default:T(({item:c,index:m})=>[c.isParent?(h(),u("div",{key:0,class:"table-parent-tr","data-even":m%2===0,style:$({transform:"translateX("+t.left+")",width:l.fullWidth})},[(h(!0),u(D,null,L(e.$props.columnsDef,f=>(h(),u("div",{class:"table-td",style:$({width:typeof f.width=="number"?f.width+"px":f.width}),key:f.keyName},[f.custom?(h(),u(D,{key:0},[c.isExpand&&c.isParent&&c.name?(h(),u("i",{key:0,class:"collapse-icon",onMousedown:N(y=>e.$emit("toggleExpand",m),["stop","prevent"])},null,40,lo)):v("",!0),c.isExpand===!1&&c.isParent&&c.name?(h(),u("i",{key:1,class:"expand-icon",onMousedown:N(y=>e.$emit("toggleExpand",m),["stop","prevent"])},null,40,io)):v("",!0)],64)):(h(),u(D,{key:1},[k(b(f.displayMap?f.displayMap(c[f.keyName]):c[f.keyName]),1)],64))],4))),128))],12,so)):(h(),u(D,{key:1},[c.isChildTit?(h(),u("div",{key:0,class:"table-header o-table-expand-child",style:$({transform:"translateX("+t.left+")",width:l.fullWidth})},co,4)):(h(),u("div",{key:1,class:"table-parent",style:$({transform:"translateX("+t.left+")",width:l.fullWidth})},[a("div",ho,[a("span",uo,b(c.name),1),a("span",mo,b(c.value),1),a("span",po,b(l.filterHex(c.hex)),1),a("span",fo,b(c.comment),1)])],4))],64))]),_:1},8,["items","onUpdate"]),a("div",{class:"table-scroll-x",onScroll:s[1]||(s[1]=(...c)=>l.onScrollX&&l.onScrollX(...c))},[a("div",{class:"table-scroll-x-bar",style:$({width:l.fullWidth})},null,4)],32)])}const bo=E(Qn,[["render",go],["__scopeId","data-v-906464b1"]]);const _o={beforeMount(){console.log("this.params",this.params)},methods:{onExpand(){debugger;console.log("this.params.data",this.params.data),this.params.data.isExpand===!1?(this.params.node.setDataValue("isExpand",!0),this.params.api.applyTransactionAsync({add:[JSON.parse(this.params.data.parsedData)],addIndex:this.params.rowIndex+1})):(this.params.node.setDataValue("isExpand",!1),this.params.api.applyTransactionAsync({remove:this.params.api.getRowNode(this.params.rowIndex+1)})),this.params.api.redrawRows()}}};function yo(e,s,i,o,t,l){return h(),u("div",null,[e.params.data.isExpand?(h(),u("i",{key:0,class:"expand-icon",onClick:s[0]||(s[0]=(...n)=>l.onExpand&&l.onExpand(...n))})):(h(),u("i",{key:1,class:"collapse-icon",onClick:s[1]||(s[1]=(...n)=>l.onExpand&&l.onExpand(...n))})),a("span",null,b(e.params.value),1)])}const wo=E(_o,[["render",yo]]),vo={methods:{onClick(){debugger}}},Co=Ne('<table><thead class="o-table-thead"><tr><th class="o-table-cell">信号</th><th class="o-table-cell o-cell-ar">信号物理值</th><th class="o-table-cell o-cell-ar">信号描述</th></tr></thead><tbody class="o-table-tbody"></tbody></table>',1),ko=[Co];function So(e,s,i,o,t,l){return h(),u("div",{onClick:s[0]||(s[0]=(...n)=>l.onClick&&l.onClick(...n))},ko)}const To=E(vo,[["render",So]]);let Ze=0,et=0,ge=0,Ve=0,xe;const Do={props:["store","closeFlag","recentTest","connectStatus","colFilterShow","channelOne","channelTwo","channelThree","linChannelVal","linChannelValTwo","filePath","dbcVal","startTime"],emits:["updateBock","updateTimeData","recordTimeChange","startTimeChange"],components:{Button:K,Message:J,ScrollBar:zn,ExpandInfo:wo,FullWidthCellRenderer:To,TableRecycleScroller:bo,CopyPath:ut,ButtonGroup:ve},data(){return{expandKeys:new Set,visibleStartIndex:0,visibleEndIndex:0,bottomPadding:0,recordLoading:!1,mode:"all",sliderValue:-1,comments:["","","","","","","","","","","","","","","",""],message:{visible:!1,level:"",content:""},seconds:0,timeFilterModeVal:"absolute",rowData:[],isRecording:!1,startSqlId:0,endSqlId:0,isLock:!1,isScrollEnd:!0,isAddData:!0,secondConfirm:!1,topLock:!1,bottomLock:!1,openFlag:!1,mlist:[{key:"lookRecord",name:"帧查看",icon:"box"},{key:"supeRecord",name:"图像查看",icon:"setting"}],cur:"lookRecord",recordShow:!0,colorList:["blue","cerulean","cyan","green","lime","purple","pink","red","orange","yellow"],columnsDef:[{titName:"",width:30,keyName:"id",type:"number",value:[],filterShow:!1,custom:!0},{titName:"",width:164,keyName:this.timeFilterModeVal==="diff"?this.mode==="single"?"deltaTime":"diff":"timestamp",type:"number",value:[],filterShow:!1,displayMap:e=>{let s=parseFloat(e);switch(this.timeFilterModeVal){case"diff":return s.toFixed(6);case"absolute":return new Date(s*1e3).toLocaleString("zh-Hans-CN",{hour:"2-digit",minute:"2-digit",second:"2-digit",fractionalSecondDigits:3,hourCycle:"h23",timeZone:"Asia/Shanghai"});case"relative":return(e-this.startTime).toFixed(6);default:return e}}},{titName:"Chn",width:60,keyName:"channel",type:"number",value:[],filterShow:!0},{titName:"ID",width:60,keyName:"linId",type:"number",value:[],filterShow:!0,displayMap:e=>"0x"+e.toString(16)},{titName:"NAME",width:200,keyName:"name",type:"string",value:[],filterShow:!0},{titName:"checksum",width:80,keyName:"checksum",type:"string",value:[],filterShow:!1,displayMap:e=>"0x"+e.toString(16)},{titName:"Dir",width:60,keyName:"dir",type:"string",value:[],filterShow:!0},{titName:"Dlc",width:60,keyName:"dlc",type:"number",value:[],filterShow:!0},{titName:"DATA",width:1380,keyName:"data",type:"string",value:[],filterShow:!1,displayMap:e=>e.map(s=>s.toString(16).padStart(2,"0")).join(" ")}]}},watch:{mode(e,s){this.topPadding=0,this.$refs.table.scrollToItem(0),this.expandKeys.clear(),this.rowData=[],this.isRecording&&this.resumeScroll()},filePath(){this.$emit("updateBock",{filePath:this.filePath,dbcVal:this.dbcVal,recordLoading:this.recordLoading,isRecording:this.isRecording})},dbcVal(){this.$emit("updateBock",{filePath:this.filePath,dbcVal:this.dbcVal,recordLoading:this.recordLoading,isRecording:this.isRecording})},recordLoading(){this.$emit("updateBock",{filePath:this.filePath,dbcVal:this.dbcVal,recordLoading:this.recordLoading,isRecording:this.isRecording})},isRecording(){this.$emit("updateBock",{filePath:this.filePath,dbcVal:this.dbcVal,recordLoading:this.recordLoading,isRecording:this.isRecording})},colComputed(){this.columnsDef[1]={titName:"",width:164,keyName:this.timeFilterModeVal==="diff"?this.mode==="single"?"deltaTime":"diff":"timestamp",type:"number",value:[],filterShow:!1,displayMap:e=>{let s=parseFloat(e);switch(this.timeFilterModeVal){case"diff":return s.toFixed(6);case"absolute":return new Date(s*1e3).toLocaleString("zh-Hans-CN",{hour:"2-digit",minute:"2-digit",second:"2-digit",hourCycle:"h23",timeZone:"Asia/Shanghai"})+"."+s.toFixed(6).split(".")[1];case"relative":return(e-this.startTime).toFixed(6);default:return e}}}}},computed:{colComputed(){return this.timeFilterModeVal+this.startTime+this.mode},recordTime(){return new Date(0,0,0,0,0,this.seconds).toLocaleTimeString()},showData(){let e={mode:"all"};return this.columnsDef.forEach(s=>{s.filterShow&&(e[s.keyName]=(s.value||[]).map(i=>i.value))}),e},diffRowData(){return this.rowData.map((e,s,i)=>({...e,diff:s===0?0:i[s].timestamp-i[s-1].timestamp}))}},methods:{choose(e){this.cur=e,e=="supeRecord"?this.recordShow=!1:this.recordShow=!0},async colFilter(e){var n;console.log("col111",e);const s=e.keyName==="name"?null:"";let i={selectItem:e.keyName,...this.showData,[e.keyName]:s};console.log("params222",i);let o;try{o=await await x.blfLogging.getFiltItemsLin(i)}catch(r){}return(((n=o==null?void 0:o.data)==null?void 0:n.data)||[]).map(r=>({value:r,label:e.keyName==="linId"?"0x"+r.toString(16):r===""?" 空":r})).sort((r,d)=>(e.type==="number"?+r.value>+d.value:r.value>d.value)?1:-1)},startRecord(){clearInterval(Ve),this.checkHardware(),this.isLock=!1,this.columnsDef=this.columnsDef.map(e=>({...e,value:[]}))},async checkHardware(){this.recordLoading=!1,this.secondConfirm=!1,clearInterval(Ve),this.isRecording=!0,this.resumeScroll()},async startLogging(){this.seconds=0,this.rowData=[],this.$emit("startTimeChange",Date.now()/1e3),Ve=setInterval(()=>{this.seconds=Date.now()/1e3-this.startTime},1e3),this.$emit("recordTimeChange",this.recordTime),parseInt(this.channelOne),parseInt(this.channelTwo),parseInt(this.channelThree),parseInt(this.linChannelVal),parseInt(this.linChannelValTwo),this.channelOne.split("-").pop(),this.channelTwo.split("-").pop(),this.channelThree.split("-").pop();let s=this.filePath.replace(".blf","-"+Ae()+".blf");console.log(s)},showMessage({level:e,content:s,timeout:i}){clearTimeout(Ze),e!=null&&(this.message.level=e),s!=null&&(this.message.content=s),this.message.visible=!0,i>0&&(Ze=setTimeout(()=>{this.message.visible=!1},i))},showLoggingMessage(){console.log("23333"),clearTimeout(ge),xe=async()=>{var i;this.showData.mode=this.mode;let e;try{e=await x.blfLogging.showLoggingMessageLin({...this.showData})}catch(o){}if(!e)return;let s=((i=e==null?void 0:e.data)==null?void 0:i.frame_data)||[];if(console.log("eventData",s),!this.isLock&&(s==null?void 0:s.length)>0)if(this.mode==="all"){let o=s[0].sqlId,t=s[s.length-1].sqlId;s.forEach(l=>{l.isExpand=!1,l.isParent=!0,l.id=""+l.sqlId,l.canId=l.arbitrationId,delete l.arbitrationId}),this.startSqlId=o,this.endSqlId=t,et=s[s.length-1].timestamp,this.rowData=s,this.$refs.table.scrollToBottom(),this.isAddData&&(this.sliderValue=o/t*(et-this.startTime)*1e3)}else this.mode==="single"&&(s.forEach(o=>{console.log("ele111",o),o.isExpand=!1,o.isParent=!0,o.id=""+o.sqlId,o.canId=o.arbitrationId,delete o.arbitrationId}),s=s.sort((o,t)=>o.channel===t.channel?o.linId-t.linId:o.channel-t.channel),console.log("finevent",s),await this.drawExpandRows(s),this.rowData=s);this.$emit("updateTimeData",e.data.signal_data),this.isRecording?ge=setTimeout(()=>{requestAnimationFrame(xe)},400):clearTimeout(ge),this.$emit("recordTimeChange",this.recordTime)},xe()},async drawExpandRows(e){const s="-",i={};console.log("1233event"),this.rowData.slice().sort((l,n)=>{const r=l.id,d=n.id;return!~r.indexOf(s)&&~d.indexOf(s)?-1:~r.indexOf(s)&&!~d.indexOf(s)?1:!~r.indexOf(s)&&!~d.indexOf(s)?l.channel<n.channel?-1:l.channel>n.channel?1:l.canId-n.canId:r>d?1:r<d?-1:0}),e.forEach(l=>{var r;const n=l.channel+"-"+l.canId;if(~l.id.indexOf(s))i[n].children.push(l);else{const d=((r=i[n])==null?void 0:r.children)||[];i[n]=l,i[n].children=this.expandKeys.has(n)?d:[]}});let o=this.rowData.slice();for(let l=this.visibleEndIndex;l>=this.visibleStartIndex;l--){if(!(o!=null&&o[l]))continue;let n=null,r=0;if(o[l].isParent)n=o[l],r=l;else if(l===this.visibleStartIndex){for(let d=l;d>=0;d--)if(o[d].isParent){n=o[d],r=d;break}}if(n){const d=n.channel+"-"+n.canId;if(this.expandKeys.has(d)){const c=await this.onToggleExpand(r,o,!0);c!=null&&c.length&&(i[d].children=c)}}}const t=[];for(let l in i){const n=i[l],r=n.children;delete n.children,r.length&&(n.isExpand=!0),t.push(n),r.forEach(d=>{t.push(d)})}this.rowData=t},getSelectData(e){let s="",i="",o="",t="";switch(console.log("向下"),e){case"up":t=this.startSqlId;break;case"down":o=this.endSqlId;break;case"pick":clearTimeout(ge),s=this.sliderValue/1e3+this.startTime;break}x.blfLogging.selectDataLin({moreThanTimeStamp:s,lessThanTimeStamp:i,moreThanSqlID:o,lessThanSqlID:t,...this.showData,sqlId:"",numbers:100}).then(l=>{var n,r;if(((r=(n=l==null?void 0:l.data)==null?void 0:n.data)==null?void 0:r.length)>0){let d=l.data.data;switch(d.forEach(c=>{c.isExpand=!1,c.isParent=!0,c.id=c.sqlId,c.canId=c.arbitrationId,delete c.arbitrationId}),e){case"up":this.rowData=d.concat(...this.rowData),this.$refs.table.scrollToItem(l.data.data.length-1),this.sliderValue=(l.data.data[0].timestamp-this.startTime)*1e3,l.data.startSqlId&&(this.startSqlId=l.data.startSqlId);break;case"down":this.rowData=this.rowData.concat(...d),l.data.endSqlId&&(this.endSqlId=l.data.endSqlId);break;case"pick":this.startSqlId=l.data.startSqlId,this.endSqlId=l.data.endSqlId,this.rowData=d,this.sliderValue=(l.data.data[0].timestamp-this.startTime)*1e3;break}}}).finally(()=>{this.topLock=!1,this.bottomLock=!1})},onUpdatePadding(e){this.visibleStartIndex=e.visibleStartIndex,this.visibleEndIndex=e.visibleEndIndex},onTimeModeChange(e){this.timeFilterModeVal=e},onScrollAction(e){this.isLock||(this.mode==="all"?this.isLock=!0:this.isLock=!1,this.isScrollEnd=!1)},onBodyScrollEnd(e){this.mode!=="single"&&(e==="up"&&this.topLock===!1&&(this.topLock=!0,this.getSelectData(e)),e==="down"&&this.bottomLock===!1&&(this.bottomLock=!0,this.getSelectData(e)))},onClicked(){this.isLock=!1,this.isScrollEnd=!1},resumeScroll(){this.isScrollEnd=!0,this.isAddData=!0,this.isLock=!1,this.showLoggingMessage()},async onToggleExpand(e,s,i){const o=s.map(d=>({...d})),t=o[e],l=t.channel+"-"+t.canId;let n=parseInt(this.linChannelVal)||0,r=parseInt(this.linChannelValTwo)||0;if(i||!t.isExpand){this.expandKeys.add(l);const d=await x.blfLogging.parsedSignalLin({channel:t.channel,linId:""+t.linId,ldfChn:[n,r],linData:(t.data||[]).map(f=>f.toString(16))});let c=(d==null?void 0:d.data.sort((f,y)=>f.name<y.name?-1:1))||[],m=t.sqlId;if(c.forEach((f,y)=>{f.channel=t.channel,f.canId=""+t.canId,f.isParent=!1,f.isExpand=!0,f.isChildTit=!1,f.id=m+"-"+f.name}),c.unshift({channel:t.channel,canId:""+t.canId,isParent:!1,isExpand:!0,isChildTit:!0,id:m+"-"}),o.splice(e+1,0,...c),t.isExpand=c.length,i)return c;this.rowData=o}else this.expandKeys.delete(l),o.splice(e+1,o[e].isExpand),o[e].isExpand=!1,this.rowData=o},onSliderChange(e){this.isScrollEnd=!1,this.isAddData=!1,this.isLock=!0,this.getSelectData("pick")},onFilterItem(){this.openFlag=!this.openFlag},onColFilterChange(e){let s=this.columnsDef.find(i=>e.keyName===i.keyName);s&&(s.value=e.value),this.resumeScroll()}},mounted(){},unmounted(){xe=null,clearTimeout(ge),clearInterval(Ve)}},ae=e=>(B("data-v-7da5c499"),e=e(),j(),e),Vo={class:"o-pul-er"},xo={key:0},Io=ae(()=>a("div",{class:"o-pul-title"},"报文录制配置",-1)),Lo={class:"o-pul-p-wrap"},Fo={class:"o-pul-p"},Ro={class:"record-header-message"},Mo=ae(()=>a("b",null,"车型/DBC：",-1)),Eo=["v-tooltip"],$o=ae(()=>a("b",null,"保存目录：",-1)),Ao=[$o],No={class:"o-pul-path"},Oo={class:"o-pul-p-wrap"},Po={class:"o-pul-p"},Uo={class:"record-header-message"},Ho=ae(()=>a("b",null,"Lin通道1：",-1)),Bo={class:"record-header-message"},jo=ae(()=>a("b",null,"Lin通道2：",-1)),qo={class:"o-pul-btn-wrap"},zo=ae(()=>a("div",{class:"tool-btn-wrap"},[a("i",{class:"warn-icon"}),a("div",{class:"tool-picker-contianer-wrap"},"录制将覆盖文件,确认要开始录制吗?")],-1)),Ko=ae(()=>a("div",{class:"tool-picker-arrow"},null,-1)),Wo={class:"tool-picker-footer-wrap"},Xo={class:"o-dialog-footer"},Go=ae(()=>a("div",{class:"o-pul-hr"},null,-1)),Yo={class:"o-table-wrap"};function Jo(e,s,i,o,t,l){const n=w("CopyPath"),r=w("Button"),d=w("ButtonGroup"),c=w("ScrollBar"),m=w("TableRecycleScroller"),f=w("Message"),y=U("tooltip"),R=U("esc");return h(),u(D,null,[a("div",Vo,[t.recordShow?(h(),u("div",xo,[Io,a("div",Lo,[a("div",Fo,[a("span",Ro,[Mo,k(b(i.dbcVal),1)]),a("span",{class:"record-header-message",style:{width:"71px"},"v-tooltip":i.filePath},Ao,8,Eo),a("span",No,[g(n,{path:i.filePath,length:60,full:!0},null,8,["path"])])])]),a("div",Oo,[a("div",Po,[C((h(),u("span",Uo,[Ho,k(b(i.linChannelVal),1)])),[[y,i.linChannelVal]]),C((h(),u("span",Bo,[jo,k(b(i.linChannelValTwo),1)])),[[y,i.linChannelValTwo]])])]),a("div",qo,[t.secondConfirm?C((h(),u("div",{key:0,class:"tool-picker-wrap",onClick:s[1]||(s[1]=N(()=>{},["stop"]))},[zo,Ko,a("div",Wo,[a("div",Xo,[g(r,{class:"small-btn",style:{width:"30px"},onClick:s[0]||(s[0]=N(A=>t.secondConfirm=!1,["stop"]))},{default:T(()=>[k("取消")]),_:1}),g(r,{class:"small-btn",type:"primary",style:{width:"30px",margin:"0 0 0 10px"},onClick:N(l.checkHardware,["stop"])},{default:T(()=>[k("确定")]),_:1},8,["onClick"])])])])),[[R,()=>e.$emit("cancel")]]):v("",!0),k("   "),g(d,{options:[{label:"普通",value:"all"},{label:"单帧",value:"single"}],class:"theme-btn-group",modelValue:t.mode,"onUpdate:modelValue":s[2]||(s[2]=A=>t.mode=A)},null,8,["modelValue"])]),Go,a("div",Yo,[g(c,{modelValue:t.sliderValue,"onUpdate:modelValue":s[3]||(s[3]=A=>t.sliderValue=A),disable:t.mode!=="all",startTime:i.startTime*1e3,start:0,end:t.seconds*1e3,onChange:l.onSliderChange,timeFilter:t.timeFilterModeVal!="relative"?"absolute":"relative"},null,8,["modelValue","disable","startTime","end","onChange","timeFilter"]),g(m,{rowData:l.diffRowData,filters:l.showData,columnsDef:t.columnsDef,onToggleExpand:s[4]||(s[4]=A=>l.onToggleExpand(A,t.rowData)),onScrollRow:l.onBodyScrollEnd,onScrollAction:l.onScrollAction,onFilterItem:l.onFilterItem,onClick:l.onClicked,columnsFilter:l.colFilter,openFlag:t.openFlag,onColFilterChange:l.onColFilterChange,ref:"table",onUpdatePadding:l.onUpdatePadding,onTimeModeChange:l.onTimeModeChange,style:{height:"100%"}},null,8,["rowData","filters","columnsDef","onScrollRow","onScrollAction","onFilterItem","onClick","columnsFilter","openFlag","onColFilterChange","onUpdatePadding","onTimeModeChange"]),C(a("div",{class:"scrollToBottomBtn",onClick:s[5]||(s[5]=N(A=>l.resumeScroll(),["stop"]))},null,512),[[P,t.isLock&&t.mode==="all"],[y,"恢复向下滚动",void 0,{left:!0}]])])])):v("",!0)]),g(f,{message:t.message},null,8,["message"])],64)}const Qo=E(Do,[["render",Jo],["__scopeId","data-v-7da5c499"]]);let be=[],tt=0;const Zo={props:["filledOptions","checkedOptions"],emits:["connect","showMessage","getCarCode","cancel","signalsChange"],components:{Button:K,RecycleScroller:me,Spin:oe,Message:J},data(){var s,i,o;const e=this.$ls.get("blfread_sdbData")||[];if(this.carType==="custom"){let t=(s=e.find(l=>l.sdb===this.sdb))==null?void 0:s.comments;t&&(be=["",...t])}else be=((o=(i=W.DEFAULT.find(t=>t.value===this.$props.carType))==null?void 0:i.children.find(t=>t.value===this.$props.sdb))==null?void 0:o.comments)||[];return be=be.map((t,l)=>"".concat("⓪①②③④⑤⑥⑦⑧⑨⑩⑪⑫⑬⑭⑮⑯⑰⑱⑲⑳㉑㉒㉓㉔㉕㉖㉗㉘㉙㉚㉛㉜㉝㉞㉟㊱㊲"[l]).concat(t)),{inputStr:"",checkedList:[],selectNodeList:[],counter:0,sdbCustom:e,lodingSpin:!1,isFlag:1,message:{visible:!1,level:"",content:""},listOpen:[],expandKeys:new Set([])}},computed:{list(){this.checkedList=this.$props.checkedOptions;let e=[],s=this,i=this.$props.filledOptions.data;for(let t in i){let l;l={_id:+t,id:+t,text:be[t],node_type:"channel",children:[],set checked(n){l.children.forEach(r=>{r.checked=n})},get checked(){return!l.children.some(n=>n.checked==!1)},get indeterminate(){return l.children.some(n=>n.checked)&&l.children.some(n=>!n.checked)}};for(let n in i[t]){let r;r={_id:t+"_"+n,id:t+"_"+n,text:n=="-1"?"":n,node_type:"msg",channel:l.id,set checked(d){d?s.checkedList.push(r):s.checkedList=s.checkedList.filter(c=>c._id!==r._id)},get checked(){return s.checkedList.some(d=>d._id===r._id)},children:i[t][n].map(d=>{var m;let c;return c={_id:t+"_"+n+"_"+d[0],id:d[0],msg:n=="-1"?"-1":+((m=n.match(/0x\w+/))==null?void 0:m[0])||n,channel:l.id,text:d[0],node_type:"signal",comment:d[1],remark:d[2],canId:d[3],rawValue:d[4],maxRaw:d[5],minRaw:d[6],maxPhys:d[7],minPhys:d[8],selectPhys:d[9],unit:d[10],startBit:d[11],length:d[12],physStep:d[13],dlc:d[14],canType:d[15],periodic:d[16],eteDisable:d[17]},c})},l.children.push(r)}e.push(l)}let o=[];for(let t=0;t<e.length;t++){let l=e[t];if(l.id!=-1&&o.push(l),!(!this.inputStr&&!this.expandKeys.has(l.id)))for(let n=0;n<l.children.length;n++){let r=l.children[n];r.id[0]!="-"&&o.push(r)}}if(this.inputStr.length>0){const t=this.inputStr.toLowerCase();let l;try{l=new RegExp(t,"i")}catch(n){l={test(r){return~r.toLowerCase().indexOf(r.toLowerCase())}}}o=o.filter(n=>l.test(n.text)||n.comment&&l.test(n.comment)||n.remark&&l.test(n.remark))}return o}},watch:{checkedListIndex:{handler(e){this.checkedList=[]},deep:!0}},mounted(){this.$refs.chsInputRef.focus(),setTimeout(()=>{document.body.addEventListener("mousedown",this.clickHandler)},300)},beforeUnmount(){},unmounted(){document.body.removeEventListener("mousedown",this.clickHandler)},methods:{clickHandler(e){var s;((s=this.$refs.root)==null?void 0:s.contains(e.target))==!1&&this.$emit("cancel")},showFirstChild(e){this.expandKeys.has(e.id)?this.expandKeys.delete(e.id):this.expandKeys.add(e.id)},clearTable(){this.checkedList=[]},title4node(e){return we(e)},showMessage({level:e,content:s,timeout:i}){clearTimeout(tt),e!=null&&(this.message.level=e),s!=null&&(this.message.content=s),this.message.visible=!0,i>0&&(tt=setTimeout(()=>{this.message.visible=!1},i))},submit(){this.checkedList.length>80?this.showMessage({level:"error",content:"信号选择不能超过80项",timeout:3e3}):this.$emit("signalsChange",this.checkedList)},highlightWord(e){if(!e)return e;const s=this.inputStr;if(!s)return e;const i=s.split(/\s+/g);var o,t=i.length,l;for(o=0;o<t;o++)try{l=new RegExp(i[o],"gi"),l.test(e)&&(e=e.replace(l,"<strong>$&</strong>"))}catch(n){l=i[o],e=e.replace(l,"<strong>$&</strong>")}return e}}},er={class:"chs-er",ref:"root"},tr={class:"chs-list-er","data-loading":!1},sr=["onClick"],lr=["id","onUpdate:modelValue","data-indeterminate"],ir=["innerHTML"],ar=["for"],nr=["id","onUpdate:modelValue","data-indeterminate"],or=["innerHTML"],rr={class:"footer"};function dr(e,s,i,o,t,l){const n=w("RecycleScroller"),r=w("Message"),d=U("tooltip"),c=U("esc");return C((h(),u("div",er,[C(a("input",{class:"chs-input-er",placeholder:"搜索信号名称/信号描述",ref:"chsInputRef","onUpdate:modelValue":s[0]||(s[0]=m=>t.inputStr=m),onInput:s[1]||(s[1]=(...m)=>e.onChange&&e.onChange(...m)),draggable:!1},null,544),[[Y,t.inputStr]]),a("div",tr,[g(n,{class:"chs-list",items:l.list,"item-size":28,"key-field":"_id"},{default:T(({item:m})=>[a("label",null,[m.node_type=="channel"&&m.id<=36?(h(),u("div",{key:0,style:{"margin-left":"1px"},class:pe(!t.inputStr&&t.expandKeys.has(m.id)?"switch-open":"switch-close"),onClick:N(f=>l.showFirstChild(m),["stop","prevent"])},null,10,sr)):v("",!0),m.node_type=="channel"&&m.id<=36?C((h(),u("input",{key:1,style:{"margin-left":"3px"},id:m._id,type:"checkbox","onUpdate:modelValue":f=>m.checked=f,"data-indeterminate":m.indeterminate,"click.stop":""},null,8,lr)),[[Q,m.checked]]):v("",!0),m.node_type=="channel"&&m.id<=36?(h(),u("span",{key:2,class:"chs-node",innerHTML:l.highlightWord(m._id)},null,8,ir)):m.node_type=="msg"?C((h(),u("div",{key:3,for:m.children,style:{"text-indent":"2em","margin-left":"-15px"},class:"chs-node chs-node-item"},[C(a("input",{id:m._id,type:"checkbox","onUpdate:modelValue":f=>m.checked=f,"data-indeterminate":m.indeterminate,"click.stop":""},null,8,nr),[[Q,m.checked]]),a("span",{class:"",innerHTML:l.highlightWord(m.text)},null,8,or)],8,ar)),[[d,{content:l.title4node(m),html:!0},void 0,{right:!0}]]):v("",!0)])]),_:1},8,["items"])]),a("div",rr,[a("div",{class:"chs-btn confirm",onClick:s[2]||(s[2]=(...m)=>l.submit&&l.submit(...m))},"确认"),a("div",{class:"chs-btn cancel",onClick:s[3]||(s[3]=(...m)=>l.clearTable&&l.clearTable(...m))},"重置")]),g(r,{message:t.message},null,8,["message"])])),[[c,()=>e.$emit("cancel")]])}const cr=E(Zo,[["render",dr],["__scopeId","data-v-c2cba19d"]]);const hr={props:["disabled"],data(){return{editable:!1}},methods:{clickBody(e){var i,o;if(this.$props.disabled)return;this.editable=!0,(o=(i=e.target.children)==null?void 0:i[0])==null||o.focus(),console.log("e.target111",e.target);let s=t=>{var l;t.target&&(t.target==this.$refs.root||(l=this.$refs.root)!=null&&l.contains(t.target))?this.editable=!0:t.target&&(this.editable=!1,document.body.removeEventListener("mousedown",s))};document.body.addEventListener("mousedown",s)}},mounted(){}},ur=["data-forbidden","data-disabled"];function mr(e,s,i,o,t,l){return h(),u("div",{ref:"root",class:"ewer","data-forbidden":e.$props.disabled,"data-disabled":!t.editable,onClick:s[0]||(s[0]=(...n)=>l.clickBody&&l.clickBody(...n))},[ht(e.$slots,"default")],8,ur)}const Ue=E(hr,[["render",mr]]);const pr={props:["modelValue","min","max","watch"],emits:["update:modelValue","change","error"],data(){return{str:"",type:16,highlight:!1}},watch:{modelValue:{handler(e,s){s!=null&&parseFloat(e)!==parseFloat(s)&&this.$props.watch&&(this.highlight=!0,setTimeout(()=>{this.highlight=!1},500));let i="0x0";try{i="0x"+(parseInt(e)||0).toString(16)}catch(o){}this.str=i,this.type=16},immediate:!0}},methods:{onChange(e){let s=e.target.value;if(!this.valid(s.toString())){this.str="0x"+(parseInt(this.$props.modelValue)||0).toString(16),this.$emit("error",s);return}let i=this.type===10?parseInt(s):parseInt("0x"+s.replace("0x",""),16);i<this.min?i=+this.min:i>this.max&&(i=+this.max),this.str="0x"+i.toString(16),this.$emit("update:modelValue",i),this.$emit("change",i)},valid(e){return this.type==16?/^(0x)?[0-9a-fA-F]+$/.test(e):/\d+/.test(e)}}},fr=["data-hi"];function gr(e,s,i,o,t,l){return C((h(),u("input",{class:"input","data-hi":t.highlight,type:"text","onUpdate:modelValue":s[0]||(s[0]=n=>t.str=n),onChange:s[1]||(s[1]=N((...n)=>l.onChange&&l.onChange(...n),["prevent"])),onKeydown:s[2]||(s[2]=ft(N((...n)=>l.onChange&&l.onChange(...n),["stop","prevent"]),["enter"]))},null,40,fr)),[[Y,t.str,void 0,{lazy:!0}]])}const He=E(pr,[["render",gr],["__scopeId","data-v-c55d1b50"]]);const br={props:["min","max","step","modelValue","enum","watch","class"],emits:["update:modelValue","change"],data(){return{str:"",highlight:!1}},computed:{enumOpts(){return Object.entries(this.$props.enum)}},watch:{modelValue:{handler(e,s){var i;s!=null&&parseFloat(e)!==parseFloat(s)&&this.$props.watch&&(this.highlight=!0,setTimeout(()=>{this.highlight=!1},500)),(e==null?void 0:e[0])>="A"?this.str=((i=this.enumOpts.find(o=>+o[1]==+e))==null?void 0:i[0])||"":this.str=parseFloat(e)},immediate:!0}},methods:{onChange(e){let s=parseFloat(e.target.value),i=parseFloat(this.min),o=parseFloat(this.max);console.log(s,this.min,this.max),s<i?s=i:s>o&&(s=o),this.str=s.toString(),this.$emit("update:modelValue",s),this.$emit("change",s)}}},_r=["data-hi","min","max","step"],yr={key:0,class:"ic-down"},wr=["data-hi","value"],vr=["value"];function Cr(e,s,i,o,t,l){return h(),u(D,null,[C(a("input",{class:pe(["input",e.$props.class]),type:"number","data-hi":t.highlight,min:i.min,max:i.max,step:i.step,"onUpdate:modelValue":s[0]||(s[0]=n=>t.str=n),onChange:s[1]||(s[1]=(...n)=>l.onChange&&l.onChange(...n)),style:$({width:l.enumOpts.length?"40%":""})},null,46,_r),[[Y,t.str,void 0,{lazy:!0}]]),l.enumOpts.length?(h(),u("i",yr)):v("",!0),l.enumOpts.length?(h(),u("select",{key:1,"data-hi":t.highlight,class:"select",value:t.str,onChange:s[2]||(s[2]=(...n)=>l.onChange&&l.onChange(...n))},[(h(!0),u(D,null,L(l.enumOpts,n=>(h(),u("option",{value:n[0]},b(n[1]),9,vr))),256))],40,wr)):v("",!0)],64)}const Be=E(br,[["render",Cr],["__scopeId","data-v-b4b10b3c"]]);let st=0;const kr={props:["store","setStore"],components:{Button:K,Message:J,ChooseSignal:cr,EditWrapper:Ue,InputHex:He,InputOrSelect:Be},data(){return{hexMultiValue:0,isHexMulti:!1,hexs:[],frames:[],listTable:{cols:[{label:"",width:"2.8em",icon:"add"},{label:"Frame Name",width:"auto"},{label:"E2E",width:"6em",type:"checkbox",checked:!1},{label:"Period (ms)",width:"9em",tooltip:{content:"1-1000ms:周期发送<br/>0:单点发送",html:!0}},{label:"ID",width:"4.5em",tooltip:"DBC导入禁止修改ID"},{label:"Channel",width:"6em"},{label:"Type",width:"6em"},{label:"DLC",width:"4em"},{label:"",width:"5em"}]},sigTable:{cols:[{label:"Signal Name",width:"auto"},{label:"Raw",width:"90px"},{label:"Phys",width:"200px"},{label:"Unit",width:"4em"}]},cur:-1,chooseSignalShow:!1,filledOptions:[],isSyncFrames:!1,addRecordShow:!1,message:{visible:!1,level:"",content:""},curChannel:0}},computed:{checkedOptions(){return this.frames.filter(e=>e.from=="dbc")},checkIndeterminate(){return this.frames.some(e=>e.e2e)&&this.frames.some(e=>!e.e2e)},allChecked(){return this.frames.some(e=>e.e2e)&&this.frames.some(e=>e.children[0].eteDisable)}},watch:{"$props.store.sendRecord.isRecording":{handler(e){e&&this.updateMultiFrame(this.frames.map((s,i)=>({...s,row:i+1})),"add")}},"$props.store.sendRecord.dbc.dbcChn":{handler(e,s){}},"$props.store.sendRecord":{handler(e,s){}},frames:{async handler(e,s){if(this.isSyncFrames)return;this.isSyncFrames=!0,this.isHexMulti=!1;for(let t=0;t<e.length;t++){let l=e[t],n=l.channel;console.log("sendframe.dbcChannel07041553",n);let r=l.canId;console.log("sendframe.dirty07041441",l.dirty),l.dirty==="raw"?(await x.blfLogging.getRawValueToPhysValue({dbcChannel:n,canId:r,signalsData:l.children}).then(d=>{this.frames[t]={...l,rawData:d.data.data.rawData,children:l.children.map(c=>{var m,f;return{...c,physValue:(f=(m=d.data.data.signalsData.find(y=>y.name===c.id))==null?void 0:m.physValue)!=null?f:c.physValue}}),dirty:!1,raw:t+1},this.updateMultiFrame([{row:t+1,...this.frames[t]}],"modify")}).catch(console.log),await ct(100)):l.dirty==="data"?(console.log("sendframes[i]07051410",l),l.from==="dbc"?await x.blfLogging.getDataToValues({dbcChannel:n,canId:r,rawData:l.rawData}).then(d=>{this.frames[t]={...l,children:l.children.map(c=>{var m,f,y,R;return{...c,physValue:(f=(m=d.data.data.signalsPhysData.find(A=>A.name===c.id))==null?void 0:m.physValue)!=null?f:c.physValue,rawValue:(R=(y=d.data.data.signalsRawData.find(A=>A.name===c.id))==null?void 0:y.rawValue)!=null?R:c.rawValue}}),dirty:!1,raw:t+1},this.updateMultiFrame([{row:t+1,...this.frames[t]}],"modify")}).catch(console.log):(this.frames[t]={...l,dirty:!1,raw:t+1},this.updateMultiFrame([{row:t+1,...this.frames[t]}],"modify"))):l.dirty==="phys"?await x.blfLogging.getPhysValueToRawValue({dbcChannel:n,canId:r,signalsData:l.children}).then(d=>{this.frames[t]={...l,rawData:d.data.data.rawData,children:l.children.map(c=>{var m,f;return{...c,rawValue:(f=(m=d.data.data.signalsData.find(y=>y.name===c.id))==null?void 0:m.rawValue)!=null?f:c.rawValue}}),dirty:!1,raw:t+1},this.updateMultiFrame([{row:t+1,...this.frames[t]}],"modify")}).catch(console.log):l.dirty==="dlc"?(this.frames[t]={...l,rawData:Array.from({length:l.dlc},(d,c)=>l.rawData[c]||0),dirty:!1,raw:t+1},this.updateMultiFrame([{row:t+1,...l}],"modify")):l.dirty==="periodic"?(this.frames[t]={...l,isSending:l.periodic==0?!1:l.isSending,dirty:!1,raw:t+1},this.updateMultiFrame([{row:t+1,...l}],"modify")):l.dirty&&(this.frames[t].dirty=!1,this.updateMultiFrame([{row:t+1,...l}],"modify"))}this.isSyncFrames=!1;let i=e.filter(t=>{var l;return((l=t.children[0])==null?void 0:l.eteDisable)===!0}),o=[];i.forEach(t=>{o.push({raw:t.raw,canId:t.canId,dbcChannel:t.channel,useE2E:t.e2e?1:0})}),x.blfLogging.setE2EConfig({e2eSlotList:o})},deep:!0},cur(e){console.log("sendCur07041058",e,this.frames[e]),this.isHexMulti=!1,this.hexs=[]}},methods:{showMessage({level:e,content:s,timeout:i}){clearTimeout(st),e!=null&&(this.message.level=e),s!=null&&(this.message.content=s),this.message.visible=!0,i>0&&(st=setTimeout(()=>{this.message.visible=!1},i))},onHexErr(){this.showMessage({timeout:2e3,level:"error",content:"请输入正确格式的16进制"})},updateFrame(e){let s=this.frames.slice(),i=[],o=[];for(let t=s.length-1;t>=0;t--){let l=s[t];if(l.from==="dbc"){let n=e.findIndex(r=>r.id===l.id);if(~n)e.splice(n,1);else{t===this.cur&&(this.cur=-1);let r=s.splice(t,1);o.unshift({...r,row:t+1})}}}this.updateMultiFrame(o,"delete"),i=e.map((t,l)=>{let n=t.children[0]||{};return{...t,name:t.text,from:"dbc",e2e:!1,periodic:n.periodic||0,canType:n.canType||"CAN",dlc:n.dlc||64,canId:n.msg||0,dirty:"raw",isSending:!1,children:t.children.map(r=>({...r,name:r.id}))}}),s.push(...i),this.frames=s,this.chooseSignalShow=!1,this.addRecordShow=!1},delFrame(e){e===this.cur&&(this.cur=-1);let s=this.frames.splice(e,1);this.frames.forEach((i,o)=>{this.frames[o].raw=o+1}),this.updateMultiFrame([{...s,row:e+1}],"delete")},addFrame(e){this.addRecordShow=!1;let s=[{name:"",e2e:!1,periodic:1e3,canId:e==="CAN"?111:222,channel:this.$props.store.sendRecord.dbc.dbcChn[e==="CAN"?0:1],canType:e,dlc:8,isSending:!1,from:e,rawData:[0,0,0,0,0,0,0,0],children:[{eteDisable:!1}]}],i=this.frames.length-1;this.frames.push(...s),console.log("addthis.frames",this.frames),this.updateMultiFrame(s.map((o,t)=>({...o,row:i+t})),"add")},updateMultiFrame(e,s){if(!this.$props.store.sendRecord.isRecording)return;let i=e.map(o=>({...o,channel:1+this.$props.store.sendRecord.dbc.dbcChn.indexOf(o.channel)}));i.length>0&&x.blfLogging.getPeriodicSend({data:i,behavor:s})},togglePlay(e,s){e.periodic>0?(e.isSending=!e.isSending,this.updateMultiFrame([{row:s+1,...e}],"modify")):x.blfLogging.getManualSend({row:s+1,...e,channel:1+this.$props.store.sendRecord.dbc.dbcChn.indexOf(e.channel)}).catch(console.log)},onHexMultiChange(){this.frames[this.cur].rawData=this.frames[this.cur].rawData.map((e,s)=>this.hexs.includes(s)?this.hexMultiValue:e),this.frames[this.cur].dirty="data"},clickHandler(e){var s;((s=this.$refs.root)==null?void 0:s.contains(e.target))==!1&&(this.addRecordShow=!1)},onChecked(e){this.allChecked=!e,this.allChecked?this.frames.forEach(s=>{var i;(i=s.children[0])!=null&&i.eteDisable&&(s.e2e=!0)}):this.frames.forEach(s=>{s.e2e=!1})}},mounted(){setTimeout(()=>{document.body.addEventListener("mousedown",this.clickHandler)},300)},unmounted(){document.body.removeEventListener("mousedown",this.clickHandler)}},je=e=>(B("data-v-437f19d4"),e=e(),j(),e),Sr={class:"body"},Tr={class:"list-er"},Dr={class:"list-table"},Vr={key:1,class:"ic-help"},xr=["data-indeterminate"],Ir=["onClick","data-active"],Lr=["title"],Fr=["data-from","data-cantype","data-valid"],Rr=["disabled","onUpdate:modelValue"],Mr=["onUpdate:modelValue","onChange"],Er=["disabled","onUpdate:modelValue","onChange"],$r=["value"],Ar=["disabled","onUpdate:modelValue","onChange"],Nr=je(()=>a("option",{value:"CAN"},"CAN",-1)),Or=je(()=>a("option",{value:"CANFD"},"CANFD",-1)),Pr=[Nr,Or],Ur=["disabled","onUpdate:modelValue","onChange"],Hr=["value"],Br=["data-disable","data-recording","data-active","onClick"],jr=["onClick"],qr={key:0,class:"table-empty"},zr={class:"empty-meark"},Kr={class:"sig-er"},Wr={class:"hex-er"},Xr=je(()=>a("th",{style:{width:"4em"}}," ",-1)),Gr={style:{width:"11.8%"}},Yr={key:0},Jr=["value"],Qr={class:"hex-footer"},Zr={class:"hex-multi-input"},ed={class:"btn-import-er"},td={class:"add-record",ref:"root"},sd=["data-disabled"],ld=["data-disabled"],id=["data-disabled"];function ad(e,s,i,o,t,l){var R,A,X;const n=w("EditWrapper"),r=w("InputHex"),d=w("InputOrSelect"),c=w("Button"),m=w("ChooseSignal"),f=w("Message"),y=U("tooltip");return h(),u(D,null,[a("div",Sr,[a("div",Tr,[a("table",Dr,[a("tr",null,[(h(!0),u(D,null,L(t.listTable.cols,_=>(h(),u("th",{style:$({width:_.width})},[k(b(_.label)+" ",1),_.icon?(h(),u("i",{key:0,onClick:s[0]||(s[0]=M=>t.addRecordShow=!t.addRecordShow),class:"ic-add"})):v("",!0),_.tooltip?C((h(),u("i",Vr,null,512)),[[y,_.tooltip]]):v("",!0),_.type?C((h(),u("input",{key:2,type:"checkbox",onChange:s[1]||(s[1]=M=>l.onChecked(l.allChecked)),"data-indeterminate":l.checkIndeterminate,"onUpdate:modelValue":s[2]||(s[2]=M=>l.allChecked=M)},null,40,xr)),[[Q,l.allChecked]]):v("",!0)],4))),256))]),(h(!0),u(D,null,L(t.frames,(_,M)=>(h(),u("tr",{onClick:I=>t.cur=M,"data-active":t.cur===M},[a("td",null,b(M+1),1),a("td",{title:_.name},[a("i",{class:"ic-can","data-from":_.from,"data-cantype":_.canType,"data-valid":Object.values(e.$props.store.sendRecord.dbc.dbcChn).includes(_.channel)},null,8,Fr),k(" "+b(_.name),1)],8,Lr),a("td",null,[g(n,{style:{"justify-content":"center"}},{default:T(()=>{var I;return[C(a("input",{type:"checkbox",disabled:!((I=_.children[0])!=null&&I.eteDisable),"onUpdate:modelValue":S=>_.e2e=S},null,8,Rr),[[Q,_.e2e,void 0,{lazy:!0}]])]}),_:2},1024)]),a("td",null,[g(n,null,{default:T(()=>[C(a("input",{class:"td-input",type:"number",min:"0",max:"1000","onUpdate:modelValue":I=>_.periodic=I,onChange:I=>_.dirty="periodic"},null,40,Mr),[[Y,_.periodic,void 0,{lazy:!0}]])]),_:2},1024)]),a("td",null,[g(n,{disabled:_.from==="dbc"},{default:T(()=>[g(r,{onError:l.onHexErr,min:0,max:2047,disabled:_.from==="dbc",class:"td-input",modelValue:_.canId,"onUpdate:modelValue":I=>_.canId=I,onChange:I=>_.dirty="canId"},null,8,["onError","disabled","modelValue","onUpdate:modelValue","onChange"])]),_:2},1032,["disabled"])]),a("td",null,[g(n,{disabled:_.from==="dbc"},{default:T(()=>[C(a("select",{disabled:_.from==="dbc",class:"td-input","onUpdate:modelValue":I=>_.channel=I,onChange:I=>_.dirty="channel"},[(h(!0),u(D,null,L(e.$props.store.sendRecord.dbc.dbcChn,(I,S)=>(h(),u("option",{value:I},"CAN"+b(S+1),9,$r))),256))],40,Er),[[ne,_.channel,void 0,{lazy:!0}]])]),_:2},1032,["disabled"])]),a("td",null,[g(n,{disabled:_.from==="dbc"},{default:T(()=>[C(a("select",{disabled:_.from==="dbc",class:"td-input","onUpdate:modelValue":I=>_.canType=I,onChange:I=>_.dirty="canType"},Pr,40,Ar),[[ne,_.canType]])]),_:2},1032,["disabled"])]),a("td",null,[g(n,{disabled:_.canType==="CAN"||_.from==="dbc"},{default:T(()=>[C(a("select",{disabled:_.canType==="CAN"||_.from==="dbc",class:"td-input","onUpdate:modelValue":I=>_.dlc=I,onChange:I=>_.dirty="dlc"},[(h(),u(D,null,L([8,12,16,20,24,32,48,64],I=>a("option",{value:I},b(I),9,Hr)),64))],40,Ur),[[ne,_.dlc]])]),_:2},1032,["disabled"])]),a("td",null,[a("i",{class:"ic-play","data-disable":Object.values(e.$props.store.sendRecord.dbc.dbcChn).includes(_.channel),"data-recording":e.$props.store.sendRecord.isRecording,"data-active":_.isSending,onClick:I=>l.togglePlay(_,M)},null,8,Br),k("  "),a("i",{class:"ic-del",onClick:N(I=>l.delFrame(M),["stop"])},null,8,jr)])],8,Ir))),256))]),t.frames.length==0?(h(),u("div",qr,[a("div",zr,[k("暂无内容，请先"),a("span",{class:"empty-btn",onClick:s[3]||(s[3]=_=>t.addRecordShow=!t.addRecordShow)},"导入帧")])])):v("",!0)]),a("div",Kr,[(h(),u("table",{class:"sig-table",key:"sig"+t.cur},[a("tr",null,[(h(!0),u(D,null,L(t.sigTable.cols,_=>(h(),u("th",{style:$({width:_.width})},b(_.label),5))),256))]),((R=t.frames[t.cur])==null?void 0:R.name)!==""?(h(!0),u(D,{key:0},L((A=t.frames[t.cur])==null?void 0:A.children,_=>(h(),u("tr",null,[C((h(),u("td",null,[k(b(_.text)+" ",1)])),[[y,{content:"".concat(_.text,"<hr/>phys:").concat(_.minPhys," ~ ").concat(_.maxPhys,"<br/>raw:").concat(_.minRaw?"0x"+_.minRaw.toString(16):""," ~ ").concat(_.maxRaw?"0x"+_.maxRaw.toString(16):"","<br/>Start Bit:").concat(_.startBit,"<br>Length:").concat(_.length,"<br>Phys Step:").concat(_.physStep),html:!0},void 0,{"top-start":!0}]]),a("td",null,[g(n,null,{default:T(()=>[g(r,{watch:!0,onError:l.onHexErr,min:_.minRaw,max:_.maxRaw,class:"td-input",modelValue:_.rawValue,"onUpdate:modelValue":M=>_.rawValue=M,modelModifiers:{lazy:!0},onChange:s[4]||(s[4]=M=>t.frames[t.cur].dirty="raw")},null,8,["onError","min","max","modelValue","onUpdate:modelValue"])]),_:2},1024)]),a("td",null,[g(n,null,{default:T(()=>[g(d,{watch:!0,min:_.minPhys,max:_.maxPhys,class:"td-input",step:_.physStep,modelValue:_.physValue,"onUpdate:modelValue":M=>_.physValue=M,enum:_.selectPhys?_.selectPhys:"",onChange:s[5]||(s[5]=M=>t.frames[t.cur].dirty="phys")},null,8,["min","max","step","modelValue","onUpdate:modelValue","enum"])]),_:2},1024)]),a("td",null,b(_.unit),1)]))),256)):v("",!0)]))]),a("div",Wr,[(h(),u("table",{class:"hex-table",key:"hex"+t.cur},[a("tr",null,[Xr,(h(),u(D,null,L([0,1,2,3,4,5,6,7],_=>a("th",Gr,b(_),1)),64))]),(X=t.frames[t.cur])!=null&&X.rawData?(h(),u(D,{key:0},L([0,8,16,24,32,40,48,56,64],(_,M)=>(h(),u(D,null,[t.frames[t.cur].rawData.length>_?(h(),u("tr",Yr,[a("td",null,[a("b",null,b(_),1)]),(h(),u(D,null,L(8,I=>a("td",null,[t.isHexMulti&&_+I-1<t.frames[t.cur].rawData.length?C((h(),u("input",{key:0,type:"checkbox",class:"radio","onUpdate:modelValue":s[6]||(s[6]=S=>t.hexs=S),value:_+I-1},null,8,Jr)),[[Q,t.hexs]]):v("",!0),_+I-1<t.frames[t.cur].rawData.length?(h(),O(n,{key:1},{default:T(()=>[g(r,{watch:!0,onError:l.onHexErr,min:0,max:255,class:"td-input",style:{width:"calc(100%)","text-indent":"20px"},modelValue:t.frames[t.cur].rawData[_+I-1],"onUpdate:modelValue":S=>t.frames[t.cur].rawData[_+I-1]=S,modelModifiers:{lazy:!0},onChange:s[7]||(s[7]=S=>t.frames[t.cur].dirty="data")},null,8,["onError","modelValue","onUpdate:modelValue"])]),_:2},1024)):v("",!0)])),64))])):v("",!0)],64))),64)):v("",!0)])),a("div",Qr,[t.isHexMulti?(h(),u(D,{key:1},[k(" 批量修改:("+b(t.hexs.length)+"个)  ",1),g(c,{style:{float:"right",height:"23px","margin-left":"8px"},onClick:s[9]||(s[9]=_=>{t.hexs=[],t.isHexMulti=!1})},{default:T(()=>[k("退出")]),_:1}),g(c,{style:{float:"right",height:"23px"},type:"primary",onClick:l.onHexMultiChange},{default:T(()=>[k("修改")]),_:1},8,["onClick"]),a("div",Zr,[g(r,{onError:l.onHexErr,min:0,max:255,modelValue:t.hexMultiValue,"onUpdate:modelValue":s[10]||(s[10]=_=>t.hexMultiValue=_)},null,8,["onError","modelValue"])])],64)):(h(),u("div",{key:0,class:"hex-footer-full-btn",onClick:s[8]||(s[8]=_=>t.isHexMulti=!t.isHexMulti)},"进入批量修改"))])]),C(a("div",ed,[t.chooseSignalShow?(h(),O(m,{key:0,filledOptions:e.$props.store.sendRecord.frames,checkedOptions:l.checkedOptions,onSignalsChange:l.updateFrame,onCancel:s[11]||(s[11]=()=>{t.chooseSignalShow=!1})},null,8,["filledOptions","checkedOptions","onSignalsChange"])):v("",!0)],512),[[P,t.chooseSignalShow]]),C(a("div",td,[a("div",{onClick:s[12]||(s[12]=_=>t.chooseSignalShow=!t.chooseSignalShow),"data-disabled":e.$props.store.sendRecord.frames.length===0},"从DBC中导入帧",8,sd),a("div",{onClick:s[13]||(s[13]=_=>l.addFrame("CAN")),"data-disabled":e.$props.store.sendRecord.dbc.dbcChn.length==0},"自定义CAN帧",8,ld),a("div",{onClick:s[14]||(s[14]=_=>l.addFrame("CANFD")),"data-disabled":e.$props.store.sendRecord.dbc.dbcChn.length==0},"自定义CAN FD帧",8,id)],512),[[P,t.addRecordShow]])]),g(f,{message:t.message},null,8,["message"])],64)}const nd=E(kr,[["render",ad],["__scopeId","data-v-437f19d4"]]);let _e=[],lt=0;const od={props:["filledOptions","checkedOptions"],emits:["connect","showMessage","getCarCode","cancel","signalsChange"],components:{Button:K,RecycleScroller:me,Spin:oe,Message:J},data(){var s,i,o;const e=this.$ls.get("blfread_sdbData")||[];if(this.carType==="custom"){let t=(s=e.find(l=>l.sdb===this.sdb))==null?void 0:s.comments;t&&(_e=["",...t])}else _e=((o=(i=Ie.find(t=>t.value===this.$props.carType))==null?void 0:i.children.find(t=>t.value===this.$props.sdb))==null?void 0:o.comments)||[];return _e=_e.map((t,l)=>"".concat("⓪①②③④⑤⑥⑦⑧⑨⑩⑪⑫⑬⑭⑮⑯⑰⑱⑲⑳㉑㉒㉓㉔㉕㉖㉗㉘㉙㉚㉛㉜㉝㉞㉟㊱㊲"[l]).concat(t)),{inputStr:"",checkedList:[],selectNodeList:[],counter:0,sdbCustom:e,lodingSpin:!1,isFlag:1,message:{visible:!1,level:"",content:""},listOpen:[],expandKeys:new Set([])}},computed:{list(){this.checkedList=this.$props.checkedOptions;let e=[],s=this,i=this.$props.filledOptions.data;for(let t in i){let l;l={_id:+t,id:+t,text:_e[t],node_type:"channel",children:[],set checked(n){l.children.forEach(r=>{r.checked=n})},get checked(){return!l.children.some(n=>n.checked==!1)},get indeterminate(){return l.children.some(n=>n.checked)&&l.children.some(n=>!n.checked)}};for(let n in i[t]){let r;r={_id:t+"_"+n,id:t+"_"+n,text:n=="-1"?"":n,node_type:"msg",channel:l.id,set checked(d){d?s.checkedList.push(r):s.checkedList=s.checkedList.filter(c=>c._id!==r._id)},get checked(){return s.checkedList.some(d=>d._id===r._id)},children:i[t][n].map(d=>{var m;let c;return c={_id:t+"_"+n+"_"+d[0],id:d[0],msg:n=="-1"?"-1":+((m=n.match(/0x\w+/))==null?void 0:m[0])||n,channel:l.id,text:d[0],node_type:"signal",comment:d[1],remark:d[2],canId:d[3],rawValue:d[4],maxRaw:d[5],minRaw:d[6],maxPhys:d[7],minPhys:d[8],selectPhys:d[9],unit:d[10],startBit:d[11],length:d[12],physStep:d[13],dlc:d[14],canType:d[15],periodic:d[16],eteDisable:d[17]},c})},l.children.push(r)}e.push(l)}let o=[];for(let t=0;t<e.length;t++){let l=e[t];if(l.id!=-1&&o.push(l),!(!this.inputStr&&!this.expandKeys.has(l.id)))for(let n=0;n<l.children.length;n++){let r=l.children[n];r.id[0]!="-"&&o.push(r)}}if(this.inputStr.length>0){const t=this.inputStr.toLowerCase();let l;try{l=new RegExp(t,"i")}catch(n){l={test(r){return~r.toLowerCase().indexOf(r.toLowerCase())}}}o=o.filter(n=>l.test(n.text)||n.comment&&l.test(n.comment)||n.remark&&l.test(n.remark))}return o}},watch:{checkedListIndex:{handler(e){this.checkedList=[]},deep:!0}},mounted(){this.$refs.chsInputRef.focus(),setTimeout(()=>{document.body.addEventListener("mousedown",this.clickHandler)},300)},beforeUnmount(){},unmounted(){document.body.removeEventListener("mousedown",this.clickHandler)},methods:{clickHandler(e){var s;((s=this.$refs.root)==null?void 0:s.contains(e.target))==!1&&this.$emit("cancel")},showFirstChild(e){this.expandKeys.has(e.id)?this.expandKeys.delete(e.id):this.expandKeys.add(e.id)},clearTable(){this.checkedList=[]},title4node(e){return we(e)},showMessage({level:e,content:s,timeout:i}){clearTimeout(lt),e!=null&&(this.message.level=e),s!=null&&(this.message.content=s),this.message.visible=!0,i>0&&(lt=setTimeout(()=>{this.message.visible=!1},i))},submit(){this.checkedList.length>80?this.showMessage({level:"error",content:"信号选择不能超过80项",timeout:3e3}):this.$emit("signalsChange",this.checkedList)},highlightWord(e){if(!e)return e;const s=this.inputStr;if(!s)return e;const i=s.split(/\s+/g);var o,t=i.length,l;for(o=0;o<t;o++)try{l=new RegExp(i[o],"gi"),l.test(e)&&(e=e.replace(l,"<strong>$&</strong>"))}catch(n){l=i[o],e=e.replace(l,"<strong>$&</strong>")}return e}}},rd={class:"chs-er",ref:"root"},dd={class:"chs-list-er","data-loading":!1},cd=["onClick"],hd=["id","onUpdate:modelValue","data-indeterminate"],ud=["innerHTML"],md=["for"],pd=["id","onUpdate:modelValue","data-indeterminate"],fd=["innerHTML"],gd={class:"footer"};function bd(e,s,i,o,t,l){const n=w("RecycleScroller"),r=w("Message"),d=U("tooltip"),c=U("esc");return C((h(),u("div",rd,[C(a("input",{class:"chs-input-er",placeholder:"搜索信号名称/信号描述",ref:"chsInputRef","onUpdate:modelValue":s[0]||(s[0]=m=>t.inputStr=m),onInput:s[1]||(s[1]=(...m)=>e.onChange&&e.onChange(...m)),draggable:!1},null,544),[[Y,t.inputStr]]),a("div",dd,[g(n,{class:"chs-list",items:l.list,"item-size":28,"key-field":"_id"},{default:T(({item:m})=>[a("label",null,[m.node_type=="channel"&&m.id>=1e3?(h(),u("div",{key:0,style:{"margin-left":"1px"},class:pe(!t.inputStr&&t.expandKeys.has(m.id)?"switch-open":"switch-close"),onClick:N(f=>l.showFirstChild(m),["stop","prevent"])},null,10,cd)):v("",!0),m.node_type=="channel"&&m.id>=1e3?C((h(),u("input",{key:1,style:{"margin-left":"3px"},id:m._id,type:"checkbox","onUpdate:modelValue":f=>m.checked=f,"data-indeterminate":m.indeterminate,"click.stop":""},null,8,hd)),[[Q,m.checked]]):v("",!0),m.node_type=="channel"&&m.id>=1e3?(h(),u("span",{key:2,class:"chs-node",innerHTML:l.highlightWord(m._id)},null,8,ud)):m.node_type=="msg"?C((h(),u("div",{key:3,for:m.children,style:{"text-indent":"2em","margin-left":"-15px"},class:"chs-node chs-node-item"},[C(a("input",{id:m._id,type:"checkbox","onUpdate:modelValue":f=>m.checked=f,"data-indeterminate":m.indeterminate,"click.stop":""},null,8,pd),[[Q,m.checked]]),a("span",{class:"",innerHTML:l.highlightWord(m.text)},null,8,fd)],8,md)),[[d,{content:l.title4node(m),html:!0},void 0,{right:!0}]]):v("",!0)])]),_:1},8,["items"])]),a("div",gd,[a("div",{class:"chs-btn confirm",onClick:s[2]||(s[2]=(...m)=>l.submit&&l.submit(...m))},"确认"),a("div",{class:"chs-btn cancel",onClick:s[3]||(s[3]=(...m)=>l.clearTable&&l.clearTable(...m))},"重置")]),g(r,{message:t.message},null,8,["message"])])),[[c,()=>e.$emit("cancel")]])}const _d=E(od,[["render",bd],["__scopeId","data-v-b5f3b0db"]]);let it=0;const yd={props:["activeTab","linSendInfo","nodeOpt","ldfChn","store","setStore","curFileIdx","deployDisable"],components:{ButtonGroup:ve,Button:K,InputHex:He,EditWrapper:Ue,ChooseSignal:_d,InputOrSelect:Be},data(){return{nodeVal:{},mode:"schedule",cur:-1,linListTable:{cols:[{label:"",width:"2.8em",icon:"add"},{label:"Frame Name",width:"auto"},{label:"Delay (ms)",width:"9em",tooltip:{content:"1-1000ms:周期发送<br/>0:单点发送",html:!0}},{label:"ID",width:"4.5em",tooltip:"DBC导入禁止修改ID"},{label:"Channel",width:"6em"},{label:"DIR",width:"6em"},{label:"DLC",width:"3em"},{label:"",width:"5em"}]},linSigTable:{cols:[{label:"Signal Name",width:"auto"},{label:"Raw",width:"90px"},{label:"Phys",width:"200px"},{label:"Unit",width:"4em"}]},linIsHexMulti:!1,hexs:[],activeTab:0,activeChn:0,activeScheduleIndex:-1,activeTableList:new Map,chooseLinSignalShow:!1,linAddRecordShow:!1,frames:[],cur:-1,isDeploying:!1,isDeployChecked:!0,showScheduleList:!0,scheduleStyleOpt:[{label:"调度表",value:"schedule",disable:"false"},{label:"单帧",value:"single",disable:"false"}],isFilled:!0}},watch:{curFileIdx(e){this.activeTab=e},deployDisable(e){console.log("部署disable",e)},linSendInfo(e){this.activeLinData=e==null?void 0:e.data[this.activeChn],console.log("this.activeLinData07251122",this.activeLinData)},ldfChn:{handler(e){console.log("newVal07051108",e),this.nodeVal={},this.frames=[],this.scheduleList=[]},deep:!0,immediate:!0},"$props.store.sendRecord.isRecording":{handler(e){e&&this.updateMultiFrame(this.frames.map((s,i)=>({...s,row:i+1})),"add")}},"$props.store.sendRecord":{handler(e,s){}},frames:{async handler(e,s){if(console.log("nextFrames1800111",e),!this.isSyncFrames){this.isSyncFrames=!0,this.isHexMulti=!1,e.length>0&&(this.isDeployChecked=!1);for(let i=0;i<e.length;i++){let o=e[i],t=o.channel;console.log("frame07051053",t);let l=o.id;console.log("frame.dirty07041441",o.dirty,o),o.dirty==="raw"?await x.blfLogging.getRawValueToPhysValueLIN({ldfChannel:this.ldfChn[this.activeTab],linId:l,signalsData:o.children.map(n=>({name:n.text,rawValue:n.rawValue}))}).then(n=>{this.frames[i]={...o,rawData:n.data.data.rawData,children:o.children.map(r=>{var d,c;return{...r,physValue:(c=(d=n.data.data.signalsData.find(m=>m.name===r.id))==null?void 0:d.physValue)!=null?c:r.physValue}}),dirty:!1,raw:i+1},this.updateMultiFrame([{row:i+1,...this.frames[i]}],"modify"),this.isDeploying&&this.getDSServer()}).catch(console.log):o.dirty==="data"?(console.log("this.frames[i]07051410",o),o.from==="dbc"||o.from==="sch"?await x.blfLogging.getDataToValuesLIN({ldfChannel:this.ldfChn[this.activeTab],linId:l,rawData:o.rawData}).then(n=>{console.log("res07110934",n),this.frames[i]={...o,children:o.children.map(r=>{var d,c,m,f;return{...r,physValue:(c=(d=n.data.data.signalsPhysData.find(y=>y.name===r.id))==null?void 0:d.physValue)!=null?c:r.physValue,rawValue:(f=(m=n.data.data.signalsRawData.find(y=>y.name===r.id))==null?void 0:m.rawValue)!=null?f:r.rawValue}}),dirty:!1,raw:i+1},this.updateMultiFrame([{row:i+1,...this.frames[i]}],"modify")}).catch(console.log):(this.frames[i]={...o,dirty:!1,raw:i+1},this.updateMultiFrame([{row:i+1,...this.frames[i]}],"modify")),this.isDeploying&&this.getDSServer()):o.dirty==="phys"?(console.log("frame.children0710",o.children),await x.blfLogging.getPhysValueToRawValueLIN({ldfChannel:this.ldfChn[this.activeTab],linId:l,signalsData:o.children.map(n=>({name:n.text,physValue:parseInt(n.physValue)}))}).then(n=>{this.frames[i]={...o,rawData:n.data.data.rawData,children:o.children.map(r=>{var d,c;return{...r,rawValue:(c=(d=n.data.data.signalsData.find(m=>m.name===r.id))==null?void 0:d.rawValue)!=null?c:r.rawValue}}),dirty:!1,raw:i+1},this.updateMultiFrame([{row:i+1,...this.frames[i]}],"modify"),this.isDeploying&&this.getDSServer()}).catch(console.log)):o.dirty==="dlc"?(this.frames[i]={...o,rawData:Array.from({length:o.dlc},(n,r)=>o.rawData[r]||0),dirty:!1,raw:i+1},this.updateMultiFrame([{row:i+1,...o}],"modify"),this.isDeploying&&this.getDSServer()):o.dirty==="delay"?(this.frames[i]={...o,isSending:o.delay==0?!1:o.isSending,dirty:!1,raw:i+1},this.updateMultiFrame([{row:i+1,...o}],"modify"),this.isDeploying&&this.getDSServer()):o.dirty&&(this.frames[i].dirty=!1,this.updateMultiFrame([{row:i+1,...o}],"modify"),this.isDeploying&&this.getDSServer())}this.isSyncFrames=!1}},deep:!0},cur(e){console.log("cur07041051",e,this.frames[e]),this.isHexMulti=!1,this.hexs=[]}},computed:{scheduleList(){if(console.log("this.activeLinData",this.ldfChn[this.activeTab],this.activeTab,this.linSendInfo,this.ldfChn),console.log("this.nodeVal.value",this.nodeVal),Object.keys(this.nodeVal).length>0&&this.nodeVal.value!==""){let e={};if(this.nodeVal.parentNode==="master")return this.showScheduleList=!0,e=this.ldfChn[this.activeTab]!==0?this.linSendInfo.data[this.ldfChn[this.activeTab]][this.nodeVal.parentNode][this.nodeVal.value]:{},Object.keys(e||{});{this.showScheduleList=!1,console.log("this.linSendInfo.data[this.ldfChn[this.activeTab]]",this.linSendInfo.data[this.ldfChn[this.activeTab]],this.linSendInfo),e=this.ldfChn[this.activeTab]!==0?this.linSendInfo.data[this.ldfChn[this.activeTab]][this.nodeVal.parentNode]:{};let s=Object.keys(e||{});return console.log("99999",s),s.forEach((i,o)=>{i===this.nodeVal.value&&this.checkedSchedule(o,i)}),s}}},checkedOptions(){return this.frames.filter(e=>e.from=="dbc")}},mounted(){setTimeout(()=>{document.body.addEventListener("mousedown",this.clickHandler)},300)},unmounted(){document.body.removeEventListener("mousedown",this.clickHandler)},methods:{checkedSchedule(e,s){console.log("index,item",e,s);let i=[];this.nodeVal.parentNode==="master"?i=this.ldfChn[this.activeTab]!==0?this.linSendInfo.data[this.ldfChn[this.activeTab]][this.nodeVal.parentNode][this.nodeVal.value][s]:[]:i=this.ldfChn[this.activeTab]!==0?this.linSendInfo.data[this.ldfChn[this.activeTab]][this.nodeVal.parentNode][s]:[],this.activeScheduleIndex=e;let o=i.map(t=>({_id:this.nodeVal.parentNode+"_"+t[0]+"_"+this.mode,id:t[1],linId:t[1],text:t[0],name:t[0],dir:t[2],dlc:t[3],delay:t[4],channel:this.ldfChn[0],dirty:"raw",from:"sch",children:t[5].map(l=>{let n;return n={_id:l[0],id:l[0],text:l[0],node_type:"signal",comment:l[1],remark:l[2],linId:l[3],rawValue:l[4],maxRaw:l[5],minRaw:l[6],maxPhys:l[7].toString(),minPhys:l[8].toString(),selectPhys:l[9],unit:l[10],startBit:l[11],length:l[12],physStep:l[13].toString(),dlc:l[14],canType:l[15],periodic:l[16]},n})}));this.frames=[],this.frames.push(...o),this.activeTableList.set(this.nodeVal.parentNode+"-"+this.nodeVal.value+"-"+this.mode,{phone:"213-555-1234",address:"123 N 1st Ave"})},clickHandler(e){var s;((s=this.$refs.root)==null?void 0:s.contains(e.target))==!1&&(this.linAddRecordShow=!1)},showMessage({level:e,content:s,timeout:i}){clearTimeout(it),e!=null&&(this.message.level=e),s!=null&&(this.message.content=s),this.message.visible=!0,i>0&&(it=setTimeout(()=>{this.message.visible=!1},i))},onHexErr(){this.showMessage({timeout:2e3,level:"error",content:"请输入正确格式的16进制"})},addFrame(e){console.log("this.ldfChn[0]",this.ldfChn[0]),this.linAddRecordShow=!1;let s=[{name:"",delay:20,id:e===1,channel:this.ldfChn[0],canType:e,dir:"tx",dlc:8,isSending:!1,from:e,rawData:[0,0,0,0,0,0,0,0]}],i=this.frames.length-1;this.frames.push(...s),this.updateMultiFrame(s.map((o,t)=>({...o,row:i+t})),"add")},updateMultiFrame(e,s){console.log("list07051359",e),this.$props.store.sendRecord.isRecording&&e.map(i=>({...i,channel:1+this.$props.store.sendRecord.dbc.ldfChn.indexOf(i.channel)}))},updateFrame(e){let s=this.frames.slice(),i=[],o=[];for(let t=s.length-1;t>=0;t--){let l=s[t];if(l.from==="dbc"){let n=e.findIndex(r=>r.id===l.id);if(~n)e.splice(n,1);else{t===this.cur&&(this.cur=-1);let r=s.splice(t,1);o.unshift({...r,row:t+1})}}}this.updateMultiFrame(o,"delete"),i=e.map((t,l)=>{let n=t.children[0]||{};return console.log("it111",n),{...t,name:t.text,from:"dbc",periodic:n.periodic||0,canType:n.canType||"LIN",dlc:n.dlc||64,id:n.msg||0,linId:n.canId||0,dirty:"raw",dir:"tx",delay:10,isSending:!1,children:t.children.map(r=>({...r,name:r.id}))}}),s.push(...i),this.frames=s,console.log("this.frames07040952",this.frames),this.chooseLinSignalShow=!1,this.addRecordShow=!1},async startDeploy(){console.log("部署",this.nodeVal,this.nodeVal.parentNode),this.isDeploying=!0;for(var e=0;e<this.scheduleStyleOpt.length;e++)this.scheduleStyleOpt[e].value==="single"&&(this.scheduleStyleOpt[e].disable="true");this.getDSServer(),console.log("ldfChn11",this.ldfChn,this.frames)},async getDSServer(){await x.blfLogging.getDeployShedule({channelId:1,mode:this.nodeVal.parentNode?this.nodeVal.parentNode:this.isFilled?"master":"slave",LINFrames:this.frames.map(e=>({LINId:e.linId?"0x"+(parseInt(e.linId)||0).toString(16):"0x0",dataLength:e.rawData?e.rawData.length:0,dir:e.dir==="tx"?0:1,delay:e.delay,data:e.rawData}))}).then(e=>{}).catch(console.log)},async endDeploy(){this.isDeploying=!1;for(var e=0;e<this.scheduleStyleOpt.length;e++)this.scheduleStyleOpt[e].value==="single"&&(this.scheduleStyleOpt[e].disable="false");await x.blfLogging.getUnDeployShedule({channelId:1,mode:this.nodeVal.parentNode?this.nodeVal.parentNode:this.isFilled?"master":"slave"}).then(s=>{}).catch(console.log)},async togglePlay(e,s){console.log("raw07162036",e,s),await x.blfLogging.getManualSendLIN({channelId:1,mode:this.nodeVal.parentNode?this.nodeVal.parentNode:this.isFilled?"master":"slave",LINFrames:[{LINId:e.linId?"0x"+(parseInt(e.linId)||0).toString(16):"0x0",dataLength:e.rawData.length,dir:e.dir==="tx"?0:1,delay:e.delay,data:e.rawData}]}).then(i=>{})},delFrame(e){console.log("idx2003",e,this.frames),e===this.cur&&(this.cur=-1);let s=this.frames.splice(e,1);this.frames.forEach((i,o)=>{this.frames[o].raw=o+1}),this.updateMultiFrame([{...s,row:e+1}],"delete")}}},le=e=>(B("data-v-290efa56"),e=e(),j(),e),wd={class:"lin-body"},vd={class:"select-er"},Cd={class:"select-left"},kd=le(()=>a("span",{class:"record-header-message"},[a("b",null,"节点：")],-1)),Sd={key:0,class:"chs-ft-label pointer"},Td=["checked"],Dd=le(()=>a("i",{class:"icon-ques"},null,-1)),Vd={class:"select-right"},xd=le(()=>a("i",{class:"play-icon"},null,-1)),Id=le(()=>a("i",{class:"stop-icon"},null,-1)),Ld={class:"lin-list-wrap"},Fd={class:"lin-list-tree-er"},Rd=le(()=>a("div",{class:"lin-list-tree-tit"},[a("i",{class:"lin-list-icon"}),a("b",null,"LIN调度表")],-1)),Md={class:"lin-list-tree-body"},Ed=["data-disabled","data-active","onClick"],$d=le(()=>a("i",{class:"lin-list-icon-sm"},null,-1)),Ad=["title"],Nd={class:"lin-list-er"},Od={class:"lin-list-table"},Pd={key:1,class:"ic-help"},Ud={key:2,type:"checkbox"},Hd={class:"add-record",ref:"root"},Bd=["data-disabled"],jd=["data-disabled"],qd=["onClick","data-active"],zd=["data-from","data-cantype","data-valid"],Kd=["onUpdate:modelValue","onChange"],Wd=["onUpdate:modelValue","onChange"],Xd=["value"],Gd=["onUpdate:modelValue","onChange"],Yd=le(()=>a("option",{value:"tx"},"tx",-1)),Jd=le(()=>a("option",{value:"rx"},"rx",-1)),Qd=[Yd,Jd],Zd=["disabled","onUpdate:modelValue","onChange"],ec=["data-disable","data-recording","data-active","onClick"],tc=["data-disable","onClick"],sc={key:0,class:"table-empty"},lc={class:"empty-meark"},ic={class:"btn-import-er"},ac={class:"lin-sig-er"},nc={class:"lin-hex-er"},oc=le(()=>a("th",{style:{width:"4em"}}," ",-1)),rc={style:{width:"11.8%"}},dc={key:0},cc=["value"],hc={class:"hex-footer"},uc={class:"hex-multi-input"};function mc(e,s,i,o,t,l){var A,X,_,M,I,S,te,z,de;const n=w("v-select"),r=w("ButtonGroup"),d=w("Button"),c=w("EditWrapper"),m=w("InputHex"),f=w("ChooseSignal"),y=w("InputOrSelect"),R=U("tooltip");return h(),u("div",wd,[a("div",vd,[a("div",Cd,[kd,g(n,{options:i.nodeOpt,clearable:!1,searchable:!1,disabled:t.isDeploying,label:"label",value:"value",modelValue:t.nodeVal,"onUpdate:modelValue":s[0]||(s[0]=p=>t.nodeVal=p),class:"tch-tool-select"},null,8,["options","disabled","modelValue"]),i.ldfChn[this.activeTab]=="0"?C((h(),u("label",Sd,[a("input",{class:"chs-node-checkboxAll",type:"checkbox",checked:t.isFilled,onClick:s[1]||(s[1]=p=>e.checkMasterMode())},null,8,Td),k("主节点模式"),Dd])),[[R,"主节点模式"]]):v("",!0)]),a("div",Vd,[g(r,{options:t.scheduleStyleOpt,class:"theme-btn-group",modelValue:t.mode,"onUpdate:modelValue":s[2]||(s[2]=p=>t.mode=p)},null,8,["options","modelValue"]),k("  "),t.isDeploying?(h(),O(d,{key:1,type:"primary",class:"header-import-btn",onClick:l.endDeploy},{default:T(()=>[Id,k("停止 ")]),_:1},8,["onClick"])):(h(),O(d,{key:0,type:"primary",class:"header-import-btn",onClick:l.startDeploy,disabled:t.isDeployChecked||t.mode=="single"||i.deployDisable,progress:"100%"},{default:T(()=>[xd,k("部署 ")]),_:1},8,["onClick","disabled"]))])]),a("div",Ld,[C(a("div",Fd,[Rd,a("div",Md,[(h(!0),u(D,null,L(l.scheduleList,(p,F)=>(h(),u("div",{class:"lin-list-tree-item",key:F,"data-disabled":t.isDeploying,"data-active":t.activeScheduleIndex===F,onClick:V=>l.checkedSchedule(F,p)},[$d,a("span",{title:p},b(p),9,Ad)],8,Ed))),128))])],512),[[P,t.showScheduleList]]),a("div",Nd,[a("table",Od,[a("tr",null,[(h(!0),u(D,null,L(t.linListTable.cols,p=>(h(),u("th",{style:$({width:p.width})},[k(b(p.label)+" ",1),p.icon?(h(),u("i",{key:0,onClick:s[3]||(s[3]=F=>t.linAddRecordShow=!t.linAddRecordShow),class:"lin-ic-add"})):v("",!0),p.tooltip?C((h(),u("i",Pd,null,512)),[[R,p.tooltip]]):v("",!0),p.type?(h(),u("input",Ud)):v("",!0)],4))),256)),C(a("div",Hd,[a("div",{onClick:s[4]||(s[4]=p=>t.chooseLinSignalShow=!t.chooseLinSignalShow),"data-disabled":((_=(X=(A=e.$props.store)==null?void 0:A.sendRecord)==null?void 0:X.frames)==null?void 0:_.length)===0||t.isDeploying},"从DBC中导入帧",8,Bd),a("div",{onClick:s[5]||(s[5]=p=>l.addFrame("LIN")),"data-disabled":((S=(I=(M=e.$props.store)==null?void 0:M.sendRecord)==null?void 0:I.frames)==null?void 0:S.length)==0||t.isDeploying},"自定义帧",8,jd)],512),[[P,t.linAddRecordShow]])]),(h(!0),u(D,null,L(t.frames,(p,F)=>(h(),u("tr",{onClick:V=>t.cur=F,"data-active":t.cur===F},[a("td",null,b(F+1),1),a("td",null,[a("i",{class:"ic-can","data-from":p.from,"data-cantype":p.canType,"data-valid":Object.values(e.$props.store.sendRecord.dbc.ldfChn).includes(p.channel)},null,8,zd),k(" "+b(p.name),1)]),a("td",null,[g(c,null,{default:T(()=>[C(a("input",{class:"td-input",type:"number",min:"0",max:"1000","onUpdate:modelValue":V=>p.delay=V,onChange:V=>p.dirty="delay"},null,40,Kd),[[Y,p.delay,void 0,{lazy:!0}]])]),_:2},1024)]),a("td",null,[g(c,{disabled:p.from!=="LIN"},{default:T(()=>[g(m,{onError:l.onHexErr,min:0,max:2047,disabled:p.from!=="LIN",class:"td-input",modelValue:p.linId,"onUpdate:modelValue":V=>p.linId=V,onChange:V=>p.dirty="linId"},null,8,["onError","disabled","modelValue","onUpdate:modelValue","onChange"])]),_:2},1032,["disabled"])]),a("td",null,[g(c,{disabled:!0},{default:T(()=>[C(a("select",{class:"td-input",disabled:!0,"onUpdate:modelValue":V=>p.channel=V,onChange:V=>p.dirty="channel"},[(h(!0),u(D,null,L(e.$props.store.sendRecord.dbc.ldfChn,(V,G)=>(h(),u("option",{value:V},"LIN"+b(G+1),9,Xd))),256))],40,Wd),[[ne,p.channel,void 0,{lazy:!0}]])]),_:2},1024)]),a("td",null,[g(c,null,{default:T(()=>[C(a("select",{class:"td-input","onUpdate:modelValue":V=>p.dir=V,onChange:V=>p.dirty="dir"},Qd,40,Gd),[[ne,p.dir]])]),_:2},1024)]),a("td",null,[g(c,{disabled:p.from!=="LIN"},{default:T(()=>[C(a("input",{disabled:p.from!=="LIN",class:"td-input",type:"number",min:"0",max:"8","onUpdate:modelValue":V=>p.dlc=V,onChange:V=>p.dirty="dlc"},null,40,Zd),[[Y,p.dlc,void 0,{lazy:!0}]])]),_:2},1032,["disabled"])]),a("td",null,[t.mode!=="schedule"?(h(),u("i",{key:0,class:"ic-play","data-disable":Object.values(e.$props.store.sendRecord.dbc.ldfChn).includes(p.channel),"data-recording":e.$props.store.sendRecord.isRecording,"data-active":p.isSending,onClick:V=>l.togglePlay(p,F)},null,8,ec)):v("",!0),k("  "),a("i",{class:"ic-del","data-disable":t.isDeploying,onClick:N(V=>l.delFrame(F),["stop"])},null,8,tc)])],8,qd))),256))]),t.frames.length==0?(h(),u("div",sc,[a("div",lc,[k("暂无内容，请先"),a("span",{class:"empty-btn",onClick:s[6]||(s[6]=p=>t.linAddRecordShow=!t.linAddRecordShow)},"导入帧")])])):v("",!0)]),C(a("div",ic,[t.chooseLinSignalShow?(h(),O(f,{key:0,filledOptions:e.$props.store.sendRecord.frames,checkedOptions:l.checkedOptions,onSignalsChange:l.updateFrame,onCancel:s[7]||(s[7]=()=>{t.chooseLinSignalShow=!1})},null,8,["filledOptions","checkedOptions","onSignalsChange"])):v("",!0)],512),[[P,t.chooseLinSignalShow]])]),a("div",ac,[(h(),u("table",{class:"sig-table",key:"sig"+t.cur},[a("tr",null,[(h(!0),u(D,null,L(t.linSigTable.cols,p=>(h(),u("th",{style:$({width:p.width})},b(p.label),5))),256))]),((te=t.frames[t.cur])==null?void 0:te.name)!==""?(h(!0),u(D,{key:0},L((z=t.frames[t.cur])==null?void 0:z.children,p=>(h(),u("tr",null,[C((h(),u("td",null,[k(b(p.text)+" ",1)])),[[R,{content:"".concat(p.text,"<hr/>phys:").concat(p.minPhys," ~ ").concat(p.maxPhys,"<br/>raw:").concat(p.minRaw?"0x"+p.minRaw.toString(16):""," ~ ").concat(p.maxRaw?"0x"+p.maxRaw.toString(16):"","<br/>Start Bit:").concat(p.startBit,"<br>Length:").concat(p.length,"<br>Phys Step:").concat(p.physStep),html:!0},void 0,{"top-start":!0}]]),a("td",null,[g(c,null,{default:T(()=>[g(m,{watch:!0,onError:l.onHexErr,min:p.minRaw,max:p.maxRaw,class:"td-input",modelValue:p.rawValue,"onUpdate:modelValue":F=>p.rawValue=F,modelModifiers:{lazy:!0},onChange:s[8]||(s[8]=F=>t.frames[t.cur].dirty="raw")},null,8,["onError","min","max","modelValue","onUpdate:modelValue"])]),_:2},1024)]),a("td",null,[g(c,null,{default:T(()=>[g(y,{watch:!0,min:p.minPhys,max:p.maxPhys,class:"td-input",step:p.physStep,modelValue:p.physValue,"onUpdate:modelValue":F=>p.physValue=F,enum:p.selectPhys?p.selectPhys:"",onChange:s[9]||(s[9]=F=>t.frames[t.cur].dirty="phys")},null,8,["min","max","step","modelValue","onUpdate:modelValue","enum"])]),_:2},1024)]),a("td",null,b(p.unit),1)]))),256)):v("",!0)]))]),a("div",nc,[(h(),u("table",{class:"lin-hex-table",key:"hex"+t.cur},[a("tr",null,[oc,(h(),u(D,null,L([0,1,2,3,4,5,6,7],p=>a("th",rc,b(p),1)),64))]),(de=t.frames[t.cur])!=null&&de.rawData?(h(),u(D,{key:0},L([0,8,16,24,32,40,48,56,64],(p,F)=>(h(),u(D,null,[t.frames[t.cur].rawData.length>p?(h(),u("tr",dc,[a("td",null,[a("b",null,b(p),1)]),(h(),u(D,null,L(8,V=>a("td",null,[e.isHexMulti&&p+V-1<t.frames[t.cur].rawData.length?C((h(),u("input",{key:0,type:"checkbox",class:"radio","onUpdate:modelValue":s[10]||(s[10]=G=>t.hexs=G),value:p+V-1},null,8,cc)),[[Q,t.hexs]]):v("",!0),p+V-1<t.frames[t.cur].rawData.length?(h(),O(c,{key:1},{default:T(()=>[g(m,{watch:!0,onError:l.onHexErr,min:0,max:255,class:"td-input",style:{width:"calc(100%)","text-indent":"20px"},modelValue:t.frames[t.cur].rawData[p+V-1],"onUpdate:modelValue":G=>t.frames[t.cur].rawData[p+V-1]=G,modelModifiers:{lazy:!0},onChange:s[11]||(s[11]=G=>t.frames[t.cur].dirty="data")},null,8,["onError","modelValue","onUpdate:modelValue"])]),_:2},1024)):v("",!0)])),64))])):v("",!0)],64))),64)):v("",!0)])),a("div",hc,[t.linIsHexMulti?(h(),u(D,{key:1},[k(" 批量修改:("+b(t.hexs.length)+"个)  ",1),g(d,{style:{float:"right",height:"23px","margin-left":"8px"},onClick:s[13]||(s[13]=p=>{t.hexs=[],t.linIsHexMulti=!1})},{default:T(()=>[k("退出")]),_:1}),g(d,{style:{float:"right",height:"23px"},type:"primary"},{default:T(()=>[k("修改")]),_:1}),a("div",uc,[g(m,{onError:l.onHexErr,min:0,max:255,modelValue:e.hexMultiValue,"onUpdate:modelValue":s[14]||(s[14]=p=>e.hexMultiValue=p)},null,8,["onError","modelValue"])])],64)):(h(),u("div",{key:0,class:"hex-footer-full-btn",onClick:s[12]||(s[12]=p=>t.linIsHexMulti=!t.linIsHexMulti)},"进入批量修改"))])])])}const pc=E(yd,[["render",mc],["__scopeId","data-v-290efa56"]]);let ye=[],at=0;const fc={props:["filledOptions","checkedOptions"],emits:["connect","showMessage","getCarCode","cancel","signalsChange"],components:{Button:K,RecycleScroller:me,Spin:oe,Message:J},data(){var s,i,o;const e=this.$ls.get("blfread_sdbData")||[];if(this.carType==="custom"){let t=(s=e.find(l=>l.sdb===this.sdb))==null?void 0:s.comments;t&&(ye=["",...t])}else ye=((o=(i=Ie.find(t=>t.value===this.$props.carType))==null?void 0:i.children.find(t=>t.value===this.$props.sdb))==null?void 0:o.comments)||[];return ye=ye.map((t,l)=>"".concat("⓪①②③④⑤⑥⑦⑧⑨⑩⑪⑫⑬⑭⑮⑯⑰⑱⑲⑳㉑㉒㉓㉔㉕㉖㉗㉘㉙㉚㉛㉜㉝㉞㉟㊱㊲"[l]).concat(t)),{inputStr:"",checkedList:[],selectNodeList:[],counter:0,sdbCustom:e,lodingSpin:!1,isFlag:1,message:{visible:!1,level:"",content:""},listOpen:[],expandKeys:new Set([])}},computed:{list(){this.checkedList=this.$props.checkedOptions;let e=[],s=this,i=this.$props.filledOptions.data;for(let t in i){let l;l={_id:+t,id:+t,text:ye[t],node_type:"channel",children:[],set checked(n){l.children.forEach(r=>{r.checked=n})},get checked(){return!l.children.some(n=>n.checked==!1)},get indeterminate(){return l.children.some(n=>n.checked)&&l.children.some(n=>!n.checked)}};for(let n in i[t]){let r;r={_id:t+"_"+n,id:t+"_"+n,text:n=="-1"?"":n,node_type:"msg",channel:l.id,set checked(d){d?s.checkedList.push(r):s.checkedList=s.checkedList.filter(c=>c._id!==r._id)},get checked(){return s.checkedList.some(d=>d._id===r._id)},children:i[t][n].map(d=>{var m;let c;return c={_id:t+"_"+n+"_"+d[0],id:d[0],msg:n=="-1"?"-1":+((m=n.match(/0x\w+/))==null?void 0:m[0])||n,channel:l.id,text:d[0],node_type:"signal",comment:d[1],remark:d[2],canId:d[3],rawValue:d[4],maxRaw:d[5],minRaw:d[6],maxPhys:d[7],minPhys:d[8],selectPhys:d[9],unit:d[10],startBit:d[11],length:d[12],physStep:d[13],dlc:d[14],canType:d[15],periodic:d[16],eteDisable:d[17]},c})},l.children.push(r)}e.push(l)}let o=[];for(let t=0;t<e.length;t++){let l=e[t];if(l.id!=-1&&o.push(l),!(!this.inputStr&&!this.expandKeys.has(l.id)))for(let n=0;n<l.children.length;n++){let r=l.children[n];r.id[0]!="-"&&o.push(r)}}if(this.inputStr.length>0){const t=this.inputStr.toLowerCase();let l;try{l=new RegExp(t,"i")}catch(n){l={test(r){return~r.toLowerCase().indexOf(r.toLowerCase())}}}o=o.filter(n=>l.test(n.text)||n.comment&&l.test(n.comment)||n.remark&&l.test(n.remark))}return o}},watch:{checkedListIndex:{handler(e){this.checkedList=[]},deep:!0}},mounted(){this.$refs.chsInputRef.focus(),setTimeout(()=>{document.body.addEventListener("mousedown",this.clickHandler)},300)},beforeUnmount(){},unmounted(){document.body.removeEventListener("mousedown",this.clickHandler)},methods:{clickHandler(e){var s;((s=this.$refs.root)==null?void 0:s.contains(e.target))==!1&&this.$emit("cancel")},showFirstChild(e){this.expandKeys.has(e.id)?this.expandKeys.delete(e.id):this.expandKeys.add(e.id)},clearTable(){this.checkedList=[]},title4node(e){return we(e)},showMessage({level:e,content:s,timeout:i}){clearTimeout(at),e!=null&&(this.message.level=e),s!=null&&(this.message.content=s),this.message.visible=!0,i>0&&(at=setTimeout(()=>{this.message.visible=!1},i))},submit(){this.checkedList.length>80?this.showMessage({level:"error",content:"信号选择不能超过80项",timeout:3e3}):this.$emit("signalsChange",this.checkedList)},highlightWord(e){if(!e)return e;const s=this.inputStr;if(!s)return e;const i=s.split(/\s+/g);var o,t=i.length,l;for(o=0;o<t;o++)try{l=new RegExp(i[o],"gi"),l.test(e)&&(e=e.replace(l,"<strong>$&</strong>"))}catch(n){l=i[o],e=e.replace(l,"<strong>$&</strong>")}return e}}},gc={class:"chs-er",ref:"root"},bc={class:"chs-list-er","data-loading":!1},_c=["onClick"],yc=["id","onUpdate:modelValue","data-indeterminate"],wc=["innerHTML"],vc=["for"],Cc=["id","onUpdate:modelValue","data-indeterminate"],kc=["innerHTML"],Sc={class:"footer"};function Tc(e,s,i,o,t,l){const n=w("RecycleScroller"),r=w("Message"),d=U("tooltip"),c=U("esc");return C((h(),u("div",gc,[C(a("input",{class:"chs-input-er",placeholder:"搜索信号名称/信号描述",ref:"chsInputRef","onUpdate:modelValue":s[0]||(s[0]=m=>t.inputStr=m),onInput:s[1]||(s[1]=(...m)=>e.onChange&&e.onChange(...m)),draggable:!1},null,544),[[Y,t.inputStr]]),a("div",bc,[g(n,{class:"chs-list",items:l.list,"item-size":28,"key-field":"_id"},{default:T(({item:m})=>[a("label",null,[m.node_type=="channel"&&m.id>=1e3?(h(),u("div",{key:0,style:{"margin-left":"1px"},class:pe(!t.inputStr&&t.expandKeys.has(m.id)?"switch-open":"switch-close"),onClick:N(f=>l.showFirstChild(m),["stop","prevent"])},null,10,_c)):v("",!0),m.node_type=="channel"&&m.id>=1e3?C((h(),u("input",{key:1,style:{"margin-left":"3px"},id:m._id,type:"checkbox","onUpdate:modelValue":f=>m.checked=f,"data-indeterminate":m.indeterminate,"click.stop":""},null,8,yc)),[[Q,m.checked]]):v("",!0),m.node_type=="channel"&&m.id>=1e3?(h(),u("span",{key:2,class:"chs-node",innerHTML:l.highlightWord(m._id)},null,8,wc)):m.node_type=="msg"?C((h(),u("div",{key:3,for:m.children,style:{"text-indent":"2em","margin-left":"-15px"},class:"chs-node chs-node-item"},[C(a("input",{id:m._id,type:"checkbox","onUpdate:modelValue":f=>m.checked=f,"data-indeterminate":m.indeterminate,"click.stop":""},null,8,Cc),[[Q,m.checked]]),a("span",{class:"",innerHTML:l.highlightWord(m.text)},null,8,kc)],8,vc)),[[d,{content:l.title4node(m),html:!0},void 0,{right:!0}]]):v("",!0)])]),_:1},8,["items"])]),a("div",Sc,[a("div",{class:"chs-btn confirm",onClick:s[2]||(s[2]=(...m)=>l.submit&&l.submit(...m))},"确认"),a("div",{class:"chs-btn cancel",onClick:s[3]||(s[3]=(...m)=>l.clearTable&&l.clearTable(...m))},"重置")]),g(r,{message:t.message},null,8,["message"])])),[[c,()=>e.$emit("cancel")]])}const Dc=E(fc,[["render",Tc],["__scopeId","data-v-c5da6a65"]]);let nt=0;const Vc={props:["activeTab","linSendInfo","nodeOpt","ldfChn","store","setStore","curFileIdx","deployDisable"],components:{ButtonGroup:ve,Button:K,InputHex:He,EditWrapper:Ue,ChooseSignal:Dc,InputOrSelect:Be},data(){return{nodeVal:{},mode:"schedule",cur:-1,linListTable:{cols:[{label:"",width:"2.8em",icon:"add"},{label:"Frame Name",width:"auto"},{label:"Delay (ms)",width:"9em",tooltip:{content:"1-1000ms:周期发送<br/>0:单点发送",html:!0}},{label:"ID",width:"4.5em",tooltip:"DBC导入禁止修改ID"},{label:"Channel",width:"6em"},{label:"DIR",width:"6em"},{label:"DLC",width:"3em"},{label:"",width:"5em"}]},linSigTable:{cols:[{label:"Signal Name",width:"auto"},{label:"Raw",width:"90px"},{label:"Phys",width:"200px"},{label:"Unit",width:"4em"}]},linIsHexMulti:!1,hexs:[],activeTab:0,activeChn:0,activeScheduleIndex:-1,activeTableList:new Map,chooseLinSignalShow:!1,linAddRecordShow:!1,otherFrames:[],cur:-1,isDeploying:!1,isDeployChecked:!0,showScheduleList:!0,scheduleStyleOpt:[{label:"调度表",value:"schedule",disable:"false"},{label:"单帧",value:"single",disable:"false"}],isFilled:!0}},watch:{curFileIdx(e){this.activeTab=e,console.log("this.activeChn",this.activeChn,this.ldfChn)},deployDisable(e){console.log("部署disable",e)},linSendInfo(e){console.log("val111111",e),this.activeLinData=e==null?void 0:e.data[this.activeChn]},ldfChn:{handler(e){console.log("newVal07051108",e),this.nodeVal={},this.otherFrames=[],this.scheduleList=[]},deep:!0,immediate:!0},"$props.store.sendRecord.isRecording":{handler(e){e&&this.updateMultiFrame(this.otherFrames.map((s,i)=>({...s,row:i+1})),"add")}},"$props.store.sendRecord":{handler(e,s){}},otherFrames:{async handler(e,s){if(console.log("nextFrames1800",e),!this.isSyncFrames){this.isSyncFrames=!0,this.isHexMulti=!1;for(let i=0;i<e.length;i++){this.isDeployChecked=!1;let o=e[i],t=o.channel;console.log("frame07051053",t);let l=o.id;console.log("frame.dirty07041441",o.dirty,o),o.dirty==="raw"?await x.blfLogging.getRawValueToPhysValueLIN({ldfChannel:this.ldfChn[this.activeTab],linId:l,signalsData:o.children.map(n=>({name:n.text,rawValue:n.rawValue}))}).then(n=>{this.otherFrames[i]={...o,rawData:n.data.data.rawData,children:o.children.map(r=>{var d,c;return{...r,physValue:(c=(d=n.data.data.signalsData.find(m=>m.name===r.id))==null?void 0:d.physValue)!=null?c:r.physValue}}),dirty:!1,raw:i+1},this.updateMultiFrame([{row:i+1,...this.otherFrames[i]}],"modify"),this.isDeploying&&this.getDSServer()}).catch(console.log):o.dirty==="data"?(console.log("this.otherFrames[i]07051410",o),o.from==="dbc"||o.from==="sch"?await x.blfLogging.getDataToValuesLIN({ldfChannel:this.ldfChn[this.activeTab],linId:l,rawData:o.rawData}).then(n=>{console.log("res07110934",n),this.otherFrames[i]={...o,children:o.children.map(r=>{var d,c,m,f;return{...r,physValue:(c=(d=n.data.data.signalsPhysData.find(y=>y.name===r.id))==null?void 0:d.physValue)!=null?c:r.physValue,rawValue:(f=(m=n.data.data.signalsRawData.find(y=>y.name===r.id))==null?void 0:m.rawValue)!=null?f:r.rawValue}}),dirty:!1,raw:i+1},this.updateMultiFrame([{row:i+1,...this.otherFrames[i]}],"modify")}).catch(console.log):(this.otherFrames[i]={...o,dirty:!1,raw:i+1},this.updateMultiFrame([{row:i+1,...this.otherFrames[i]}],"modify")),this.isDeploying&&this.getDSServer()):o.dirty==="phys"?(console.log("frame.children0710",o.children),await x.blfLogging.getPhysValueToRawValueLIN({ldfChannel:this.ldfChn[this.activeTab],linId:l,signalsData:o.children.map(n=>({name:n.text,physValue:parseInt(n.physValue)}))}).then(n=>{this.otherFrames[i]={...o,rawData:n.data.data.rawData,children:o.children.map(r=>{var d,c;return{...r,rawValue:(c=(d=n.data.data.signalsData.find(m=>m.name===r.id))==null?void 0:d.rawValue)!=null?c:r.rawValue}}),dirty:!1,raw:i+1},this.updateMultiFrame([{row:i+1,...this.otherFrames[i]}],"modify"),this.isDeploying&&this.getDSServer()}).catch(console.log)):o.dirty==="dlc"?(this.otherFrames[i]={...o,rawData:Array.from({length:o.dlc},(n,r)=>o.rawData[r]||0),dirty:!1,raw:i+1},this.updateMultiFrame([{row:i+1,...o}],"modify"),this.isDeploying&&this.getDSServer()):o.dirty==="delay"?(this.otherFrames[i]={...o,isSending:o.delay==0?!1:o.isSending,dirty:!1,raw:i+1},this.updateMultiFrame([{row:i+1,...o}],"modify"),this.isDeploying&&this.getDSServer()):o.dirty&&(this.otherFrames[i].dirty=!1,this.updateMultiFrame([{row:i+1,...o}],"modify"),this.isDeploying&&this.getDSServer())}this.isSyncFrames=!1}},deep:!0},cur(e){console.log("cur07041051",e,this.otherFrames[e]),this.isHexMulti=!1,this.hexs=[]}},computed:{scheduleList(){if(console.log("this.nodeVal",Object.keys(this.nodeVal),this.nodeVal,this.linSendInfo,this.ldfChn[this.activeTab]),Object.keys(this.nodeVal).length>0&&this.nodeVal.value!==""){let e={};if(this.nodeVal.parentNode==="master")return this.showScheduleList=!0,e=this.ldfChn[this.activeTab]!==0?this.linSendInfo.data[this.ldfChn[this.activeTab]][this.nodeVal.parentNode][this.nodeVal.value]:{},Object.keys(e||{});{this.showScheduleList=!1,e=this.ldfChn[this.activeTab]!==0?this.linSendInfo.data[this.ldfChn[this.activeTab]][this.nodeVal.parentNode]:{};let s=Object.keys(e||{});return console.log("99999",s),s.forEach((i,o)=>{i===this.nodeVal.value&&this.checkedSchedule(o,i)}),s}}},checkedOptions(){return this.otherFrames.filter(e=>e.from=="dbc")}},mounted(){setTimeout(()=>{document.body.addEventListener("mousedown",this.clickHandler)},300)},unmounted(){document.body.removeEventListener("mousedown",this.clickHandler)},methods:{checkedSchedule(e,s){let i=[];console.log("this.nodeVal.parentNode1749",this.nodeVal.parentNode),this.nodeVal.parentNode==="master"?i=this.ldfChn[this.activeTab]!==0?this.linSendInfo.data[this.ldfChn[this.activeTab]][this.nodeVal.parentNode][this.nodeVal.value][s]:[]:i=this.ldfChn[this.activeTab]!==0?this.linSendInfo.data[this.ldfChn[this.activeTab]][this.nodeVal.parentNode][s]:[],this.activeScheduleIndex=e;let o=i.map(t=>({_id:this.nodeVal.parentNode+"_"+t[0]+"_"+this.mode,id:t[1],linId:t[1],text:t[0],name:t[0],dir:t[2],dlc:t[3],delay:t[4],channel:this.ldfChn[1],dirty:"raw",from:"sch",children:t[5].map(l=>{let n;return n={_id:l[0],id:l[0],text:l[0],node_type:"signal",comment:l[1],remark:l[2],linId:l[3],rawValue:l[4],maxRaw:l[5],minRaw:l[6],maxPhys:l[7].toString(),minPhys:l[8].toString(),selectPhys:l[9],unit:l[10],startBit:l[11],length:l[12],physStep:l[13].toString(),dlc:l[14],canType:l[15],periodic:l[16]},n})}));this.otherFrames=[],this.otherFrames.push(...o),this.activeTableList.set(this.nodeVal.parentNode+"-"+this.nodeVal.value+"-"+this.mode,{phone:"213-555-1234",address:"123 N 1st Ave"})},clickHandler(e){var s;((s=this.$refs.root)==null?void 0:s.contains(e.target))==!1&&(this.linAddRecordShow=!1)},showMessage({level:e,content:s,timeout:i}){clearTimeout(nt),e!=null&&(this.message.level=e),s!=null&&(this.message.content=s),this.message.visible=!0,i>0&&(nt=setTimeout(()=>{this.message.visible=!1},i))},onHexErr(){this.showMessage({timeout:2e3,level:"error",content:"请输入正确格式的16进制"})},addFrame(e){this.linAddRecordShow=!1;let s=[{name:"",delay:20,id:e===1,channel:this.ldfChn[1],canType:e,dir:"tx",dlc:8,isSending:!1,from:e,rawData:[0,0,0,0,0,0,0,0]}],i=this.otherFrames.length-1;this.otherFrames.push(...s),this.updateMultiFrame(s.map((o,t)=>({...o,row:i+t})),"add")},updateMultiFrame(e,s){console.log("list07051359",e),this.$props.store.sendRecord.isRecording&&e.map(i=>({...i,channel:this.$props.store.sendRecord.dbc.ldfChn.indexOf(i.channel)+1}))},updateFrame(e){let s=this.otherFrames.slice(),i=[],o=[];for(let t=s.length-1;t>=0;t--){let l=s[t];if(l.from==="dbc"){let n=e.findIndex(r=>r.id===l.id);if(~n)e.splice(n,1);else{t===this.cur&&(this.cur=-1);let r=s.splice(t,1);o.unshift({...r,row:t+1})}}}this.updateMultiFrame(o,"delete"),i=e.map((t,l)=>{let n=t.children[0]||{};return console.log("it2222",n),{...t,name:t.text,from:"dbc",periodic:n.periodic||0,canType:n.canType||"LIN",dlc:n.dlc||64,id:n.msg||0,linId:n.canId||0,dirty:"raw",dir:"tx",delay:10,isSending:!1,children:t.children.map(r=>({...r,name:r.id}))}}),s.push(...i),this.otherFrames=s,console.log("this.frames07040952",this.otherFrames),this.chooseLinSignalShow=!1,this.addRecordShow=!1},async startDeploy(){console.log("部署",this.nodeVal,this.nodeVal.parentNode),this.isDeploying=!0;for(var e=0;e<this.scheduleStyleOpt.length;e++)this.scheduleStyleOpt[e].value==="single"&&(this.scheduleStyleOpt[e].disable="true");this.getDSServer(),console.log("ldfChn11",this.ldfChn,this.otherFrames)},async getDSServer(){await x.blfLogging.getDeployShedule({channelId:2,mode:this.nodeVal.parentNode?this.nodeVal.parentNode:this.isFilled?"master":"slave",LINFrames:this.otherFrames.map(e=>({LINId:e.linId?"0x"+(parseInt(e.linId)||0).toString(16):"0x0",dataLength:e.rawData?e.rawData.length:0,dir:e.dir==="tx"?0:1,delay:e.delay,data:e.rawData}))}).then(e=>{}).catch(console.log)},async endDeploy(){this.isDeploying=!1;for(var e=0;e<this.scheduleStyleOpt.length;e++)this.scheduleStyleOpt[e].value==="single"&&(this.scheduleStyleOpt[e].disable="false");await x.blfLogging.getUnDeployShedule({channelId:2,mode:this.nodeVal.parentNode?this.nodeVal.parentNode:this.isFilled?"master":"slave"}).then(s=>{}).catch(console.log)},async togglePlay(e,s){console.log("raw07162036",e,s),await x.blfLogging.getManualSendLIN({channelId:2,mode:this.nodeVal.parentNode?this.nodeVal.parentNode:this.isFilled?"master":"slave",LINFrames:[{LINId:e.linId?"0x"+(parseInt(e.linId)||0).toString(16):"0x0",dataLength:e.rawData.length,dir:e.dir==="tx"?0:1,delay:e.delay,data:e.rawData}]}).then(i=>{})},delFrame(e){console.log("idx200322222",e,this.otherFrames),e===this.cur&&(this.cur=-1);let s=this.otherFrames.splice(e,1);this.otherFrames.forEach((i,o)=>{this.otherFrames[o].raw=o+1}),this.updateMultiFrame([{...s,row:e+1}],"delete")}}},ie=e=>(B("data-v-ec94f9f4"),e=e(),j(),e),xc={class:"lin-body"},Ic={class:"select-er"},Lc={class:"select-left"},Fc=ie(()=>a("span",{class:"record-header-message"},[a("b",null,"节点：")],-1)),Rc={key:0,class:"chs-ft-label pointer"},Mc=["checked"],Ec=ie(()=>a("i",{class:"icon-ques"},null,-1)),$c={class:"select-right"},Ac=ie(()=>a("i",{class:"play-icon"},null,-1)),Nc=ie(()=>a("i",{class:"stop-icon"},null,-1)),Oc={class:"lin-list-wrap"},Pc={class:"lin-list-tree-er"},Uc=ie(()=>a("div",{class:"lin-list-tree-tit"},[a("i",{class:"lin-list-icon"}),a("b",null,"LIN调度表")],-1)),Hc={class:"lin-list-tree-body"},Bc=["data-disabled","data-active","onClick"],jc=ie(()=>a("i",{class:"lin-list-icon-sm"},null,-1)),qc=["title"],zc={class:"lin-list-er"},Kc={class:"lin-list-table"},Wc={key:1,class:"ic-help"},Xc={key:2,type:"checkbox"},Gc={class:"add-record",ref:"root"},Yc=["data-disabled"],Jc=["data-disabled"],Qc=["onClick","data-active"],Zc=["data-from","data-cantype","data-valid"],eh=["onUpdate:modelValue","onChange"],th=["onUpdate:modelValue","onChange"],sh=["value"],lh=["onUpdate:modelValue","onChange"],ih=ie(()=>a("option",{value:"tx"},"tx",-1)),ah=ie(()=>a("option",{value:"rx"},"rx",-1)),nh=[ih,ah],oh=["disabled","onUpdate:modelValue","onChange"],rh=["data-disable","data-recording","data-active","onClick"],dh=["data-disable","onClick"],ch={key:0,class:"table-empty"},hh={class:"empty-meark"},uh={class:"btn-import-er"},mh={class:"lin-sig-er"},ph={class:"lin-hex-er"},fh=ie(()=>a("th",{style:{width:"4em"}}," ",-1)),gh={style:{width:"11.8%"}},bh={key:0},_h=["value"],yh={class:"hex-footer"},wh={class:"hex-multi-input"};function vh(e,s,i,o,t,l){var A,X,_,M,I,S,te,z,de;const n=w("v-select"),r=w("ButtonGroup"),d=w("Button"),c=w("EditWrapper"),m=w("InputHex"),f=w("ChooseSignal"),y=w("InputOrSelect"),R=U("tooltip");return h(),u("div",xc,[a("div",Ic,[a("div",Lc,[Fc,g(n,{options:i.nodeOpt,clearable:!1,searchable:!1,disabled:t.isDeploying,label:"label",value:"value",modelValue:t.nodeVal,"onUpdate:modelValue":s[0]||(s[0]=p=>t.nodeVal=p),class:"tch-tool-select"},null,8,["options","disabled","modelValue"]),i.ldfChn[this.activeTab]=="0"?C((h(),u("label",Rc,[a("input",{class:"chs-node-checkboxAll",type:"checkbox",checked:t.isFilled,onClick:s[1]||(s[1]=p=>e.checkMasterMode())},null,8,Mc),k("主节点模式"),Ec])),[[R,"主节点模式"]]):v("",!0)]),a("div",$c,[g(r,{options:t.scheduleStyleOpt,class:"theme-btn-group",modelValue:t.mode,"onUpdate:modelValue":s[2]||(s[2]=p=>t.mode=p)},null,8,["options","modelValue"]),k("  "),t.isDeploying?(h(),O(d,{key:1,type:"primary",class:"header-import-btn",onClick:l.endDeploy},{default:T(()=>[Nc,k("停止 ")]),_:1},8,["onClick"])):(h(),O(d,{key:0,type:"primary",class:"header-import-btn",onClick:l.startDeploy,disabled:t.isDeployChecked||t.mode=="single"||i.deployDisable,progress:"100%"},{default:T(()=>[Ac,k("部署 ")]),_:1},8,["onClick","disabled"]))])]),a("div",Oc,[C(a("div",Pc,[Uc,a("div",Hc,[(h(!0),u(D,null,L(l.scheduleList,(p,F)=>(h(),u("div",{class:"lin-list-tree-item",key:F,"data-disabled":t.isDeploying,"data-active":t.activeScheduleIndex===F,onClick:V=>l.checkedSchedule(F,p)},[jc,a("span",{title:p},b(p),9,qc)],8,Bc))),128))])],512),[[P,t.showScheduleList]]),a("div",zc,[a("table",Kc,[a("tr",null,[(h(!0),u(D,null,L(t.linListTable.cols,p=>(h(),u("th",{style:$({width:p.width})},[k(b(p.label)+" ",1),p.icon?(h(),u("i",{key:0,onClick:s[3]||(s[3]=F=>t.linAddRecordShow=!t.linAddRecordShow),class:"lin-ic-add"})):v("",!0),p.tooltip?C((h(),u("i",Wc,null,512)),[[R,p.tooltip]]):v("",!0),p.type?(h(),u("input",Xc)):v("",!0)],4))),256)),C(a("div",Gc,[a("div",{onClick:s[4]||(s[4]=p=>t.chooseLinSignalShow=!t.chooseLinSignalShow),"data-disabled":((_=(X=(A=e.$props.store)==null?void 0:A.sendRecord)==null?void 0:X.otherFrames)==null?void 0:_.length)===0||t.isDeploying},"从DBC中导入帧",8,Yc),a("div",{onClick:s[5]||(s[5]=p=>l.addFrame("LIN")),"data-disabled":((S=(I=(M=e.$props.store)==null?void 0:M.sendRecord)==null?void 0:I.otherFrames)==null?void 0:S.length)==0||t.isDeploying},"自定义帧",8,Jc)],512),[[P,t.linAddRecordShow]])]),(h(!0),u(D,null,L(t.otherFrames,(p,F)=>(h(),u("tr",{onClick:V=>t.cur=F,"data-active":t.cur===F},[a("td",null,b(F+1),1),a("td",null,[a("i",{class:"ic-can","data-from":p.from,"data-cantype":p.canType,"data-valid":Object.values(e.$props.store.sendRecord.dbc.ldfChn).includes(p.channel)},null,8,Zc),k(" "+b(p.name),1)]),a("td",null,[g(c,null,{default:T(()=>[C(a("input",{class:"td-input",type:"number",min:"0",max:"1000","onUpdate:modelValue":V=>p.delay=V,onChange:V=>p.dirty="delay"},null,40,eh),[[Y,p.delay,void 0,{lazy:!0}]])]),_:2},1024)]),a("td",null,[g(c,{disabled:p.from!=="LIN"},{default:T(()=>[g(m,{onError:l.onHexErr,min:0,max:2047,disabled:p.from!=="LIN",class:"td-input",modelValue:p.linId,"onUpdate:modelValue":V=>p.linId=V,onChange:V=>p.dirty="linId"},null,8,["onError","disabled","modelValue","onUpdate:modelValue","onChange"])]),_:2},1032,["disabled"])]),a("td",null,[g(c,{disabled:!0},{default:T(()=>[C(a("select",{disabled:!0,class:"td-input","onUpdate:modelValue":V=>p.channel=V,onChange:V=>p.dirty="channel"},[(h(!0),u(D,null,L(e.$props.store.sendRecord.dbc.ldfChn,(V,G)=>(h(),u("option",{value:V},"LIN2",8,sh))),256))],40,th),[[ne,p.channel,void 0,{lazy:!0}]])]),_:2},1024)]),a("td",null,[g(c,null,{default:T(()=>[C(a("select",{class:"td-input","onUpdate:modelValue":V=>p.dir=V,onChange:V=>p.dirty="dir"},nh,40,lh),[[ne,p.dir]])]),_:2},1024)]),a("td",null,[g(c,{disabled:p.from!=="LIN"},{default:T(()=>[C(a("input",{disabled:p.from!=="LIN",class:"td-input",type:"number",min:"0",max:"8","onUpdate:modelValue":V=>p.dlc=V,onChange:V=>p.dirty="dlc"},null,40,oh),[[Y,p.dlc,void 0,{lazy:!0}]])]),_:2},1032,["disabled"])]),a("td",null,[t.mode!=="schedule"?(h(),u("i",{key:0,class:"ic-play","data-disable":Object.values(e.$props.store.sendRecord.dbc.ldfChn).includes(p.channel),"data-recording":e.$props.store.sendRecord.isRecording,"data-active":p.isSending,onClick:V=>l.togglePlay(p,F)},null,8,rh)):v("",!0),k("  "),a("i",{class:"ic-del","data-disable":t.isDeploying,onClick:N(V=>l.delFrame(F),["stop"])},null,8,dh)])],8,Qc))),256))]),t.otherFrames.length==0?(h(),u("div",ch,[a("div",hh,[k("暂无内容，请先"),a("span",{class:"empty-btn",onClick:s[6]||(s[6]=p=>t.linAddRecordShow=!t.linAddRecordShow)},"导入帧")])])):v("",!0)]),C(a("div",uh,[t.chooseLinSignalShow?(h(),O(f,{key:0,filledOptions:e.$props.store.sendRecord.otherFrames,checkedOptions:l.checkedOptions,onSignalsChange:l.updateFrame,onCancel:s[7]||(s[7]=()=>{t.chooseLinSignalShow=!1})},null,8,["filledOptions","checkedOptions","onSignalsChange"])):v("",!0)],512),[[P,t.chooseLinSignalShow]])]),a("div",mh,[(h(),u("table",{class:"sig-table",key:"sig"+t.cur},[a("tr",null,[(h(!0),u(D,null,L(t.linSigTable.cols,p=>(h(),u("th",{style:$({width:p.width})},b(p.label),5))),256))]),((te=t.otherFrames[t.cur])==null?void 0:te.name)!==""?(h(!0),u(D,{key:0},L((z=t.otherFrames[t.cur])==null?void 0:z.children,p=>(h(),u("tr",null,[C((h(),u("td",null,[k(b(p.text)+" ",1)])),[[R,{content:"".concat(p.text,"<hr/>phys:").concat(p.minPhys," ~ ").concat(p.maxPhys,"<br/>raw:").concat(p.minRaw?"0x"+p.minRaw.toString(16):""," ~ ").concat(p.maxRaw?"0x"+p.maxRaw.toString(16):"","<br/>Start Bit:").concat(p.startBit,"<br>Length:").concat(p.length,"<br>Phys Step:").concat(p.physStep),html:!0},void 0,{"top-start":!0}]]),a("td",null,[g(c,null,{default:T(()=>[g(m,{watch:!0,onError:l.onHexErr,min:p.minRaw,max:p.maxRaw,class:"td-input",modelValue:p.rawValue,"onUpdate:modelValue":F=>p.rawValue=F,modelModifiers:{lazy:!0},onChange:s[8]||(s[8]=F=>t.otherFrames[t.cur].dirty="raw")},null,8,["onError","min","max","modelValue","onUpdate:modelValue"])]),_:2},1024)]),a("td",null,[g(c,null,{default:T(()=>[g(y,{watch:!0,min:p.minPhys,max:p.maxPhys,class:"td-input",step:p.physStep,modelValue:p.physValue,"onUpdate:modelValue":F=>p.physValue=F,enum:p.selectPhys?p.selectPhys:"",onChange:s[9]||(s[9]=F=>t.otherFrames[t.cur].dirty="phys")},null,8,["min","max","step","modelValue","onUpdate:modelValue","enum"])]),_:2},1024)]),a("td",null,b(p.unit),1)]))),256)):v("",!0)]))]),a("div",ph,[(h(),u("table",{class:"lin-hex-table",key:"hex"+t.cur},[a("tr",null,[fh,(h(),u(D,null,L([0,1,2,3,4,5,6,7],p=>a("th",gh,b(p),1)),64))]),(de=t.otherFrames[t.cur])!=null&&de.rawData?(h(),u(D,{key:0},L([0,8,16,24,32,40,48,56,64],(p,F)=>(h(),u(D,null,[t.otherFrames[t.cur].rawData.length>p?(h(),u("tr",bh,[a("td",null,[a("b",null,b(p),1)]),(h(),u(D,null,L(8,V=>a("td",null,[e.isHexMulti&&p+V-1<t.otherFrames[t.cur].rawData.length?C((h(),u("input",{key:0,type:"checkbox",class:"radio","onUpdate:modelValue":s[10]||(s[10]=G=>t.hexs=G),value:p+V-1},null,8,_h)),[[Q,t.hexs]]):v("",!0),p+V-1<t.otherFrames[t.cur].rawData.length?(h(),O(c,{key:1},{default:T(()=>[g(m,{watch:!0,onError:l.onHexErr,min:0,max:255,class:"td-input",style:{width:"calc(100%)","text-indent":"20px"},modelValue:t.otherFrames[t.cur].rawData[p+V-1],"onUpdate:modelValue":G=>t.otherFrames[t.cur].rawData[p+V-1]=G,modelModifiers:{lazy:!0},onChange:s[11]||(s[11]=G=>t.otherFrames[t.cur].dirty="data")},null,8,["onError","modelValue","onUpdate:modelValue"])]),_:2},1024)):v("",!0)])),64))])):v("",!0)],64))),64)):v("",!0)])),a("div",yh,[t.linIsHexMulti?(h(),u(D,{key:1},[k(" 批量修改:("+b(t.hexs.length)+"个)  ",1),g(d,{style:{float:"right",height:"23px","margin-left":"8px"},onClick:s[13]||(s[13]=p=>{t.hexs=[],t.linIsHexMulti=!1})},{default:T(()=>[k("退出")]),_:1}),g(d,{style:{float:"right",height:"23px"},type:"primary"},{default:T(()=>[k("修改")]),_:1}),a("div",wh,[g(m,{onError:l.onHexErr,min:0,max:255,modelValue:e.hexMultiValue,"onUpdate:modelValue":s[14]||(s[14]=p=>e.hexMultiValue=p)},null,8,["onError","modelValue"])])],64)):(h(),u("div",{key:0,class:"hex-footer-full-btn",onClick:s[12]||(s[12]=p=>t.linIsHexMulti=!t.linIsHexMulti)},"进入批量修改"))])])])}const Ch=E(Vc,[["render",vh],["__scopeId","data-v-ec94f9f4"]]);const kh={props:["theme","modelValue","options","position","closeable"],emits:["update:modelValue","close"],data(){return{value:this.$props.modelValue}},watch:{value(e){e!==this.modelValue&&this.$emit("update:modelValue",e)},modelValue(e){this.value=e}},methods:{onWheel(e){let s=0;e.deltaY>0||e.deltaX>0?s=100:s=-100;const i=this.$refs.rootRef;let o=i.scrollLeft+s;o<0?o=0:o+i.clientWidth>=i.scrollWidth&&(o=i.scrollWidth-i.clientWidth),console.log("nextD",i,o),i.scrollLeft=o}}},Sh=["data-theme","data-position"],Th={class:"tab"},Dh=["value"],Vh=["data-dirty","onClick"];function xh(e,s,i,o,t,l){return h(),u("div",{class:"tab-er","data-theme":i.theme||"default","data-position":i.position,ref:"rootRef",onWheel:s[1]||(s[1]=(...n)=>l.onWheel&&l.onWheel(...n))},[(h(!0),u(D,null,L(i.options,n=>(h(),u("label",Th,[a("span",null,b(n.label),1),C(a("input",{type:"radio","onUpdate:modelValue":s[0]||(s[0]=r=>t.value=r),value:n.value},null,8,Dh),[[gt,t.value]]),i.closeable?(h(),u("i",{key:0,class:"ic-close","data-dirty":n.dirty,onClick:r=>e.$emit("close",n.value)},null,8,Vh)):v("",!0)]))),256)),ht(e.$slots,"default",{},void 0,!0)],40,Sh)}const Ih=E(kh,[["render",xh],["__scopeId","data-v-a2a581b5"]]);let ot=0,Lh=0,Fh=0;const Rh={props:["store","setStore","closeFlag"],emits:["connect","showMessage","getCarCode"],components:{Button:K,Header:rt,FrameRecord:Nn,LinRecord:Qo,ChartRecord:Fa,EditModal:ss,FiveChannelEditModal:dl,TwelveChannelEditModal:Al,SendRecord:nd,Message:J,LinSendRecord:pc,LinOtherSendRecord:Ch,Tabs:Ih},data(){return{system:ue,isHardwareChecked:!1,expandKeys:new Set,visibleStartIndex:0,visibleEndIndex:0,bottomPadding:0,recordLoading:!1,startTime:0,editModal:{title:"配置",editVisible:!1},mode:"all",dbcVal:"",sliderValue:-1,channelOne:"",channelTwo:"",channelThree:"",channelFour:"",channelFive:"",channelSix:"",channelSeven:"",channelEight:"",channelNine:"",channelTen:"",channelEleven:"",channelTwelve:"",linChannelVal:"",linChannelValTwo:"",filePath:"",comments:["","","","","","","","","","","","","","","",""],message:{visible:!1,level:"",content:""},seconds:0,rowData:[],isRecording:!1,startSqlId:0,endSqlId:0,isLock:!1,isScrollEnd:!0,isAddData:!0,secondConfirm:!1,topLock:!1,bottomLock:!1,openFlag:!1,mlist:[{key:"lookRecord",name:"CAN帧查看",icon:"box"},{key:"supeRecord",name:"图像查看",icon:"setting"},{key:"sendRecord",name:"CAN发送报文",icon:"send"},{key:"linSendRecord",name:"LIN发送报文",icon:"send"},{key:"linRecord",name:"LIN帧查看",icon:"box"}],cur:"lookRecord",recordShow:!1,linRecordShow:!0,colFilterShow:!1,recordChart:"RecordChart",recordTime:"00:00:00",frames:[],timeData:Object.freeze([]),showSignalsList:[],updateSignalData:{},dbcLoading:!1,sendRecordShow:!1,linSendRecordShow:!1,lookRecord:!0,isEditModalLoading:!1,sn:"--",sw:"--",frameType:"canFrame",sdb:"E4U3_1115",dbcChn:[],ldfChn:[],linSendInfo:[],channelValList:[],linChannelValList:[],chartTableData:[],btnActionStyle:"",curFileIdx:0,mainTabs:[],activeTab:0,activeLinData:{},nodeOpt:[],deployDisable:!0,changeDbcLoading:!1}},watch:{mode(e,s){this.topPadding=0,this.$refs.table.scrollToItem(0),this.expandKeys.clear(),this.rowData=[],this.isRecording&&this.resumeScroll()},frames(e){this.$props.setStore("sendRecord",{frames:e})},isRecording(e){this.$props.setStore("sendRecord",{isRecording:e})},curFileIdx(e){this.activeTab=this.ldfChn[e],console.log("newVal",e,this.ldfChn,this.activeTab),this.activeTab===0?(this.nodeOpt=[],console.log("111111")):this.changeTabOption(this.activeTab)}},computed:{quitConfirm(){return!!(this.dbcVal||this.channelOne||this.channelTwo||this.channelThree||this.filePath)}},methods:{chartTableFun(e){},updateTimeData(e){var s;(s=this.$refs.chartRecordRef)==null||s.upTimeData(e)},recordTimeChange(e){this.recordTime=e},async colFilterChange(){this.editModal.editVisible=!0,this.changeDbcLoading=!0,await x.blfLogging.checkHardware().then(async e=>{var s,i,o,t,l,n;console.log("res111",e),ue==="android"?((s=e==null?void 0:e.data)==null?void 0:s.code)===200?(this.showMessage({timeout:5e3,level:"success",content:((i=e.data)==null?void 0:i.msg)||"硬件连接成功"}),this.sn=e.data.data.sn,this.sw=e.data.data.version,this.isHardwareChecked=!0,this.isEditModalLoading=!1,this.changeDbcLoading=!1):(this.isHardwareChecked=!1,this.showMessage({timeout:5e3,level:"error",content:((o=e.data)==null?void 0:o.msg)||"硬件连接失败"})):((t=e==null?void 0:e.data)==null?void 0:t.code)===1?(this.showMessage({timeout:5e3,level:"success",content:((l=e.data)==null?void 0:l.msg)||"硬件连接成功"}),this.sn=e.data.data.sn,this.sw=e.data.data.sw,this.isHardwareChecked=!0,this.isEditModalLoading=!1,this.changeDbcLoading=!1):(this.isHardwareChecked=!1,this.showMessage({timeout:5e3,level:"error",content:((n=e.data)==null?void 0:n.msg)||"硬件连接失败"}))}).catch(e=>{this.isHardwareChecked=!1,this.showMessage({timeout:5e3,level:"error",content:"硬件连接失败"})}).finally(()=>{this.isEditModalLoading=!1,this.changeDbcLoading=!1})},async startRecord(){var e,s,i,o;this.updateSignalData=(e=this.$refs.chartRecordRef)==null?void 0:e.view,(i=this.$refs.chartRecordRef)==null||i.updateSignal((s=this.updateSignalData)==null?void 0:s.children,"1"),(o=this.$refs.chartRecordRef)==null||o.clearTimeData(),this.btnActionStyle="normal",this.$refs.frameRecordRef.startRecord(this.btnActionStyle),this.$refs.linRecordRef.startRecord(),this.isRecording=!0,this.deployDisable=!1,he.report("track","click",{element_name:"开始录制",tip:"1174.18.0.1.33199"})},async startListen(){this.btnActionStyle="listen",this.$refs.frameRecordRef.startRecord(this.btnActionStyle),this.isRecording=!0,this.deployDisable=!1},endRecord(){JSBridge.send({method:"stopDevice"},e=>{console.log("res",e)}),this.$refs.frameRecordRef.endRecord(),this.isRecording=!1,this.deployDisable=!0,he.report("track","click",{element_name:"停止录制",tip:"1174.18.0.1.33203"})},endListen(){this.$refs.frameRecordRef.endRecord(),this.isRecording=!1,this.deployDisable=!0,he.report("track","click",{element_name:"停止录制",tip:"1174.18.0.1.33203"})},choose(e){this.cur=e,e=="supeRecord"?(this.recordShow=!0,this.sendRecordShow=!0,this.linSendRecordShow=!0,this.lookRecord=!1,this.linRecordShow=!0):e=="lookRecord"?(this.recordShow=!1,this.sendRecordShow=!0,this.linSendRecordShow=!0,this.lookRecord=!0,this.frameType="canFrame",this.linRecordShow=!0):e=="sendRecord"?(this.recordShow=!0,this.lookRecord=!0,this.sendRecordShow=!1,this.linSendRecordShow=!0,this.linRecordShow=!0):e=="linRecord"?(this.linRecordShow=!1,this.recordShow=!0,this.sendRecordShow=!0,this.lookRecord=!0,this.linSendRecordShow=!0,this.frameType="linFrame"):e=="linSendRecord"&&(this.recordShow=!0,this.lookRecord=!0,this.sendRecordShow=!0,this.linSendRecordShow=!1,this.linRecordShow=!0)},updateBocks(e){this.dbcVal=e.dbcVal,this.recordLoading=e.recordLoading,this.isRecording=e.isRecording,this.filePath=e.filePath},openEditDialog(){this.editModal.editVisible=!0,this.openFlag=!1},onCancelSelect(){this.editModal.editVisible=!1},showMessage({level:e,content:s,timeout:i}){clearTimeout(ot),e!=null&&(this.message.level=e),s!=null&&(this.message.content=s),this.message.visible=!0,i>0&&(ot=setTimeout(()=>{this.message.visible=!1},i))},async onSubmitToShow(e,s,i,o){console.log("onSubmitToShow called with:",e,s,i,o),console.log("dbcVal",e,s,i,o),this.dbcVal=e[0]==="自定义模板"?this.dbcVal="自定义模板":this.dbcVal=e[0]+"/"+e[1],this.sdb=this.dbcVal==="自定义模板"?"默认视图":this.dbcVal.split("/")[1],this.filePath=o,this.filePath="C:/Users/Downloads/";let t=["","","","","","","","","","","","","","","",""],l=["","","","","","","","","","","","","","","",""];this.dbcChn=s.map((d,c)=>d!=="(不加载)"?(t[c]=d.split("-").pop(),parseInt(d.split("-")[0])):0-(c+1)),console.log("this.dbcChn111",this.dbcChn),this.ldfChn=i.map((d,c)=>(console.log("item111",d),l[c]=d.split("-").pop(),d!=="(不加载)"?parseInt(d):0)),this.channelValList=s,this.linChannelValList=i,this.mainTabs=[],this.linChannelValList.forEach((d,c)=>{d!=="(不加载)"?this.mainTabs.push({label:d,value:c,dirty:"tab"}):this.mainTabs.push({label:"LIN"+(c+1),value:c,dirty:"tab"})}),console.log("mainTabs",this.mainTabs,this.linChannelValList,this.linChannelValList.some(d=>d!=="(不加载)")),this.channelOne=s[0],this.channelTwo=s[1],this.channelThree=s[2],this.linChannelVal=i[0],this.linChannelValTwo=i[1];let n={sdb:this.sdb,carType:this.dbcVal==="自定义模板"?"custom":this.dbcVal.split("/")[0],dbcChn:this.dbcChn,ldfChn:this.ldfChn,files:this.dbcVal==="自定义模板"?t:["","","","","","","","","","","","","","","",""],ldfFiles:this.dbcVal==="自定义模板"?l:["","","","","","","","","","","","","","","",""],comments:this.comments,ldfComments:this.comments};this.$props.setStore("sendRecord",{dbc:n}),this.dbcLoading=!0,this.changeDbcLoading=!0,console.log("Calling getDBC");let r=await x.blfLogging.getDBC(n).finally(()=>{console.log("getDBC completed"),this.dbcLoading=!1,this.changeDbcLoading=!1});this.frames=r,this.editModal.editVisible=!1},changeTabOption(e){var i;let s=(i=this.linSendInfo)==null?void 0:i.data[e];if(console.log("allNodeObj",s),Object.keys(s||{}).length!==0){let o=Object.keys(s.master).map(l=>({value:l,label:l+"[主节点]",parentNode:"master"})),t=Object.keys(s.slaves).map(l=>({value:l,label:l+"[从节点]",parentNode:"slaves"}));this.nodeOpt=[...o,...t]}}},mounted(){he.report("trackPage",{page:"报文录制",tip:"1174.18.0.1.33191"}),x.blfLogging.removeSql()},unmounted(){x.blfLogging.removeSql(),clearInterval(Lh),clearInterval(Fh)}},Z=e=>(B("data-v-ff039c9e"),e=e(),j(),e),Mh=["data-loading"],Eh={style:{position:"absolute",left:"1em",display:"flex","column-gap":"6px","align-items":"center"}},$h=Z(()=>a("i",{class:"lead-icon"},null,-1)),Ah={class:"o-pul-record-btn"},Nh=Z(()=>a("i",{class:"play-icon"},null,-1)),Oh=Z(()=>a("i",{class:"stop-icon"},null,-1)),Ph={class:"o-pul-record-btn"},Uh=Z(()=>a("i",{class:"play-icon"},null,-1)),Hh={key:0,class:"o-pul-record-time"},Bh={key:1,class:"o-pul-record-time"},jh={style:{display:"flex"}},qh={class:"record-header-message",style:{display:"flex","align-items":"center"}},zh={class:"record-header-message-imp"},Kh=Z(()=>a("span",{style:{color:"#D9D9D9","font-size":"16px",margin:"0 10px"}},"|",-1)),Wh={class:"record-header-message",style:{"margin-right":"8px"}},Xh={class:"record-header-message-imp"},Gh={class:"o-pul-er"},Yh={class:"o-menu"},Jh={style:{position:"relative"}},Qh=["data-active"],Zh=Z(()=>a("i",{class:"supe-look-record"},null,-1)),eu=["data-active"],tu=Z(()=>a("i",{class:"supe-record"},null,-1)),su=["data-active"],lu=Z(()=>a("i",{class:"send-record"},null,-1)),iu=["data-active"],au=Z(()=>a("i",{class:"send-record"},null,-1)),nu=["data-active"],ou=Z(()=>a("i",{class:"supe-lin-record"},null,-1)),ru=["data-hidden"],du=["data-hidden"],cu=["data-hidden"],hu=["data-hidden"],uu=["data-hidden"],mu={key:0,class:"bdy-tabs"},pu=Z(()=>a("div",{style:{width:"54px",display:"inline-block"}},null,-1));function fu(e,s,i,o,t,l){const n=w("Button"),r=w("Header"),d=w("FrameRecord"),c=w("LinRecord"),m=w("ChartRecord"),f=w("SendRecord"),y=w("Tabs"),R=w("LinSendRecord"),A=w("LinOtherSendRecord"),X=w("EditModal"),_=w("FiveChannelEditModal"),M=w("TwelveChannelEditModal"),I=w("Message");return h(),u(D,null,[a("div",{class:"record-page-er","data-loading":t.changeDbcLoading},[g(r,{title:"报文录制",quitConfirm:l.quitConfirm,showRight:!1,recentTest:e.$props.store.connectCar.latest,connectStatus:e.$props.store.connectCar.status},{default:T(()=>[a("div",Eh,[g(n,{type:"primary",class:"header-import-btn",disabled:t.isRecording,onClick:l.colFilterChange},{default:T(()=>[$h,k("连接设备")]),_:1},8,["disabled","onClick"]),a("div",Ah,[t.isRecording?(h(),O(n,{key:1,type:"primary",onClick:l.endRecord,loading:t.recordLoading,progress:"100%"},{default:T(()=>[Oh,k("停止")]),_:1},8,["onClick","loading"])):(h(),O(n,{key:0,type:"primary",loading:t.recordLoading,disabled:t.dbcLoading||!t.dbcVal||!t.filePath||!t.isHardwareChecked,progress:"100%",onClick:l.startRecord},{default:T(()=>[Nh,k("监控并录制 ")]),_:1},8,["loading","disabled","onClick"]))]),a("div",Ph,[t.isRecording?v("",!0):(h(),O(n,{key:0,type:"primary",loading:t.recordLoading,disabled:t.dbcLoading||!t.dbcVal||!t.filePath||!t.isHardwareChecked,progress:"100%",onClick:l.startListen},{default:T(()=>[Uh,k("仅监控 ")]),_:1},8,["loading","disabled","onClick"]))]),t.btnActionStyle=="listen"?(h(),u("div",Hh,"监控时间: "+b(t.recordTime),1)):(h(),u("div",Bh,"录制时间: "+b(t.recordTime),1))]),a("template",jh,[a("span",qh,[k(" 设备名称： "),a("span",zh,b(t.sn),1)]),Kh,a("span",Wh,[k(" 版本号："),a("span",Xh,b(t.sw),1)])])]),_:1},8,["quitConfirm","recentTest","connectStatus"]),a("div",Gh,[a("div",Yh,[a("div",Jh,[a("div",{class:"o-menu-it","data-active":t.cur==t.mlist[0].key||t.mlist[0].active,onClick:s[0]||(s[0]=S=>l.choose(t.mlist[0].key))},[Zh,k(" "+b(t.mlist[0].name),1)],8,Qh),t.system!="mac"?(h(),u("div",{key:0,class:"o-menu-it","data-active":t.cur==t.mlist[1].key||t.mlist[1].active,onClick:s[1]||(s[1]=S=>l.choose(t.mlist[1].key))},[tu,k(" "+b(t.mlist[1].name),1)],8,eu)):v("",!0),a("div",{class:"o-menu-it","data-active":t.cur==t.mlist[2].key||t.mlist[2].active,onClick:s[2]||(s[2]=S=>l.choose(t.mlist[2].key))},[lu,k(" "+b(t.mlist[2].name),1)],8,su),t.sn.includes("CR3")?(h(),u("div",{key:1,class:"o-menu-it","data-active":t.cur==t.mlist[3].key||t.mlist[3].active,onClick:s[3]||(s[3]=S=>l.choose(t.mlist[3].key))},[au,k(" "+b(t.mlist[3].name),1)],8,iu)):v("",!0),t.sn.includes("CR3")?(h(),u("div",{key:2,class:"o-menu-it","data-active":t.cur==t.mlist[4].key||t.mlist[4].active,onClick:s[4]||(s[4]=S=>l.choose(t.mlist[4].key))},[ou,k(" "+b(t.mlist[4].name),1)],8,nu)):v("",!0)])]),a("div",{class:"rec-body","data-hidden":t.recordShow},[g(d,{onUpdateBock:l.updateBocks,onUpdateTimeData:l.updateTimeData,ref:"frameRecordRef",onChartTableFun:l.chartTableFun,frameType:t.frameType,sn:t.sn,dbcChn:t.dbcChn,ldfChn:t.ldfChn,channelValList:t.channelValList,linChannelValList:t.linChannelValList,channelOne:t.channelOne,channelTwo:t.channelTwo,channelThree:t.channelThree,linChannelVal:t.linChannelVal,linChannelValTwo:t.linChannelValTwo,filePath:t.filePath,onRecordTimeChange:l.recordTimeChange,dbcVal:t.dbcVal,colFilterShow:t.colFilterShow,onStartTimeChange:s[5]||(s[5]=S=>{t.startTime=S}),startTime:t.startTime},null,8,["onUpdateBock","onUpdateTimeData","onChartTableFun","frameType","sn","dbcChn","ldfChn","channelValList","linChannelValList","channelOne","channelTwo","channelThree","linChannelVal","linChannelValTwo","filePath","onRecordTimeChange","dbcVal","colFilterShow","startTime"])],8,ru),t.sn.includes("CR3")?(h(),u("div",{key:0,class:"rec-body","data-hidden":t.linRecordShow},[g(c,{onUpdateBock:l.updateBocks,onUpdateTimeData:l.updateTimeData,ref:"linRecordRef",channelOne:t.channelOne,channelTwo:t.channelTwo,channelThree:t.channelThree,linChannelVal:t.linChannelVal,linChannelValTwo:t.linChannelValTwo,filePath:t.filePath,dbcVal:t.dbcVal,colFilterShow:t.colFilterShow,onStartTimeChange:s[6]||(s[6]=S=>{t.startTime=S}),startTime:t.startTime},null,8,["onUpdateBock","onUpdateTimeData","channelOne","channelTwo","channelThree","linChannelVal","linChannelValTwo","filePath","dbcVal","colFilterShow","startTime"])],8,du)):v("",!0),t.system!=="mac"?(h(),u("div",{key:1,class:"rec-body","data-hidden":t.lookRecord},[g(m,{ref:"chartRecordRef",sdb:t.sdb,dbcChn:t.dbcChn,ldfChn:t.ldfChn,dbcVal:t.dbcVal,getDbcData:t.frames},null,8,["sdb","dbcChn","ldfChn","dbcVal","getDbcData"])],8,cu)):v("",!0),a("div",{class:"rec-body","data-hidden":t.sendRecordShow},[g(f,{store:e.$props.store,setStore:e.$props.setStore},null,8,["store","setStore"])],8,hu),t.sn.includes("CR3")?(h(),u("div",{key:2,class:"rec-body","data-hidden":t.linSendRecordShow},[t.mainTabs.length>0?(h(),u("div",mu,[g(y,{position:"top",closeable:!1,options:t.mainTabs,modelValue:t.curFileIdx,"onUpdate:modelValue":s[7]||(s[7]=S=>t.curFileIdx=S)},{default:T(()=>[pu]),_:1},8,["options","modelValue"])])):v("",!0),C(g(R,{activeTab:t.activeTab,linSendInfo:t.linSendInfo,nodeOpt:t.nodeOpt,curFileIdx:t.curFileIdx,ldfChn:t.ldfChn,deployDisable:t.deployDisable,store:e.$props.store,setStore:e.$props.setStore},null,8,["activeTab","linSendInfo","nodeOpt","curFileIdx","ldfChn","deployDisable","store","setStore"]),[[P,t.curFileIdx===0]]),C(g(A,{activeTab:t.activeTab,linSendInfo:t.linSendInfo,nodeOpt:t.nodeOpt,curFileIdx:t.curFileIdx,ldfChn:t.ldfChn,deployDisable:t.deployDisable,store:e.$props.store,setStore:e.$props.setStore},null,8,["activeTab","linSendInfo","nodeOpt","curFileIdx","ldfChn","deployDisable","store","setStore"]),[[P,t.curFileIdx===1]])],8,uu)):v("",!0),C(g(X,{loading:t.isEditModalLoading,title:t.editModal.title,onCancel:l.onCancelSelect,onSubmitToShow:l.onSubmitToShow},null,8,["loading","title","onCancel","onSubmitToShow"]),[[P,t.editModal.editVisible&&t.sn.includes("CR2")&&!t.changeDbcLoading]]),C(g(_,{loading:t.isEditModalLoading,title:t.editModal.title,onCancel:l.onCancelSelect,onSubmitFiveToShow:l.onSubmitToShow},null,8,["loading","title","onCancel","onSubmitFiveToShow"]),[[P,t.editModal.editVisible&&t.sn.includes("CR3")&&!t.changeDbcLoading]]),C(g(M,{loading:t.isEditModalLoading,title:t.editModal.title,onCancel:l.onCancelSelect,onSubmitTwelveToShow:l.onSubmitToShow},null,8,["loading","title","onCancel","onSubmitTwelveToShow"]),[[P,t.editModal.editVisible&&t.sn.includes("DR4")&&!t.changeDbcLoading]])])],8,Mh),g(I,{message:t.message},null,8,["message"])],64)}const Fu=E(Rh,[["render",fu],["__scopeId","data-v-ff039c9e"]]);export{Fu as default};
