import{H as rt}from"./Header-dfa396fd.js";import{B as G}from"./Button-2d915d8e.js";import{M as Z}from"./Message-8a3d84cb.js";import{_ as E,S as X,k as J,r as w,l as H,w as v,o as h,c as u,d as a,t as b,h as g,F as T,i as S,a as C,f as k,p as j,b as q,L as dt,m as F,q as he,H as je,I as Ie,u as ft,g as Q,x as A,y as ue,B as $,s as ct,j as ye,e as D,z as $e,A as P,v as U,C as Ae,J as ht,E as ee,K as ut,M as gt,N as re,n as bt}from"./index-cece5334.js";import{C as Ne}from"./Cascader-afe02674.js";import{S as de}from"./Spin-c24d679c.js";import{A as _t,W as yt,P as wt}from"./ev-timeplot-08401d0e.js";import{M as vt}from"./index-4275d5d3.js";import{c as Ct}from"./index.es-1de2169e.js";import{t as we}from"./signal-577d7bc6.js";import{n as kt}from"./index-1760e29d.js";import{b as St,s as Tt,C as pt}from"./CopyPath-e4cdfd70.js";import{s as Dt,a as qe}from"./time-4b339df6.js";import{B as ve}from"./ButtonGroup-56659d51.js";import{b as mt}from"./num-b2a97d52.js";let ze=0;const Vt={props:["title","curViewInx","carType","sdb","tinyBatteryFlag","loading"],emits:["cancel","importFileSubmit","treeDataChange"],components:{Button:G,Cascader:Ne,Message:Z,Spin:de},data(){return{dbcVal:[X.DEFAULT[0].value,X.DEFAULT[0].children[0].value],channelVal:{label:"(不加载)",value:0},channelValTwo:{label:"(不加载)",value:0},blfDirectory:"",dbcDirectory:"",dbcDirectoryTwo:"",channelNo:{label:1,value:1},channelNoTwo:{label:2,value:2},message:{visible:!1,level:"",content:""},filesList:["","","","","","","","","","","","","","","",""]}},watch:{dbcVal:{handler(e){this.channelVal={label:"(不加载)",value:0},this.channelValTwo={label:"(不加载)",value:0}},immediate:!0}},mounted(){},computed:{dbcVerOpts(){return[...X.DEFAULT,{label:"自定义模板",value:"自定义模板"}]},channelOptions(){var s,i;let e=[];if(this.dbcVal[0]!==""&&this.dbcVal[1]!==""){e=((i=(s=X.DEFAULT.find(l=>l.value===this.dbcVal[0]))==null?void 0:s.children.find(l=>l.value===this.dbcVal[1]))==null?void 0:i.comments)||[];let t=e.map((l,n)=>l&&"".concat(n,"-").concat(l)).filter(l=>l!=="").map((l,n)=>({label:l,value:Number(l.split("-")[0])}));return t.unshift({label:"(不加载)",value:0}),t}}},methods:{choosePath(){J.choosePath({directory:window.downloadPath,saveFilename:"tspa-Record.blf",dialogType:"SAVE_DIALOG",fileTypes:["BLF文件 (*.blf;*.BLF)"],allow_multiple:!1}).then(({data:e})=>{console.log("res>>>",e),e.directory&&(this.blfDirectory=e.directory)})},chooseDbcPath(){J.choosePath({dialogType:"OPEN_DIALOG",fileTypes:["DBC文件 (*.dbc;*.DBC)"],allow_multiple:!1}).then(({data:e})=>{e.directory&&(this.dbcDirectory=e.directory)})},chooseDbcPathTwo(){J.choosePath({dialogType:"OPEN_DIALOG",fileTypes:["DBC文件 (*.dbc;*.DBC)"],allow_multiple:!1}).then(({data:e})=>{e.directory&&(this.dbcDirectoryTwo=e.directory)})},submit(){this.dbcVal[0]!=="自定义模板"?this.channelVal.value===this.channelValTwo.value&&this.channelVal.value!==0?this.showMessage({timeout:5e3,level:"error",content:"不可重复选择相同通道"}):this.blfDirectory!==""?this.$emit("submitToShow",this.dbcVal,[this.channelVal.label,this.channelValTwo.label],["(不加载)","(不加载)"],this.blfDirectory):this.showMessage({timeout:5e3,level:"error",content:"请选择保存目录路径"}):this.channelNo===this.channelNoTwo?this.showMessage({timeout:5e3,level:"error",content:"不可重复选择相同通道"}):this.blfDirectory!==""?(console.log("自定义传参",this.channelNo),this.$emit("submitToShow",this.dbcVal,[this.channelNo.value+"-"+this.dbcDirectory,this.channelNoTwo.value+"-"+this.dbcDirectoryTwo],[],this.blfDirectory)):this.showMessage({timeout:5e3,level:"error",content:"请选择保存目录路径"})},showMessage({level:e,content:s,timeout:i}){clearTimeout(ze),e!=null&&(this.message.level=e),s!=null&&(this.message.content=s),this.message.visible=!0,i>0&&(ze=setTimeout(()=>{this.message.visible=!1},i))}}},ie=e=>(j("data-v-a7c549e5"),e=e(),q(),e),xt={class:"o-import-dialog"},It={class:"o-dialog-wrap"},Lt={class:"o-dialog-header-wrap"},Ft={class:"o-dialog-title"},Rt={class:"o-dialog-container-wrap"},Mt={class:"o-import-configuration"},Et={class:"o-dialog-item-wrap"},$t=ie(()=>a("span",{class:"o-dialog-item"},"车型/DBC：",-1)),At={class:"o-dialog-item-select"},Nt={class:"o-dialog-item-wrap edit-modal-channel"},Ot=ie(()=>a("span",{class:"o-dialog-item"},"通道1：",-1)),Pt={class:"o-dialog-item-wrap edit-modal-channel-two"},Ut=ie(()=>a("span",{class:"o-dialog-item"},"通道2：",-1)),Ht={class:"o-dialog-item-wrap"},Bt=ie(()=>a("span",{style:{color:"red"}},null,-1)),jt=ie(()=>a("span",{class:"o-dialog-item"},"通道1：",-1)),qt={class:"o-dialog-tab"},zt={class:"o-dialog-choose-dbc"},Kt=["title"],Wt={class:"o-dialog-item-wrap"},Gt=ie(()=>a("span",{style:{color:"red"}},null,-1)),Xt=ie(()=>a("span",{class:"o-dialog-item"},"通道2：",-1)),Yt={class:"o-dialog-tab"},Jt={class:"o-dialog-choose-dbc"},Qt=["title"],Zt={class:"o-dialog-item-wrap"},es=ie(()=>a("span",{style:{color:"red"}},"* ",-1)),ts=ie(()=>a("span",{class:"o-dialog-item"},"保存目录：",-1)),ss=["title"],ls={class:"o-dialog-footer-wrap"},is={class:"o-dialog-footer"},as={key:0,class:"o-dialog-loading"};function ns(e,s,i,o,t,l){const n=w("Cascader"),r=w("v-select"),d=w("Button"),c=w("Spin"),p=w("Message"),f=H("esc");return v((h(),u("div",xt,[a("div",It,[a("div",Lt,[a("div",Ft,b(e.$props.title),1),a("i",{class:"o-dialog-title-close",onClick:s[0]||(s[0]=y=>e.$emit("cancel"))})]),a("div",Rt,[a("div",Mt,[a("div",Et,[$t,a("div",At,[g(n,{options:l.dbcVerOpts,modelValue:t.dbcVal,"onUpdate:modelValue":s[1]||(s[1]=y=>t.dbcVal=y)},null,8,["options","modelValue"])])]),t.dbcVal[0]!="自定义模板"?(h(),u(T,{key:0},[a("div",Nt,[Ot,g(r,{options:l.channelOptions,clearable:!1,label:"label",value:"value",modelValue:t.channelVal,"onUpdate:modelValue":s[2]||(s[2]=y=>t.channelVal=y),class:"chf-input-ecu"},null,8,["options","modelValue"])]),a("div",Pt,[Ut,g(r,{options:l.channelOptions,clearable:!1,label:"label",value:"value",modelValue:t.channelValTwo,"onUpdate:modelValue":s[3]||(s[3]=y=>t.channelValTwo=y),class:"chf-input-ecu"},null,8,["options","modelValue"])])],64)):(h(),u(T,{key:1},[a("div",Ht,[Bt,jt,a("div",qt,[a("div",zt,[a("div",{class:"o-table-dbc input-overflow-sty",title:t.dbcDirectory||"--"},b(t.dbcDirectory||"--"),9,Kt),a("a",{class:"chose-file chose-dbc-file",onClick:s[4]||(s[4]=y=>l.chooseDbcPath())},"选择DBC文件")])])]),a("div",Wt,[Gt,Xt,a("div",Yt,[a("div",Jt,[a("div",{class:"o-table-dbc input-overflow-sty",title:t.dbcDirectoryTwo||"--"},b(t.dbcDirectoryTwo||"--"),9,Qt),a("a",{class:"chose-file chose-dbc-file",onClick:s[5]||(s[5]=y=>l.chooseDbcPathTwo())},"选择DBC文件")])])])],64)),a("div",Zt,[es,ts,g(d,{onClick:l.choosePath,class:"choose-path"},{default:S(()=>[C("选择路径")]),_:1},8,["onClick"]),C("    ")]),a("div",{class:"show-directory",title:t.blfDirectory},b(t.blfDirectory),9,ss)])]),a("div",ls,[a("div",is,[g(d,{style:{width:"52px"},onClick:s[6]||(s[6]=y=>e.$emit("cancel"))},{default:S(()=>[C("取消")]),_:1}),g(d,{type:"primary",style:{width:"52px",margin:"0 20px 0 10px"},onClick:l.submit},{default:S(()=>[C("连接")]),_:1},8,["onClick"])])]),e.$props.loading?(h(),u("div",as,[g(c)])):k("",!0)]),g(p,{message:t.message},null,8,["message"])])),[[f,()=>e.$emit("cancel")]])}const os=E(Vt,[["render",ns],["__scopeId","data-v-a7c549e5"]]);let Ke=0;const rs={props:["title","curViewInx","carType","sdb","tinyBatteryFlag","loading"],emits:["cancel","importFileSubmit","treeDataChange"],components:{Button:G,Cascader:Ne,Message:Z,Spin:de},data(){return{dbcVal:[X.DEFAULT[0].value,X.DEFAULT[0].children[0].value],channelVal:{label:"(不加载)",value:0},channelValTwo:{label:"(不加载)",value:0},channelValThree:{label:"(不加载)",value:0},linChannelVal:{label:"(不加载)",value:0},linChannelValTwo:{label:"(不加载)",value:0},blfDirectory:"",dbcDirectory:"",dbcDirectoryTwo:"",dbcDirectoryThree:"",linDbcDirectory:"",linDbcDirectoryTwo:"",channelNo:{label:1,value:1},channelNoTwo:{label:2,value:2},channelNoThree:{label:3,value:3},linChannelNo:{label:4,value:4},linChannelNoTwo:{label:5,value:5},message:{visible:!1,level:"",content:""},filesList:["","","","","","","","","","","","","","","",""]}},watch:{dbcVal:{handler(e){this.channelVal={label:"(不加载)",value:0},this.channelValTwo={label:"(不加载)",value:0},this.channelValThree={label:"(不加载)",value:0},this.linChannelVal={label:"(不加载)",value:0},this.linChannelValTwo={label:"(不加载)",value:0}},immediate:!0}},mounted(){},computed:{dbcVerOpts(){return[...X.DEFAULT,{label:"自定义模板",value:"自定义模板"}]},channelOptions(){var s,i;let e=[];if(this.dbcVal[0]!==""&&this.dbcVal[1]!==""){e=((i=(s=X.DEFAULT.find(l=>l.value===this.dbcVal[0]))==null?void 0:s.children.find(l=>l.value===this.dbcVal[1]))==null?void 0:i.comments)||[];let t=e.map((l,n)=>l&&"".concat(n,"-").concat(l)).filter(l=>l!=="").map((l,n)=>({label:l,value:Number(l.split("-")[0])}));return t.unshift({label:"(不加载)",value:0}),t}},linChannelOptions(){var s,i;let e=[];if(this.dbcVal[0]!==""&&this.dbcVal[1]!==""){e=((i=(s=dt.find(t=>t.value===this.dbcVal[0]))==null?void 0:s.children.find(t=>t.value===this.dbcVal[1]))==null?void 0:i.comments)||[];let o=e.map(t=>({label:t,value:Number(t.split("-")[0])-1e3}));return o.unshift({label:"(不加载)",value:0}),o}}},methods:{choosePath(){J.choosePath({directory:window.downloadPath,saveFilename:"tspa-Record.blf",dialogType:"SAVE_DIALOG",fileTypes:["BLF文件 (*.blf;*.BLF)"],allow_multiple:!1}).then(({data:e})=>{console.log("res>>>",e),e.directory&&(this.blfDirectory=e.directory)})},chooseDbcPath(){J.choosePath({dialogType:"OPEN_DIALOG",fileTypes:["DBC文件 (*.dbc;*.DBC)"],allow_multiple:!1}).then(({data:e})=>{e.directory&&(this.dbcDirectory=e.directory)})},chooseDbcPathTwo(){J.choosePath({dialogType:"OPEN_DIALOG",fileTypes:["DBC文件 (*.dbc;*.DBC)"],allow_multiple:!1}).then(({data:e})=>{e.directory&&(this.dbcDirectoryTwo=e.directory)})},chooseDbcPathThree(){J.choosePath({dialogType:"OPEN_DIALOG",fileTypes:["DBC文件 (*.dbc;*.DBC)"],allow_multiple:!1}).then(({data:e})=>{e.directory&&(this.dbcDirectoryThree=e.directory)})},chooseLinDbcPath(){J.choosePath({dialogType:"OPEN_DIALOG",fileTypes:["LDF文件 (*.ldf;*.LDF)"],allow_multiple:!1}).then(({data:e})=>{e.directory&&(this.linDbcDirectory=e.directory)})},chooseLinDbcPathTwo(){J.choosePath({dialogType:"OPEN_DIALOG",fileTypes:["LDF文件 (*.ldf;*.LDF)"],allow_multiple:!1}).then(({data:e})=>{e.directory&&(this.linDbcDirectoryTwo=e.directory)})},submit(){console.log("linChannelOptions1111",this.linChannelOptions),this.dbcVal[0]!=="自定义模板"?(console.log("提交中..123"),this.channelVal.value===this.channelValTwo.value&&this.channelVal.value!==0?this.showMessage({timeout:5e3,level:"error",content:"不可重复选择相同通道"}):this.blfDirectory!==""?this.$emit("submitFiveToShow",this.dbcVal,[this.channelVal.label,this.channelValTwo.label,this.channelValThree.label],[this.linChannelVal.label,this.linChannelValTwo.label],this.blfDirectory):this.showMessage({timeout:5e3,level:"error",content:"请选择保存目录路径"})):this.channelNo===this.channelNoTwo===this.channelNoThree?this.showMessage({timeout:5e3,level:"error",content:"不可重复选择相同通道"}):this.blfDirectory!==""?(console.log("自定义传参",this.channelNo),this.$emit("submitFiveToShow",this.dbcVal,[this.channelNo.value+"-"+this.dbcDirectory,this.channelNoTwo.value+"-"+this.dbcDirectoryTwo,this.channelNoThree.value+"-"+this.dbcDirectoryThree],[this.linChannelNo.value+"-"+this.linDbcDirectory,this.linChannelNoTwo.value+"-"+this.linDbcDirectoryTwo],this.blfDirectory)):this.showMessage({timeout:5e3,level:"error",content:"请选择保存目录路径"})},showMessage({level:e,content:s,timeout:i}){clearTimeout(Ke),e!=null&&(this.message.level=e),s!=null&&(this.message.content=s),this.message.visible=!0,i>0&&(Ke=setTimeout(()=>{this.message.visible=!1},i))}}},B=e=>(j("data-v-dfc162bc"),e=e(),q(),e),ds={class:"o-import-dialog"},cs={class:"o-dialog-wrap"},hs={class:"o-dialog-header-wrap"},us={class:"o-dialog-title"},ps={class:"o-dialog-container-wrap"},ms={class:"o-import-configuration"},fs={class:"o-dialog-item-wrap"},gs=B(()=>a("span",{class:"o-dialog-item"},"车型/DBC：",-1)),bs={class:"o-dialog-item-select"},_s={class:"o-dialog-item-group-wrap"},ys={class:"o-dialog-item-wrap edit-modal-channel"},ws=B(()=>a("span",{class:"o-dialog-item"},"CAN通道1：",-1)),vs={class:"o-dialog-item-wrap edit-modal-channel-two"},Cs=B(()=>a("span",{class:"o-dialog-item"},"CAN通道2：",-1)),ks={class:"o-dialog-item-wrap edit-modal-channel-three"},Ss=B(()=>a("span",{class:"o-dialog-item"},"CAN通道3：",-1)),Ts={class:"o-dialog-item-group-wrap"},Ds={class:"o-dialog-item-wrap edit-modal-channel"},Vs=B(()=>a("span",{class:"o-dialog-item"},"LIN通道1：",-1)),xs={class:"o-dialog-item-wrap edit-modal-channel-two"},Is=B(()=>a("span",{class:"o-dialog-item"},"LIN通道2：",-1)),Ls={class:"o-dialog-item-wrap"},Fs=B(()=>a("span",{style:{color:"red"}},null,-1)),Rs=B(()=>a("span",{class:"o-dialog-item"},"CAN通道1：",-1)),Ms={class:"o-dialog-tab"},Es={class:"o-dialog-choose-dbc"},$s=["title"],As={class:"o-dialog-item-wrap"},Ns=B(()=>a("span",{style:{color:"red"}},null,-1)),Os=B(()=>a("span",{class:"o-dialog-item"},"CAN通道2：",-1)),Ps={class:"o-dialog-tab"},Us={class:"o-dialog-choose-dbc"},Hs=["title"],Bs={class:"o-dialog-item-wrap"},js=B(()=>a("span",{style:{color:"red"}},null,-1)),qs=B(()=>a("span",{class:"o-dialog-item"},"CAN通道3：",-1)),zs={class:"o-dialog-tab"},Ks={class:"o-dialog-choose-dbc"},Ws=["title"],Gs={class:"o-dialog-item-wrap"},Xs=B(()=>a("span",{style:{color:"red"}},null,-1)),Ys=B(()=>a("span",{class:"o-dialog-item"},"LIN通道1：",-1)),Js={class:"o-dialog-tab"},Qs={class:"o-dialog-choose-dbc"},Zs=["title"],el={class:"o-dialog-item-wrap"},tl=B(()=>a("span",{style:{color:"red"}},null,-1)),sl=B(()=>a("span",{class:"o-dialog-item"},"LIN通道2：",-1)),ll={class:"o-dialog-tab"},il={class:"o-dialog-choose-dbc"},al=["title"],nl={class:"o-dialog-item-wrap"},ol=B(()=>a("span",{style:{color:"red"}},"* ",-1)),rl=B(()=>a("span",{class:"o-dialog-item"},"保存目录：",-1)),dl=["title"],cl={class:"o-dialog-footer-wrap"},hl={class:"o-dialog-footer"},ul={key:0,class:"o-dialog-loading"};function pl(e,s,i,o,t,l){const n=w("Cascader"),r=w("v-select"),d=w("Button"),c=w("Spin"),p=w("Message"),f=H("esc");return v((h(),u("div",ds,[a("div",cs,[a("div",hs,[a("div",us,b(e.$props.title),1),a("i",{class:"o-dialog-title-close",onClick:s[0]||(s[0]=y=>e.$emit("cancel"))})]),a("div",ps,[a("div",ms,[a("div",fs,[gs,a("div",bs,[g(n,{options:l.dbcVerOpts,modelValue:t.dbcVal,"onUpdate:modelValue":s[1]||(s[1]=y=>t.dbcVal=y)},null,8,["options","modelValue"])])]),t.dbcVal[0]!="自定义模板"?(h(),u(T,{key:0},[a("div",_s,[a("div",ys,[ws,g(r,{options:l.channelOptions,clearable:!1,label:"label",value:"value",modelValue:t.channelVal,"onUpdate:modelValue":s[2]||(s[2]=y=>t.channelVal=y),class:"chf-input-ecu"},null,8,["options","modelValue"])]),a("div",vs,[Cs,g(r,{options:l.channelOptions,clearable:!1,label:"label",value:"value",modelValue:t.channelValTwo,"onUpdate:modelValue":s[3]||(s[3]=y=>t.channelValTwo=y),class:"chf-input-ecu"},null,8,["options","modelValue"])])]),a("div",ks,[Ss,g(r,{options:l.channelOptions,clearable:!1,label:"label",value:"value",modelValue:t.channelValThree,"onUpdate:modelValue":s[4]||(s[4]=y=>t.channelValThree=y),class:"chf-input-ecu"},null,8,["options","modelValue"])]),a("div",Ts,[a("div",Ds,[Vs,g(r,{options:l.linChannelOptions,clearable:!1,label:"label",value:"value",modelValue:t.linChannelVal,"onUpdate:modelValue":s[5]||(s[5]=y=>t.linChannelVal=y),class:"chf-input-ecu"},null,8,["options","modelValue"])]),a("div",xs,[Is,g(r,{options:l.linChannelOptions,clearable:!1,label:"label",value:"value",modelValue:t.linChannelValTwo,"onUpdate:modelValue":s[6]||(s[6]=y=>t.linChannelValTwo=y),class:"chf-input-ecu"},null,8,["options","modelValue"])])])],64)):(h(),u(T,{key:1},[a("div",Ls,[Fs,Rs,a("div",Ms,[a("div",Es,[a("div",{class:"o-table-dbc input-overflow-sty",title:t.dbcDirectory||"--"},b(t.dbcDirectory||"--"),9,$s),a("a",{class:"chose-file chose-dbc-file",onClick:s[7]||(s[7]=y=>l.chooseDbcPath())},"选择DBC文件")])])]),a("div",As,[Ns,Os,a("div",Ps,[a("div",Us,[a("div",{class:"o-table-dbc input-overflow-sty",title:t.dbcDirectoryTwo||"--"},b(t.dbcDirectoryTwo||"--"),9,Hs),a("a",{class:"chose-file chose-dbc-file",onClick:s[8]||(s[8]=y=>l.chooseDbcPathTwo())},"选择DBC文件")])])]),a("div",Bs,[js,qs,a("div",zs,[a("div",Ks,[a("div",{class:"o-table-dbc input-overflow-sty",title:t.dbcDirectoryThree||"--"},b(t.dbcDirectoryThree||"--"),9,Ws),a("a",{class:"chose-file chose-dbc-file",onClick:s[9]||(s[9]=y=>l.chooseDbcPathThree())},"选择DBC文件")])])]),a("div",Gs,[Xs,Ys,a("div",Js,[a("div",Qs,[a("div",{class:"o-table-dbc input-overflow-sty",title:t.linDbcDirectory||"--"},b(t.linDbcDirectory||"--"),9,Zs),a("a",{class:"chose-file chose-dbc-file",onClick:s[10]||(s[10]=y=>l.chooseLinDbcPath())},"选择LDF文件")])])]),a("div",el,[tl,sl,a("div",ll,[a("div",il,[a("div",{class:"o-table-dbc input-overflow-sty",title:t.linDbcDirectoryTwo||"--"},b(t.linDbcDirectoryTwo||"--"),9,al),a("a",{class:"chose-file chose-dbc-file",onClick:s[11]||(s[11]=y=>l.chooseLinDbcPathTwo())},"选择LDF文件")])])])],64)),a("div",nl,[ol,rl,g(d,{onClick:l.choosePath,class:"choose-path"},{default:S(()=>[C("选择路径")]),_:1},8,["onClick"]),C("    ")]),a("div",{class:"show-directory",title:t.blfDirectory},b(t.blfDirectory),9,dl)])]),a("div",cl,[a("div",hl,[g(d,{style:{width:"52px"},onClick:s[12]||(s[12]=y=>e.$emit("cancel"))},{default:S(()=>[C("取消")]),_:1}),g(d,{type:"primary",style:{width:"52px",margin:"0 20px 0 10px"},onClick:l.submit},{default:S(()=>[C("连接")]),_:1},8,["onClick"])])]),e.$props.loading?(h(),u("div",ul,[g(c)])):k("",!0)]),g(p,{message:t.message},null,8,["message"])])),[[f,()=>e.$emit("cancel")]])}const ml=E(rs,[["render",pl],["__scopeId","data-v-dfc162bc"]]);let We=0;const fl={props:["title","curViewInx","carType","sdb","tinyBatteryFlag","loading"],emits:["cancel","importFileSubmit","treeDataChange"],components:{Button:G,Cascader:Ne,Message:Z,Spin:de},data(){return{dbcVal:[X.DEFAULT[0].value,X.DEFAULT[0].children[0].value],channelValList:[{label:"(不加载)",value:0},{label:"(不加载)",value:0},{label:"(不加载)",value:0},{label:"(不加载)",value:0},{label:"(不加载)",value:0},{label:"(不加载)",value:0},{label:"(不加载)",value:0},{label:"(不加载)",value:0},{label:"(不加载)",value:0},{label:"(不加载)",value:0},{label:"(不加载)",value:0},{label:"(不加载)",value:0}],blfDirectory:"",dbcDirectoryList:["","","","","","","","","","","",""],channelNo:{label:1,value:1},channelNoTwo:{label:2,value:2},channelNoThree:{label:3,value:3},linChannelNo:{label:4,value:4},linChannelNoTwo:{label:5,value:5},message:{visible:!1,level:"",content:""},filesList:["","","","","","","","","","","","","","","",""]}},watch:{dbcVal:{handler(e){console.log("dbcVal1753",e),this.channelValList=[{label:"(不加载)",value:0},{label:"(不加载)",value:0},{label:"(不加载)",value:0},{label:"(不加载)",value:0},{label:"(不加载)",value:0},{label:"(不加载)",value:0},{label:"(不加载)",value:0},{label:"(不加载)",value:0},{label:"(不加载)",value:0},{label:"(不加载)",value:0},{label:"(不加载)",value:0},{label:"(不加载)",value:0}]},immediate:!0}},mounted(){},computed:{dbcVerOpts(){return[...X.DEFAULT,{label:"自定义模板",value:"自定义模板"}]},channelOptions(){var s,i;let e=[];if(this.dbcVal[0]!==""&&this.dbcVal[1]!==""){e=((i=(s=X.DEFAULT.find(l=>l.value===this.dbcVal[0]))==null?void 0:s.children.find(l=>l.value===this.dbcVal[1]))==null?void 0:i.comments)||[];let t=e.map((l,n)=>l&&"".concat(n,"-").concat(l)).filter(l=>l!=="").map((l,n)=>({label:l,value:Number(l.split("-")[0])}));return t.unshift({label:"(不加载)",value:0}),t}},linChannelOptions(){var s,i;let e=[];if(this.dbcVal[0]!==""&&this.dbcVal[1]!==""){e=((i=(s=dt.find(t=>t.value===this.dbcVal[0]))==null?void 0:s.children.find(t=>t.value===this.dbcVal[1]))==null?void 0:i.comments)||[];let o=e.map(t=>({label:t,value:Number(t.split("-")[0])-1e3}));return o.unshift({label:"(不加载)",value:0}),o}}},methods:{choosePath(){J.choosePath({directory:window.downloadPath,saveFilename:"tspa-Record.blf",dialogType:"SAVE_DIALOG",fileTypes:["BLF文件 (*.blf;*.BLF)"],allow_multiple:!1}).then(({data:e})=>{console.log("res>>>",e),e.directory&&(this.blfDirectory=e.directory)})},chooseDbcPath(e){console.log("inx",e),J.choosePath({dialogType:"OPEN_DIALOG",fileTypes:["DBC文件 (*.dbc;*.DBC)"],allow_multiple:!1}).then(({data:s})=>{s.directory&&(this.dbcDirectoryList[e]=s.directory)})},submit(){console.log("linChannelOptions1111",this.linChannelOptions),this.dbcVal[0]!=="自定义模板"?(console.log("提交中..123"),this.blfDirectory!==""?this.$emit("submitTwelveToShow",this.dbcVal,this.channelValList.map(e=>e.label),["(不加载)","(不加载)"],this.blfDirectory):this.showMessage({timeout:5e3,level:"error",content:"请选择保存目录路径"})):this.blfDirectory!==""?(console.log("自定义传参",this.channelValList,this.channelValList.map((e,s)=>s+1+"-"+this.dbcDirectoryList[s])),this.$emit("submitTwelveToShow",this.dbcVal,this.channelValList.map((e,s)=>s+1+"-"+this.dbcDirectoryList[s]),[],this.blfDirectory)):this.showMessage({timeout:5e3,level:"error",content:"请选择保存目录路径"})},showMessage({level:e,content:s,timeout:i}){clearTimeout(We),e!=null&&(this.message.level=e),s!=null&&(this.message.content=s),this.message.visible=!0,i>0&&(We=setTimeout(()=>{this.message.visible=!1},i))}}},Le=e=>(j("data-v-beec6812"),e=e(),q(),e),gl={class:"o-import-dialog"},bl={class:"o-dialog-wrap"},_l={class:"o-dialog-header-wrap"},yl={class:"o-dialog-title"},wl={class:"o-dialog-container-wrap"},vl={class:"o-import-configuration"},Cl={class:"o-dialog-item-wrap"},kl=Le(()=>a("span",{class:"o-dialog-item"},"车型/DBC：",-1)),Sl={class:"o-dialog-item-select"},Tl={key:0,class:"o-dialog-item-group-wrap"},Dl={class:"o-dialog-item"},Vl=Le(()=>a("span",{style:{color:"red"}},null,-1)),xl={class:"o-dialog-item"},Il={class:"o-dialog-tab"},Ll={class:"o-dialog-choose-dbc"},Fl=["title"],Rl=["onClick"],Ml={class:"o-dialog-item-wrap"},El=Le(()=>a("span",{style:{color:"red"}},"* ",-1)),$l=Le(()=>a("span",{class:"o-dialog-item"},"保存目录：",-1)),Al=["title"],Nl={class:"o-dialog-footer-wrap"},Ol={class:"o-dialog-footer"},Pl={key:0,class:"o-dialog-loading"};function Ul(e,s,i,o,t,l){const n=w("Cascader"),r=w("v-select"),d=w("Button"),c=w("Spin"),p=w("Message"),f=H("esc");return v((h(),u("div",gl,[a("div",bl,[a("div",_l,[a("div",yl,b(e.$props.title),1),a("i",{class:"o-dialog-title-close",onClick:s[0]||(s[0]=y=>e.$emit("cancel"))})]),a("div",wl,[a("div",vl,[a("div",Cl,[kl,a("div",Sl,[g(n,{options:l.dbcVerOpts,modelValue:t.dbcVal,"onUpdate:modelValue":s[1]||(s[1]=y=>t.dbcVal=y)},null,8,["options","modelValue"])])]),t.dbcVal[0]!="自定义模板"?(h(),u("div",Tl,[(h(!0),u(T,null,F(t.channelValList,(y,M)=>(h(),u("div",{class:"o-dialog-item-wrap edit-modal-channel",key:M},[a("span",Dl,"CAN通道"+b(M+1)+"：",1),g(r,{options:l.channelOptions,clearable:!1,label:"label",value:"value",modelValue:t.channelValList[M],"onUpdate:modelValue":L=>t.channelValList[M]=L,class:"chf-input-ecu"},null,8,["options","modelValue","onUpdate:modelValue"])]))),128))])):(h(!0),u(T,{key:1},F(t.dbcDirectoryList,(y,M)=>(h(),u("div",{class:"o-dialog-item-wrap",key:M},[Vl,a("span",xl,"CAN通道"+b(M+1)+"：",1),a("div",Il,[a("div",Ll,[a("div",{class:"o-table-dbc input-overflow-sty",title:t.dbcDirectoryList[M]||"--"},b(t.dbcDirectoryList[M]||"--"),9,Fl),a("a",{class:"chose-file chose-dbc-file",onClick:L=>l.chooseDbcPath(M)},"选择DBC文件",8,Rl)])])]))),128)),a("div",Ml,[El,$l,g(d,{onClick:l.choosePath,class:"choose-path"},{default:S(()=>[C("选择路径")]),_:1},8,["onClick"]),C("    ")]),a("div",{class:"show-directory",title:t.blfDirectory},b(t.blfDirectory),9,Al)])]),a("div",Nl,[a("div",Ol,[g(d,{style:{width:"52px"},onClick:s[2]||(s[2]=y=>e.$emit("cancel"))},{default:S(()=>[C("取消")]),_:1}),g(d,{type:"primary",style:{width:"52px",margin:"0 20px 0 10px"},onClick:l.submit},{default:S(()=>[C("连接")]),_:1},8,["onClick"])])]),e.$props.loading?(h(),u("div",Pl,[g(c)])):k("",!0)]),g(p,{message:t.message},null,8,["message"])])),[[f,()=>e.$emit("cancel")]])}const Hl=E(fl,[["render",Ul],["__scopeId","data-v-beec6812"]]);const Bl={props:{modelValue:{type:Boolean,required:!0},id:{type:String,required:!0}},computed:{checkValue:{get(){return this.modelValue},set(e){this.$emit("update:modelValue",e)}}},methods:{handleChange(e){this.checkValue=e.target.checked}}},jl=e=>(j("data-v-3935df67"),e=e(),q(),e),ql={class:"switch-wrap"},zl={class:"switch"},Kl=["checked"],Wl=jl(()=>a("span",null,null,-1));function Gl(e,s,i,o,t,l){return h(),u("div",ql,[a("label",zl,[a("input",{type:"checkbox",checked:l.checkValue,onChange:s[0]||(s[0]=(...n)=>l.handleChange&&l.handleChange(...n))},null,40,Kl),Wl])])}const Xl=E(Bl,[["render",Gl],["__scopeId","data-v-3935df67"]]);let le=[],Ge=0;const Yl={props:["signals","carType","sdb","dbcVal","fileType","defaultOptions","filledOptions","loading","dbcChn","ldfChn"],emits:["signalsChange","cancel"],components:{Button:G,RecycleScroller:he,Spin:de,Message:Z},data(){var s,i,o,t,l,n,r,d,c;const e=this.$ls.get("blfread_sdbData")||[];if(console.log("sdbCustom123",this.$props.dbcVal,this.sdb,this.dbcChn,this.ldfChn),this.carType==="custom"){let p=(s=e.find(f=>f.sdb===this.sdb))==null?void 0:s.comments;p&&(le=["",...p])}else if(console.log("6777",this.ldfChn,this.dbcChn),this.ldfChn.every(p=>p==0)&&this.dbcChn.some(p=>p>0)&&(le=((o=(i=je.find(p=>p.value===this.$props.carType))==null?void 0:i.children.find(p=>p.value===this.$props.sdb))==null?void 0:o.comments)||[]),this.ldfChn.some(p=>p>0)&&this.dbcChn.every(p=>p<0)&&(le=((l=(t=Ie.find(p=>p.value===this.$props.carType))==null?void 0:t.children.find(p=>p.value===this.$props.sdb))==null?void 0:l.comments)||[]),this.ldfChn.some(p=>p>0)&&this.dbcChn.some(p=>p>0)){console.log("5566");let p=((r=(n=je.find(y=>y.value===this.$props.carType))==null?void 0:n.children.find(y=>y.value===this.$props.sdb))==null?void 0:r.comments)||[],f=((c=(d=Ie.find(y=>y.value===this.$props.carType))==null?void 0:d.children.find(y=>y.value===this.$props.sdb))==null?void 0:c.comments)||[];le=p.concat(f)}return console.log("C2C123",le),le=le.map((p,f)=>"".concat("⓪①②③④⑤⑥⑦⑧⑨⑩⑪⑫⑬⑭⑮⑯⑰⑱⑲⑳㉑㉒㉓㉔㉕㉖㉗㉘㉙㉚㉛㉜㉝㉞㉟㊱㊲"[f]).concat(p)),{inputStr:"",treeData:[],checkedList:[],isFilled:!1,message:{visible:!1,level:"",content:""},showSignalsList:[]}},computed:{list(){let e=[];for(let s=0;s<this.treeData.length;s++){let i=this.treeData[s];i.id!=-1&&e.push({_id:i.id,id:i.id,node_type:i.node_type,text:i.text});for(let o=0;o<i.children.length;o++){let t=i.children[o];t.id[0]!="-"&&e.push({_id:i.id+"-"+t.id,id:t.id,node_type:t.node_type,text:t.text});for(let l=0;l<t.children.length;l++){let n=t.children[l];e.push({...n,_id:i.id+"-"+t.id+"-"+n.id})}}}return console.log(e,11111111),e}},watch:{isFilled(e,s){this.dataInit()}},async created(){this.dataInit()},mounted(){console.log(this.$props.signals),this.$refs.chsInputRef.focus(),this.checkedList=this.$props.signals,this.updateChecked(),setTimeout(()=>{document.body.addEventListener("mousedown",this.clickHandler)},300)},beforeUnmount(){},unmounted(){document.body.removeEventListener("mousedown",this.clickHandler)},methods:{onFilledChange(e){this.inputStr="",this.isFilled=!this.isFilled},title4node(e){return we(e)},clickHandler(e){var s;((s=this.$refs.root)==null?void 0:s.contains(e.target))==!1&&this.$emit("cancel")},dataInit(){let e=[];console.log(this.$props.filledOptions.data,33333333333);let s=this.$props.filledOptions.data;for(let i in s){let o={id:+i,text:le[i],node_type:"channel",children:[]};for(let t in s[i]){let l={id:i+"_"+t,text:t=="-1"?"":t,node_type:"msg",channel:o.id,children:s[i][t].map(n=>{var r;return{id:n[0],msg:t=="-1"?"-1":+((r=t.match(/\(([^)]+)\)/))==null?void 0:r[1].toUpperCase().replace(/X/g,"x"))||t,channel:o.id,text:n[0],node_type:"signal",comment:n[1],remark:n[2],maxRaw:n[5],minRaw:n[6],enums:n[9],unit:n[10]}})};o.children.push(l)}e.push(o)}this.treeData=Object.freeze(e),console.log(this.treeData)},selectNode(e){console.log(this.checkedList);let s=this.checkedList.map(i=>({...i}));s.some(i=>i._id===e._id)?(console.log("s1"),this.checkedList=s.filter(i=>i._id!==e._id)):(console.log("s2"),s.length<30?this.checkedList=[...s.filter(i=>i._id!==e._id),e]:this.showMessage({level:"error",content:"选择不能超过".concat(s.length,"项"),timeout:2e3}))},showMessage({level:e,content:s,timeout:i}){clearTimeout(Ge),e!=null&&(this.message.level=e),s!=null&&(this.message.content=s),this.message.visible=!0,i>0&&(Ge=setTimeout(()=>{this.message.visible=!1},i))},submit(){this.$emit("signalsChange",this.checkedList)},updateChecked(){},highlightWord(e){if(!e)return e;const s=this.inputStr;if(!s)return e;const i=s.split(/\s+/g);var o,t=i.length,l;for(o=0;o<t;o++)try{l=new RegExp(i[o],"gi"),l.test(e)&&(e=e.replace(l,"<strong>$&</strong>"))}catch(n){l=i[o],e=e.replace(l,"<strong>$&</strong>")}return e},onChange:ft(function(){let s=!1,i=this.inputStr.toLowerCase();i.startsWith("0x")&&(s=!0);let o;try{o=new RegExp(i,"i")}catch(n){o={test(r){return~r.toLowerCase().indexOf(r.toLowerCase())}}}let t=[],l=this.$props.filledOptions.data;for(let n in l){let r={id:+n,text:le[n],node_type:"channel",children:[]};for(let d in l[n]){let c=s&&d.includes(i),p={id:n+"_"+d,text:d=="-1"?"":d,node_type:"msg",channel:r.id,children:l[n][d].filter(f=>c||o.test(f[0])||o.test(f[1])).map(f=>{var y;return{id:f[0],msg:d=="-1"?"-1":+((y=d.match(/\(([^)]+)\)/))==null?void 0:y[1].toUpperCase().replace(/X/g,"x")),channel:r.id,text:f[0],node_type:"signal",comment:f[1],remark:f[2],maxRaw:f[5],minRaw:f[6],enums:f[9],unit:f[10]}})};p.children.length>0&&r.children.push(p)}(r.children.length>0||o.test(r.text)||o.test(r.comment))&&t.push(r)}this.treeData=t,console.log(this.treeData),this.updateChecked()},500,{leading:!1})}},Jl=e=>(j("data-v-999e513a"),e=e(),q(),e),Ql={class:"chs-er",ref:"root"},Zl={class:"chs-list-er"},ei={key:0,class:"chs-node"},ti=["innerHTML"],si=["onMousedown","for"],li=["id","checked"],ii=["innerHTML"],ai=["innerHTML"],ni={key:0,class:"spin-loding-style"},oi=Jl(()=>a("div",null,null,-1));function ri(e,s,i,o,t,l){const n=w("RecycleScroller"),r=w("Spin"),d=w("Message"),c=H("tooltip"),p=H("esc");return v((h(),u("div",Ql,[v(a("input",{class:"chs-input-er",ref:"chsInputRef",placeholder:"搜索信号名称/信号描述","onUpdate:modelValue":s[0]||(s[0]=f=>t.inputStr=f),onInput:s[1]||(s[1]=(...f)=>l.onChange&&l.onChange(...f)),draggable:!1},null,544),[[Q,t.inputStr]]),a("div",Zl,[g(n,{class:"chs-list",items:l.list,"item-size":28,"key-field":"_id"},{default:S(({item:f})=>[f.node_type=="channel"?(h(),u("div",ei,b(f.text),1)):f.node_type=="msg"?(h(),u("div",{key:1,class:"chs-node",style:{"text-indent":"1em"},innerHTML:l.highlightWord(f.text)},null,8,ti)):f.node_type=="signal"?v((h(),u("div",{key:2,onMousedown:A(y=>l.selectNode(f),["prevent","stop"]),for:f._id,style:{"text-indent":"2em"},class:"chs-node chs-node-item"},[a("input",{id:f._id,type:"checkbox",class:"chs-node-checkbox",checked:t.checkedList.some(y=>y._id===f._id)},null,8,li),a("span",{class:"chs-node-signal",innerHTML:l.highlightWord(f.text)},null,8,ii),C(" "),a("span",{class:"chs-node-comment",innerHTML:l.highlightWord(f.comment)},null,8,ai)],40,si)),[[c,{content:l.title4node(f),html:!0},void 0,{right:!0}]]):k("",!0)]),_:1},8,["items"]),a("div",{class:ue(t.checkedList.length==30?"chs-ft-label-len":"chs-ft-label")},"（"+b(t.checkedList.length)+"/30）",3),a("div",{class:"chs-btn confirm","data-cy":"chooseSignalSubmit",onClick:s[2]||(s[2]=(...f)=>l.submit&&l.submit(...f))},"确定"),a("div",{class:"chs-btn cancel",onClick:s[3]||(s[3]=f=>e.$emit("cancel"))},"取消"),e.$props.loading?(h(),u("div",ni,[oi,g(r)])):k("",!0),g(d,{message:t.message},null,8,["message"])])])),[[p,()=>e.$emit("cancel")]])}const di=E(Yl,[["render",ri],["__scopeId","data-v-999e513a"]]);const ci={props:["chartTableData","showSignalsList"],computed:{mergedArray(){return this.$props.chartTableData.map(e=>{const s=this.$props.showSignalsList.find(i=>i.name===e.name);return s?{...e,...s}:e})}},watch:{mergedArray:{deep:!0,handler(e,s){this.mergedArray.forEach((i,o)=>{let t=Math.trunc((i.raw_values[i.raw_values.length-1]-Math.abs(i.minRaw))/(i.maxRaw-Math.abs(i.minRaw))*100)>100?100:Math.trunc((i.raw_values[i.raw_values.length-1]-Math.abs(i.minRaw))/(i.maxRaw-Math.abs(i.minRaw))*100);this.mergedArray[o].proportion=t,console.log(this.mergedArray[o].proportion,i.raw_values[i.raw_values.length-1]-Math.abs(i.minRaw),Math.abs(i.minRaw),(i.raw_values[i.raw_values.length-1]-Math.abs(i.minRaw))/(i.maxRaw-Math.abs(i.minRaw))*100,"11111111")})}}},data(){return{}}},Oe=e=>(j("data-v-7bdb070d"),e=e(),q(),e),hi={style:{"overflow-y":"auto",height:"calc(100vh - 215px)",border:"1px solid #f0f0f0",width:"calc(100% - 20px)",position:"relative"}},ui={class:"o-table"},pi=Oe(()=>a("thead",{class:"o-table-thead",style:{"background-color":"#FAFAFA"}},[a("tr",null,[a("th",{class:"o-table-cell"},[a("div",{style:{display:"flex","justify-content":"space-between","align-items":"center"}},[a("div",null,"Name"),a("div",{class:"time-line"})])]),a("th",{class:"o-table-cell"},[a("div",{style:{display:"flex","justify-content":"space-between","align-items":"center"}},[C(" Value "),a("div",{class:"time-line"})])]),a("th",{class:"o-table-cell"},[a("div",{style:{display:"flex","justify-content":"space-between","align-items":"center"}},[C(" Unit "),a("div",{class:"time-line"})])]),a("th",{class:"o-table-cell"},[a("div",{style:{display:"flex","justify-content":"space-between","align-items":"center"}},[C(" Raw Value "),a("div",{class:"time-line"})])]),a("th",{class:"o-table-cell"},[a("div",{style:{display:"flex","justify-content":"space-between","align-items":"center"}},[C(" Bar "),a("div",{class:"time-line"})])]),a("th",{class:"o-table-cell"},"Commont")])],-1)),mi={class:"o-table-tbody"},fi={key:0,class:"o-pul-button-wrap-icon"},gi=Oe(()=>a("img",{class:"text-muted-ing-data",src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAKAAAACICAMAAABX7hBEAAAAM1BMVEUAAAD////Nzc0MDAyXl5cAAAAAAAC9vb3t7e0BAQF1dXUAAAApKSkAAABBQUFXV1cAAACKKc10AAAAEXRSTlMATExMTAk1TExBTCFLF0tMKkK5GFYAAAL4SURBVHja7JntauswDIZty7Is+fP+r/Y0dUOz0BZzMKkGe35sMFh5Kr2Sndb88cd/gR2NahBAuWJolZNmxd6iz1z0KiJEGwVCMVoBsvauqLWIQaxVrZhqtHeoscqBRiY7iJRVDjSL3dkGWt+09GqtasUCWSg+FSUrm5ZQJUNuPu6STtdAF/DOkVSAKm5XbIpOaG7uDvmWAZqPyhQLkCM3oFFI726SkZRcIoKQ5NrEE9HTUShuA63ghC5ADUC27kJum+febPFRwSUCueXsx32BvNThKeLvhczef3ugE0AlqmIHMUbnpQ3P2mD7Bd9URIZKzkmN9shNc5TzwfcuER2g3aiwC548yUvLQ9FcDqIxKQyA7FuirwAczLVgCpyOu+aNHEkGDpfvQ+zMHfF8aT33V2re5C7PHyY+bzfM7ly5BkPuepC5mDPsj3J1tPU7lJc7I4gKuRuJy8s/55WZW+9nkBXI3Sic3pknDZ9+4M1PNV3To8YLEEopGjr5jgDAzOoee3ewj8egpNQQGcIjiWwUgtz3EUaNJcQQnl5B4bIJwSCjGfRutFEYN0G9FeRkNkG1GUTAg1didbu6h/vPIVYUHsgjdBg4lRQU+u3NxcSs8oN81Be6Xyeobq/sfGkzY5ilvDjbSljF+74kaDJDYxxOxxBy80uon5IdMrkZHi+CgMcnYLuEnD7Gvk0ZUu6nECKLXQJ9Xg2Fxc3gYRwiz3+ENQWMNU18PzSBAP6cr1UFBDSf6UBzhj9akfIVBRyEOhfDGtAsT6Df3/aiQdlJdVEBnyO8alAG7C8p4E6ajSHg4gRCMlP0PNfk9tjXqwu4OoYpX5bAHZyP4dICmhMr9nUxfXkBlw4K/2vfXlIABKEAikbaR7P9b7d5kxREDM5dwVGcPNS71wbm1PhmI1ZVQjn6FK7GoXx0rRNOipULj2eX4r60AteqQqcjCAgICAgICAgICAgICAgICAgICAgICAgICAgI+BdgHn3buX1/XJmr9AZus7VIkiRJD2y6ViB4C1+1AAAAAElFTkSuQmCC",alt:""},null,-1)),bi=Oe(()=>a("td",{class:"text-center text-muted-data"},"请先选择信号并确认",-1)),_i=[gi,bi],yi={class:"o-table-cell"},wi={class:"o-table-cell"},vi={class:"o-table-cell"},Ci={class:"o-table-cell"},ki={class:"o-table-cell",style:{width:"230px"}},Si={class:"o-table-cell"},Ti={style:{width:"360px","white-space":"nowrap",overflow:"hidden","text-overflow":"ellipsis"}};function Di(e,s,i,o,t,l){const n=H("tooltip");return h(),u("div",hi,[a("table",ui,[pi,a("tbody",mi,[l.mergedArray.length==0?(h(),u("div",fi,_i)):k("",!0),(h(!0),u(T,null,F(l.mergedArray,(r,d)=>(h(),u("tr",{key:d},[a("td",yi,b(r.name),1),a("td",wi,b(Object.keys(r.enums).length===0?r.values[r.values.length-1]:r.enums[r.values[r.values.length-1]]),1),a("td",vi,b(r.unit),1),a("td",Ci,b(r.raw_values[r.raw_values.length-1]),1),a("td",ki,[a("div",{style:$({width:r.proportion+"%"}),class:"proportion"},null,4)]),v((h(),u("td",Si,[a("div",Ti,b(r.comment),1)])),[[n,r.comment]])]))),128))])])])}const Vi=E(ci,[["render",Di],["__scopeId","data-v-7bdb070d"]]);let Xe=0;const xi={props:["store","closeFlag","getDbcData","dbcVal","sdb","dbcChn","ldfChn","chartTableData"],emits:["connect","showMessage","getCarCode"],components:{Button:G,TableChart:Vi,Header:rt,ManageViewsGroup:vt,Draggable:Ct,ChooseSignal:di,AddOrSelector:_t,TimePlotMulti:yt,ProgressBar:wt,Message:Z,ButtonGroup:ve,Switch:Xl},data(){var s,i,o;let e=(s=this.$ls.get("blfread_treeData"))==null?void 0:s.map(t=>({...t,carType:t.carType||"MS11",sdb:t.sdb||"E4U1",children:t.children.map(l=>({...l,warning:!1,pid:t.id,color:l.color||"blue"}))}));return(!e||(e==null?void 0:e.length)===0)&&(e=[]),e=e.filter(t=>!(t.carType==="MS11"&&t.sdb==="E4U1"&&t.text==="默认视图"&&t.children.length===0)),e.some(t=>t.carType==="MS11"&&t.sdb==="E4U1"),this.$ls.set("blfread_treeData",e),{system:ct,modeOptions:[{label:"分散",value:"single"},{label:"对齐",value:"same"},{label:"聚合",value:"shifted"}],chartMode:"single",timeFilterOptions:[{label:"绝对时间",value:"absolute"},{label:"相对时间",value:"relative"}],timeFilterMode:{label:"绝对时间",value:"absolute"},startTime:0,showDotsFrame:!1,fileType:"blf",blfcpp:"cpp",isBigFile:!1,chooseSignalAble:!1,message:{visible:!1,level:"",content:""},modal:{title:"导入文件",visible:!1},manageModal:{title:"管理视图",manageVisible:!1},treeData:e.map(t=>(t.children.forEach(l=>{l.warning=!1}),t)),curView:{label:(i=e[0])==null?void 0:i.text,value:0,tag:(o=e[0])==null?void 0:o.sdb},C2C:[],colorList:["blue","cerulean","cyan","green","lime","purple","pink","red","orange","yellow"],sdb:"E4U3_1115",directory:"",carType:"MS11",directorySize:{label:"",value:0,durationMaybe:0,durationMaybeLabel:"0秒"},backBlock:!1,chartDataLoaded:!0,waitChart:{},fileChoosed:!1,traceList:new Map,timeData:Object.freeze([]),tableList:[],channelVersion:[{label:"全部",value:""}],channelVal:"全部",ECUVersion:[{label:"全部",value:""}],ECUVal:"全部",canIdsVersion:[{label:"全部",value:""}],canIdsVal:"全部",filterTableList:[],columnDefs:[{headerName:"Time",field:"timeTabData"},{headerName:"Chn",field:"chnTabData",width:80},{headerName:"ID",field:"idTabData",width:80},{headerName:"Name",field:"nameTabData",width:300},{headerName:"Event Type",field:"eventTabData"},{headerName:"Dir",field:"dirTabData",width:80},{headerName:"DLC",field:"dlcTabData",width:80},{headerName:"文本ECU",field:"dataTabData"}],debug:window._debug,signalLoading:!1,defaultOptions:{},filledOptions:{},showSignalsList:[],objSing:{},mlistChart:[{key:"timeChart",name:" 切换为折线图",icon:"box"},{key:"tableChart",name:"切换为表格",icon:"setting"}],curChart:"timeChart",tablechartShow:!0,timechartShow:!1,timeLimit:10,minTime:0,turnTimeLimit:!1}},computed:{sdbVal(){return[this.carType,this.$props.sdb]},quitConfirm(){return!!this.directory.trim()},treeDataDbc(){return this.treeData.map((e,s)=>({...e,label:e.text,value:s,tag:e.sdb})).filter(e=>e.carType===this.carType&&e.sdb===this.sdb)},carTypeLabel(){return this.carType&&this.carType!=="custom"?this.carType+" / ":""},view(){var e;return this.treeData[(e=this.curView)==null?void 0:e.value]},directoryLabel(){let e=this.directory.split("/").pop();return e.length>25?e.slice(0,10)+"..."+e.slice(-15):e},fileType_CarType(){return[this.fileType,this.carType]}},mounted(){this.debug=!!window._debug,this.fillEmptyTreeData(),this.curView=this.treeDataDbc[0],ye.report("trackPage",{page:"查看报文",tip:"1174.10.0.1.27765"}),window._timeData=this.timeData},beforeUnmount(){this.timeData=[]},unmounted(){D.blf.freeSpace(),D.ascReader.freeSpace(),D.logReader.freeSpace(),window._timeData.forEach(e=>{e.t.length=0})},watch:{fileType_CarType(){this.fileType==="mdf"?this.blfcpp="cpp":this.debug||(this.carType==="custom"?this.blfcpp="python":this.blfcpp="cpp")},blfcpp:{handler(e){window._blfcpp=e},immediate:!0},sdbVal:{handler(e){var o,t,l;this.sdb=this.$props.sdb;let s=[];this.curView=this.treeDataDbc[0];const i=this.$ls.get("blfread_sdbData")||[];if(this.carType==="custom"){let n=(o=i.find(r=>r.sdb===this.sdb))==null?void 0:o.comments;n&&(s=["",...n])}else s=((l=(t=SDB.DEFAULT.find(n=>n.value===this.carType))==null?void 0:t.children.find(n=>n.value===this.sdb))==null?void 0:l.comments)||[];this.C2C=s.map((n,r)=>"".concat("⓪①②③④⑤⑥⑦⑧⑨⑩⑪⑫⑬⑭⑮⑯⑰⑱⑲⑳㉑㉒㉓㉔㉕㉖㉗㉘㉙㉚㉛㉜㉝㉞㉟㊱㊲"[r]).concat(n))},immediate:!0},chartDataLoaded(e,s){e?(this.backBlock=!1,document.querySelector(".o-body").style.cursor=""):(this.backBlock=!0,document.querySelector(".o-body").style.cursor="wait")},treeData:{handler(e,s){JSON.stringify(this.$ls.get("blfread_treeData"))!==JSON.stringify(e)&&this.$ls.set("blfread_treeData",e)},deep:!0},chooseSignalAble:{handler(){this.filledOptions=this.$props.getDbcData}},directory:{async handler(e){const s=await J.getFileSize(e),i=.83*.2,o=Math.round((1678e-19*s*s+1768e-10*s+.5581)*i);this.directorySize={label:St(s),value:s,durationMaybe:o*1e3,durationMaybeLabel:Dt(o)}}},curView:{handler(e){this.updateSignal(this.view.children)},deep:!0},dbcVal:{handler(e){this.carType=e==="自定义模板"?"custom":e.split("/")[0]},deep:!0}},beforeUpdate(){},methods:{choose(e){this.curChart=e,e=="timeChart"?(this.timechartShow=!1,this.tablechartShow=!0):e=="tableChart"&&(this.timechartShow=!0,this.tablechartShow=!1)},upTimeData(e){if(!((e==null?void 0:e.length)>0))return;let s=Date.now()/1e3-(this.turnTimeLimit?this.timeLimit:1200);console.log("minTime",s);let i=this.timeData.slice();e.forEach(o=>{var l;let t=i.find(n=>n.channel===o.busId&&n.msg===o.canId&&n.name===o.name);for(;((l=t==null?void 0:t.t)==null?void 0:l[0])<s;)t.t.shift(),t.v.shift();t&&(t.t.push(...o.times.map(n=>+n.toFixed(3))),t.v.push(...o.values))}),this.timeData=Object.freeze(i),this.loadChart(this.view)},onUpdateDefaultOptions(e){this.defaultOptions=Object.freeze(e)},title4node(e){return we(e)},showMessage({level:e,content:s,timeout:i}){clearTimeout(Xe),e!=null&&(this.message.level=e),s!=null&&(this.message.content=s),this.message.visible=!0,i>0&&(Xe=setTimeout(()=>{this.message.visible=!1},i))},hideMessage(){this.message.visible=!1},onTreeDataChange(){this.treeData=this.$ls.get("blfread_treeData")},fillEmptyTreeData(){SDB.DEFAULT.forEach(e=>{e.children.forEach(s=>{this.treeData.some(i=>i.carType===e.value&&i.sdb===s.value)||this.treeData.push({id:+Math.random().toString().replace(".",""),text:"默认视图",type:"view",editable:!1,carType:e.value,sdb:s.value,deleteConfirm:!1,children:[]})})})},deleteView(e){let s=this.treeData.filter(i=>i.id!==e.id);this.curView.value=s.findIndex(i=>i.id===this.view.id),this.treeData=s},updateView(e){this.treeData=this.treeData.map(s=>s.id===e.id?e:s)},onImportView(e){this.addView(e)},resetTimeData(){this.directory="",this.backBlock=!1,this.chartDataLoaded=!0,this.waitChart={},this.fileChoosed=!1,this.traceList=new Map},choosePath(){this.fileType==="blf"?(this.chartDataLoaded=!1,this.clearTimeData(),D.blf.getBLFdata({blfFile:this.directory,mode:this.isBigFile?"bigFile":void 0}).then(async e=>{this.startTime=e.data.startTime,this.fileChoosed=!0,this.treeData.forEach(i=>{this.waitChart[i.id]=!0});let s=this.treeData.slice();s.splice(this.curView.value,1),s.unshift(this.treeData[this.curView.value]),s=s.filter(i=>i.carType===this.carType&&i.sdb===this.sdb),D.blf.haveDataSignal({}).then(i=>{this.filledOptions=Object.freeze(i.data),this.signalLoading=!1});for(let i=0;i<s.length;i++)await this.play(s[i]),i===0&&(this.chartDataLoaded=!0)}).catch(()=>{}).finally(()=>{this.chartDataLoaded=!0,this.signalLoading=!1})):this.fileType==="mdf"?(async()=>{this.signalLoading=!1,this.chartDataLoaded=!1,this.clearTimeData(),this.fileChoosed=!0,this.treeData.forEach(s=>{this.waitChart[s.id]=!0});let e=this.treeData.slice();e.splice(this.curView.value,1),e.unshift(this.treeData[this.curView.value]),e=e.filter(s=>s.carType===this.carType&&s.sdb===this.sdb),await this.play(this.treeData[this.curView.value]);for(let s=0;s<e.length;s++)await this.play(e[s]),s===0&&(this.chartDataLoaded=!0)})():this.fileType==="asc"?(this.chartDataLoaded=!1,this.clearTimeData(),D.ascReader.getAscdata({ascFile:this.directory}).then(async e=>{var i,o;this.startTime=((o=(i=e.data)==null?void 0:i.data)==null?void 0:o.startTime)||0,this.fileChoosed=!0,this.treeData.forEach(t=>{this.waitChart[t.id]=!0});let s=this.treeData.slice();s.splice(this.curView.value,1),s.unshift(this.treeData[this.curView.value]),s=s.filter(t=>t.carType===this.carType&&t.sdb===this.sdb),D.ascReader.haveDataSignal({ascFile:this.directory}).then(t=>{this.filledOptions=Object.freeze(t.data),this.signalLoading=!1});for(let t=0;t<s.length;t++)await this.play(s[t]),t===0&&(this.chartDataLoaded=!0)}).catch(()=>{}).finally(()=>{this.chartDataLoaded=!0,this.signalLoading=!1})):this.fileType==="log"&&(this.chartDataLoaded=!1,this.clearTimeData(),D.logReader.getLogData({logFile:this.directory}).then(async e=>{var i,o;this.startTime=((o=(i=e.data)==null?void 0:i.data)==null?void 0:o.startTime)||0,this.fileChoosed=!0,this.treeData.forEach(t=>{this.waitChart[t.id]=!0});let s=this.treeData.slice();s.splice(this.curView.value,1),s.unshift(this.treeData[this.curView.value]),s=s.filter(t=>t.carType===this.carType&&t.sdb===this.sdb),D.logReader.haveDataSignal({ascFile:this.directory}).then(t=>{this.filledOptions=Object.freeze(t.data),this.signalLoading=!1});for(let t=0;t<s.length;t++)await this.play(s[t]),t===0&&(this.chartDataLoaded=!0)}).catch(()=>{}).finally(()=>{this.chartDataLoaded=!0,this.signalLoading=!1}))},clearTimeData(){this.timeData=Object.freeze([]),this.treeData.forEach(e=>{e.children.forEach(s=>{s.warning=void 0})})},hideSignal(e,s){e.hidden=!e.hidden,this.play(s,!0)},deleteSignal(e){this.treeData=this.treeData.map(s=>{if(s.id==e.pid){let i={...s,children:s.children.filter(o=>!(o.id==e.id&&o.msg==e.msg&&o.channel==e.channel))};return this.$nextTick(()=>this.play(i,!0)),i}return{...s}})},async play(e,s){console.log("this.$props.getDbcData1041",this.$props.getDbcData),this.loadChart(e)},loadChart(e){console.log("node1727",e,this.timeData);const s={blue:"#2266ff",cerulean:"#00c7f2",cyan:"#00e0b8",green:"#3fd926",lime:"#add900",purple:"#8125ff",pink:"#ff4475",red:"#ff3838",orange:"#ffad4d",yellow:"#f1d900"},i=e.children.filter(o=>!o.hidden).map((o,t)=>{const l=this.timeData.find(n=>o.channel===n.channel&&o.msg===n.msg&&o.text===n.name);return l?{...l,color:s[o.color]}:{name:o.text,enums:o.enums,channel:o.channel,msg:o.msg,color:s[this.colorList[t%9]],t:[],v:[]}});this.timeData=Object.freeze(i)},tranLinCanId(e){const s=e.match(/\(([^)]+)\)/);if(s){const i=s[1],o=parseInt(i,16);return console.log(o),o}},async updateSignal(e,s){var l;console.log("signals8899",e,(l=this.curView)==null?void 0:l.value,this.treeData),e.length==0&&(this.timeData=Object.freeze([])),this.showSignalsList=[],e.forEach(n=>{let r={};r.busId=n.channel,r.canId=n.msg,r.name=n.text,r.color=n.color,r.maxRaw=+n.maxRaw,r.minRaw=+n.minRaw,r.comment=n.comment,r.unit=n.unit,r.enums=n.enums,this.showSignalsList.push(r)});let i=this.showSignalsList.filter((n,r)=>this.showSignalsList.findIndex(d=>d.name===n.name)===r),o=await D.blfLogging.selectShowSignals(i);o.data.code!==1&&this.showMessage({timeout:2e3,level:"error",content:o.data.msg});const t=this.view;this.treeData=this.treeData.map(n=>{if(n.id==t.id){let r=e.map((c,p)=>{let f=n.children.find(y=>c.id==y.id&&c.msg==y.msg&&c.channel==y.channel);return f?{...f,pid:n.id,color:s=="1"||(c==null?void 0:c.colorEditable)==!1?c.color:this.colorList[p%9]}:{_id:c._id,pid:n.id,id:c.id,text:c.text,comment:c.comment,remark:c.remark,msg:c.msg,channel:c.channel,type:"signal",color:s=="1"||(c==null?void 0:c.colorEditable)==!1?c.color:this.colorList[p%9],colorEditable:!1,maxRaw:+c.maxRaw,minRaw:+c.minRaw,comment:c.comment,unit:c.unit,enums:c.enums}});return{...n,children:r}}return n}),this.upTimeData(),this.chooseSignalAble=!1},goBackHome(){this.$router.push({path:"/"})},importFile(){this.modal.visible=!0},addView(e){let s=e.label||"新建视图"+(this.treeData.length+1);if(this.treeData=[...this.treeData,{id:e.id||Date.now(),text:s,type:"view",editable:!1,deleteConfirm:!1,children:(e==null?void 0:e.children)||[],carType:(e==null?void 0:e.carType)||this.carType,sdb:(e==null?void 0:e.sdb)||this.sdb}],(e==null?void 0:e.from)==="AddOrSelector"){let i=this.treeData.length-1;this.curView={label:this.treeData[i].text,value:i}}},onSwitchView({fromNode:e,toNode:s}){this.view.id===e.id?this.curView.value=this.treeData.findIndex(i=>i.id===s.id):this.view.id===s.id&&(this.curView.value=this.treeData.findIndex(i=>i.id===e.id)),this.treeData=this.treeData.map(i=>i.id===e.id?s:i.id===s.id?e:i)},manageShow(){this.manageModal.manageVisible=!0},onCancelImportFile(){this.modal.visible=!1},async onCancelSelect(e){this.manageModal.manageVisible=!1;const s=this.treeData.findIndex(o=>o.id===e),i=this.treeData[s];if(console.log("view334",i),this.curView={label:this.treeData[s].text,value:s,tag:i.sdb},this.carType!==i.carType||this.sdb!==i.sdb){let o=[],t=[];if(i.carType==="custom"){const n=(this.$ls.get("blfread_sdbData")||[]).find(r=>r.sdb===i.sdb);o=n.files,t=n.comments}this.onCheckView({curId:i.id,carType:i.carType,sdb:i.sdb,directory:this.directory,files:o,comments:t})}else this.$nextTick(()=>{const o=i,t=o.id;this.waitChart[t]===void 0&&this.directory&&this.play(o)}),this.fileType=="mdf"&&this.play(this.treeData[this.curView.value])},onCheckView(e){this.signalLoading=!0,this.resetTimeData(),this.$nextTick(()=>{this.modal.visible=!1;let i=this.treeData.filter(o=>o.id===e.curId).map(o=>({label:o.text,value:this.treeData.findIndex(t=>t.id===e.curId)}));this.curView=i[0],this.carType=e.carType,console.log("data1725",e),this.sdb=e==null?void 0:e.sdb,this.directory=kt(e.directory),this.files=e.files.length?e.files:void 0,this.comments=e.comments.length?e.comments:void 0,this.fileType=e.fileType,e.isBigFile!==void 0&&(this.isBigFile=e.isBigFile),e.fileType==="mdf"?D.mdf.getSignals({mdfPath:e.directory}).then(o=>{this.defaultOptions=Object.freeze(o.data.data)}).then(()=>{this.choosePath()}):this.$nextTick(async()=>{console.log("this.carType7788",this.carType),this.carType==="custom"?this.fileType==="blf"?await D.blf.getDBC({carType:this.carType,sdb:this.sdb,files:this.files,comments:this.comments}).then(o=>{this.defaultOptions=Object.freeze(o.data)}):this.fileType==="log"?await D.logReader.getDBC({carType:this.carType,sdb:this.sdb,files:this.files,comments:this.comments}).then(o=>{this.defaultOptions=Object.freeze(o.data)}):await D.ascReader.getDBC({carType:this.carType,sdb:this.sdb,files:this.files,comments:this.comments}).then(o=>{this.defaultOptions=Object.freeze(o.data)}):this.fileType==="blf"?await D.blf.reAdjust(e.sendReAdjust):this.fileType==="log"?(e.adaptedType=="noAdapted"&&await D.logReader.getDBC({carType:this.carType,sdb:this.sdb,files:this.files,comments:this.comments}).then(o=>{this.defaultOptions=Object.freeze(o.data)}),await D.logReader.reAdjust(e.sendReAdjust)):(e.adaptedType=="noAdapted"&&await D.ascReader.getDBC({carType:this.carType,sdb:this.sdb,files:this.files,comments:this.comments}).then(o=>{this.defaultOptions=Object.freeze(o.data)}),await D.ascReader.reAdjust(e.sendReAdjust)),console.log("this.defaultOptions",this.defaultOptions),this.choosePath()})}),ye.report("track","click",{element_name:"查看报文",asset_name:this.directory+";",tip:"1174.10.0.1.27766"})},onExportDotsData(e){const s=e.map(i=>i.join("	")).join("\n");Tt(s,"tspa-打点-"+$e()+".txt")},changeState(){this.turnTimeLimit=!this.turnTimeLimit,console.log("this.turnTimeLimit ? this.timeLimit : 1200",this.turnTimeLimit?this.timeLimit:1200)}}},W=e=>(j("data-v-3f83ca40"),e=e(),q(),e),Ii={class:"o-pul-er"},Li={key:0,class:"o-column"},Fi={class:"o-column-left"},Ri=W(()=>a("div",{class:"o-resize-bar"},null,-1)),Mi=W(()=>a("div",{class:"o-resize-line"},null,-1)),Ei={class:"o-resize-save"},$i={class:"o-pul-board"},Ai={class:"o-pul-select-wrap"},Ni={class:"o-pul-button-wrap"},Oi=W(()=>a("i",{class:"t-icon chooseSignal"},null,-1)),Pi=W(()=>a("span",null,"选择信号",-1)),Ui=[Oi,Pi],Hi=W(()=>a("span",{style:{color:"#D9D9D9","font-size":"18px",transform:"scaleX(0.5)"}},"|",-1)),Bi=W(()=>a("i",{class:"t-icon manageView"},null,-1)),ji=W(()=>a("span",null,"管理视图",-1)),qi=[Bi,ji],zi=["data-empty"],Ki=["data-hidden"],Wi=["data-open","onClick"],Gi=["data-color","onClick"],Xi=["onMouseleave"],Yi=["title","data-color","onClick"],Ji={class:"t-node-text"},Qi={key:0,class:"t-node-warning"},Zi={key:1,class:"t-node-error"},ea=["onClick"],ta=["onClick"],sa=W(()=>a("div",{class:"drag-icon"},null,-1)),la={class:"o-column-right"},ia={class:"o-menu-chart"},aa=["data-active"],na=W(()=>a("i",{class:"o-menu-chart-it-icon"},null,-1)),oa=["data-active"],ra=W(()=>a("i",{class:"o-menu-chart-it-icon"},null,-1)),da={class:"rec-body",style:{position:"relative"}},ca={class:"timechart-er"},ha={class:"tch-tool-er"},ua={class:"tch-tool-hotkey-er"},pa={class:"timechart-hotkey"},ma={class:"hotkey-more"},fa=W(()=>a("div",{class:"hotkey-icon-book"},null,-1)),ga={class:"hotkey-more-body"},ba=Ae('<li data-v-3f83ca40><div class="timechart-hotkey-it" data-v-3f83ca40>缩放横轴 <span class="hotkey-btn" data-v-3f83ca40>ctrl+滚轮</span></div></li><li data-v-3f83ca40><div class="timechart-hotkey-it" data-v-3f83ca40>平移横轴 <span class="hotkey-btn" data-v-3f83ca40>shift+滚轮</span></div></li><li data-v-3f83ca40><div class="timechart-hotkey-it" data-v-3f83ca40>缩放纵轴 <span class="hotkey-btn" data-v-3f83ca40>alt+ctrl+滚轮</span></div></li><li data-v-3f83ca40><div class="timechart-hotkey-it" data-v-3f83ca40>平移纵轴 <span class="hotkey-btn" data-v-3f83ca40>alt+shift+滚轮</span></div></li><li data-v-3f83ca40><div class="timechart-hotkey-it" data-v-3f83ca40>框选放大 <span class="hotkey-btn" data-v-3f83ca40>左键拖拽</span></div></li><li data-v-3f83ca40><div class="timechart-hotkey-it" data-v-3f83ca40>复位轴 <span class="hotkey-btn" data-v-3f83ca40>左键双击</span></div></li><li data-v-3f83ca40><div class="timechart-hotkey-it" data-v-3f83ca40>选择帧 <span class="hotkey-btn" data-v-3f83ca40>左键单击</span></div></li>',7),_a={class:"timechart-hotkey-it"},ya={class:"hotkey-btn"},wa=W(()=>a("li",null,[a("div",{class:"timechart-hotkey-it"},[C("框选时段 "),a("span",{class:"hotkey-btn"},"shift+左键")])],-1)),va={class:"tch-tool-blank-er"},Ca=W(()=>a("div",{class:"tch-tool-span"},null,-1)),ka=W(()=>a("div",{class:"tch-tool-span"},null,-1)),Sa=["id"],Ta={class:"filter-time"},Da={class:"filter-time-wrap"},Va=W(()=>a("span",null,"筛选时间： 近 ",-1)),xa=["disabled"],Ia={class:"rec-body-table"},La={class:"table-data"},Fa={key:1,class:"board-spin-er"},Ra={class:"board-spin-progress"},Ma={class:"board-spin-text"};function Ea(e,s,i,o,t,l){var N;const n=w("AddOrSelector"),r=w("ChooseSignal"),d=w("Draggable"),c=w("Button"),p=w("v-select"),f=w("ButtonGroup"),y=w("TimePlotMulti"),M=w("Switch"),L=w("TableChart"),z=w("ProgressBar"),_=w("ManageViewsGroup"),O=w("Message"),x=H("tooltip");return h(),u(T,null,[a("div",Ii,[l.view?(h(),u("div",Li,[a("div",Fi,[Ri,Mi,a("div",Ei,[a("div",$i,[a("div",Ai,[g(n,{options:l.treeDataDbc,placeholder:"输入视图名称",modelValue:t.curView,"onUpdate:modelValue":s[0]||(s[0]=I=>t.curView=I),onAdd:l.addView},null,8,["options","modelValue","onAdd"])]),a("div",Ni,[a("div",{class:"head-btn",onClick:s[1]||(s[1]=A(()=>t.chooseSignalAble=!t.chooseSignalAble,["prevent","stop"]))},Ui),Hi,a("div",{class:"head-btn",id:"delete_module",onClick:s[2]||(s[2]=I=>l.manageShow())},qi),t.chooseSignalAble?(h(),P(r,{key:0,filledOptions:t.filledOptions,signals:l.view.children,onSignalsChange:l.updateSignal,loading:t.signalLoading,carType:t.carType,fileType:t.fileType,sdb:t.sdb,dbcVal:i.dbcVal,dbcChn:i.dbcChn,ldfChn:i.ldfChn,onCancel:s[3]||(s[3]=()=>t.chooseSignalAble=!1)},null,8,["filledOptions","signals","onSignalsChange","loading","carType","fileType","sdb","dbcVal","dbcChn","ldfChn"])):k("",!0)]),a("div",{class:"o-pul-tree-er","data-empty":l.view.children.length===0},[l.view?(h(),P(d,{key:0,onDrag:s[4]||(s[4]=A(()=>{},["stop"])),onDragstart:s[5]||(s[5]=A(()=>{},["stop"])),maxLevel:1,class:"t-list",modelValue:l.view.children,"onUpdate:modelValue":s[6]||(s[6]=I=>l.view.children=I),onAfterDrop:s[7]||(s[7]=I=>l.updateSignal(l.view.children,"1"))},{default:S(({node:I,stat:se})=>[a("div",{class:"t-node","data-type":"signal","data-hidden":I.hidden},[a("i",{class:"t-node-exp","data-open":se.open,onClick:K=>se.open=!se.open},null,8,Wi),C(),v((h(),u("i",{class:"t-node-icon","data-color":I.color,onClick:A(K=>I.colorEditable=!0,["stop","prevent"])},[v(a("div",{class:"color-picker",onMouseleave:K=>I.colorEditable=!1},[(h(!0),u(T,null,F(t.colorList,K=>(h(),u("div",{class:"color-item",title:K,"data-color":K,key:K,onClick:m=>{I.color=K,l.updateSignal(l.view.children,"1")}},null,8,Yi))),128))],40,Xi),[[U,I.colorEditable]])],8,Gi)),[[x,"更改颜色"]]),v((h(),u("span",Ji,[a("span",null,b(t.fileType!=="mdf"?I.channel>1e3?"":t.C2C[I.channel]+"-":"")+b(I.text),1),I.warning===!0?v((h(),u("div",Qi,null,512)),[[x,"信号无数据"]]):k("",!0),!I.hidden&&I.warning===null?v((h(),u("div",Zi,null,512)),[[x,"文件内无此信号"]]):k("",!0)])),[[x,{content:l.title4node(I),html:!0},void 0,{right:!0}]]),v(a("div",{class:"t-node-delete",onClick:K=>l.deleteSignal(I)},null,8,ea),[[x,"删除"]]),v(a("div",{class:"t-node-watch",onClick:K=>{l.hideSignal(I,l.view)}},null,8,ta),[[x,"显示|隐藏"]])],8,Ki)]),_:1},8,["modelValue"])):k("",!0)],8,zi)])]),sa]),a("div",la,[a("div",ia,[t.curChart!=="timeChart"?(h(),u("div",{key:0,class:"o-menu-chart-it-button","data-active":t.curChart==t.mlistChart[0].key||t.mlistChart[0].active,onClick:s[8]||(s[8]=I=>l.choose(t.mlistChart[0].key))},[na,C(" "+b(t.mlistChart[0].name),1)],8,aa)):(h(),u("div",{key:1,class:"o-menu-chart-it-button","data-active":t.curChart==t.mlistChart[1].key||t.mlistChart[1].active,onClick:s[9]||(s[9]=I=>l.choose(t.mlistChart[1].key))},[ra,C(" "+b(t.mlistChart[1].name),1)],8,oa))]),v(a("div",da,[a("div",ca,[a("div",ha,[a("div",ua,[a("div",pa,[a("div",ma,[fa,C("快捷键 "),a("div",ga,[a("ul",null,[ba,a("li",null,[a("div",_a,[C("打点 "),a("span",ya,b(t.system==="mac"?"option":"alt")+"+左键",1)])]),wa])])])])]),a("div",va,[v((h(),P(c,{class:"tch-tool-btn",onClick:s[10]||(s[10]=I=>t.showDotsFrame=!t.showDotsFrame)},{default:S(()=>[C("打点")]),_:1})),[[x,"alt+左键"]]),Ca,v(g(p,{options:t.timeFilterOptions,clearable:!1,searchable:!1,label:"label",value:"value",modelValue:t.timeFilterMode,"onUpdate:modelValue":s[11]||(s[11]=I=>t.timeFilterMode=I),class:"tch-tool-select"},null,8,["options","modelValue"]),[[x,"时间显示"]]),ka,g(f,{options:t.modeOptions,modelValue:t.chartMode,"onUpdate:modelValue":s[12]||(s[12]=I=>t.chartMode=I)},null,8,["options","modelValue"])])]),(h(),u("div",{id:"timechart_"+l.view.id,style:$("width: 100%; height: calc(100% - 93px);min-height: ".concat(t.chartMode==="single"?(((N=t.timeData)==null?void 0:N.length)||0)*40+1:1,"px;")),key:l.view.id},[t.timeData.length>0&&t.timeData.some(I=>I.t)?(h(),P(y,{key:0,"data-cy":"timePlotMulti",fileType:t.fileType,timeData:t.timeData,showEnum:!0,mode:t.chartMode,startTime:t.startTime,timeFilter:t.timeFilterMode.value,showExport:!1,showDotsFrame:t.showDotsFrame,"onUpdate:showDotsFrame":s[13]||(s[13]=I=>t.showDotsFrame=I),monitor:!0},null,8,["fileType","timeData","mode","startTime","timeFilter","showDotsFrame"])):k("",!0)],12,Sa)),a("div",Ta,[g(M,{modelValue:t.turnTimeLimit,"onUpdate:modelValue":s[14]||(s[14]=I=>l.changeState()),id:t.turnTimeLimit},null,8,["modelValue","id"]),a("div",Da,[Va,v(a("input",{class:"input",type:"number",placeholder:"输入数字",disabled:!t.turnTimeLimit,min:"0",max:"1200","onUpdate:modelValue":s[15]||(s[15]=I=>t.timeLimit=I),onInput:s[16]||(s[16]=(...I)=>e.onChange&&e.onChange(...I))},null,40,xa),[[Q,t.timeLimit,void 0,{lazy:!0}]]),C(" 秒 ")])])])],512),[[U,!t.timechartShow]]),v(a("div",Ia,[a("div",La,[g(L,{chartTableData:this.$props.chartTableData,showSignalsList:t.showSignalsList},null,8,["chartTableData","showSignalsList"])])],512),[[U,!t.tablechartShow]])])])):k("",!0),t.chartDataLoaded?k("",!0):(h(),u("div",Fa,[a("div",Ra,[t.directorySize.durationMaybe?(h(),P(z,{key:0,second:t.directorySize.durationMaybe},null,8,["second"])):k("",!0)]),a("div",Ma,"正在解析文件 "+b(l.directoryLabel)+"（"+b(t.directorySize.label)+"），约"+b(t.directorySize.durationMaybeLabel)+"…",1)]))]),t.manageModal.manageVisible?(h(),P(_,{key:0,fileType:t.fileType,propTreeData:t.treeData,curViewInx:t.curView.value,title:t.manageModal.title,onCancel:l.onCancelSelect,onDelete:l.deleteView,onUpdate:l.updateView,onImport:l.onImportView,onAdd:l.addView,onSwitch:l.onSwitchView},null,8,["fileType","propTreeData","curViewInx","title","onCancel","onDelete","onUpdate","onImport","onAdd","onSwitch"])):k("",!0),g(O,{message:t.message},null,8,["message"])],64)}const $a=E(xi,[["render",Ea],["__scopeId","data-v-3f83ca40"]]);let Se;const Aa={name:"ScrollBar",props:["modelValue","start","end","disable","timeFilter","startTime"],emits:["update:modelValue","change"],data(){return{lineTop:0,scrollTop:0,lineTitle:"",scrollTitle:"",lineVisible:!1,dragging:!1,dragHover:!1}},methods:{enterHandler(){this.dragging||(this.lineVisible=!0)},leaveHandler(){this.lineVisible=!1},moveHandler(e){this.lineVisible&&(e.offsetY<0||e.offsetY>=this.$refs.root.clientHeight-28||(this.lineTop=e.offsetY,this.lineTitle=this.tooltipFormatter(this.$props.start+(this.$props.end-this.$props.start)*e.offsetY/(this.$refs.root.clientHeight-28))))},clickHandler(e){this.scrollTop=e.offsetY;const s=this.$props.start+(this.$props.end-this.$props.start)*this.scrollTop/(this.$refs.root.clientHeight-28);this.$emit("update:modelValue",s),this.$emit("change",s)},tooltipFormatter(e){return parseInt(e)/1e3},timeStrFilter(e){return this.$props.timeFilter==="absolute"?new Date(e*1e3+(this.$props.startTime||0)).toLocaleString("zh-Hans-CN",{hour:"2-digit",minute:"2-digit",second:"2-digit",fractionalSecondDigits:3,hourCycle:"h23",timeZone:"Asia/Shanghai"}):e},blockDownHandler(){this.dragging=!0,Se=void 0},blockUphandler(){if(this.dragging){this.dragging=!1;const e=this.$props.start+(this.$props.end-this.$props.start)*this.scrollTop/(this.$refs.root.clientHeight-28);this.$emit("update:modelValue",e),this.$emit("change",e)}},blockLeaveHandler(){this.enterHandler(),this.dragHover=!1},blockEnterHandler(){this.leaveHandler(),this.dragHover=!0},blockMoveHandler(e){if(this.dragging){let s=0;Se!=null&&(s=e.pageY-Se),Se=e.pageY,console.log("move",e.pageY);let i=this.scrollTop+s;const o=this.$refs.root.clientHeight;if(i<0){if(this.scrollTop===0)return;i=0}else if(i>o-28){if(this.scrollTop===o-28)return;i=o-28}this.scrollTop=i,this.scrollTitle=this.tooltipFormatter(this.$props.start+(this.$props.end-this.$props.start)*this.scrollTop/(this.$refs.root.clientHeight-28))}}},watch:{modelValue(e){if(this.dragging)return;let s=(e-this.$props.start)/(this.$props.end-this.$props.start);this.scrollTop=parseInt(s*(this.$refs.root.clientHeight-28)),this.scrollTitle=this.tooltipFormatter(e),this.dragging=!1,this.dragHover=!1},end(e){if(this.dragging)return;let s=(this.$props.modelValue-this.$props.start)/(this.$props.end-this.$props.start);this.scrollTop=parseInt(s*(this.$refs.root.clientHeight-28))}},mounted(){window.addEventListener("mouseup",this.blockUphandler),window.addEventListener("mousemove",this.blockMoveHandler)},unmounted(){window.removeEventListener("mouseup",this.blockUphandler),window.removeEventListener("mousemove",this.blockMoveHandler)}},Na=["data-disable"],Oa=["data-active"],Pa={class:"block-title"},Ua={class:"line-title"},Ha=["data-active"];function Ba(e,s,i,o,t,l){return h(),u("div",{class:"bar-er","data-disable":e.$props.disable,ref:"root",onClick:s[5]||(s[5]=A((...n)=>l.clickHandler&&l.clickHandler(...n),["prevent","stop"])),onMousemove:s[6]||(s[6]=(...n)=>l.moveHandler&&l.moveHandler(...n)),onMouseenter:s[7]||(s[7]=(...n)=>l.enterHandler&&l.enterHandler(...n)),onMouseleave:s[8]||(s[8]=(...n)=>l.leaveHandler&&l.leaveHandler(...n))},[a("div",{class:"bar-block","data-active":t.dragging,onClick:s[0]||(s[0]=A(()=>{},["prevent","stop"])),onMousedown:s[1]||(s[1]=(...n)=>l.blockDownHandler&&l.blockDownHandler(...n)),onMouseup:s[2]||(s[2]=(...n)=>l.blockUphandler&&l.blockUphandler(...n)),onMouseleave:s[3]||(s[3]=(...n)=>l.blockLeaveHandler&&l.blockLeaveHandler(...n)),onMouseenter:s[4]||(s[4]=(...n)=>l.blockEnterHandler&&l.blockEnterHandler(...n)),style:$({transform:"translateY("+t.scrollTop+"px)"})},[a("div",Pa,b(l.timeStrFilter(t.scrollTitle)),1)],44,Oa),v(a("div",{class:"bar-line",style:$({transform:"translateY("+t.lineTop+"px)"})},[a("div",Ua,b(l.timeStrFilter(t.lineTitle)),1)],4),[[U,t.lineVisible]]),a("div",{class:"scroll-title","data-active":t.dragging},b(l.timeStrFilter(t.scrollTitle)),9,Ha)],40,Na)}const ja=E(Aa,[["render",Ba],["__scopeId","data-v-af35b704"]]);const qa={props:["col","asyncData"],emits:["change"],data(){return{options:[],loading:!1,current:[]}},methods:{async onMouseEnter(){this.loading=!0,this.options=[];try{this.options=await this.$props.asyncData(this.$props.col)}catch(e){}this.loading=!1},onModelValueChange(e){this.current=e,this.$emit("change",e)}},watch:{col:{handler(e){this.current=e.value},deep:!0}}},za=e=>(j("data-v-f346e8e4"),e=e(),q(),e),Ka=["data-active"],Wa=za(()=>a("div",null,null,-1));function Ga(e,s,i,o,t,l){var r;const n=w("v-select");return h(),u("div",{class:"select-icon","data-active":((r=t.current)==null?void 0:r.length)>0,onMouseenter:s[0]||(s[0]=(...d)=>l.onMouseEnter&&l.onMouseEnter(...d))},[a("div",{class:"flt-er",style:$({width:e.$props.col.width+40+"px"})},[g(n,{loading:t.loading,options:t.options,dropdownShouldOpen:()=>!0,searchable:!0,modelValue:t.current,"onUpdate:modelValue":l.onModelValueChange,multiple:""},{"no-options":S(()=>[Wa]),_:1},8,["loading","options","modelValue","onUpdate:modelValue"])],4)],40,Ka)}const Xa=E(qa,[["render",Ga],["__scopeId","data-v-f346e8e4"]]);let Fe=0,Re=0;const Ya={props:["rowData","columnsDef","columnsFilter","from","filters"],emits:["toggleExpand","scrollRow","scrollAction","filterItem","colFilterChange","updatePadding","timeModeChange"],components:{RecycleScroller:he,FilterItem:Xa},created(){this.$_scrollTimer=0},data(){return{isChildTit:!1,searchVal:"",isOpenSearch:!1,selectFilterList:[],showSelect:!1,curId:-1,filterChnItem:"",filterValItem:"",formData:{},filterList:{channel:"",canId:"",name:"",canType:"",dir:"",dlc:""},left:0,timeFilterOptions:[{label:"Time 绝对时间",value:"absolute"},{label:"Time 相对时间",value:"relative"},{label:"ΔTime 时间差",value:"diff"}],timeFilterMode:{label:"Time 绝对时间",value:"absolute"},selectionActive:!1}},computed:{fullWidth(){return"calc("+this.$props.columnsDef.map(e=>typeof e.width=="number"?e.width+"px":e.width).join(" + ")+")"}},watch:{rowData:{handler(){if(this.selectionActive){this.selectionActive=!1;let e=window.getSelection();e.removeAllRanges(),e=null}setTimeout(()=>{console.log("updateVisibleItems"),this.$refs.scroller.updateVisibleItems(!0)},0)},deep:!0},timeFilterMode(e){this.onTimeModelChange(e.value)}},methods:{onScrollX(e){this.left=-e.target.scrollLeft+"px"},onTableClick(e){var s,i,o;if((o=(i=(s=e.target)==null?void 0:s.className)==null?void 0:i.includes)!=null&&o.call(i,"table-td")){this.selectionActive=!0;let t=window.getSelection();t.removeAllRanges();let l=document.createRange();l.selectNodeContents(e.target),t.addRange(l),t=l=null}},filterHex(e){return e===void 0?"":(e>=0?mt(e):e).toString().replace(/^(00)+/g,"")||"00"},update(e,s,i,o){Fe=i,Re=this.$props.rowData.length-o,this.$emit("updatePadding",{visibleStartIndex:i,visibleEndIndex:o})},searchInfo(){this.isOpenSearch=!1},onOpenSearch(){this.isOpenSearch=!0},scrollToBottom(){var e;(e=this.$refs.scroller)==null||e.scrollToItem(this.$props.rowData.length-1)},scrollToItem(e){var s;(s=this.$refs.scroller)==null||s.scrollToItem(e)},nativeScroll(){const e=this.$refs.scroller.$el;e.addEventListener("scroll",s=>{if(clearTimeout(this.$_scrollTimer),this.selectionActive){this.selectionActive=!1;let i=window.getSelection();i.removeAllRanges(),i=null}this.$_scrollTimer=setTimeout(()=>{console.log("updateVisibleItems"),this.$refs.scroller.updateVisibleItems(!0)},100)}),e.addEventListener("wheel",s=>{this.$emit("scrollAction",{topPadding:Fe,bottomPadding:Re}),s.deltaY>0||s.deltaX>0?Re<=40&&this.$emit("scrollRow","down"):(s.deltaY<0||s.deltaX<0)&&Fe<=40&&this.$emit("scrollRow","up")})},filterItem(e,s){this.filterChnItem=e,this.curId=s,this.$emit("filterItem"),this.selectFilterList=[],D.blfLogging.getFiltItems({selectItem:e,channel:"",canId:"",name:"",canType:"",dir:"",dlc:""}).then(i=>{let o=i.data.data;o.length>0&&o.forEach(t=>{t&&this.selectFilterList.push({value:t,label:t,selected:!1})})})},onChooseFilterItem(e,s){e.selected=!0,this.$emit("reDrawTable",e,s,this.selectFilterList)},onTimeModelChange(e){this.$emit("timeModeChange",e)}},mounted(){this.nativeScroll()}},Ce=e=>(j("data-v-bff57cb2"),e=e(),q(),e),Ja={style:{position:"absolute",left:"0",top:"0",right:"0",bottom:"0",display:"inherit","flex-direction":"inherit","align-items":"inherit"}},Qa={key:1,class:"o-pul-time-option-warp"},Za=Ce(()=>a("div",{class:"table-header",style:{height:"32px","line-height":"32px"}},null,-1)),en=["data-even"],tn=["onMousedown"],sn=["onMousedown"],ln=Ce(()=>a("span",{class:"container-tit",style:{width:"205px"}},"信号名",-1)),an=Ce(()=>a("span",{class:"container-tit",style:{width:"200px"}},"信号物理值",-1)),nn=Ce(()=>a("span",{class:"container-tit",style:{width:"80px"}},"HEX",-1)),on=Ce(()=>a("span",{class:"container-tit",style:{width:"calc(100vw - 487px)"}},"信号描述",-1)),rn=[ln,an,nn,on],dn={class:"table-parent-tr o-table-expand-child"},cn={class:"table-td",style:{width:"205px"}},hn={class:"table-td",style:{width:"200px"}},un={class:"table-td",style:{width:"80px"}},pn={class:"table-td",style:{width:"calc(100vw - 487px)"}};function mn(e,s,i,o,t,l){const n=w("FilterItem"),r=w("v-select"),d=w("RecycleScroller");return h(),u("div",{class:"table",onClick:s[2]||(s[2]=(...c)=>l.onTableClick&&l.onTableClick(...c))},[a("div",{class:"table-header",style:$({height:"32px",lineHeight:"32px",transform:"translateX("+t.left+")",width:l.fullWidth,position:"absolute",zIndex:1})},[a("div",Ja,[(h(!0),u(T,null,F(e.$props.columnsDef,(c,p)=>(h(),u("div",{class:"header-tit",key:p,style:$({width:c.width>0?c.width+"px":c.width})},[a("span",null,b(c.titName),1),c.filterShow?(h(),P(n,{key:0,onChange:f=>e.$emit("colFilterChange",{keyName:c.keyName,value:f}),col:c,asyncData:e.$props.columnsFilter},null,8,["onChange","col","asyncData"])):k("",!0),c.keyName=="timestamp"||c.keyName=="diff"||c.keyName=="deltaTime"?(h(),u("div",Qa,[g(r,{options:t.timeFilterOptions,clearable:!1,searchable:!1,label:"label",value:"value",modelValue:t.timeFilterMode,"onUpdate:modelValue":s[0]||(s[0]=f=>t.timeFilterMode=f),class:"canoe-frame-vselect"},null,8,["options","modelValue"])])):k("",!0)],4))),128))])],4),Za,g(d,{items:e.$props.rowData,"item-size":24,"key-field":"id",emitUpdate:!0,onUpdate:l.update,ref:"scroller",class:"frame-class"},{default:S(({item:c,index:p})=>[c.isParent?(h(),u("div",{key:0,class:ue(c.canId!="0"?"table-parent-tr":"table-parent-tr-error"),"data-even":p%2===0,style:$({transform:"translateX("+t.left+")",width:l.fullWidth})},[(h(!0),u(T,null,F(e.$props.columnsDef,f=>(h(),u("div",{class:"table-td",style:$({width:typeof f.width=="number"?f.width+"px":f.width}),key:f.keyName},[f.custom?(h(),u(T,{key:0},[c.isExpand&&c.isParent&&c.name?(h(),u("i",{key:0,class:"collapse-icon",onMousedown:A(y=>e.$emit("toggleExpand",p),["stop","prevent"])},null,40,tn)):k("",!0),c.isExpand===!1&&c.isParent&&c.name?(h(),u("i",{key:1,class:"expand-icon",onMousedown:A(y=>e.$emit("toggleExpand",p),["stop","prevent"])},null,40,sn)):k("",!0)],64)):(h(),u(T,{key:1},[C(b(f.displayMap?f.displayMap(c[f.keyName]):c[f.keyName]),1)],64))],4))),128))],14,en)):(h(),u(T,{key:1},[c.isChildTit?(h(),u("div",{key:0,class:"table-header o-table-expand-child",style:$({transform:"translateX("+t.left+")",width:l.fullWidth})},rn,4)):(h(),u("div",{key:1,class:"table-parent",style:$({transform:"translateX("+t.left+")",width:l.fullWidth})},[a("div",dn,[a("span",cn,b(c.name),1),a("span",hn,b(c.value),1),a("span",un,b(l.filterHex(c.hex)),1),a("span",pn,b(c.comment),1)])],4))],64))]),_:1},8,["items","onUpdate"]),a("div",{class:"table-scroll-x",onScroll:s[1]||(s[1]=(...c)=>l.onScrollX&&l.onScrollX(...c))},[a("div",{class:"table-scroll-x-bar",style:$({width:l.fullWidth})},null,4)],32)])}const fn=E(Ya,[["render",mn],["__scopeId","data-v-bff57cb2"]]);const gn={beforeMount(){console.log("this.params",this.params)},methods:{onExpand(){debugger;console.log("this.params.data",this.params.data),this.params.data.isExpand===!1?(this.params.node.setDataValue("isExpand",!0),this.params.api.applyTransactionAsync({add:[JSON.parse(this.params.data.parsedData)],addIndex:this.params.rowIndex+1})):(this.params.node.setDataValue("isExpand",!1),this.params.api.applyTransactionAsync({remove:this.params.api.getRowNode(this.params.rowIndex+1)})),this.params.api.redrawRows()}}};function bn(e,s,i,o,t,l){return h(),u("div",null,[e.params.data.isExpand?(h(),u("i",{key:0,class:"expand-icon",onClick:s[0]||(s[0]=(...n)=>l.onExpand&&l.onExpand(...n))})):(h(),u("i",{key:1,class:"collapse-icon",onClick:s[1]||(s[1]=(...n)=>l.onExpand&&l.onExpand(...n))})),a("span",null,b(e.params.value),1)])}const _n=E(gn,[["render",bn]]),yn={methods:{onClick(){debugger}}},wn=Ae('<table><thead class="o-table-thead"><tr><th class="o-table-cell">信号</th><th class="o-table-cell o-cell-ar">信号物理值</th><th class="o-table-cell o-cell-ar">信号描述</th></tr></thead><tbody class="o-table-tbody"></tbody></table>',1),vn=[wn];function Cn(e,s,i,o,t,l){return h(),u("div",{onClick:s[0]||(s[0]=(...n)=>l.onClick&&l.onClick(...n))},vn)}const kn=E(yn,[["render",Cn]]);let Ye=0,Je=0,ce=0,me=0,Te;const Sn={props:["store","closeFlag","recentTest","connectStatus","colFilterShow","channelOne","channelTwo","channelThree","linChannelVal","linChannelValTwo","filePath","dbcVal","startTime","sn","dbcChn","ldfChn","channelValList","linChannelValList"],emits:["updateBock","updateTimeData","recordTimeChange","startTimeChange","chartTableFun"],components:{Button:G,Message:Z,ScrollBar:ja,ExpandInfo:_n,FullWidthCellRenderer:kn,TableRecycleScroller:fn,CopyPath:pt,ButtonGroup:ve},data(){return{expandKeys:new Set,visibleStartIndex:0,visibleEndIndex:0,bottomPadding:0,recordLoading:!1,mode:"all",sliderValue:-1,comments:["","","","","","","","","","","","","","","",""],message:{visible:!1,level:"",content:""},seconds:0,timeFilterModeVal:"absolute",rowData:[],isRecording:!1,startSqlId:0,endSqlId:0,isLock:!1,isScrollEnd:!0,isAddData:!0,secondConfirm:!1,topLock:!1,bottomLock:!1,openFlag:!1,mlist:[{key:"lookRecord",name:"帧查看",icon:"box"},{key:"supeRecord",name:"图像查看",icon:"setting"}],cur:"lookRecord",recordShow:!0,colorList:["blue","cerulean","cyan","green","lime","purple","pink","red","orange","yellow"],columnsDef:[{titName:"",width:30,keyName:"id",type:"number",value:[],filterShow:!1,custom:!0},{titName:"",width:164,keyName:this.timeFilterModeVal==="diff"?this.mode==="single"?"deltaTime":"diff":"timestamp",type:"number",value:[],filterShow:!1,displayMap:e=>{let s=parseFloat(e);switch(this.timeFilterModeVal){case"diff":return s.toFixed(6);case"absolute":return new Date(s*1e3).toLocaleString("zh-Hans-CN",{hour:"2-digit",minute:"2-digit",second:"2-digit",fractionalSecondDigits:3,hourCycle:"h23",timeZone:"Asia/Shanghai"});case"relative":return(e-this.startTime).toFixed(6);default:return e}}},{titName:"Chn",width:60,keyName:"channel",type:"number",value:[],filterShow:!0},{titName:"ID",width:60,keyName:"canId",type:"number",value:[],filterShow:!0,displayMap:e=>"0x"+e.toString(16)},{titName:"NAME",width:200,keyName:"name",type:"string",value:[],filterShow:!0},{titName:"Event",width:80,keyName:"canType",type:"string",value:[],filterShow:!0},{titName:"Dir",width:60,keyName:"dir",type:"string",value:[],filterShow:!0},{titName:"Dlc",width:60,keyName:"dlc",type:"number",value:[],filterShow:!0},{titName:"DATA",width:1380,keyName:"data",type:"string",value:[],filterShow:!1,displayMap:e=>e.map(s=>s.toString(16).padStart(2,"0")).join(" ")}]}},watch:{mode(e,s){this.topPadding=0,this.$refs.table.scrollToItem(0),this.expandKeys.clear(),this.rowData=[],this.isRecording&&this.resumeScroll()},filePath(){this.$emit("updateBock",{filePath:this.filePath,dbcVal:this.dbcVal,recordLoading:this.recordLoading,isRecording:this.isRecording})},dbcVal(){this.$emit("updateBock",{filePath:this.filePath,dbcVal:this.dbcVal,recordLoading:this.recordLoading,isRecording:this.isRecording})},recordLoading(){this.$emit("updateBock",{filePath:this.filePath,dbcVal:this.dbcVal,recordLoading:this.recordLoading,isRecording:this.isRecording})},isRecording(){this.$emit("updateBock",{filePath:this.filePath,dbcVal:this.dbcVal,recordLoading:this.recordLoading,isRecording:this.isRecording})},colComputed(){this.columnsDef[1]={titName:"",width:164,keyName:this.timeFilterModeVal==="diff"?this.mode==="single"?"deltaTime":"diff":"timestamp",type:"number",value:[],filterShow:!1,displayMap:e=>{let s=parseFloat(e);switch(this.timeFilterModeVal){case"diff":return s.toFixed(6);case"absolute":return new Date(s*1e3).toLocaleString("zh-Hans-CN",{hour:"2-digit",minute:"2-digit",second:"2-digit",hourCycle:"h23",timeZone:"Asia/Shanghai"})+"."+s.toFixed(6).split(".")[1];case"relative":return(e-this.startTime).toFixed(6);default:return e}}}}},computed:{colComputed(){return this.timeFilterModeVal+this.startTime+this.mode},recordTime(){return console.log("recordTime223",qe(parseInt((this.seconds*1e3).toString().split(".")[0]))),qe(parseInt((this.seconds*1e3).toString().split(".")[0]))},showData(){let e={mode:"all"};return this.columnsDef.forEach(s=>{s.filterShow&&(e[s.keyName]=(s.value||[]).map(i=>i.value))}),e},diffRowData(){return this.rowData.map((e,s,i)=>({...e,diff:s===0?0:i[s].timestamp-i[s-1].timestamp}))}},methods:{choose(e){this.cur=e,e=="supeRecord"?this.recordShow=!1:this.recordShow=!0},async colFilter(e){var n;const s=e.keyName==="name"?null:"";let i={selectItem:e.keyName,...this.showData,[e.keyName]:s},o;try{o=await await D.blfLogging.getFiltItems(i)}catch(r){}return(((n=o==null?void 0:o.data)==null?void 0:n.data)||[]).map(r=>({value:r,label:e.keyName==="canId"?"0x"+r.toString(16):r===""?" 空":r})).sort((r,d)=>(e.type==="number"?+r.value>+d.value:r.value>d.value)?1:-1)},startRecord(e){clearInterval(me),this.checkHardware(e),this.isLock=!1,this.columnsDef=this.columnsDef.map(s=>({...s,value:[]}))},async endRecord(){this.recordLoading=!0,clearTimeout(ce),clearInterval(me),D.blfLogging.stopLogging(),await ht(2e3),this.isRecording=!1,this.recordLoading=!1},async checkHardware(e){this.recordLoading=!1,this.secondConfirm=!1,console.log("调检查并连接硬件设备接口"),clearInterval(me),this.isRecording=!0,this.startLogging(e),this.resumeScroll()},async startLogging(e){console.log("55666",e),this.seconds=0,this.rowData=[],this.$emit("startTimeChange",Date.now()/1e3),me=setInterval(()=>{this.seconds=Date.now()/1e3-this.startTime},1e3),this.$emit("recordTimeChange",this.recordTime);let s=["","","","","","","","","","","","","","","",""];this.channelValList.forEach((l,n)=>{s[n]=l.split("-").pop()}),console.log("this.dbcChn07101822",this.dbcChn,s);let o=this.filePath.replace(".blf","-"+$e()+".blf"),t=await D.blfLogging.startLogging({path:o,type:"blf",typelin:"asc",channel:3,sdb:this.dbcVal==="自定义模板"?"":this.dbcVal.split("/")[1],carType:this.dbcVal==="自定义模板"?"custom":this.dbcVal.split("/")[0],dbcChn:this.dbcChn,ldfChn:this.ldfChn,files:this.dbcVal==="自定义模板"?s:["","","","","","","","","","","","","","","",""],comments:this.comments,mode:e});console.log("startLoggin",t)},showMessage({level:e,content:s,timeout:i}){clearTimeout(Ye),e!=null&&(this.message.level=e),s!=null&&(this.message.content=s),this.message.visible=!0,i>0&&(Ye=setTimeout(()=>{this.message.visible=!1},i))},showLoggingMessage(){clearTimeout(ce),Te=async()=>{var i;this.showData.mode=this.mode;let e;try{e=await D.blfLogging.showLoggingMessage({...this.showData}),console.log("showLogginMsg",e)}catch(o){}if(this.$emit("chartTableFun",e.data.signal_data),console.log(e.data.signal_data,e.data,0x1ed6eb565788e400),!e)return;let s=((i=e==null?void 0:e.data)==null?void 0:i.frame_data)||[];if(!this.isLock&&(s==null?void 0:s.length)>0)if(this.mode==="all"){let o=s[0].sqlId,t=s[s.length-1].sqlId;s.forEach(l=>{l.isExpand=!1,l.isParent=!0,l.id=""+l.sqlId,l.canId=l.arbitrationId,delete l.arbitrationId}),this.startSqlId=o,this.endSqlId=t,Je=s[s.length-1].timestamp,this.rowData=s,this.$refs.table.scrollToBottom(),this.isAddData&&(this.sliderValue=o/t*(Je-this.startTime)*1e3)}else this.mode==="single"&&(s.forEach(o=>{o.isExpand=!1,o.isParent=!0,o.id=""+o.sqlId,o.canId=o.arbitrationId,delete o.arbitrationId}),s=s.sort((o,t)=>o.channel===t.channel?o.canId-t.canId:o.channel-t.channel),await this.drawExpandRows(s));this.$emit("updateTimeData",e.data.signal_data),this.isRecording?ce=setTimeout(()=>{requestAnimationFrame(Te)},500):clearTimeout(ce),this.$emit("recordTimeChange",this.recordTime)},Te()},async drawExpandRows(e){const s="-",i={};this.rowData.slice().sort((l,n)=>{const r=l.id,d=n.id;return!~r.indexOf(s)&&~d.indexOf(s)?-1:~r.indexOf(s)&&!~d.indexOf(s)?1:!~r.indexOf(s)&&!~d.indexOf(s)?l.channel<n.channel?-1:l.channel>n.channel?1:l.canId-n.canId:r>d?1:r<d?-1:0}),e.forEach(l=>{var r;const n=l.channel+"-"+l.canId;if(~l.id.indexOf(s))i[n].children.push(l);else{const d=((r=i[n])==null?void 0:r.children)||[];i[n]=l,i[n].children=this.expandKeys.has(n)?d:[]}});let o=this.rowData.slice();for(let l=this.visibleEndIndex;l>=this.visibleStartIndex;l--){if(!(o!=null&&o[l]))continue;let n=null,r=0;if(o[l].isParent)n=o[l],r=l;else if(l===this.visibleStartIndex){for(let d=l;d>=0;d--)if(o[d].isParent){n=o[d],r=d;break}}if(n){const d=n.channel+"-"+n.canId;if(this.expandKeys.has(d)){const c=await this.onToggleExpand(r,o,!0);c!=null&&c.length&&(i[d].children=c)}}}const t=[];for(let l in i){const n=i[l],r=n.children;delete n.children,r.length&&(n.isExpand=!0),t.push(n),r.forEach(d=>{t.push(d)})}this.rowData=t},getSelectData(e){let s="",i="",o="",t="";switch(e){case"up":t=this.startSqlId;break;case"down":o=this.endSqlId;break;case"pick":clearTimeout(ce),s=this.sliderValue/1e3+this.startTime;break}D.blfLogging.selectData({moreThanTimeStamp:s,lessThanTimeStamp:i,moreThanSqlID:o,lessThanSqlID:t,...this.showData,sqlId:"",numbers:100}).then(l=>{var n,r;if(((r=(n=l==null?void 0:l.data)==null?void 0:n.data)==null?void 0:r.length)>0){let d=l.data.data;switch(d.forEach(c=>{c.isExpand=!1,c.isParent=!0,c.id=c.sqlId,c.canId=c.arbitrationId,delete c.arbitrationId}),e){case"up":this.rowData=d.concat(...this.rowData),this.$refs.table.scrollToItem(l.data.data.length-1),this.sliderValue=(l.data.data[0].timestamp-this.startTime)*1e3,l.data.startSqlId&&(this.startSqlId=l.data.startSqlId);break;case"down":this.rowData=this.rowData.concat(...d),l.data.endSqlId&&(this.endSqlId=l.data.endSqlId);break;case"pick":this.startSqlId=l.data.startSqlId,this.endSqlId=l.data.endSqlId,this.rowData=d,this.sliderValue=(l.data.data[0].timestamp-this.startTime)*1e3;break}}}).finally(()=>{this.topLock=!1,this.bottomLock=!1})},onUpdatePadding(e){this.visibleStartIndex=e.visibleStartIndex,this.visibleEndIndex=e.visibleEndIndex},onTimeModeChange(e){this.timeFilterModeVal=e},onScrollAction(e){this.isLock||(this.mode==="all"?this.isLock=!0:this.isLock=!1,this.isScrollEnd=!1)},onBodyScrollEnd(e){this.mode!=="single"&&(e==="up"&&this.topLock===!1&&(this.topLock=!0,this.getSelectData(e)),e==="down"&&this.bottomLock===!1&&(this.bottomLock=!0,this.getSelectData(e)))},onClicked(){this.isLock=!1,this.isScrollEnd=!1},resumeScroll(){this.isScrollEnd=!0,this.isAddData=!0,this.isLock=!1,this.showLoggingMessage()},async onToggleExpand(e,s,i){const o=s.map(n=>({...n})),t=o[e],l=t.channel+"-"+t.canId;if(i||!t.isExpand){this.expandKeys.add(l);const n=await D.blfLogging.parsedSignal({channel:t.channel,canId:""+t.canId,canData:(t.data||[]).map(c=>c.toString(16))});let r=(n==null?void 0:n.data.sort((c,p)=>c.name<p.name?-1:1))||[],d=t.sqlId;if(r.forEach((c,p)=>{c.channel=t.channel,c.canId=""+t.canId,c.isParent=!1,c.isExpand=!0,c.isChildTit=!1,c.id=d+"-"+c.name}),r.unshift({channel:t.channel,canId:""+t.canId,isParent:!1,isExpand:!0,isChildTit:!0,id:d+"-"}),o.splice(e+1,0,...r),t.isExpand=r.length,i)return r;this.rowData=o}else this.expandKeys.delete(l),o.splice(e+1,o[e].isExpand),o[e].isExpand=!1,this.rowData=o},onSliderChange(e){this.isScrollEnd=!1,this.isAddData=!1,this.mode==="all"?this.isLock=!0:this.isLock=!1,this.getSelectData("pick")},onFilterItem(){this.openFlag=!this.openFlag},onColFilterChange(e){let s=this.columnsDef.find(i=>e.keyName===i.keyName);s&&(s.value=e.value),this.resumeScroll()}},mounted(){},unmounted(){Te=null,clearTimeout(ce),clearInterval(me)}},pe=e=>(j("data-v-dee93b70"),e=e(),q(),e),Tn={class:"o-pul-er"},Dn={key:0},Vn=pe(()=>a("div",{class:"o-pul-title"},"报文录制配置",-1)),xn={class:"o-pul-p-wrap"},In={class:"o-pul-p"},Ln={class:"record-header-message"},Fn=pe(()=>a("b",null,"车型/DBC：",-1)),Rn=["v-tooltip"],Mn=pe(()=>a("b",null,"保存目录：",-1)),En=[Mn],$n={class:"o-pul-path"},An={class:"o-pul-p-wrap",style:{"flex-wrap":"wrap"}},Nn={class:"record-header-message",style:{width:"20vw"}},On={class:"o-pul-btn-wrap"},Pn=pe(()=>a("div",{class:"tool-btn-wrap"},[a("i",{class:"warn-icon"}),a("div",{class:"tool-picker-contianer-wrap"},"录制将覆盖文件,确认要开始录制吗?")],-1)),Un=pe(()=>a("div",{class:"tool-picker-arrow"},null,-1)),Hn={class:"tool-picker-footer-wrap"},Bn={class:"o-dialog-footer"},jn=pe(()=>a("div",{class:"o-pul-hr"},null,-1)),qn={class:"o-table-wrap"};function zn(e,s,i,o,t,l){const n=w("CopyPath"),r=w("Button"),d=w("ButtonGroup"),c=w("ScrollBar"),p=w("TableRecycleScroller"),f=w("Message"),y=H("tooltip"),M=H("esc");return h(),u(T,null,[a("div",Tn,[t.recordShow?(h(),u("div",Dn,[Vn,a("div",xn,[a("div",In,[a("span",Ln,[Fn,C(b(i.dbcVal),1)]),a("span",{class:"record-header-message",style:{width:"71px"},"v-tooltip":i.filePath},En,8,Rn),a("span",$n,[g(n,{path:i.filePath,length:60,full:!0},null,8,["path"])])])]),a("div",An,[(h(!0),u(T,null,F(i.channelValList,(L,z)=>(h(),u("div",{class:"o-pul-p",key:z},[v((h(),u("span",Nn,[a("b",null,"CAN通道"+b(z+1)+"：",1),C(b(L),1)])),[[y,L]])]))),128))]),a("div",On,[t.secondConfirm?v((h(),u("div",{key:0,class:"tool-picker-wrap",onClick:s[1]||(s[1]=A(()=>{},["stop"]))},[Pn,Un,a("div",Hn,[a("div",Bn,[g(r,{class:"small-btn",style:{width:"30px"},onClick:s[0]||(s[0]=A(L=>t.secondConfirm=!1,["stop"]))},{default:S(()=>[C("取消")]),_:1}),g(r,{class:"small-btn",type:"primary",style:{width:"30px",margin:"0 0 0 10px"},onClick:A(l.checkHardware,["stop"])},{default:S(()=>[C("确定")]),_:1},8,["onClick"])])])])),[[M,()=>e.$emit("cancel")]]):k("",!0),C("   "),g(d,{options:[{label:"普通",value:"all"},{label:"单帧",value:"single"}],class:"theme-btn-group",modelValue:t.mode,"onUpdate:modelValue":s[2]||(s[2]=L=>t.mode=L)},null,8,["modelValue"])]),jn,a("div",qn,[g(c,{modelValue:t.sliderValue,"onUpdate:modelValue":s[3]||(s[3]=L=>t.sliderValue=L),disable:t.mode!=="all",startTime:i.startTime*1e3,start:0,end:t.seconds*1e3,onChange:l.onSliderChange,timeFilter:t.timeFilterModeVal!="relative"?"absolute":"relative"},null,8,["modelValue","disable","startTime","end","onChange","timeFilter"]),g(p,{rowData:l.diffRowData,filters:l.showData,columnsDef:t.columnsDef,onToggleExpand:s[4]||(s[4]=L=>l.onToggleExpand(L,t.rowData)),onScrollRow:l.onBodyScrollEnd,onScrollAction:l.onScrollAction,onFilterItem:l.onFilterItem,onClick:l.onClicked,columnsFilter:l.colFilter,openFlag:t.openFlag,onColFilterChange:l.onColFilterChange,ref:"table",onUpdatePadding:l.onUpdatePadding,onTimeModeChange:l.onTimeModeChange,style:{height:"100%"}},null,8,["rowData","filters","columnsDef","onScrollRow","onScrollAction","onFilterItem","onClick","columnsFilter","openFlag","onColFilterChange","onUpdatePadding","onTimeModeChange"]),v(a("div",{class:"scrollToBottomBtn",onClick:s[5]||(s[5]=A(L=>l.resumeScroll(),["stop"]))},null,512),[[U,t.isLock&&t.mode==="all"],[y,"恢复向下滚动",void 0,{left:!0}]])])])):k("",!0)]),g(f,{message:t.message},null,8,["message"])],64)}const Kn=E(Sn,[["render",zn],["__scopeId","data-v-dee93b70"]]);let De;const Wn={name:"ScrollBar",props:["modelValue","start","end","disable","timeFilter","startTime"],emits:["update:modelValue","change"],data(){return{lineTop:0,scrollTop:0,lineTitle:"",scrollTitle:"",lineVisible:!1,dragging:!1,dragHover:!1}},methods:{enterHandler(){this.dragging||(this.lineVisible=!0)},leaveHandler(){this.lineVisible=!1},moveHandler(e){this.lineVisible&&(e.offsetY<0||e.offsetY>=this.$refs.root.clientHeight-28||(this.lineTop=e.offsetY,this.lineTitle=this.tooltipFormatter(this.$props.start+(this.$props.end-this.$props.start)*e.offsetY/(this.$refs.root.clientHeight-28))))},clickHandler(e){this.scrollTop=e.offsetY;const s=this.$props.start+(this.$props.end-this.$props.start)*this.scrollTop/(this.$refs.root.clientHeight-28);this.$emit("update:modelValue",s),this.$emit("change",s)},tooltipFormatter(e){return parseInt(e)/1e3},timeStrFilter(e){return this.$props.timeFilter==="absolute"?new Date(e*1e3+(this.$props.startTime||0)).toLocaleString("zh-Hans-CN",{hour:"2-digit",minute:"2-digit",second:"2-digit",fractionalSecondDigits:3,hourCycle:"h23",timeZone:"Asia/Shanghai"}):e},blockDownHandler(){this.dragging=!0,De=void 0},blockUphandler(){if(this.dragging){this.dragging=!1;const e=this.$props.start+(this.$props.end-this.$props.start)*this.scrollTop/(this.$refs.root.clientHeight-28);this.$emit("update:modelValue",e),this.$emit("change",e)}},blockLeaveHandler(){this.enterHandler(),this.dragHover=!1},blockEnterHandler(){this.leaveHandler(),this.dragHover=!0},blockMoveHandler(e){if(this.dragging){let s=0;De!=null&&(s=e.pageY-De),De=e.pageY,console.log("move",e.pageY);let i=this.scrollTop+s;const o=this.$refs.root.clientHeight;if(i<0){if(this.scrollTop===0)return;i=0}else if(i>o-28){if(this.scrollTop===o-28)return;i=o-28}this.scrollTop=i,this.scrollTitle=this.tooltipFormatter(this.$props.start+(this.$props.end-this.$props.start)*this.scrollTop/(this.$refs.root.clientHeight-28))}}},watch:{modelValue(e){if(this.dragging)return;let s=(e-this.$props.start)/(this.$props.end-this.$props.start);this.scrollTop=parseInt(s*(this.$refs.root.clientHeight-28)),this.scrollTitle=this.tooltipFormatter(e),this.dragging=!1,this.dragHover=!1},end(e){if(this.dragging)return;let s=(this.$props.modelValue-this.$props.start)/(this.$props.end-this.$props.start);this.scrollTop=parseInt(s*(this.$refs.root.clientHeight-28))}},mounted(){window.addEventListener("mouseup",this.blockUphandler),window.addEventListener("mousemove",this.blockMoveHandler)},unmounted(){window.removeEventListener("mouseup",this.blockUphandler),window.removeEventListener("mousemove",this.blockMoveHandler)}},Gn=["data-disable"],Xn=["data-active"],Yn={class:"block-title"},Jn={class:"line-title"},Qn=["data-active"];function Zn(e,s,i,o,t,l){return h(),u("div",{class:"bar-er","data-disable":e.$props.disable,ref:"root",onClick:s[5]||(s[5]=A((...n)=>l.clickHandler&&l.clickHandler(...n),["prevent","stop"])),onMousemove:s[6]||(s[6]=(...n)=>l.moveHandler&&l.moveHandler(...n)),onMouseenter:s[7]||(s[7]=(...n)=>l.enterHandler&&l.enterHandler(...n)),onMouseleave:s[8]||(s[8]=(...n)=>l.leaveHandler&&l.leaveHandler(...n))},[a("div",{class:"bar-block","data-active":t.dragging,onClick:s[0]||(s[0]=A(()=>{},["prevent","stop"])),onMousedown:s[1]||(s[1]=(...n)=>l.blockDownHandler&&l.blockDownHandler(...n)),onMouseup:s[2]||(s[2]=(...n)=>l.blockUphandler&&l.blockUphandler(...n)),onMouseleave:s[3]||(s[3]=(...n)=>l.blockLeaveHandler&&l.blockLeaveHandler(...n)),onMouseenter:s[4]||(s[4]=(...n)=>l.blockEnterHandler&&l.blockEnterHandler(...n)),style:$({transform:"translateY("+t.scrollTop+"px)"})},[a("div",Yn,b(l.timeStrFilter(t.scrollTitle)),1)],44,Xn),v(a("div",{class:"bar-line",style:$({transform:"translateY("+t.lineTop+"px)"})},[a("div",Jn,b(l.timeStrFilter(t.lineTitle)),1)],4),[[U,t.lineVisible]]),a("div",{class:"scroll-title","data-active":t.dragging},b(l.timeStrFilter(t.scrollTitle)),9,Qn)],40,Gn)}const eo=E(Wn,[["render",Zn],["__scopeId","data-v-1c63ae6b"]]);const to={props:["col","asyncData"],emits:["change"],data(){return{options:[],loading:!1,current:[]}},methods:{async onMouseEnter(){this.loading=!0,this.options=[];try{this.options=await this.$props.asyncData(this.$props.col)}catch(e){}this.loading=!1},onModelValueChange(e){this.current=e,this.$emit("change",e)}},watch:{col:{handler(e){this.current=e.value},deep:!0}}},so=e=>(j("data-v-0c66c0da"),e=e(),q(),e),lo=["data-active"],io=so(()=>a("div",null,null,-1));function ao(e,s,i,o,t,l){var r;const n=w("v-select");return h(),u("div",{class:"select-icon","data-active":((r=t.current)==null?void 0:r.length)>0,onMouseenter:s[0]||(s[0]=(...d)=>l.onMouseEnter&&l.onMouseEnter(...d))},[a("div",{class:"flt-er",style:$({width:e.$props.col.width+40+"px"})},[g(n,{loading:t.loading,options:t.options,dropdownShouldOpen:()=>!0,searchable:!0,modelValue:t.current,"onUpdate:modelValue":l.onModelValueChange,multiple:""},{"no-options":S(()=>[io]),_:1},8,["loading","options","modelValue","onUpdate:modelValue"])],4)],40,lo)}const no=E(to,[["render",ao],["__scopeId","data-v-0c66c0da"]]);let Me=0,Ee=0;const oo={props:["rowData","columnsDef","columnsFilter","from","filters"],emits:["toggleExpand","scrollRow","scrollAction","filterItem","colFilterChange","updatePadding","timeModeChange"],components:{RecycleScroller:he,FilterItem:no},created(){this.$_scrollTimer=0},data(){return{isChildTit:!1,searchVal:"",isOpenSearch:!1,selectFilterList:[],showSelect:!1,curId:-1,filterChnItem:"",filterValItem:"",formData:{},filterList:{channel:"",canId:"",name:"",canType:"",dir:"",dlc:""},left:0,timeFilterOptions:[{label:"Time 绝对时间",value:"absolute"},{label:"Time 相对时间",value:"relative"},{label:"ΔTime 时间差",value:"diff"}],timeFilterMode:{label:"Time 绝对时间",value:"absolute"},selectionActive:!1}},computed:{fullWidth(){return"calc("+this.$props.columnsDef.map(e=>typeof e.width=="number"?e.width+"px":e.width).join(" + ")+")"}},watch:{rowData:{handler(){if(this.selectionActive){this.selectionActive=!1;let e=window.getSelection();e.removeAllRanges(),e=null}setTimeout(()=>{console.log("updateVisibleItems"),this.$refs.scroller.updateVisibleItems(!0)},0)},deep:!0},timeFilterMode(e){this.onTimeModelChange(e.value)}},methods:{onScrollX(e){this.left=-e.target.scrollLeft+"px"},onTableClick(e){var s,i,o;if((o=(i=(s=e.target)==null?void 0:s.className)==null?void 0:i.includes)!=null&&o.call(i,"table-td")){this.selectionActive=!0;let t=window.getSelection();t.removeAllRanges();let l=document.createRange();l.selectNodeContents(e.target),t.addRange(l),t=l=null}},filterHex(e){return e===void 0?"":(e>=0?mt(e):e).toString().replace(/^(00)+/g,"")||"00"},update(e,s,i,o){Me=i,Ee=this.$props.rowData.length-o,this.$emit("updatePadding",{visibleStartIndex:i,visibleEndIndex:o})},searchInfo(){this.isOpenSearch=!1},onOpenSearch(){this.isOpenSearch=!0},scrollToBottom(){var e;(e=this.$refs.scroller)==null||e.scrollToItem(this.$props.rowData.length-1)},scrollToItem(e){var s;(s=this.$refs.scroller)==null||s.scrollToItem(e)},nativeScroll(){const e=this.$refs.scroller.$el;e.addEventListener("scroll",s=>{if(clearTimeout(this.$_scrollTimer),this.selectionActive){this.selectionActive=!1;let i=window.getSelection();i.removeAllRanges(),i=null}this.$_scrollTimer=setTimeout(()=>{console.log("updateVisibleItems"),this.$refs.scroller.updateVisibleItems(!0)},100)}),e.addEventListener("wheel",s=>{this.$emit("scrollAction",{topPadding:Me,bottomPadding:Ee}),s.deltaY>0||s.deltaX>0?Ee<=40&&this.$emit("scrollRow","down"):(s.deltaY<0||s.deltaX<0)&&Me<=40&&this.$emit("scrollRow","up")})},filterItem(e,s){this.filterChnItem=e,this.curId=s,this.$emit("filterItem"),this.selectFilterList=[],D.blfLogging.getFiltItems({selectItem:e,channel:"",canId:"",name:"",canType:"",dir:"",dlc:""}).then(i=>{let o=i.data.data;o.length>0&&o.forEach(t=>{t&&this.selectFilterList.push({value:t,label:t,selected:!1})})})},onChooseFilterItem(e,s){e.selected=!0,this.$emit("reDrawTable",e,s,this.selectFilterList)},onTimeModelChange(e){this.$emit("timeModeChange",e)}},mounted(){this.nativeScroll()}},ke=e=>(j("data-v-906464b1"),e=e(),q(),e),ro={style:{position:"absolute",left:"0",top:"0",right:"0",bottom:"0",display:"inherit","flex-direction":"inherit","align-items":"inherit"}},co={key:1,class:"o-pul-time-option-warp"},ho=ke(()=>a("div",{class:"table-header",style:{height:"32px","line-height":"32px"}},null,-1)),uo=["data-even"],po=["onMousedown"],mo=["onMousedown"],fo=ke(()=>a("span",{class:"container-tit",style:{width:"205px"}},"信号名",-1)),go=ke(()=>a("span",{class:"container-tit",style:{width:"200px"}},"信号物理值",-1)),bo=ke(()=>a("span",{class:"container-tit",style:{width:"80px"}},"HEX",-1)),_o=ke(()=>a("span",{class:"container-tit",style:{width:"calc(100vw - 487px)"}},"信号描述",-1)),yo=[fo,go,bo,_o],wo={class:"table-parent-tr o-table-expand-child"},vo={class:"table-td",style:{width:"205px"}},Co={class:"table-td",style:{width:"200px"}},ko={class:"table-td",style:{width:"80px"}},So={class:"table-td",style:{width:"calc(100vw - 487px)"}};function To(e,s,i,o,t,l){const n=w("FilterItem"),r=w("v-select"),d=w("RecycleScroller");return h(),u("div",{class:"table",onClick:s[2]||(s[2]=(...c)=>l.onTableClick&&l.onTableClick(...c))},[a("div",{class:"table-header",style:$({height:"32px",lineHeight:"32px",transform:"translateX("+t.left+")",width:l.fullWidth,position:"absolute",zIndex:1})},[a("div",ro,[(h(!0),u(T,null,F(e.$props.columnsDef,(c,p)=>(h(),u("div",{class:"header-tit",key:p,style:$({width:c.width>0?c.width+"px":c.width})},[a("span",null,b(c.titName),1),c.filterShow?(h(),P(n,{key:0,onChange:f=>e.$emit("colFilterChange",{keyName:c.keyName,value:f}),col:c,asyncData:e.$props.columnsFilter},null,8,["onChange","col","asyncData"])):k("",!0),c.keyName=="timestamp"||c.keyName=="diff"||c.keyName=="deltaTime"?(h(),u("div",co,[g(r,{options:t.timeFilterOptions,clearable:!1,searchable:!1,label:"label",value:"value",modelValue:t.timeFilterMode,"onUpdate:modelValue":s[0]||(s[0]=f=>t.timeFilterMode=f),class:"canoe-frame-vselect"},null,8,["options","modelValue"])])):k("",!0)],4))),128))])],4),ho,g(d,{items:e.$props.rowData,"item-size":24,"key-field":"id",emitUpdate:!0,onUpdate:l.update,ref:"scroller",class:"frame-class"},{default:S(({item:c,index:p})=>[c.isParent?(h(),u("div",{key:0,class:"table-parent-tr","data-even":p%2===0,style:$({transform:"translateX("+t.left+")",width:l.fullWidth})},[(h(!0),u(T,null,F(e.$props.columnsDef,f=>(h(),u("div",{class:"table-td",style:$({width:typeof f.width=="number"?f.width+"px":f.width}),key:f.keyName},[f.custom?(h(),u(T,{key:0},[c.isExpand&&c.isParent&&c.name?(h(),u("i",{key:0,class:"collapse-icon",onMousedown:A(y=>e.$emit("toggleExpand",p),["stop","prevent"])},null,40,po)):k("",!0),c.isExpand===!1&&c.isParent&&c.name?(h(),u("i",{key:1,class:"expand-icon",onMousedown:A(y=>e.$emit("toggleExpand",p),["stop","prevent"])},null,40,mo)):k("",!0)],64)):(h(),u(T,{key:1},[C(b(f.displayMap?f.displayMap(c[f.keyName]):c[f.keyName]),1)],64))],4))),128))],12,uo)):(h(),u(T,{key:1},[c.isChildTit?(h(),u("div",{key:0,class:"table-header o-table-expand-child",style:$({transform:"translateX("+t.left+")",width:l.fullWidth})},yo,4)):(h(),u("div",{key:1,class:"table-parent",style:$({transform:"translateX("+t.left+")",width:l.fullWidth})},[a("div",wo,[a("span",vo,b(c.name),1),a("span",Co,b(c.value),1),a("span",ko,b(l.filterHex(c.hex)),1),a("span",So,b(c.comment),1)])],4))],64))]),_:1},8,["items","onUpdate"]),a("div",{class:"table-scroll-x",onScroll:s[1]||(s[1]=(...c)=>l.onScrollX&&l.onScrollX(...c))},[a("div",{class:"table-scroll-x-bar",style:$({width:l.fullWidth})},null,4)],32)])}const Do=E(oo,[["render",To],["__scopeId","data-v-906464b1"]]);const Vo={beforeMount(){console.log("this.params",this.params)},methods:{onExpand(){debugger;console.log("this.params.data",this.params.data),this.params.data.isExpand===!1?(this.params.node.setDataValue("isExpand",!0),this.params.api.applyTransactionAsync({add:[JSON.parse(this.params.data.parsedData)],addIndex:this.params.rowIndex+1})):(this.params.node.setDataValue("isExpand",!1),this.params.api.applyTransactionAsync({remove:this.params.api.getRowNode(this.params.rowIndex+1)})),this.params.api.redrawRows()}}};function xo(e,s,i,o,t,l){return h(),u("div",null,[e.params.data.isExpand?(h(),u("i",{key:0,class:"expand-icon",onClick:s[0]||(s[0]=(...n)=>l.onExpand&&l.onExpand(...n))})):(h(),u("i",{key:1,class:"collapse-icon",onClick:s[1]||(s[1]=(...n)=>l.onExpand&&l.onExpand(...n))})),a("span",null,b(e.params.value),1)])}const Io=E(Vo,[["render",xo]]),Lo={methods:{onClick(){debugger}}},Fo=Ae('<table><thead class="o-table-thead"><tr><th class="o-table-cell">信号</th><th class="o-table-cell o-cell-ar">信号物理值</th><th class="o-table-cell o-cell-ar">信号描述</th></tr></thead><tbody class="o-table-tbody"></tbody></table>',1),Ro=[Fo];function Mo(e,s,i,o,t,l){return h(),u("div",{onClick:s[0]||(s[0]=(...n)=>l.onClick&&l.onClick(...n))},Ro)}const Eo=E(Lo,[["render",Mo]]);let Qe=0,Ze=0,fe=0,Ve=0,xe;const $o={props:["store","closeFlag","recentTest","connectStatus","colFilterShow","channelOne","channelTwo","channelThree","linChannelVal","linChannelValTwo","filePath","dbcVal","startTime"],emits:["updateBock","updateTimeData","recordTimeChange","startTimeChange"],components:{Button:G,Message:Z,ScrollBar:eo,ExpandInfo:Io,FullWidthCellRenderer:Eo,TableRecycleScroller:Do,CopyPath:pt,ButtonGroup:ve},data(){return{expandKeys:new Set,visibleStartIndex:0,visibleEndIndex:0,bottomPadding:0,recordLoading:!1,mode:"all",sliderValue:-1,comments:["","","","","","","","","","","","","","","",""],message:{visible:!1,level:"",content:""},seconds:0,timeFilterModeVal:"absolute",rowData:[],isRecording:!1,startSqlId:0,endSqlId:0,isLock:!1,isScrollEnd:!0,isAddData:!0,secondConfirm:!1,topLock:!1,bottomLock:!1,openFlag:!1,mlist:[{key:"lookRecord",name:"帧查看",icon:"box"},{key:"supeRecord",name:"图像查看",icon:"setting"}],cur:"lookRecord",recordShow:!0,colorList:["blue","cerulean","cyan","green","lime","purple","pink","red","orange","yellow"],columnsDef:[{titName:"",width:30,keyName:"id",type:"number",value:[],filterShow:!1,custom:!0},{titName:"",width:164,keyName:this.timeFilterModeVal==="diff"?this.mode==="single"?"deltaTime":"diff":"timestamp",type:"number",value:[],filterShow:!1,displayMap:e=>{let s=parseFloat(e);switch(this.timeFilterModeVal){case"diff":return s.toFixed(6);case"absolute":return new Date(s*1e3).toLocaleString("zh-Hans-CN",{hour:"2-digit",minute:"2-digit",second:"2-digit",fractionalSecondDigits:3,hourCycle:"h23",timeZone:"Asia/Shanghai"});case"relative":return(e-this.startTime).toFixed(6);default:return e}}},{titName:"Chn",width:60,keyName:"channel",type:"number",value:[],filterShow:!0},{titName:"ID",width:60,keyName:"linId",type:"number",value:[],filterShow:!0,displayMap:e=>"0x"+e.toString(16)},{titName:"NAME",width:200,keyName:"name",type:"string",value:[],filterShow:!0},{titName:"checksum",width:80,keyName:"checksum",type:"string",value:[],filterShow:!1,displayMap:e=>"0x"+e.toString(16)},{titName:"Dir",width:60,keyName:"dir",type:"string",value:[],filterShow:!0},{titName:"Dlc",width:60,keyName:"dlc",type:"number",value:[],filterShow:!0},{titName:"DATA",width:1380,keyName:"data",type:"string",value:[],filterShow:!1,displayMap:e=>e.map(s=>s.toString(16).padStart(2,"0")).join(" ")}]}},watch:{mode(e,s){this.topPadding=0,this.$refs.table.scrollToItem(0),this.expandKeys.clear(),this.rowData=[],this.isRecording&&this.resumeScroll()},filePath(){this.$emit("updateBock",{filePath:this.filePath,dbcVal:this.dbcVal,recordLoading:this.recordLoading,isRecording:this.isRecording})},dbcVal(){this.$emit("updateBock",{filePath:this.filePath,dbcVal:this.dbcVal,recordLoading:this.recordLoading,isRecording:this.isRecording})},recordLoading(){this.$emit("updateBock",{filePath:this.filePath,dbcVal:this.dbcVal,recordLoading:this.recordLoading,isRecording:this.isRecording})},isRecording(){this.$emit("updateBock",{filePath:this.filePath,dbcVal:this.dbcVal,recordLoading:this.recordLoading,isRecording:this.isRecording})},colComputed(){this.columnsDef[1]={titName:"",width:164,keyName:this.timeFilterModeVal==="diff"?this.mode==="single"?"deltaTime":"diff":"timestamp",type:"number",value:[],filterShow:!1,displayMap:e=>{let s=parseFloat(e);switch(this.timeFilterModeVal){case"diff":return s.toFixed(6);case"absolute":return new Date(s*1e3).toLocaleString("zh-Hans-CN",{hour:"2-digit",minute:"2-digit",second:"2-digit",hourCycle:"h23",timeZone:"Asia/Shanghai"})+"."+s.toFixed(6).split(".")[1];case"relative":return(e-this.startTime).toFixed(6);default:return e}}}}},computed:{colComputed(){return this.timeFilterModeVal+this.startTime+this.mode},recordTime(){return new Date(0,0,0,0,0,this.seconds).toLocaleTimeString()},showData(){let e={mode:"all"};return this.columnsDef.forEach(s=>{s.filterShow&&(e[s.keyName]=(s.value||[]).map(i=>i.value))}),e},diffRowData(){return this.rowData.map((e,s,i)=>({...e,diff:s===0?0:i[s].timestamp-i[s-1].timestamp}))}},methods:{choose(e){this.cur=e,e=="supeRecord"?this.recordShow=!1:this.recordShow=!0},async colFilter(e){var n;console.log("col111",e);const s=e.keyName==="name"?null:"";let i={selectItem:e.keyName,...this.showData,[e.keyName]:s};console.log("params222",i);let o;try{o=await await D.blfLogging.getFiltItemsLin(i)}catch(r){}return(((n=o==null?void 0:o.data)==null?void 0:n.data)||[]).map(r=>({value:r,label:e.keyName==="linId"?"0x"+r.toString(16):r===""?" 空":r})).sort((r,d)=>(e.type==="number"?+r.value>+d.value:r.value>d.value)?1:-1)},startRecord(){clearInterval(Ve),this.checkHardware(),this.isLock=!1,this.columnsDef=this.columnsDef.map(e=>({...e,value:[]}))},async checkHardware(){this.recordLoading=!1,this.secondConfirm=!1,clearInterval(Ve),this.isRecording=!0,this.resumeScroll()},async startLogging(){this.seconds=0,this.rowData=[],this.$emit("startTimeChange",Date.now()/1e3),Ve=setInterval(()=>{this.seconds=Date.now()/1e3-this.startTime},1e3),this.$emit("recordTimeChange",this.recordTime),parseInt(this.channelOne),parseInt(this.channelTwo),parseInt(this.channelThree),parseInt(this.linChannelVal),parseInt(this.linChannelValTwo),this.channelOne.split("-").pop(),this.channelTwo.split("-").pop(),this.channelThree.split("-").pop();let s=this.filePath.replace(".blf","-"+$e()+".blf");console.log(s)},showMessage({level:e,content:s,timeout:i}){clearTimeout(Qe),e!=null&&(this.message.level=e),s!=null&&(this.message.content=s),this.message.visible=!0,i>0&&(Qe=setTimeout(()=>{this.message.visible=!1},i))},showLoggingMessage(){console.log("23333"),clearTimeout(fe),xe=async()=>{var i;this.showData.mode=this.mode;let e;try{e=await D.blfLogging.showLoggingMessageLin({...this.showData})}catch(o){}if(!e)return;let s=((i=e==null?void 0:e.data)==null?void 0:i.frame_data)||[];if(console.log("eventData",s),!this.isLock&&(s==null?void 0:s.length)>0)if(this.mode==="all"){let o=s[0].sqlId,t=s[s.length-1].sqlId;s.forEach(l=>{l.isExpand=!1,l.isParent=!0,l.id=""+l.sqlId,l.canId=l.arbitrationId,delete l.arbitrationId}),this.startSqlId=o,this.endSqlId=t,Ze=s[s.length-1].timestamp,this.rowData=s,this.$refs.table.scrollToBottom(),this.isAddData&&(this.sliderValue=o/t*(Ze-this.startTime)*1e3)}else this.mode==="single"&&(s.forEach(o=>{console.log("ele111",o),o.isExpand=!1,o.isParent=!0,o.id=""+o.sqlId,o.canId=o.arbitrationId,delete o.arbitrationId}),s=s.sort((o,t)=>o.channel===t.channel?o.linId-t.linId:o.channel-t.channel),console.log("finevent",s),await this.drawExpandRows(s),this.rowData=s);this.$emit("updateTimeData",e.data.signal_data),this.isRecording?fe=setTimeout(()=>{requestAnimationFrame(xe)},400):clearTimeout(fe),this.$emit("recordTimeChange",this.recordTime)},xe()},async drawExpandRows(e){const s="-",i={};console.log("1233event"),this.rowData.slice().sort((l,n)=>{const r=l.id,d=n.id;return!~r.indexOf(s)&&~d.indexOf(s)?-1:~r.indexOf(s)&&!~d.indexOf(s)?1:!~r.indexOf(s)&&!~d.indexOf(s)?l.channel<n.channel?-1:l.channel>n.channel?1:l.canId-n.canId:r>d?1:r<d?-1:0}),e.forEach(l=>{var r;const n=l.channel+"-"+l.canId;if(~l.id.indexOf(s))i[n].children.push(l);else{const d=((r=i[n])==null?void 0:r.children)||[];i[n]=l,i[n].children=this.expandKeys.has(n)?d:[]}});let o=this.rowData.slice();for(let l=this.visibleEndIndex;l>=this.visibleStartIndex;l--){if(!(o!=null&&o[l]))continue;let n=null,r=0;if(o[l].isParent)n=o[l],r=l;else if(l===this.visibleStartIndex){for(let d=l;d>=0;d--)if(o[d].isParent){n=o[d],r=d;break}}if(n){const d=n.channel+"-"+n.canId;if(this.expandKeys.has(d)){const c=await this.onToggleExpand(r,o,!0);c!=null&&c.length&&(i[d].children=c)}}}const t=[];for(let l in i){const n=i[l],r=n.children;delete n.children,r.length&&(n.isExpand=!0),t.push(n),r.forEach(d=>{t.push(d)})}this.rowData=t},getSelectData(e){let s="",i="",o="",t="";switch(console.log("向下"),e){case"up":t=this.startSqlId;break;case"down":o=this.endSqlId;break;case"pick":clearTimeout(fe),s=this.sliderValue/1e3+this.startTime;break}D.blfLogging.selectDataLin({moreThanTimeStamp:s,lessThanTimeStamp:i,moreThanSqlID:o,lessThanSqlID:t,...this.showData,sqlId:"",numbers:100}).then(l=>{var n,r;if(((r=(n=l==null?void 0:l.data)==null?void 0:n.data)==null?void 0:r.length)>0){let d=l.data.data;switch(d.forEach(c=>{c.isExpand=!1,c.isParent=!0,c.id=c.sqlId,c.canId=c.arbitrationId,delete c.arbitrationId}),e){case"up":this.rowData=d.concat(...this.rowData),this.$refs.table.scrollToItem(l.data.data.length-1),this.sliderValue=(l.data.data[0].timestamp-this.startTime)*1e3,l.data.startSqlId&&(this.startSqlId=l.data.startSqlId);break;case"down":this.rowData=this.rowData.concat(...d),l.data.endSqlId&&(this.endSqlId=l.data.endSqlId);break;case"pick":this.startSqlId=l.data.startSqlId,this.endSqlId=l.data.endSqlId,this.rowData=d,this.sliderValue=(l.data.data[0].timestamp-this.startTime)*1e3;break}}}).finally(()=>{this.topLock=!1,this.bottomLock=!1})},onUpdatePadding(e){this.visibleStartIndex=e.visibleStartIndex,this.visibleEndIndex=e.visibleEndIndex},onTimeModeChange(e){this.timeFilterModeVal=e},onScrollAction(e){this.isLock||(this.mode==="all"?this.isLock=!0:this.isLock=!1,this.isScrollEnd=!1)},onBodyScrollEnd(e){this.mode!=="single"&&(e==="up"&&this.topLock===!1&&(this.topLock=!0,this.getSelectData(e)),e==="down"&&this.bottomLock===!1&&(this.bottomLock=!0,this.getSelectData(e)))},onClicked(){this.isLock=!1,this.isScrollEnd=!1},resumeScroll(){this.isScrollEnd=!0,this.isAddData=!0,this.isLock=!1,this.showLoggingMessage()},async onToggleExpand(e,s,i){const o=s.map(d=>({...d})),t=o[e],l=t.channel+"-"+t.canId;let n=parseInt(this.linChannelVal)||0,r=parseInt(this.linChannelValTwo)||0;if(i||!t.isExpand){this.expandKeys.add(l);const d=await D.blfLogging.parsedSignalLin({channel:t.channel,linId:""+t.linId,ldfChn:[n,r],linData:(t.data||[]).map(f=>f.toString(16))});let c=(d==null?void 0:d.data.sort((f,y)=>f.name<y.name?-1:1))||[],p=t.sqlId;if(c.forEach((f,y)=>{f.channel=t.channel,f.canId=""+t.canId,f.isParent=!1,f.isExpand=!0,f.isChildTit=!1,f.id=p+"-"+f.name}),c.unshift({channel:t.channel,canId:""+t.canId,isParent:!1,isExpand:!0,isChildTit:!0,id:p+"-"}),o.splice(e+1,0,...c),t.isExpand=c.length,i)return c;this.rowData=o}else this.expandKeys.delete(l),o.splice(e+1,o[e].isExpand),o[e].isExpand=!1,this.rowData=o},onSliderChange(e){this.isScrollEnd=!1,this.isAddData=!1,this.isLock=!0,this.getSelectData("pick")},onFilterItem(){this.openFlag=!this.openFlag},onColFilterChange(e){let s=this.columnsDef.find(i=>e.keyName===i.keyName);s&&(s.value=e.value),this.resumeScroll()}},mounted(){},unmounted(){xe=null,clearTimeout(fe),clearInterval(Ve)}},oe=e=>(j("data-v-7da5c499"),e=e(),q(),e),Ao={class:"o-pul-er"},No={key:0},Oo=oe(()=>a("div",{class:"o-pul-title"},"报文录制配置",-1)),Po={class:"o-pul-p-wrap"},Uo={class:"o-pul-p"},Ho={class:"record-header-message"},Bo=oe(()=>a("b",null,"车型/DBC：",-1)),jo=["v-tooltip"],qo=oe(()=>a("b",null,"保存目录：",-1)),zo=[qo],Ko={class:"o-pul-path"},Wo={class:"o-pul-p-wrap"},Go={class:"o-pul-p"},Xo={class:"record-header-message"},Yo=oe(()=>a("b",null,"Lin通道1：",-1)),Jo={class:"record-header-message"},Qo=oe(()=>a("b",null,"Lin通道2：",-1)),Zo={class:"o-pul-btn-wrap"},er=oe(()=>a("div",{class:"tool-btn-wrap"},[a("i",{class:"warn-icon"}),a("div",{class:"tool-picker-contianer-wrap"},"录制将覆盖文件,确认要开始录制吗?")],-1)),tr=oe(()=>a("div",{class:"tool-picker-arrow"},null,-1)),sr={class:"tool-picker-footer-wrap"},lr={class:"o-dialog-footer"},ir=oe(()=>a("div",{class:"o-pul-hr"},null,-1)),ar={class:"o-table-wrap"};function nr(e,s,i,o,t,l){const n=w("CopyPath"),r=w("Button"),d=w("ButtonGroup"),c=w("ScrollBar"),p=w("TableRecycleScroller"),f=w("Message"),y=H("tooltip"),M=H("esc");return h(),u(T,null,[a("div",Ao,[t.recordShow?(h(),u("div",No,[Oo,a("div",Po,[a("div",Uo,[a("span",Ho,[Bo,C(b(i.dbcVal),1)]),a("span",{class:"record-header-message",style:{width:"71px"},"v-tooltip":i.filePath},zo,8,jo),a("span",Ko,[g(n,{path:i.filePath,length:60,full:!0},null,8,["path"])])])]),a("div",Wo,[a("div",Go,[v((h(),u("span",Xo,[Yo,C(b(i.linChannelVal),1)])),[[y,i.linChannelVal]]),v((h(),u("span",Jo,[Qo,C(b(i.linChannelValTwo),1)])),[[y,i.linChannelValTwo]])])]),a("div",Zo,[t.secondConfirm?v((h(),u("div",{key:0,class:"tool-picker-wrap",onClick:s[1]||(s[1]=A(()=>{},["stop"]))},[er,tr,a("div",sr,[a("div",lr,[g(r,{class:"small-btn",style:{width:"30px"},onClick:s[0]||(s[0]=A(L=>t.secondConfirm=!1,["stop"]))},{default:S(()=>[C("取消")]),_:1}),g(r,{class:"small-btn",type:"primary",style:{width:"30px",margin:"0 0 0 10px"},onClick:A(l.checkHardware,["stop"])},{default:S(()=>[C("确定")]),_:1},8,["onClick"])])])])),[[M,()=>e.$emit("cancel")]]):k("",!0),C("   "),g(d,{options:[{label:"普通",value:"all"},{label:"单帧",value:"single"}],class:"theme-btn-group",modelValue:t.mode,"onUpdate:modelValue":s[2]||(s[2]=L=>t.mode=L)},null,8,["modelValue"])]),ir,a("div",ar,[g(c,{modelValue:t.sliderValue,"onUpdate:modelValue":s[3]||(s[3]=L=>t.sliderValue=L),disable:t.mode!=="all",startTime:i.startTime*1e3,start:0,end:t.seconds*1e3,onChange:l.onSliderChange,timeFilter:t.timeFilterModeVal!="relative"?"absolute":"relative"},null,8,["modelValue","disable","startTime","end","onChange","timeFilter"]),g(p,{rowData:l.diffRowData,filters:l.showData,columnsDef:t.columnsDef,onToggleExpand:s[4]||(s[4]=L=>l.onToggleExpand(L,t.rowData)),onScrollRow:l.onBodyScrollEnd,onScrollAction:l.onScrollAction,onFilterItem:l.onFilterItem,onClick:l.onClicked,columnsFilter:l.colFilter,openFlag:t.openFlag,onColFilterChange:l.onColFilterChange,ref:"table",onUpdatePadding:l.onUpdatePadding,onTimeModeChange:l.onTimeModeChange,style:{height:"100%"}},null,8,["rowData","filters","columnsDef","onScrollRow","onScrollAction","onFilterItem","onClick","columnsFilter","openFlag","onColFilterChange","onUpdatePadding","onTimeModeChange"]),v(a("div",{class:"scrollToBottomBtn",onClick:s[5]||(s[5]=A(L=>l.resumeScroll(),["stop"]))},null,512),[[U,t.isLock&&t.mode==="all"],[y,"恢复向下滚动",void 0,{left:!0}]])])])):k("",!0)]),g(f,{message:t.message},null,8,["message"])],64)}const or=E($o,[["render",nr],["__scopeId","data-v-7da5c499"]]);let ge=[],et=0;const rr={props:["filledOptions","checkedOptions"],emits:["connect","showMessage","getCarCode","cancel","signalsChange"],components:{Button:G,RecycleScroller:he,Spin:de,Message:Z},data(){var s,i,o;const e=this.$ls.get("blfread_sdbData")||[];if(this.carType==="custom"){let t=(s=e.find(l=>l.sdb===this.sdb))==null?void 0:s.comments;t&&(ge=["",...t])}else ge=((o=(i=X.DEFAULT.find(t=>t.value===this.$props.carType))==null?void 0:i.children.find(t=>t.value===this.$props.sdb))==null?void 0:o.comments)||[];return ge=ge.map((t,l)=>"".concat("⓪①②③④⑤⑥⑦⑧⑨⑩⑪⑫⑬⑭⑮⑯⑰⑱⑲⑳㉑㉒㉓㉔㉕㉖㉗㉘㉙㉚㉛㉜㉝㉞㉟㊱㊲"[l]).concat(t)),{inputStr:"",checkedList:[],selectNodeList:[],counter:0,sdbCustom:e,lodingSpin:!1,isFlag:1,message:{visible:!1,level:"",content:""},listOpen:[],expandKeys:new Set([])}},computed:{list(){this.checkedList=this.$props.checkedOptions;let e=[],s=this,i=this.$props.filledOptions.data;for(let t in i){let l;l={_id:+t,id:+t,text:ge[t],node_type:"channel",children:[],set checked(n){l.children.forEach(r=>{r.checked=n})},get checked(){return!l.children.some(n=>n.checked==!1)},get indeterminate(){return l.children.some(n=>n.checked)&&l.children.some(n=>!n.checked)}};for(let n in i[t]){let r;r={_id:t+"_"+n,id:t+"_"+n,text:n=="-1"?"":n,node_type:"msg",channel:l.id,set checked(d){d?s.checkedList.push(r):s.checkedList=s.checkedList.filter(c=>c._id!==r._id)},get checked(){return s.checkedList.some(d=>d._id===r._id)},children:i[t][n].map(d=>{var p;let c;return c={_id:t+"_"+n+"_"+d[0],id:d[0],msg:n=="-1"?"-1":+((p=n.match(/0x\w+/))==null?void 0:p[0])||n,channel:l.id,text:d[0],node_type:"signal",comment:d[1],remark:d[2],canId:d[3],rawValue:d[4],maxRaw:d[5],minRaw:d[6],maxPhys:d[7],minPhys:d[8],selectPhys:d[9],unit:d[10],startBit:d[11],length:d[12],physStep:d[13],dlc:d[14],canType:d[15],periodic:d[16],eteDisable:d[17]},c})},l.children.push(r)}e.push(l)}let o=[];for(let t=0;t<e.length;t++){let l=e[t];if(l.id!=-1&&o.push(l),!(!this.inputStr&&!this.expandKeys.has(l.id)))for(let n=0;n<l.children.length;n++){let r=l.children[n];r.id[0]!="-"&&o.push(r)}}if(this.inputStr.length>0){const t=this.inputStr.toLowerCase();let l;try{l=new RegExp(t,"i")}catch(n){l={test(r){return~r.toLowerCase().indexOf(r.toLowerCase())}}}o=o.filter(n=>l.test(n.text)||n.comment&&l.test(n.comment)||n.remark&&l.test(n.remark))}return o}},watch:{checkedListIndex:{handler(e){this.checkedList=[]},deep:!0}},mounted(){this.$refs.chsInputRef.focus(),setTimeout(()=>{document.body.addEventListener("mousedown",this.clickHandler)},300)},beforeUnmount(){},unmounted(){document.body.removeEventListener("mousedown",this.clickHandler)},methods:{clickHandler(e){var s;((s=this.$refs.root)==null?void 0:s.contains(e.target))==!1&&this.$emit("cancel")},showFirstChild(e){this.expandKeys.has(e.id)?this.expandKeys.delete(e.id):this.expandKeys.add(e.id)},clearTable(){this.checkedList=[]},title4node(e){return we(e)},showMessage({level:e,content:s,timeout:i}){clearTimeout(et),e!=null&&(this.message.level=e),s!=null&&(this.message.content=s),this.message.visible=!0,i>0&&(et=setTimeout(()=>{this.message.visible=!1},i))},submit(){this.checkedList.length>80?this.showMessage({level:"error",content:"信号选择不能超过80项",timeout:3e3}):this.$emit("signalsChange",this.checkedList)},highlightWord(e){if(!e)return e;const s=this.inputStr;if(!s)return e;const i=s.split(/\s+/g);var o,t=i.length,l;for(o=0;o<t;o++)try{l=new RegExp(i[o],"gi"),l.test(e)&&(e=e.replace(l,"<strong>$&</strong>"))}catch(n){l=i[o],e=e.replace(l,"<strong>$&</strong>")}return e}}},dr={class:"chs-er",ref:"root"},cr={class:"chs-list-er","data-loading":!1},hr=["onClick"],ur=["id","onUpdate:modelValue","data-indeterminate"],pr=["innerHTML"],mr=["for"],fr=["id","onUpdate:modelValue","data-indeterminate"],gr=["innerHTML"],br={class:"footer"};function _r(e,s,i,o,t,l){const n=w("RecycleScroller"),r=w("Message"),d=H("tooltip"),c=H("esc");return v((h(),u("div",dr,[v(a("input",{class:"chs-input-er",placeholder:"搜索信号名称/信号描述",ref:"chsInputRef","onUpdate:modelValue":s[0]||(s[0]=p=>t.inputStr=p),onInput:s[1]||(s[1]=(...p)=>e.onChange&&e.onChange(...p)),draggable:!1},null,544),[[Q,t.inputStr]]),a("div",cr,[g(n,{class:"chs-list",items:l.list,"item-size":28,"key-field":"_id"},{default:S(({item:p})=>[a("label",null,[p.node_type=="channel"&&p.id<=36?(h(),u("div",{key:0,style:{"margin-left":"1px"},class:ue(!t.inputStr&&t.expandKeys.has(p.id)?"switch-open":"switch-close"),onClick:A(f=>l.showFirstChild(p),["stop","prevent"])},null,10,hr)):k("",!0),p.node_type=="channel"&&p.id<=36?v((h(),u("input",{key:1,style:{"margin-left":"3px"},id:p._id,type:"checkbox","onUpdate:modelValue":f=>p.checked=f,"data-indeterminate":p.indeterminate,"click.stop":""},null,8,ur)),[[ee,p.checked]]):k("",!0),p.node_type=="channel"&&p.id<=36?(h(),u("span",{key:2,class:"chs-node",innerHTML:l.highlightWord(p._id)},null,8,pr)):p.node_type=="msg"?v((h(),u("div",{key:3,for:p.children,style:{"text-indent":"2em","margin-left":"-15px"},class:"chs-node chs-node-item"},[v(a("input",{id:p._id,type:"checkbox","onUpdate:modelValue":f=>p.checked=f,"data-indeterminate":p.indeterminate,"click.stop":""},null,8,fr),[[ee,p.checked]]),a("span",{class:"",innerHTML:l.highlightWord(p.text)},null,8,gr)],8,mr)),[[d,{content:l.title4node(p),html:!0},void 0,{right:!0}]]):k("",!0)])]),_:1},8,["items"])]),a("div",br,[a("div",{class:"chs-btn confirm",onClick:s[2]||(s[2]=(...p)=>l.submit&&l.submit(...p))},"确认"),a("div",{class:"chs-btn cancel",onClick:s[3]||(s[3]=(...p)=>l.clearTable&&l.clearTable(...p))},"重置")]),g(r,{message:t.message},null,8,["message"])])),[[c,()=>e.$emit("cancel")]])}const yr=E(rr,[["render",_r],["__scopeId","data-v-c2cba19d"]]);const wr={props:["disabled"],data(){return{editable:!1}},methods:{clickBody(e){var i,o;if(this.$props.disabled)return;this.editable=!0,(o=(i=e.target.children)==null?void 0:i[0])==null||o.focus(),console.log("e.target111",e.target);let s=t=>{var l;t.target&&(t.target==this.$refs.root||(l=this.$refs.root)!=null&&l.contains(t.target))?this.editable=!0:t.target&&(this.editable=!1,document.body.removeEventListener("mousedown",s))};document.body.addEventListener("mousedown",s)}},mounted(){}},vr=["data-forbidden","data-disabled"];function Cr(e,s,i,o,t,l){return h(),u("div",{ref:"root",class:"ewer","data-forbidden":e.$props.disabled,"data-disabled":!t.editable,onClick:s[0]||(s[0]=(...n)=>l.clickBody&&l.clickBody(...n))},[ut(e.$slots,"default")],8,vr)}const Pe=E(wr,[["render",Cr]]);const kr={props:["modelValue","min","max","watch"],emits:["update:modelValue","change","error"],data(){return{str:"",type:16,highlight:!1}},watch:{modelValue:{handler(e,s){s!=null&&parseFloat(e)!==parseFloat(s)&&this.$props.watch&&(this.highlight=!0,setTimeout(()=>{this.highlight=!1},500));let i="0x0";try{i="0x"+(parseInt(e)||0).toString(16)}catch(o){}this.str=i,this.type=16},immediate:!0}},methods:{onChange(e){let s=e.target.value;if(!this.valid(s.toString())){this.str="0x"+(parseInt(this.$props.modelValue)||0).toString(16),this.$emit("error",s);return}let i=this.type===10?parseInt(s):parseInt("0x"+s.replace("0x",""),16);i<this.min?i=+this.min:i>this.max&&(i=+this.max),this.str="0x"+i.toString(16),this.$emit("update:modelValue",i),this.$emit("change",i)},valid(e){return this.type==16?/^(0x)?[0-9a-fA-F]+$/.test(e):/\d+/.test(e)}}},Sr=["data-hi"];function Tr(e,s,i,o,t,l){return v((h(),u("input",{class:"input","data-hi":t.highlight,type:"text","onUpdate:modelValue":s[0]||(s[0]=n=>t.str=n),onChange:s[1]||(s[1]=A((...n)=>l.onChange&&l.onChange(...n),["prevent"])),onKeydown:s[2]||(s[2]=gt(A((...n)=>l.onChange&&l.onChange(...n),["stop","prevent"]),["enter"]))},null,40,Sr)),[[Q,t.str,void 0,{lazy:!0}]])}const Ue=E(kr,[["render",Tr],["__scopeId","data-v-c55d1b50"]]);const Dr={props:["min","max","step","modelValue","enum","watch","class"],emits:["update:modelValue","change"],data(){return{str:"",highlight:!1}},computed:{enumOpts(){return Object.entries(this.$props.enum)}},watch:{modelValue:{handler(e,s){var i;s!=null&&parseFloat(e)!==parseFloat(s)&&this.$props.watch&&(this.highlight=!0,setTimeout(()=>{this.highlight=!1},500)),(e==null?void 0:e[0])>="A"?this.str=((i=this.enumOpts.find(o=>+o[1]==+e))==null?void 0:i[0])||"":this.str=parseFloat(e)},immediate:!0}},methods:{onChange(e){let s=parseFloat(e.target.value),i=parseFloat(this.min),o=parseFloat(this.max);console.log(s,this.min,this.max),s<i?s=i:s>o&&(s=o),this.str=s.toString(),this.$emit("update:modelValue",s),this.$emit("change",s)}}},Vr=["data-hi","min","max","step"],xr={key:0,class:"ic-down"},Ir=["data-hi","value"],Lr=["value"];function Fr(e,s,i,o,t,l){return h(),u(T,null,[v(a("input",{class:ue(["input",e.$props.class]),type:"number","data-hi":t.highlight,min:i.min,max:i.max,step:i.step,"onUpdate:modelValue":s[0]||(s[0]=n=>t.str=n),onChange:s[1]||(s[1]=(...n)=>l.onChange&&l.onChange(...n)),style:$({width:l.enumOpts.length?"40%":""})},null,46,Vr),[[Q,t.str,void 0,{lazy:!0}]]),l.enumOpts.length?(h(),u("i",xr)):k("",!0),l.enumOpts.length?(h(),u("select",{key:1,"data-hi":t.highlight,class:"select",value:t.str,onChange:s[2]||(s[2]=(...n)=>l.onChange&&l.onChange(...n))},[(h(!0),u(T,null,F(l.enumOpts,n=>(h(),u("option",{value:n[0]},b(n[1]),9,Lr))),256))],40,Ir)):k("",!0)],64)}const He=E(Dr,[["render",Fr],["__scopeId","data-v-b4b10b3c"]]);let tt=0;const Rr={props:["store","setStore"],components:{Button:G,Message:Z,ChooseSignal:yr,EditWrapper:Pe,InputHex:Ue,InputOrSelect:He},data(){return{hexMultiValue:0,isHexMulti:!1,hexs:[],frames:[],listTable:{cols:[{label:"",width:"2.8em",icon:"add"},{label:"Frame Name",width:"auto"},{label:"E2E",width:"6em",type:"checkbox",checked:!1},{label:"Period (ms)",width:"9em",tooltip:{content:"1-1000ms:周期发送<br/>0:单点发送",html:!0}},{label:"ID",width:"4.5em",tooltip:"DBC导入禁止修改ID"},{label:"Channel",width:"6em"},{label:"Type",width:"6em"},{label:"DLC",width:"4em"},{label:"",width:"5em"}]},sigTable:{cols:[{label:"Signal Name",width:"auto"},{label:"Raw",width:"90px"},{label:"Phys",width:"200px"},{label:"Unit",width:"4em"}]},cur:-1,chooseSignalShow:!1,filledOptions:[],isSyncFrames:!1,addRecordShow:!1,message:{visible:!1,level:"",content:""},curChannel:0}},computed:{checkedOptions(){return this.frames.filter(e=>e.from=="dbc")},checkIndeterminate(){return this.frames.some(e=>e.e2e)&&this.frames.some(e=>!e.e2e)},allChecked(){return this.frames.some(e=>e.e2e)&&this.frames.some(e=>e.children[0].eteDisable)}},watch:{"$props.store.sendRecord.isRecording":{handler(e){e&&this.updateMultiFrame(this.frames.map((s,i)=>({...s,row:i+1})),"add")}},"$props.store.sendRecord.dbc.dbcChn":{handler(e,s){}},"$props.store.sendRecord":{handler(e,s){}},frames:{async handler(e,s){if(this.isSyncFrames)return;this.isSyncFrames=!0,this.isHexMulti=!1;for(let t=0;t<e.length;t++){let l=e[t],n=l.channel;console.log("sendframe.dbcChannel07041553",n);let r=l.canId;console.log("sendframe.dirty07041441",l.dirty),l.dirty==="raw"?(await D.blfLogging.getRawValueToPhysValue({dbcChannel:n,canId:r,signalsData:l.children}).then(d=>{this.frames[t]={...l,rawData:d.data.data.rawData,children:l.children.map(c=>{var p,f;return{...c,physValue:(f=(p=d.data.data.signalsData.find(y=>y.name===c.id))==null?void 0:p.physValue)!=null?f:c.physValue}}),dirty:!1,raw:t+1},this.updateMultiFrame([{row:t+1,...this.frames[t]}],"modify")}).catch(console.log),await ht(100)):l.dirty==="data"?(console.log("sendframes[i]07051410",l),l.from==="dbc"?await D.blfLogging.getDataToValues({dbcChannel:n,canId:r,rawData:l.rawData}).then(d=>{this.frames[t]={...l,children:l.children.map(c=>{var p,f,y,M;return{...c,physValue:(f=(p=d.data.data.signalsPhysData.find(L=>L.name===c.id))==null?void 0:p.physValue)!=null?f:c.physValue,rawValue:(M=(y=d.data.data.signalsRawData.find(L=>L.name===c.id))==null?void 0:y.rawValue)!=null?M:c.rawValue}}),dirty:!1,raw:t+1},this.updateMultiFrame([{row:t+1,...this.frames[t]}],"modify")}).catch(console.log):(this.frames[t]={...l,dirty:!1,raw:t+1},this.updateMultiFrame([{row:t+1,...this.frames[t]}],"modify"))):l.dirty==="phys"?await D.blfLogging.getPhysValueToRawValue({dbcChannel:n,canId:r,signalsData:l.children}).then(d=>{this.frames[t]={...l,rawData:d.data.data.rawData,children:l.children.map(c=>{var p,f;return{...c,rawValue:(f=(p=d.data.data.signalsData.find(y=>y.name===c.id))==null?void 0:p.rawValue)!=null?f:c.rawValue}}),dirty:!1,raw:t+1},this.updateMultiFrame([{row:t+1,...this.frames[t]}],"modify")}).catch(console.log):l.dirty==="dlc"?(this.frames[t]={...l,rawData:Array.from({length:l.dlc},(d,c)=>l.rawData[c]||0),dirty:!1,raw:t+1},this.updateMultiFrame([{row:t+1,...l}],"modify")):l.dirty==="periodic"?(this.frames[t]={...l,isSending:l.periodic==0?!1:l.isSending,dirty:!1,raw:t+1},this.updateMultiFrame([{row:t+1,...l}],"modify")):l.dirty&&(this.frames[t].dirty=!1,this.updateMultiFrame([{row:t+1,...l}],"modify"))}this.isSyncFrames=!1;let i=e.filter(t=>{var l;return((l=t.children[0])==null?void 0:l.eteDisable)===!0}),o=[];i.forEach(t=>{o.push({raw:t.raw,canId:t.canId,dbcChannel:t.channel,useE2E:t.e2e?1:0})}),D.blfLogging.setE2EConfig({e2eSlotList:o})},deep:!0},cur(e){console.log("sendCur07041058",e,this.frames[e]),this.isHexMulti=!1,this.hexs=[]}},methods:{showMessage({level:e,content:s,timeout:i}){clearTimeout(tt),e!=null&&(this.message.level=e),s!=null&&(this.message.content=s),this.message.visible=!0,i>0&&(tt=setTimeout(()=>{this.message.visible=!1},i))},onHexErr(){this.showMessage({timeout:2e3,level:"error",content:"请输入正确格式的16进制"})},updateFrame(e){let s=this.frames.slice(),i=[],o=[];for(let t=s.length-1;t>=0;t--){let l=s[t];if(l.from==="dbc"){let n=e.findIndex(r=>r.id===l.id);if(~n)e.splice(n,1);else{t===this.cur&&(this.cur=-1);let r=s.splice(t,1);o.unshift({...r,row:t+1})}}}this.updateMultiFrame(o,"delete"),i=e.map((t,l)=>{let n=t.children[0]||{};return{...t,name:t.text,from:"dbc",e2e:!1,periodic:n.periodic||0,canType:n.canType||"CAN",dlc:n.dlc||64,canId:n.msg||0,dirty:"raw",isSending:!1,children:t.children.map(r=>({...r,name:r.id}))}}),s.push(...i),this.frames=s,this.chooseSignalShow=!1,this.addRecordShow=!1},delFrame(e){e===this.cur&&(this.cur=-1);let s=this.frames.splice(e,1);this.frames.forEach((i,o)=>{this.frames[o].raw=o+1}),this.updateMultiFrame([{...s,row:e+1}],"delete")},addFrame(e){this.addRecordShow=!1;let s=[{name:"",e2e:!1,periodic:1e3,canId:e==="CAN"?111:222,channel:this.$props.store.sendRecord.dbc.dbcChn[e==="CAN"?0:1],canType:e,dlc:8,isSending:!1,from:e,rawData:[0,0,0,0,0,0,0,0],children:[{eteDisable:!1}]}],i=this.frames.length-1;this.frames.push(...s),console.log("addthis.frames",this.frames),this.updateMultiFrame(s.map((o,t)=>({...o,row:i+t})),"add")},updateMultiFrame(e,s){if(!this.$props.store.sendRecord.isRecording)return;let i=e.map(o=>({...o,channel:1+this.$props.store.sendRecord.dbc.dbcChn.indexOf(o.channel)}));i.length>0&&D.blfLogging.getPeriodicSend({data:i,behavor:s})},togglePlay(e,s){e.periodic>0?(e.isSending=!e.isSending,this.updateMultiFrame([{row:s+1,...e}],"modify")):D.blfLogging.getManualSend({row:s+1,...e,channel:1+this.$props.store.sendRecord.dbc.dbcChn.indexOf(e.channel)}).catch(console.log)},onHexMultiChange(){this.frames[this.cur].rawData=this.frames[this.cur].rawData.map((e,s)=>this.hexs.includes(s)?this.hexMultiValue:e),this.frames[this.cur].dirty="data"},clickHandler(e){var s;((s=this.$refs.root)==null?void 0:s.contains(e.target))==!1&&(this.addRecordShow=!1)},onChecked(e){this.allChecked=!e,this.allChecked?this.frames.forEach(s=>{var i;(i=s.children[0])!=null&&i.eteDisable&&(s.e2e=!0)}):this.frames.forEach(s=>{s.e2e=!1})}},mounted(){setTimeout(()=>{document.body.addEventListener("mousedown",this.clickHandler)},300)},unmounted(){document.body.removeEventListener("mousedown",this.clickHandler)}},Be=e=>(j("data-v-437f19d4"),e=e(),q(),e),Mr={class:"body"},Er={class:"list-er"},$r={class:"list-table"},Ar={key:1,class:"ic-help"},Nr=["data-indeterminate"],Or=["onClick","data-active"],Pr=["title"],Ur=["data-from","data-cantype","data-valid"],Hr=["disabled","onUpdate:modelValue"],Br=["onUpdate:modelValue","onChange"],jr=["disabled","onUpdate:modelValue","onChange"],qr=["value"],zr=["disabled","onUpdate:modelValue","onChange"],Kr=Be(()=>a("option",{value:"CAN"},"CAN",-1)),Wr=Be(()=>a("option",{value:"CANFD"},"CANFD",-1)),Gr=[Kr,Wr],Xr=["disabled","onUpdate:modelValue","onChange"],Yr=["value"],Jr=["data-disable","data-recording","data-active","onClick"],Qr=["onClick"],Zr={key:0,class:"table-empty"},ed={class:"empty-meark"},td={class:"sig-er"},sd={class:"hex-er"},ld=Be(()=>a("th",{style:{width:"4em"}}," ",-1)),id={style:{width:"11.8%"}},ad={key:0},nd=["value"],od={class:"hex-footer"},rd={class:"hex-multi-input"},dd={class:"btn-import-er"},cd={class:"add-record",ref:"root"},hd=["data-disabled"],ud=["data-disabled"],pd=["data-disabled"];function md(e,s,i,o,t,l){var M,L,z;const n=w("EditWrapper"),r=w("InputHex"),d=w("InputOrSelect"),c=w("Button"),p=w("ChooseSignal"),f=w("Message"),y=H("tooltip");return h(),u(T,null,[a("div",Mr,[a("div",Er,[a("table",$r,[a("tr",null,[(h(!0),u(T,null,F(t.listTable.cols,_=>(h(),u("th",{style:$({width:_.width})},[C(b(_.label)+" ",1),_.icon?(h(),u("i",{key:0,onClick:s[0]||(s[0]=O=>t.addRecordShow=!t.addRecordShow),class:"ic-add"})):k("",!0),_.tooltip?v((h(),u("i",Ar,null,512)),[[y,_.tooltip]]):k("",!0),_.type?v((h(),u("input",{key:2,type:"checkbox",onChange:s[1]||(s[1]=O=>l.onChecked(l.allChecked)),"data-indeterminate":l.checkIndeterminate,"onUpdate:modelValue":s[2]||(s[2]=O=>l.allChecked=O)},null,40,Nr)),[[ee,l.allChecked]]):k("",!0)],4))),256))]),(h(!0),u(T,null,F(t.frames,(_,O)=>(h(),u("tr",{onClick:x=>t.cur=O,"data-active":t.cur===O},[a("td",null,b(O+1),1),a("td",{title:_.name},[a("i",{class:"ic-can","data-from":_.from,"data-cantype":_.canType,"data-valid":Object.values(e.$props.store.sendRecord.dbc.dbcChn).includes(_.channel)},null,8,Ur),C(" "+b(_.name),1)],8,Pr),a("td",null,[g(n,{style:{"justify-content":"center"}},{default:S(()=>{var x;return[v(a("input",{type:"checkbox",disabled:!((x=_.children[0])!=null&&x.eteDisable),"onUpdate:modelValue":N=>_.e2e=N},null,8,Hr),[[ee,_.e2e,void 0,{lazy:!0}]])]}),_:2},1024)]),a("td",null,[g(n,null,{default:S(()=>[v(a("input",{class:"td-input",type:"number",min:"0",max:"1000","onUpdate:modelValue":x=>_.periodic=x,onChange:x=>_.dirty="periodic"},null,40,Br),[[Q,_.periodic,void 0,{lazy:!0}]])]),_:2},1024)]),a("td",null,[g(n,{disabled:_.from==="dbc"},{default:S(()=>[g(r,{onError:l.onHexErr,min:0,max:2047,disabled:_.from==="dbc",class:"td-input",modelValue:_.canId,"onUpdate:modelValue":x=>_.canId=x,onChange:x=>_.dirty="canId"},null,8,["onError","disabled","modelValue","onUpdate:modelValue","onChange"])]),_:2},1032,["disabled"])]),a("td",null,[g(n,{disabled:_.from==="dbc"},{default:S(()=>[v(a("select",{disabled:_.from==="dbc",class:"td-input","onUpdate:modelValue":x=>_.channel=x,onChange:x=>_.dirty="channel"},[(h(!0),u(T,null,F(e.$props.store.sendRecord.dbc.dbcChn,(x,N)=>(h(),u("option",{value:x},"CAN"+b(N+1),9,qr))),256))],40,jr),[[re,_.channel,void 0,{lazy:!0}]])]),_:2},1032,["disabled"])]),a("td",null,[g(n,{disabled:_.from==="dbc"},{default:S(()=>[v(a("select",{disabled:_.from==="dbc",class:"td-input","onUpdate:modelValue":x=>_.canType=x,onChange:x=>_.dirty="canType"},Gr,40,zr),[[re,_.canType]])]),_:2},1032,["disabled"])]),a("td",null,[g(n,{disabled:_.canType==="CAN"||_.from==="dbc"},{default:S(()=>[v(a("select",{disabled:_.canType==="CAN"||_.from==="dbc",class:"td-input","onUpdate:modelValue":x=>_.dlc=x,onChange:x=>_.dirty="dlc"},[(h(),u(T,null,F([8,12,16,20,24,32,48,64],x=>a("option",{value:x},b(x),9,Yr)),64))],40,Xr),[[re,_.dlc]])]),_:2},1032,["disabled"])]),a("td",null,[a("i",{class:"ic-play","data-disable":Object.values(e.$props.store.sendRecord.dbc.dbcChn).includes(_.channel),"data-recording":e.$props.store.sendRecord.isRecording,"data-active":_.isSending,onClick:x=>l.togglePlay(_,O)},null,8,Jr),C("  "),a("i",{class:"ic-del",onClick:A(x=>l.delFrame(O),["stop"])},null,8,Qr)])],8,Or))),256))]),t.frames.length==0?(h(),u("div",Zr,[a("div",ed,[C("暂无内容，请先"),a("span",{class:"empty-btn",onClick:s[3]||(s[3]=_=>t.addRecordShow=!t.addRecordShow)},"导入帧")])])):k("",!0)]),a("div",td,[(h(),u("table",{class:"sig-table",key:"sig"+t.cur},[a("tr",null,[(h(!0),u(T,null,F(t.sigTable.cols,_=>(h(),u("th",{style:$({width:_.width})},b(_.label),5))),256))]),((M=t.frames[t.cur])==null?void 0:M.name)!==""?(h(!0),u(T,{key:0},F((L=t.frames[t.cur])==null?void 0:L.children,_=>(h(),u("tr",null,[v((h(),u("td",null,[C(b(_.text)+" ",1)])),[[y,{content:"".concat(_.text,"<hr/>phys:").concat(_.minPhys," ~ ").concat(_.maxPhys,"<br/>raw:").concat(_.minRaw?"0x"+_.minRaw.toString(16):""," ~ ").concat(_.maxRaw?"0x"+_.maxRaw.toString(16):"","<br/>Start Bit:").concat(_.startBit,"<br>Length:").concat(_.length,"<br>Phys Step:").concat(_.physStep),html:!0},void 0,{"top-start":!0}]]),a("td",null,[g(n,null,{default:S(()=>[g(r,{watch:!0,onError:l.onHexErr,min:_.minRaw,max:_.maxRaw,class:"td-input",modelValue:_.rawValue,"onUpdate:modelValue":O=>_.rawValue=O,modelModifiers:{lazy:!0},onChange:s[4]||(s[4]=O=>t.frames[t.cur].dirty="raw")},null,8,["onError","min","max","modelValue","onUpdate:modelValue"])]),_:2},1024)]),a("td",null,[g(n,null,{default:S(()=>[g(d,{watch:!0,min:_.minPhys,max:_.maxPhys,class:"td-input",step:_.physStep,modelValue:_.physValue,"onUpdate:modelValue":O=>_.physValue=O,enum:_.selectPhys?_.selectPhys:"",onChange:s[5]||(s[5]=O=>t.frames[t.cur].dirty="phys")},null,8,["min","max","step","modelValue","onUpdate:modelValue","enum"])]),_:2},1024)]),a("td",null,b(_.unit),1)]))),256)):k("",!0)]))]),a("div",sd,[(h(),u("table",{class:"hex-table",key:"hex"+t.cur},[a("tr",null,[ld,(h(),u(T,null,F([0,1,2,3,4,5,6,7],_=>a("th",id,b(_),1)),64))]),(z=t.frames[t.cur])!=null&&z.rawData?(h(),u(T,{key:0},F([0,8,16,24,32,40,48,56,64],(_,O)=>(h(),u(T,null,[t.frames[t.cur].rawData.length>_?(h(),u("tr",ad,[a("td",null,[a("b",null,b(_),1)]),(h(),u(T,null,F(8,x=>a("td",null,[t.isHexMulti&&_+x-1<t.frames[t.cur].rawData.length?v((h(),u("input",{key:0,type:"checkbox",class:"radio","onUpdate:modelValue":s[6]||(s[6]=N=>t.hexs=N),value:_+x-1},null,8,nd)),[[ee,t.hexs]]):k("",!0),_+x-1<t.frames[t.cur].rawData.length?(h(),P(n,{key:1},{default:S(()=>[g(r,{watch:!0,onError:l.onHexErr,min:0,max:255,class:"td-input",style:{width:"calc(100%)","text-indent":"20px"},modelValue:t.frames[t.cur].rawData[_+x-1],"onUpdate:modelValue":N=>t.frames[t.cur].rawData[_+x-1]=N,modelModifiers:{lazy:!0},onChange:s[7]||(s[7]=N=>t.frames[t.cur].dirty="data")},null,8,["onError","modelValue","onUpdate:modelValue"])]),_:2},1024)):k("",!0)])),64))])):k("",!0)],64))),64)):k("",!0)])),a("div",od,[t.isHexMulti?(h(),u(T,{key:1},[C(" 批量修改:("+b(t.hexs.length)+"个)  ",1),g(c,{style:{float:"right",height:"23px","margin-left":"8px"},onClick:s[9]||(s[9]=_=>{t.hexs=[],t.isHexMulti=!1})},{default:S(()=>[C("退出")]),_:1}),g(c,{style:{float:"right",height:"23px"},type:"primary",onClick:l.onHexMultiChange},{default:S(()=>[C("修改")]),_:1},8,["onClick"]),a("div",rd,[g(r,{onError:l.onHexErr,min:0,max:255,modelValue:t.hexMultiValue,"onUpdate:modelValue":s[10]||(s[10]=_=>t.hexMultiValue=_)},null,8,["onError","modelValue"])])],64)):(h(),u("div",{key:0,class:"hex-footer-full-btn",onClick:s[8]||(s[8]=_=>t.isHexMulti=!t.isHexMulti)},"进入批量修改"))])]),v(a("div",dd,[t.chooseSignalShow?(h(),P(p,{key:0,filledOptions:e.$props.store.sendRecord.frames,checkedOptions:l.checkedOptions,onSignalsChange:l.updateFrame,onCancel:s[11]||(s[11]=()=>{t.chooseSignalShow=!1})},null,8,["filledOptions","checkedOptions","onSignalsChange"])):k("",!0)],512),[[U,t.chooseSignalShow]]),v(a("div",cd,[a("div",{onClick:s[12]||(s[12]=_=>t.chooseSignalShow=!t.chooseSignalShow),"data-disabled":e.$props.store.sendRecord.frames.length===0},"从DBC中导入帧",8,hd),a("div",{onClick:s[13]||(s[13]=_=>l.addFrame("CAN")),"data-disabled":e.$props.store.sendRecord.dbc.dbcChn.length==0},"自定义CAN帧",8,ud),a("div",{onClick:s[14]||(s[14]=_=>l.addFrame("CANFD")),"data-disabled":e.$props.store.sendRecord.dbc.dbcChn.length==0},"自定义CAN FD帧",8,pd)],512),[[U,t.addRecordShow]])]),g(f,{message:t.message},null,8,["message"])],64)}const fd=E(Rr,[["render",md],["__scopeId","data-v-437f19d4"]]);let be=[],st=0;const gd={props:["filledOptions","checkedOptions"],emits:["connect","showMessage","getCarCode","cancel","signalsChange"],components:{Button:G,RecycleScroller:he,Spin:de,Message:Z},data(){var s,i,o;const e=this.$ls.get("blfread_sdbData")||[];if(this.carType==="custom"){let t=(s=e.find(l=>l.sdb===this.sdb))==null?void 0:s.comments;t&&(be=["",...t])}else be=((o=(i=Ie.find(t=>t.value===this.$props.carType))==null?void 0:i.children.find(t=>t.value===this.$props.sdb))==null?void 0:o.comments)||[];return be=be.map((t,l)=>"".concat("⓪①②③④⑤⑥⑦⑧⑨⑩⑪⑫⑬⑭⑮⑯⑰⑱⑲⑳㉑㉒㉓㉔㉕㉖㉗㉘㉙㉚㉛㉜㉝㉞㉟㊱㊲"[l]).concat(t)),{inputStr:"",checkedList:[],selectNodeList:[],counter:0,sdbCustom:e,lodingSpin:!1,isFlag:1,message:{visible:!1,level:"",content:""},listOpen:[],expandKeys:new Set([])}},computed:{list(){this.checkedList=this.$props.checkedOptions;let e=[],s=this,i=this.$props.filledOptions.data;for(let t in i){let l;l={_id:+t,id:+t,text:be[t],node_type:"channel",children:[],set checked(n){l.children.forEach(r=>{r.checked=n})},get checked(){return!l.children.some(n=>n.checked==!1)},get indeterminate(){return l.children.some(n=>n.checked)&&l.children.some(n=>!n.checked)}};for(let n in i[t]){let r;r={_id:t+"_"+n,id:t+"_"+n,text:n=="-1"?"":n,node_type:"msg",channel:l.id,set checked(d){d?s.checkedList.push(r):s.checkedList=s.checkedList.filter(c=>c._id!==r._id)},get checked(){return s.checkedList.some(d=>d._id===r._id)},children:i[t][n].map(d=>{var p;let c;return c={_id:t+"_"+n+"_"+d[0],id:d[0],msg:n=="-1"?"-1":+((p=n.match(/0x\w+/))==null?void 0:p[0])||n,channel:l.id,text:d[0],node_type:"signal",comment:d[1],remark:d[2],canId:d[3],rawValue:d[4],maxRaw:d[5],minRaw:d[6],maxPhys:d[7],minPhys:d[8],selectPhys:d[9],unit:d[10],startBit:d[11],length:d[12],physStep:d[13],dlc:d[14],canType:d[15],periodic:d[16],eteDisable:d[17]},c})},l.children.push(r)}e.push(l)}let o=[];for(let t=0;t<e.length;t++){let l=e[t];if(l.id!=-1&&o.push(l),!(!this.inputStr&&!this.expandKeys.has(l.id)))for(let n=0;n<l.children.length;n++){let r=l.children[n];r.id[0]!="-"&&o.push(r)}}if(this.inputStr.length>0){const t=this.inputStr.toLowerCase();let l;try{l=new RegExp(t,"i")}catch(n){l={test(r){return~r.toLowerCase().indexOf(r.toLowerCase())}}}o=o.filter(n=>l.test(n.text)||n.comment&&l.test(n.comment)||n.remark&&l.test(n.remark))}return o}},watch:{checkedListIndex:{handler(e){this.checkedList=[]},deep:!0}},mounted(){this.$refs.chsInputRef.focus(),setTimeout(()=>{document.body.addEventListener("mousedown",this.clickHandler)},300)},beforeUnmount(){},unmounted(){document.body.removeEventListener("mousedown",this.clickHandler)},methods:{clickHandler(e){var s;((s=this.$refs.root)==null?void 0:s.contains(e.target))==!1&&this.$emit("cancel")},showFirstChild(e){this.expandKeys.has(e.id)?this.expandKeys.delete(e.id):this.expandKeys.add(e.id)},clearTable(){this.checkedList=[]},title4node(e){return we(e)},showMessage({level:e,content:s,timeout:i}){clearTimeout(st),e!=null&&(this.message.level=e),s!=null&&(this.message.content=s),this.message.visible=!0,i>0&&(st=setTimeout(()=>{this.message.visible=!1},i))},submit(){this.checkedList.length>80?this.showMessage({level:"error",content:"信号选择不能超过80项",timeout:3e3}):this.$emit("signalsChange",this.checkedList)},highlightWord(e){if(!e)return e;const s=this.inputStr;if(!s)return e;const i=s.split(/\s+/g);var o,t=i.length,l;for(o=0;o<t;o++)try{l=new RegExp(i[o],"gi"),l.test(e)&&(e=e.replace(l,"<strong>$&</strong>"))}catch(n){l=i[o],e=e.replace(l,"<strong>$&</strong>")}return e}}},bd={class:"chs-er",ref:"root"},_d={class:"chs-list-er","data-loading":!1},yd=["onClick"],wd=["id","onUpdate:modelValue","data-indeterminate"],vd=["innerHTML"],Cd=["for"],kd=["id","onUpdate:modelValue","data-indeterminate"],Sd=["innerHTML"],Td={class:"footer"};function Dd(e,s,i,o,t,l){const n=w("RecycleScroller"),r=w("Message"),d=H("tooltip"),c=H("esc");return v((h(),u("div",bd,[v(a("input",{class:"chs-input-er",placeholder:"搜索信号名称/信号描述",ref:"chsInputRef","onUpdate:modelValue":s[0]||(s[0]=p=>t.inputStr=p),onInput:s[1]||(s[1]=(...p)=>e.onChange&&e.onChange(...p)),draggable:!1},null,544),[[Q,t.inputStr]]),a("div",_d,[g(n,{class:"chs-list",items:l.list,"item-size":28,"key-field":"_id"},{default:S(({item:p})=>[a("label",null,[p.node_type=="channel"&&p.id>=1e3?(h(),u("div",{key:0,style:{"margin-left":"1px"},class:ue(!t.inputStr&&t.expandKeys.has(p.id)?"switch-open":"switch-close"),onClick:A(f=>l.showFirstChild(p),["stop","prevent"])},null,10,yd)):k("",!0),p.node_type=="channel"&&p.id>=1e3?v((h(),u("input",{key:1,style:{"margin-left":"3px"},id:p._id,type:"checkbox","onUpdate:modelValue":f=>p.checked=f,"data-indeterminate":p.indeterminate,"click.stop":""},null,8,wd)),[[ee,p.checked]]):k("",!0),p.node_type=="channel"&&p.id>=1e3?(h(),u("span",{key:2,class:"chs-node",innerHTML:l.highlightWord(p._id)},null,8,vd)):p.node_type=="msg"?v((h(),u("div",{key:3,for:p.children,style:{"text-indent":"2em","margin-left":"-15px"},class:"chs-node chs-node-item"},[v(a("input",{id:p._id,type:"checkbox","onUpdate:modelValue":f=>p.checked=f,"data-indeterminate":p.indeterminate,"click.stop":""},null,8,kd),[[ee,p.checked]]),a("span",{class:"",innerHTML:l.highlightWord(p.text)},null,8,Sd)],8,Cd)),[[d,{content:l.title4node(p),html:!0},void 0,{right:!0}]]):k("",!0)])]),_:1},8,["items"])]),a("div",Td,[a("div",{class:"chs-btn confirm",onClick:s[2]||(s[2]=(...p)=>l.submit&&l.submit(...p))},"确认"),a("div",{class:"chs-btn cancel",onClick:s[3]||(s[3]=(...p)=>l.clearTable&&l.clearTable(...p))},"重置")]),g(r,{message:t.message},null,8,["message"])])),[[c,()=>e.$emit("cancel")]])}const Vd=E(gd,[["render",Dd],["__scopeId","data-v-b5f3b0db"]]);let lt=0;const xd={props:["activeTab","linSendInfo","nodeOpt","ldfChn","store","setStore","curFileIdx","deployDisable"],components:{ButtonGroup:ve,Button:G,InputHex:Ue,EditWrapper:Pe,ChooseSignal:Vd,InputOrSelect:He},data(){return{nodeVal:{},mode:"schedule",cur:-1,linListTable:{cols:[{label:"",width:"2.8em",icon:"add"},{label:"Frame Name",width:"auto"},{label:"Delay (ms)",width:"9em",tooltip:{content:"1-1000ms:周期发送<br/>0:单点发送",html:!0}},{label:"ID",width:"4.5em",tooltip:"DBC导入禁止修改ID"},{label:"Channel",width:"6em"},{label:"DIR",width:"6em"},{label:"DLC",width:"3em"},{label:"",width:"5em"}]},linSigTable:{cols:[{label:"Signal Name",width:"auto"},{label:"Raw",width:"90px"},{label:"Phys",width:"200px"},{label:"Unit",width:"4em"}]},linIsHexMulti:!1,hexs:[],activeTab:0,activeChn:0,activeScheduleIndex:-1,activeTableList:new Map,chooseLinSignalShow:!1,linAddRecordShow:!1,frames:[],cur:-1,isDeploying:!1,isDeployChecked:!0,showScheduleList:!0,scheduleStyleOpt:[{label:"调度表",value:"schedule",disable:"false"},{label:"单帧",value:"single",disable:"false"}],isFilled:!0}},watch:{curFileIdx(e){this.activeTab=e},deployDisable(e){console.log("部署disable",e)},linSendInfo(e){this.activeLinData=e==null?void 0:e.data[this.activeChn],console.log("this.activeLinData07251122",this.activeLinData)},ldfChn:{handler(e){console.log("newVal07051108",e),this.nodeVal={},this.frames=[],this.scheduleList=[]},deep:!0,immediate:!0},"$props.store.sendRecord.isRecording":{handler(e){e&&this.updateMultiFrame(this.frames.map((s,i)=>({...s,row:i+1})),"add")}},"$props.store.sendRecord":{handler(e,s){}},frames:{async handler(e,s){if(console.log("nextFrames1800111",e),!this.isSyncFrames){this.isSyncFrames=!0,this.isHexMulti=!1,e.length>0&&(this.isDeployChecked=!1);for(let i=0;i<e.length;i++){let o=e[i],t=o.channel;console.log("frame07051053",t);let l=o.id;console.log("frame.dirty07041441",o.dirty,o),o.dirty==="raw"?await D.blfLogging.getRawValueToPhysValueLIN({ldfChannel:this.ldfChn[this.activeTab],linId:l,signalsData:o.children.map(n=>({name:n.text,rawValue:n.rawValue}))}).then(n=>{this.frames[i]={...o,rawData:n.data.data.rawData,children:o.children.map(r=>{var d,c;return{...r,physValue:(c=(d=n.data.data.signalsData.find(p=>p.name===r.id))==null?void 0:d.physValue)!=null?c:r.physValue}}),dirty:!1,raw:i+1},this.updateMultiFrame([{row:i+1,...this.frames[i]}],"modify"),this.isDeploying&&this.getDSServer()}).catch(console.log):o.dirty==="data"?(console.log("this.frames[i]07051410",o),o.from==="dbc"||o.from==="sch"?await D.blfLogging.getDataToValuesLIN({ldfChannel:this.ldfChn[this.activeTab],linId:l,rawData:o.rawData}).then(n=>{console.log("res07110934",n),this.frames[i]={...o,children:o.children.map(r=>{var d,c,p,f;return{...r,physValue:(c=(d=n.data.data.signalsPhysData.find(y=>y.name===r.id))==null?void 0:d.physValue)!=null?c:r.physValue,rawValue:(f=(p=n.data.data.signalsRawData.find(y=>y.name===r.id))==null?void 0:p.rawValue)!=null?f:r.rawValue}}),dirty:!1,raw:i+1},this.updateMultiFrame([{row:i+1,...this.frames[i]}],"modify")}).catch(console.log):(this.frames[i]={...o,dirty:!1,raw:i+1},this.updateMultiFrame([{row:i+1,...this.frames[i]}],"modify")),this.isDeploying&&this.getDSServer()):o.dirty==="phys"?(console.log("frame.children0710",o.children),await D.blfLogging.getPhysValueToRawValueLIN({ldfChannel:this.ldfChn[this.activeTab],linId:l,signalsData:o.children.map(n=>({name:n.text,physValue:parseInt(n.physValue)}))}).then(n=>{this.frames[i]={...o,rawData:n.data.data.rawData,children:o.children.map(r=>{var d,c;return{...r,rawValue:(c=(d=n.data.data.signalsData.find(p=>p.name===r.id))==null?void 0:d.rawValue)!=null?c:r.rawValue}}),dirty:!1,raw:i+1},this.updateMultiFrame([{row:i+1,...this.frames[i]}],"modify"),this.isDeploying&&this.getDSServer()}).catch(console.log)):o.dirty==="dlc"?(this.frames[i]={...o,rawData:Array.from({length:o.dlc},(n,r)=>o.rawData[r]||0),dirty:!1,raw:i+1},this.updateMultiFrame([{row:i+1,...o}],"modify"),this.isDeploying&&this.getDSServer()):o.dirty==="delay"?(this.frames[i]={...o,isSending:o.delay==0?!1:o.isSending,dirty:!1,raw:i+1},this.updateMultiFrame([{row:i+1,...o}],"modify"),this.isDeploying&&this.getDSServer()):o.dirty&&(this.frames[i].dirty=!1,this.updateMultiFrame([{row:i+1,...o}],"modify"),this.isDeploying&&this.getDSServer())}this.isSyncFrames=!1}},deep:!0},cur(e){console.log("cur07041051",e,this.frames[e]),this.isHexMulti=!1,this.hexs=[]}},computed:{scheduleList(){if(console.log("this.activeLinData",this.ldfChn[this.activeTab],this.activeTab,this.linSendInfo,this.ldfChn),console.log("this.nodeVal.value",this.nodeVal),Object.keys(this.nodeVal).length>0&&this.nodeVal.value!==""){let e={};if(this.nodeVal.parentNode==="master")return this.showScheduleList=!0,e=this.ldfChn[this.activeTab]!==0?this.linSendInfo.data[this.ldfChn[this.activeTab]][this.nodeVal.parentNode][this.nodeVal.value]:{},Object.keys(e||{});{this.showScheduleList=!1,console.log("this.linSendInfo.data[this.ldfChn[this.activeTab]]",this.linSendInfo.data[this.ldfChn[this.activeTab]],this.linSendInfo),e=this.ldfChn[this.activeTab]!==0?this.linSendInfo.data[this.ldfChn[this.activeTab]][this.nodeVal.parentNode]:{};let s=Object.keys(e||{});return console.log("99999",s),s.forEach((i,o)=>{i===this.nodeVal.value&&this.checkedSchedule(o,i)}),s}}},checkedOptions(){return this.frames.filter(e=>e.from=="dbc")}},mounted(){setTimeout(()=>{document.body.addEventListener("mousedown",this.clickHandler)},300)},unmounted(){document.body.removeEventListener("mousedown",this.clickHandler)},methods:{checkedSchedule(e,s){console.log("index,item",e,s);let i=[];this.nodeVal.parentNode==="master"?i=this.ldfChn[this.activeTab]!==0?this.linSendInfo.data[this.ldfChn[this.activeTab]][this.nodeVal.parentNode][this.nodeVal.value][s]:[]:i=this.ldfChn[this.activeTab]!==0?this.linSendInfo.data[this.ldfChn[this.activeTab]][this.nodeVal.parentNode][s]:[],this.activeScheduleIndex=e;let o=i.map(t=>({_id:this.nodeVal.parentNode+"_"+t[0]+"_"+this.mode,id:t[1],linId:t[1],text:t[0],name:t[0],dir:t[2],dlc:t[3],delay:t[4],channel:this.ldfChn[0],dirty:"raw",from:"sch",children:t[5].map(l=>{let n;return n={_id:l[0],id:l[0],text:l[0],node_type:"signal",comment:l[1],remark:l[2],linId:l[3],rawValue:l[4],maxRaw:l[5],minRaw:l[6],maxPhys:l[7].toString(),minPhys:l[8].toString(),selectPhys:l[9],unit:l[10],startBit:l[11],length:l[12],physStep:l[13].toString(),dlc:l[14],canType:l[15],periodic:l[16]},n})}));this.frames=[],this.frames.push(...o),this.activeTableList.set(this.nodeVal.parentNode+"-"+this.nodeVal.value+"-"+this.mode,{phone:"213-555-1234",address:"123 N 1st Ave"})},clickHandler(e){var s;((s=this.$refs.root)==null?void 0:s.contains(e.target))==!1&&(this.linAddRecordShow=!1)},showMessage({level:e,content:s,timeout:i}){clearTimeout(lt),e!=null&&(this.message.level=e),s!=null&&(this.message.content=s),this.message.visible=!0,i>0&&(lt=setTimeout(()=>{this.message.visible=!1},i))},onHexErr(){this.showMessage({timeout:2e3,level:"error",content:"请输入正确格式的16进制"})},addFrame(e){console.log("this.ldfChn[0]",this.ldfChn[0]),this.linAddRecordShow=!1;let s=[{name:"",delay:20,id:e===1,channel:this.ldfChn[0],canType:e,dir:"tx",dlc:8,isSending:!1,from:e,rawData:[0,0,0,0,0,0,0,0]}],i=this.frames.length-1;this.frames.push(...s),this.updateMultiFrame(s.map((o,t)=>({...o,row:i+t})),"add")},updateMultiFrame(e,s){console.log("list07051359",e),this.$props.store.sendRecord.isRecording&&e.map(i=>({...i,channel:1+this.$props.store.sendRecord.dbc.ldfChn.indexOf(i.channel)}))},updateFrame(e){let s=this.frames.slice(),i=[],o=[];for(let t=s.length-1;t>=0;t--){let l=s[t];if(l.from==="dbc"){let n=e.findIndex(r=>r.id===l.id);if(~n)e.splice(n,1);else{t===this.cur&&(this.cur=-1);let r=s.splice(t,1);o.unshift({...r,row:t+1})}}}this.updateMultiFrame(o,"delete"),i=e.map((t,l)=>{let n=t.children[0]||{};return console.log("it111",n),{...t,name:t.text,from:"dbc",periodic:n.periodic||0,canType:n.canType||"LIN",dlc:n.dlc||64,id:n.msg||0,linId:n.canId||0,dirty:"raw",dir:"tx",delay:10,isSending:!1,children:t.children.map(r=>({...r,name:r.id}))}}),s.push(...i),this.frames=s,console.log("this.frames07040952",this.frames),this.chooseLinSignalShow=!1,this.addRecordShow=!1},async startDeploy(){console.log("部署",this.nodeVal,this.nodeVal.parentNode),this.isDeploying=!0;for(var e=0;e<this.scheduleStyleOpt.length;e++)this.scheduleStyleOpt[e].value==="single"&&(this.scheduleStyleOpt[e].disable="true");this.getDSServer(),console.log("ldfChn11",this.ldfChn,this.frames)},async getDSServer(){await D.blfLogging.getDeployShedule({channelId:1,mode:this.nodeVal.parentNode?this.nodeVal.parentNode:this.isFilled?"master":"slave",LINFrames:this.frames.map(e=>({LINId:e.linId?"0x"+(parseInt(e.linId)||0).toString(16):"0x0",dataLength:e.rawData?e.rawData.length:0,dir:e.dir==="tx"?0:1,delay:e.delay,data:e.rawData}))}).then(e=>{}).catch(console.log)},async endDeploy(){this.isDeploying=!1;for(var e=0;e<this.scheduleStyleOpt.length;e++)this.scheduleStyleOpt[e].value==="single"&&(this.scheduleStyleOpt[e].disable="false");await D.blfLogging.getUnDeployShedule({channelId:1,mode:this.nodeVal.parentNode?this.nodeVal.parentNode:this.isFilled?"master":"slave"}).then(s=>{}).catch(console.log)},async togglePlay(e,s){console.log("raw07162036",e,s),await D.blfLogging.getManualSendLIN({channelId:1,mode:this.nodeVal.parentNode?this.nodeVal.parentNode:this.isFilled?"master":"slave",LINFrames:[{LINId:e.linId?"0x"+(parseInt(e.linId)||0).toString(16):"0x0",dataLength:e.rawData.length,dir:e.dir==="tx"?0:1,delay:e.delay,data:e.rawData}]}).then(i=>{})},delFrame(e){console.log("idx2003",e,this.frames),e===this.cur&&(this.cur=-1);let s=this.frames.splice(e,1);this.frames.forEach((i,o)=>{this.frames[o].raw=o+1}),this.updateMultiFrame([{...s,row:e+1}],"delete")}}},ae=e=>(j("data-v-290efa56"),e=e(),q(),e),Id={class:"lin-body"},Ld={class:"select-er"},Fd={class:"select-left"},Rd=ae(()=>a("span",{class:"record-header-message"},[a("b",null,"节点：")],-1)),Md={key:0,class:"chs-ft-label pointer"},Ed=["checked"],$d=ae(()=>a("i",{class:"icon-ques"},null,-1)),Ad={class:"select-right"},Nd=ae(()=>a("i",{class:"play-icon"},null,-1)),Od=ae(()=>a("i",{class:"stop-icon"},null,-1)),Pd={class:"lin-list-wrap"},Ud={class:"lin-list-tree-er"},Hd=ae(()=>a("div",{class:"lin-list-tree-tit"},[a("i",{class:"lin-list-icon"}),a("b",null,"LIN调度表")],-1)),Bd={class:"lin-list-tree-body"},jd=["data-disabled","data-active","onClick"],qd=ae(()=>a("i",{class:"lin-list-icon-sm"},null,-1)),zd=["title"],Kd={class:"lin-list-er"},Wd={class:"lin-list-table"},Gd={key:1,class:"ic-help"},Xd={key:2,type:"checkbox"},Yd={class:"add-record",ref:"root"},Jd=["data-disabled"],Qd=["data-disabled"],Zd=["onClick","data-active"],ec=["data-from","data-cantype","data-valid"],tc=["onUpdate:modelValue","onChange"],sc=["onUpdate:modelValue","onChange"],lc=["value"],ic=["onUpdate:modelValue","onChange"],ac=ae(()=>a("option",{value:"tx"},"tx",-1)),nc=ae(()=>a("option",{value:"rx"},"rx",-1)),oc=[ac,nc],rc=["disabled","onUpdate:modelValue","onChange"],dc=["data-disable","data-recording","data-active","onClick"],cc=["data-disable","onClick"],hc={key:0,class:"table-empty"},uc={class:"empty-meark"},pc={class:"btn-import-er"},mc={class:"lin-sig-er"},fc={class:"lin-hex-er"},gc=ae(()=>a("th",{style:{width:"4em"}}," ",-1)),bc={style:{width:"11.8%"}},_c={key:0},yc=["value"],wc={class:"hex-footer"},vc={class:"hex-multi-input"};function Cc(e,s,i,o,t,l){var L,z,_,O,x,N,I,se,K;const n=w("v-select"),r=w("ButtonGroup"),d=w("Button"),c=w("EditWrapper"),p=w("InputHex"),f=w("ChooseSignal"),y=w("InputOrSelect"),M=H("tooltip");return h(),u("div",Id,[a("div",Ld,[a("div",Fd,[Rd,g(n,{options:i.nodeOpt,clearable:!1,searchable:!1,disabled:t.isDeploying,label:"label",value:"value",modelValue:t.nodeVal,"onUpdate:modelValue":s[0]||(s[0]=m=>t.nodeVal=m),class:"tch-tool-select"},null,8,["options","disabled","modelValue"]),i.ldfChn[this.activeTab]=="0"?v((h(),u("label",Md,[a("input",{class:"chs-node-checkboxAll",type:"checkbox",checked:t.isFilled,onClick:s[1]||(s[1]=m=>e.checkMasterMode())},null,8,Ed),C("主节点模式"),$d])),[[M,"主节点模式"]]):k("",!0)]),a("div",Ad,[g(r,{options:t.scheduleStyleOpt,class:"theme-btn-group",modelValue:t.mode,"onUpdate:modelValue":s[2]||(s[2]=m=>t.mode=m)},null,8,["options","modelValue"]),C("  "),t.isDeploying?(h(),P(d,{key:1,type:"primary",class:"header-import-btn",onClick:l.endDeploy},{default:S(()=>[Od,C("停止 ")]),_:1},8,["onClick"])):(h(),P(d,{key:0,type:"primary",class:"header-import-btn",onClick:l.startDeploy,disabled:t.isDeployChecked||t.mode=="single"||i.deployDisable,progress:"100%"},{default:S(()=>[Nd,C("部署 ")]),_:1},8,["onClick","disabled"]))])]),a("div",Pd,[v(a("div",Ud,[Hd,a("div",Bd,[(h(!0),u(T,null,F(l.scheduleList,(m,R)=>(h(),u("div",{class:"lin-list-tree-item",key:R,"data-disabled":t.isDeploying,"data-active":t.activeScheduleIndex===R,onClick:V=>l.checkedSchedule(R,m)},[qd,a("span",{title:m},b(m),9,zd)],8,jd))),128))])],512),[[U,t.showScheduleList]]),a("div",Kd,[a("table",Wd,[a("tr",null,[(h(!0),u(T,null,F(t.linListTable.cols,m=>(h(),u("th",{style:$({width:m.width})},[C(b(m.label)+" ",1),m.icon?(h(),u("i",{key:0,onClick:s[3]||(s[3]=R=>t.linAddRecordShow=!t.linAddRecordShow),class:"lin-ic-add"})):k("",!0),m.tooltip?v((h(),u("i",Gd,null,512)),[[M,m.tooltip]]):k("",!0),m.type?(h(),u("input",Xd)):k("",!0)],4))),256)),v(a("div",Yd,[a("div",{onClick:s[4]||(s[4]=m=>t.chooseLinSignalShow=!t.chooseLinSignalShow),"data-disabled":((_=(z=(L=e.$props.store)==null?void 0:L.sendRecord)==null?void 0:z.frames)==null?void 0:_.length)===0||t.isDeploying},"从DBC中导入帧",8,Jd),a("div",{onClick:s[5]||(s[5]=m=>l.addFrame("LIN")),"data-disabled":((N=(x=(O=e.$props.store)==null?void 0:O.sendRecord)==null?void 0:x.frames)==null?void 0:N.length)==0||t.isDeploying},"自定义帧",8,Qd)],512),[[U,t.linAddRecordShow]])]),(h(!0),u(T,null,F(t.frames,(m,R)=>(h(),u("tr",{onClick:V=>t.cur=R,"data-active":t.cur===R},[a("td",null,b(R+1),1),a("td",null,[a("i",{class:"ic-can","data-from":m.from,"data-cantype":m.canType,"data-valid":Object.values(e.$props.store.sendRecord.dbc.ldfChn).includes(m.channel)},null,8,ec),C(" "+b(m.name),1)]),a("td",null,[g(c,null,{default:S(()=>[v(a("input",{class:"td-input",type:"number",min:"0",max:"1000","onUpdate:modelValue":V=>m.delay=V,onChange:V=>m.dirty="delay"},null,40,tc),[[Q,m.delay,void 0,{lazy:!0}]])]),_:2},1024)]),a("td",null,[g(c,{disabled:m.from!=="LIN"},{default:S(()=>[g(p,{onError:l.onHexErr,min:0,max:2047,disabled:m.from!=="LIN",class:"td-input",modelValue:m.linId,"onUpdate:modelValue":V=>m.linId=V,onChange:V=>m.dirty="linId"},null,8,["onError","disabled","modelValue","onUpdate:modelValue","onChange"])]),_:2},1032,["disabled"])]),a("td",null,[g(c,{disabled:!0},{default:S(()=>[v(a("select",{class:"td-input",disabled:!0,"onUpdate:modelValue":V=>m.channel=V,onChange:V=>m.dirty="channel"},[(h(!0),u(T,null,F(e.$props.store.sendRecord.dbc.ldfChn,(V,Y)=>(h(),u("option",{value:V},"LIN"+b(Y+1),9,lc))),256))],40,sc),[[re,m.channel,void 0,{lazy:!0}]])]),_:2},1024)]),a("td",null,[g(c,null,{default:S(()=>[v(a("select",{class:"td-input","onUpdate:modelValue":V=>m.dir=V,onChange:V=>m.dirty="dir"},oc,40,ic),[[re,m.dir]])]),_:2},1024)]),a("td",null,[g(c,{disabled:m.from!=="LIN"},{default:S(()=>[v(a("input",{disabled:m.from!=="LIN",class:"td-input",type:"number",min:"0",max:"8","onUpdate:modelValue":V=>m.dlc=V,onChange:V=>m.dirty="dlc"},null,40,rc),[[Q,m.dlc,void 0,{lazy:!0}]])]),_:2},1032,["disabled"])]),a("td",null,[t.mode!=="schedule"?(h(),u("i",{key:0,class:"ic-play","data-disable":Object.values(e.$props.store.sendRecord.dbc.ldfChn).includes(m.channel),"data-recording":e.$props.store.sendRecord.isRecording,"data-active":m.isSending,onClick:V=>l.togglePlay(m,R)},null,8,dc)):k("",!0),C("  "),a("i",{class:"ic-del","data-disable":t.isDeploying,onClick:A(V=>l.delFrame(R),["stop"])},null,8,cc)])],8,Zd))),256))]),t.frames.length==0?(h(),u("div",hc,[a("div",uc,[C("暂无内容，请先"),a("span",{class:"empty-btn",onClick:s[6]||(s[6]=m=>t.linAddRecordShow=!t.linAddRecordShow)},"导入帧")])])):k("",!0)]),v(a("div",pc,[t.chooseLinSignalShow?(h(),P(f,{key:0,filledOptions:e.$props.store.sendRecord.frames,checkedOptions:l.checkedOptions,onSignalsChange:l.updateFrame,onCancel:s[7]||(s[7]=()=>{t.chooseLinSignalShow=!1})},null,8,["filledOptions","checkedOptions","onSignalsChange"])):k("",!0)],512),[[U,t.chooseLinSignalShow]])]),a("div",mc,[(h(),u("table",{class:"sig-table",key:"sig"+t.cur},[a("tr",null,[(h(!0),u(T,null,F(t.linSigTable.cols,m=>(h(),u("th",{style:$({width:m.width})},b(m.label),5))),256))]),((I=t.frames[t.cur])==null?void 0:I.name)!==""?(h(!0),u(T,{key:0},F((se=t.frames[t.cur])==null?void 0:se.children,m=>(h(),u("tr",null,[v((h(),u("td",null,[C(b(m.text)+" ",1)])),[[M,{content:"".concat(m.text,"<hr/>phys:").concat(m.minPhys," ~ ").concat(m.maxPhys,"<br/>raw:").concat(m.minRaw?"0x"+m.minRaw.toString(16):""," ~ ").concat(m.maxRaw?"0x"+m.maxRaw.toString(16):"","<br/>Start Bit:").concat(m.startBit,"<br>Length:").concat(m.length,"<br>Phys Step:").concat(m.physStep),html:!0},void 0,{"top-start":!0}]]),a("td",null,[g(c,null,{default:S(()=>[g(p,{watch:!0,onError:l.onHexErr,min:m.minRaw,max:m.maxRaw,class:"td-input",modelValue:m.rawValue,"onUpdate:modelValue":R=>m.rawValue=R,modelModifiers:{lazy:!0},onChange:s[8]||(s[8]=R=>t.frames[t.cur].dirty="raw")},null,8,["onError","min","max","modelValue","onUpdate:modelValue"])]),_:2},1024)]),a("td",null,[g(c,null,{default:S(()=>[g(y,{watch:!0,min:m.minPhys,max:m.maxPhys,class:"td-input",step:m.physStep,modelValue:m.physValue,"onUpdate:modelValue":R=>m.physValue=R,enum:m.selectPhys?m.selectPhys:"",onChange:s[9]||(s[9]=R=>t.frames[t.cur].dirty="phys")},null,8,["min","max","step","modelValue","onUpdate:modelValue","enum"])]),_:2},1024)]),a("td",null,b(m.unit),1)]))),256)):k("",!0)]))]),a("div",fc,[(h(),u("table",{class:"lin-hex-table",key:"hex"+t.cur},[a("tr",null,[gc,(h(),u(T,null,F([0,1,2,3,4,5,6,7],m=>a("th",bc,b(m),1)),64))]),(K=t.frames[t.cur])!=null&&K.rawData?(h(),u(T,{key:0},F([0,8,16,24,32,40,48,56,64],(m,R)=>(h(),u(T,null,[t.frames[t.cur].rawData.length>m?(h(),u("tr",_c,[a("td",null,[a("b",null,b(m),1)]),(h(),u(T,null,F(8,V=>a("td",null,[e.isHexMulti&&m+V-1<t.frames[t.cur].rawData.length?v((h(),u("input",{key:0,type:"checkbox",class:"radio","onUpdate:modelValue":s[10]||(s[10]=Y=>t.hexs=Y),value:m+V-1},null,8,yc)),[[ee,t.hexs]]):k("",!0),m+V-1<t.frames[t.cur].rawData.length?(h(),P(c,{key:1},{default:S(()=>[g(p,{watch:!0,onError:l.onHexErr,min:0,max:255,class:"td-input",style:{width:"calc(100%)","text-indent":"20px"},modelValue:t.frames[t.cur].rawData[m+V-1],"onUpdate:modelValue":Y=>t.frames[t.cur].rawData[m+V-1]=Y,modelModifiers:{lazy:!0},onChange:s[11]||(s[11]=Y=>t.frames[t.cur].dirty="data")},null,8,["onError","modelValue","onUpdate:modelValue"])]),_:2},1024)):k("",!0)])),64))])):k("",!0)],64))),64)):k("",!0)])),a("div",wc,[t.linIsHexMulti?(h(),u(T,{key:1},[C(" 批量修改:("+b(t.hexs.length)+"个)  ",1),g(d,{style:{float:"right",height:"23px","margin-left":"8px"},onClick:s[13]||(s[13]=m=>{t.hexs=[],t.linIsHexMulti=!1})},{default:S(()=>[C("退出")]),_:1}),g(d,{style:{float:"right",height:"23px"},type:"primary"},{default:S(()=>[C("修改")]),_:1}),a("div",vc,[g(p,{onError:l.onHexErr,min:0,max:255,modelValue:e.hexMultiValue,"onUpdate:modelValue":s[14]||(s[14]=m=>e.hexMultiValue=m)},null,8,["onError","modelValue"])])],64)):(h(),u("div",{key:0,class:"hex-footer-full-btn",onClick:s[12]||(s[12]=m=>t.linIsHexMulti=!t.linIsHexMulti)},"进入批量修改"))])])])}const kc=E(xd,[["render",Cc],["__scopeId","data-v-290efa56"]]);let _e=[],it=0;const Sc={props:["filledOptions","checkedOptions"],emits:["connect","showMessage","getCarCode","cancel","signalsChange"],components:{Button:G,RecycleScroller:he,Spin:de,Message:Z},data(){var s,i,o;const e=this.$ls.get("blfread_sdbData")||[];if(this.carType==="custom"){let t=(s=e.find(l=>l.sdb===this.sdb))==null?void 0:s.comments;t&&(_e=["",...t])}else _e=((o=(i=Ie.find(t=>t.value===this.$props.carType))==null?void 0:i.children.find(t=>t.value===this.$props.sdb))==null?void 0:o.comments)||[];return _e=_e.map((t,l)=>"".concat("⓪①②③④⑤⑥⑦⑧⑨⑩⑪⑫⑬⑭⑮⑯⑰⑱⑲⑳㉑㉒㉓㉔㉕㉖㉗㉘㉙㉚㉛㉜㉝㉞㉟㊱㊲"[l]).concat(t)),{inputStr:"",checkedList:[],selectNodeList:[],counter:0,sdbCustom:e,lodingSpin:!1,isFlag:1,message:{visible:!1,level:"",content:""},listOpen:[],expandKeys:new Set([])}},computed:{list(){this.checkedList=this.$props.checkedOptions;let e=[],s=this,i=this.$props.filledOptions.data;for(let t in i){let l;l={_id:+t,id:+t,text:_e[t],node_type:"channel",children:[],set checked(n){l.children.forEach(r=>{r.checked=n})},get checked(){return!l.children.some(n=>n.checked==!1)},get indeterminate(){return l.children.some(n=>n.checked)&&l.children.some(n=>!n.checked)}};for(let n in i[t]){let r;r={_id:t+"_"+n,id:t+"_"+n,text:n=="-1"?"":n,node_type:"msg",channel:l.id,set checked(d){d?s.checkedList.push(r):s.checkedList=s.checkedList.filter(c=>c._id!==r._id)},get checked(){return s.checkedList.some(d=>d._id===r._id)},children:i[t][n].map(d=>{var p;let c;return c={_id:t+"_"+n+"_"+d[0],id:d[0],msg:n=="-1"?"-1":+((p=n.match(/0x\w+/))==null?void 0:p[0])||n,channel:l.id,text:d[0],node_type:"signal",comment:d[1],remark:d[2],canId:d[3],rawValue:d[4],maxRaw:d[5],minRaw:d[6],maxPhys:d[7],minPhys:d[8],selectPhys:d[9],unit:d[10],startBit:d[11],length:d[12],physStep:d[13],dlc:d[14],canType:d[15],periodic:d[16],eteDisable:d[17]},c})},l.children.push(r)}e.push(l)}let o=[];for(let t=0;t<e.length;t++){let l=e[t];if(l.id!=-1&&o.push(l),!(!this.inputStr&&!this.expandKeys.has(l.id)))for(let n=0;n<l.children.length;n++){let r=l.children[n];r.id[0]!="-"&&o.push(r)}}if(this.inputStr.length>0){const t=this.inputStr.toLowerCase();let l;try{l=new RegExp(t,"i")}catch(n){l={test(r){return~r.toLowerCase().indexOf(r.toLowerCase())}}}o=o.filter(n=>l.test(n.text)||n.comment&&l.test(n.comment)||n.remark&&l.test(n.remark))}return o}},watch:{checkedListIndex:{handler(e){this.checkedList=[]},deep:!0}},mounted(){this.$refs.chsInputRef.focus(),setTimeout(()=>{document.body.addEventListener("mousedown",this.clickHandler)},300)},beforeUnmount(){},unmounted(){document.body.removeEventListener("mousedown",this.clickHandler)},methods:{clickHandler(e){var s;((s=this.$refs.root)==null?void 0:s.contains(e.target))==!1&&this.$emit("cancel")},showFirstChild(e){this.expandKeys.has(e.id)?this.expandKeys.delete(e.id):this.expandKeys.add(e.id)},clearTable(){this.checkedList=[]},title4node(e){return we(e)},showMessage({level:e,content:s,timeout:i}){clearTimeout(it),e!=null&&(this.message.level=e),s!=null&&(this.message.content=s),this.message.visible=!0,i>0&&(it=setTimeout(()=>{this.message.visible=!1},i))},submit(){this.checkedList.length>80?this.showMessage({level:"error",content:"信号选择不能超过80项",timeout:3e3}):this.$emit("signalsChange",this.checkedList)},highlightWord(e){if(!e)return e;const s=this.inputStr;if(!s)return e;const i=s.split(/\s+/g);var o,t=i.length,l;for(o=0;o<t;o++)try{l=new RegExp(i[o],"gi"),l.test(e)&&(e=e.replace(l,"<strong>$&</strong>"))}catch(n){l=i[o],e=e.replace(l,"<strong>$&</strong>")}return e}}},Tc={class:"chs-er",ref:"root"},Dc={class:"chs-list-er","data-loading":!1},Vc=["onClick"],xc=["id","onUpdate:modelValue","data-indeterminate"],Ic=["innerHTML"],Lc=["for"],Fc=["id","onUpdate:modelValue","data-indeterminate"],Rc=["innerHTML"],Mc={class:"footer"};function Ec(e,s,i,o,t,l){const n=w("RecycleScroller"),r=w("Message"),d=H("tooltip"),c=H("esc");return v((h(),u("div",Tc,[v(a("input",{class:"chs-input-er",placeholder:"搜索信号名称/信号描述",ref:"chsInputRef","onUpdate:modelValue":s[0]||(s[0]=p=>t.inputStr=p),onInput:s[1]||(s[1]=(...p)=>e.onChange&&e.onChange(...p)),draggable:!1},null,544),[[Q,t.inputStr]]),a("div",Dc,[g(n,{class:"chs-list",items:l.list,"item-size":28,"key-field":"_id"},{default:S(({item:p})=>[a("label",null,[p.node_type=="channel"&&p.id>=1e3?(h(),u("div",{key:0,style:{"margin-left":"1px"},class:ue(!t.inputStr&&t.expandKeys.has(p.id)?"switch-open":"switch-close"),onClick:A(f=>l.showFirstChild(p),["stop","prevent"])},null,10,Vc)):k("",!0),p.node_type=="channel"&&p.id>=1e3?v((h(),u("input",{key:1,style:{"margin-left":"3px"},id:p._id,type:"checkbox","onUpdate:modelValue":f=>p.checked=f,"data-indeterminate":p.indeterminate,"click.stop":""},null,8,xc)),[[ee,p.checked]]):k("",!0),p.node_type=="channel"&&p.id>=1e3?(h(),u("span",{key:2,class:"chs-node",innerHTML:l.highlightWord(p._id)},null,8,Ic)):p.node_type=="msg"?v((h(),u("div",{key:3,for:p.children,style:{"text-indent":"2em","margin-left":"-15px"},class:"chs-node chs-node-item"},[v(a("input",{id:p._id,type:"checkbox","onUpdate:modelValue":f=>p.checked=f,"data-indeterminate":p.indeterminate,"click.stop":""},null,8,Fc),[[ee,p.checked]]),a("span",{class:"",innerHTML:l.highlightWord(p.text)},null,8,Rc)],8,Lc)),[[d,{content:l.title4node(p),html:!0},void 0,{right:!0}]]):k("",!0)])]),_:1},8,["items"])]),a("div",Mc,[a("div",{class:"chs-btn confirm",onClick:s[2]||(s[2]=(...p)=>l.submit&&l.submit(...p))},"确认"),a("div",{class:"chs-btn cancel",onClick:s[3]||(s[3]=(...p)=>l.clearTable&&l.clearTable(...p))},"重置")]),g(r,{message:t.message},null,8,["message"])])),[[c,()=>e.$emit("cancel")]])}const $c=E(Sc,[["render",Ec],["__scopeId","data-v-c5da6a65"]]);let at=0;const Ac={props:["activeTab","linSendInfo","nodeOpt","ldfChn","store","setStore","curFileIdx","deployDisable"],components:{ButtonGroup:ve,Button:G,InputHex:Ue,EditWrapper:Pe,ChooseSignal:$c,InputOrSelect:He},data(){return{nodeVal:{},mode:"schedule",cur:-1,linListTable:{cols:[{label:"",width:"2.8em",icon:"add"},{label:"Frame Name",width:"auto"},{label:"Delay (ms)",width:"9em",tooltip:{content:"1-1000ms:周期发送<br/>0:单点发送",html:!0}},{label:"ID",width:"4.5em",tooltip:"DBC导入禁止修改ID"},{label:"Channel",width:"6em"},{label:"DIR",width:"6em"},{label:"DLC",width:"3em"},{label:"",width:"5em"}]},linSigTable:{cols:[{label:"Signal Name",width:"auto"},{label:"Raw",width:"90px"},{label:"Phys",width:"200px"},{label:"Unit",width:"4em"}]},linIsHexMulti:!1,hexs:[],activeTab:0,activeChn:0,activeScheduleIndex:-1,activeTableList:new Map,chooseLinSignalShow:!1,linAddRecordShow:!1,otherFrames:[],cur:-1,isDeploying:!1,isDeployChecked:!0,showScheduleList:!0,scheduleStyleOpt:[{label:"调度表",value:"schedule",disable:"false"},{label:"单帧",value:"single",disable:"false"}],isFilled:!0}},watch:{curFileIdx(e){this.activeTab=e,console.log("this.activeChn",this.activeChn,this.ldfChn)},deployDisable(e){console.log("部署disable",e)},linSendInfo(e){console.log("val111111",e),this.activeLinData=e==null?void 0:e.data[this.activeChn]},ldfChn:{handler(e){console.log("newVal07051108",e),this.nodeVal={},this.otherFrames=[],this.scheduleList=[]},deep:!0,immediate:!0},"$props.store.sendRecord.isRecording":{handler(e){e&&this.updateMultiFrame(this.otherFrames.map((s,i)=>({...s,row:i+1})),"add")}},"$props.store.sendRecord":{handler(e,s){}},otherFrames:{async handler(e,s){if(console.log("nextFrames1800",e),!this.isSyncFrames){this.isSyncFrames=!0,this.isHexMulti=!1;for(let i=0;i<e.length;i++){this.isDeployChecked=!1;let o=e[i],t=o.channel;console.log("frame07051053",t);let l=o.id;console.log("frame.dirty07041441",o.dirty,o),o.dirty==="raw"?await D.blfLogging.getRawValueToPhysValueLIN({ldfChannel:this.ldfChn[this.activeTab],linId:l,signalsData:o.children.map(n=>({name:n.text,rawValue:n.rawValue}))}).then(n=>{this.otherFrames[i]={...o,rawData:n.data.data.rawData,children:o.children.map(r=>{var d,c;return{...r,physValue:(c=(d=n.data.data.signalsData.find(p=>p.name===r.id))==null?void 0:d.physValue)!=null?c:r.physValue}}),dirty:!1,raw:i+1},this.updateMultiFrame([{row:i+1,...this.otherFrames[i]}],"modify"),this.isDeploying&&this.getDSServer()}).catch(console.log):o.dirty==="data"?(console.log("this.otherFrames[i]07051410",o),o.from==="dbc"||o.from==="sch"?await D.blfLogging.getDataToValuesLIN({ldfChannel:this.ldfChn[this.activeTab],linId:l,rawData:o.rawData}).then(n=>{console.log("res07110934",n),this.otherFrames[i]={...o,children:o.children.map(r=>{var d,c,p,f;return{...r,physValue:(c=(d=n.data.data.signalsPhysData.find(y=>y.name===r.id))==null?void 0:d.physValue)!=null?c:r.physValue,rawValue:(f=(p=n.data.data.signalsRawData.find(y=>y.name===r.id))==null?void 0:p.rawValue)!=null?f:r.rawValue}}),dirty:!1,raw:i+1},this.updateMultiFrame([{row:i+1,...this.otherFrames[i]}],"modify")}).catch(console.log):(this.otherFrames[i]={...o,dirty:!1,raw:i+1},this.updateMultiFrame([{row:i+1,...this.otherFrames[i]}],"modify")),this.isDeploying&&this.getDSServer()):o.dirty==="phys"?(console.log("frame.children0710",o.children),await D.blfLogging.getPhysValueToRawValueLIN({ldfChannel:this.ldfChn[this.activeTab],linId:l,signalsData:o.children.map(n=>({name:n.text,physValue:parseInt(n.physValue)}))}).then(n=>{this.otherFrames[i]={...o,rawData:n.data.data.rawData,children:o.children.map(r=>{var d,c;return{...r,rawValue:(c=(d=n.data.data.signalsData.find(p=>p.name===r.id))==null?void 0:d.rawValue)!=null?c:r.rawValue}}),dirty:!1,raw:i+1},this.updateMultiFrame([{row:i+1,...this.otherFrames[i]}],"modify"),this.isDeploying&&this.getDSServer()}).catch(console.log)):o.dirty==="dlc"?(this.otherFrames[i]={...o,rawData:Array.from({length:o.dlc},(n,r)=>o.rawData[r]||0),dirty:!1,raw:i+1},this.updateMultiFrame([{row:i+1,...o}],"modify"),this.isDeploying&&this.getDSServer()):o.dirty==="delay"?(this.otherFrames[i]={...o,isSending:o.delay==0?!1:o.isSending,dirty:!1,raw:i+1},this.updateMultiFrame([{row:i+1,...o}],"modify"),this.isDeploying&&this.getDSServer()):o.dirty&&(this.otherFrames[i].dirty=!1,this.updateMultiFrame([{row:i+1,...o}],"modify"),this.isDeploying&&this.getDSServer())}this.isSyncFrames=!1}},deep:!0},cur(e){console.log("cur07041051",e,this.otherFrames[e]),this.isHexMulti=!1,this.hexs=[]}},computed:{scheduleList(){if(console.log("this.nodeVal",Object.keys(this.nodeVal),this.nodeVal,this.linSendInfo,this.ldfChn[this.activeTab]),Object.keys(this.nodeVal).length>0&&this.nodeVal.value!==""){let e={};if(this.nodeVal.parentNode==="master")return this.showScheduleList=!0,e=this.ldfChn[this.activeTab]!==0?this.linSendInfo.data[this.ldfChn[this.activeTab]][this.nodeVal.parentNode][this.nodeVal.value]:{},Object.keys(e||{});{this.showScheduleList=!1,e=this.ldfChn[this.activeTab]!==0?this.linSendInfo.data[this.ldfChn[this.activeTab]][this.nodeVal.parentNode]:{};let s=Object.keys(e||{});return console.log("99999",s),s.forEach((i,o)=>{i===this.nodeVal.value&&this.checkedSchedule(o,i)}),s}}},checkedOptions(){return this.otherFrames.filter(e=>e.from=="dbc")}},mounted(){setTimeout(()=>{document.body.addEventListener("mousedown",this.clickHandler)},300)},unmounted(){document.body.removeEventListener("mousedown",this.clickHandler)},methods:{checkedSchedule(e,s){let i=[];console.log("this.nodeVal.parentNode1749",this.nodeVal.parentNode),this.nodeVal.parentNode==="master"?i=this.ldfChn[this.activeTab]!==0?this.linSendInfo.data[this.ldfChn[this.activeTab]][this.nodeVal.parentNode][this.nodeVal.value][s]:[]:i=this.ldfChn[this.activeTab]!==0?this.linSendInfo.data[this.ldfChn[this.activeTab]][this.nodeVal.parentNode][s]:[],this.activeScheduleIndex=e;let o=i.map(t=>({_id:this.nodeVal.parentNode+"_"+t[0]+"_"+this.mode,id:t[1],linId:t[1],text:t[0],name:t[0],dir:t[2],dlc:t[3],delay:t[4],channel:this.ldfChn[1],dirty:"raw",from:"sch",children:t[5].map(l=>{let n;return n={_id:l[0],id:l[0],text:l[0],node_type:"signal",comment:l[1],remark:l[2],linId:l[3],rawValue:l[4],maxRaw:l[5],minRaw:l[6],maxPhys:l[7].toString(),minPhys:l[8].toString(),selectPhys:l[9],unit:l[10],startBit:l[11],length:l[12],physStep:l[13].toString(),dlc:l[14],canType:l[15],periodic:l[16]},n})}));this.otherFrames=[],this.otherFrames.push(...o),this.activeTableList.set(this.nodeVal.parentNode+"-"+this.nodeVal.value+"-"+this.mode,{phone:"213-555-1234",address:"123 N 1st Ave"})},clickHandler(e){var s;((s=this.$refs.root)==null?void 0:s.contains(e.target))==!1&&(this.linAddRecordShow=!1)},showMessage({level:e,content:s,timeout:i}){clearTimeout(at),e!=null&&(this.message.level=e),s!=null&&(this.message.content=s),this.message.visible=!0,i>0&&(at=setTimeout(()=>{this.message.visible=!1},i))},onHexErr(){this.showMessage({timeout:2e3,level:"error",content:"请输入正确格式的16进制"})},addFrame(e){this.linAddRecordShow=!1;let s=[{name:"",delay:20,id:e===1,channel:this.ldfChn[1],canType:e,dir:"tx",dlc:8,isSending:!1,from:e,rawData:[0,0,0,0,0,0,0,0]}],i=this.otherFrames.length-1;this.otherFrames.push(...s),this.updateMultiFrame(s.map((o,t)=>({...o,row:i+t})),"add")},updateMultiFrame(e,s){console.log("list07051359",e),this.$props.store.sendRecord.isRecording&&e.map(i=>({...i,channel:this.$props.store.sendRecord.dbc.ldfChn.indexOf(i.channel)+1}))},updateFrame(e){let s=this.otherFrames.slice(),i=[],o=[];for(let t=s.length-1;t>=0;t--){let l=s[t];if(l.from==="dbc"){let n=e.findIndex(r=>r.id===l.id);if(~n)e.splice(n,1);else{t===this.cur&&(this.cur=-1);let r=s.splice(t,1);o.unshift({...r,row:t+1})}}}this.updateMultiFrame(o,"delete"),i=e.map((t,l)=>{let n=t.children[0]||{};return console.log("it2222",n),{...t,name:t.text,from:"dbc",periodic:n.periodic||0,canType:n.canType||"LIN",dlc:n.dlc||64,id:n.msg||0,linId:n.canId||0,dirty:"raw",dir:"tx",delay:10,isSending:!1,children:t.children.map(r=>({...r,name:r.id}))}}),s.push(...i),this.otherFrames=s,console.log("this.frames07040952",this.otherFrames),this.chooseLinSignalShow=!1,this.addRecordShow=!1},async startDeploy(){console.log("部署",this.nodeVal,this.nodeVal.parentNode),this.isDeploying=!0;for(var e=0;e<this.scheduleStyleOpt.length;e++)this.scheduleStyleOpt[e].value==="single"&&(this.scheduleStyleOpt[e].disable="true");this.getDSServer(),console.log("ldfChn11",this.ldfChn,this.otherFrames)},async getDSServer(){await D.blfLogging.getDeployShedule({channelId:2,mode:this.nodeVal.parentNode?this.nodeVal.parentNode:this.isFilled?"master":"slave",LINFrames:this.otherFrames.map(e=>({LINId:e.linId?"0x"+(parseInt(e.linId)||0).toString(16):"0x0",dataLength:e.rawData?e.rawData.length:0,dir:e.dir==="tx"?0:1,delay:e.delay,data:e.rawData}))}).then(e=>{}).catch(console.log)},async endDeploy(){this.isDeploying=!1;for(var e=0;e<this.scheduleStyleOpt.length;e++)this.scheduleStyleOpt[e].value==="single"&&(this.scheduleStyleOpt[e].disable="false");await D.blfLogging.getUnDeployShedule({channelId:2,mode:this.nodeVal.parentNode?this.nodeVal.parentNode:this.isFilled?"master":"slave"}).then(s=>{}).catch(console.log)},async togglePlay(e,s){console.log("raw07162036",e,s),await D.blfLogging.getManualSendLIN({channelId:2,mode:this.nodeVal.parentNode?this.nodeVal.parentNode:this.isFilled?"master":"slave",LINFrames:[{LINId:e.linId?"0x"+(parseInt(e.linId)||0).toString(16):"0x0",dataLength:e.rawData.length,dir:e.dir==="tx"?0:1,delay:e.delay,data:e.rawData}]}).then(i=>{})},delFrame(e){console.log("idx200322222",e,this.otherFrames),e===this.cur&&(this.cur=-1);let s=this.otherFrames.splice(e,1);this.otherFrames.forEach((i,o)=>{this.otherFrames[o].raw=o+1}),this.updateMultiFrame([{...s,row:e+1}],"delete")}}},ne=e=>(j("data-v-ec94f9f4"),e=e(),q(),e),Nc={class:"lin-body"},Oc={class:"select-er"},Pc={class:"select-left"},Uc=ne(()=>a("span",{class:"record-header-message"},[a("b",null,"节点：")],-1)),Hc={key:0,class:"chs-ft-label pointer"},Bc=["checked"],jc=ne(()=>a("i",{class:"icon-ques"},null,-1)),qc={class:"select-right"},zc=ne(()=>a("i",{class:"play-icon"},null,-1)),Kc=ne(()=>a("i",{class:"stop-icon"},null,-1)),Wc={class:"lin-list-wrap"},Gc={class:"lin-list-tree-er"},Xc=ne(()=>a("div",{class:"lin-list-tree-tit"},[a("i",{class:"lin-list-icon"}),a("b",null,"LIN调度表")],-1)),Yc={class:"lin-list-tree-body"},Jc=["data-disabled","data-active","onClick"],Qc=ne(()=>a("i",{class:"lin-list-icon-sm"},null,-1)),Zc=["title"],eh={class:"lin-list-er"},th={class:"lin-list-table"},sh={key:1,class:"ic-help"},lh={key:2,type:"checkbox"},ih={class:"add-record",ref:"root"},ah=["data-disabled"],nh=["data-disabled"],oh=["onClick","data-active"],rh=["data-from","data-cantype","data-valid"],dh=["onUpdate:modelValue","onChange"],ch=["onUpdate:modelValue","onChange"],hh=["value"],uh=["onUpdate:modelValue","onChange"],ph=ne(()=>a("option",{value:"tx"},"tx",-1)),mh=ne(()=>a("option",{value:"rx"},"rx",-1)),fh=[ph,mh],gh=["disabled","onUpdate:modelValue","onChange"],bh=["data-disable","data-recording","data-active","onClick"],_h=["data-disable","onClick"],yh={key:0,class:"table-empty"},wh={class:"empty-meark"},vh={class:"btn-import-er"},Ch={class:"lin-sig-er"},kh={class:"lin-hex-er"},Sh=ne(()=>a("th",{style:{width:"4em"}}," ",-1)),Th={style:{width:"11.8%"}},Dh={key:0},Vh=["value"],xh={class:"hex-footer"},Ih={class:"hex-multi-input"};function Lh(e,s,i,o,t,l){var L,z,_,O,x,N,I,se,K;const n=w("v-select"),r=w("ButtonGroup"),d=w("Button"),c=w("EditWrapper"),p=w("InputHex"),f=w("ChooseSignal"),y=w("InputOrSelect"),M=H("tooltip");return h(),u("div",Nc,[a("div",Oc,[a("div",Pc,[Uc,g(n,{options:i.nodeOpt,clearable:!1,searchable:!1,disabled:t.isDeploying,label:"label",value:"value",modelValue:t.nodeVal,"onUpdate:modelValue":s[0]||(s[0]=m=>t.nodeVal=m),class:"tch-tool-select"},null,8,["options","disabled","modelValue"]),i.ldfChn[this.activeTab]=="0"?v((h(),u("label",Hc,[a("input",{class:"chs-node-checkboxAll",type:"checkbox",checked:t.isFilled,onClick:s[1]||(s[1]=m=>e.checkMasterMode())},null,8,Bc),C("主节点模式"),jc])),[[M,"主节点模式"]]):k("",!0)]),a("div",qc,[g(r,{options:t.scheduleStyleOpt,class:"theme-btn-group",modelValue:t.mode,"onUpdate:modelValue":s[2]||(s[2]=m=>t.mode=m)},null,8,["options","modelValue"]),C("  "),t.isDeploying?(h(),P(d,{key:1,type:"primary",class:"header-import-btn",onClick:l.endDeploy},{default:S(()=>[Kc,C("停止 ")]),_:1},8,["onClick"])):(h(),P(d,{key:0,type:"primary",class:"header-import-btn",onClick:l.startDeploy,disabled:t.isDeployChecked||t.mode=="single"||i.deployDisable,progress:"100%"},{default:S(()=>[zc,C("部署 ")]),_:1},8,["onClick","disabled"]))])]),a("div",Wc,[v(a("div",Gc,[Xc,a("div",Yc,[(h(!0),u(T,null,F(l.scheduleList,(m,R)=>(h(),u("div",{class:"lin-list-tree-item",key:R,"data-disabled":t.isDeploying,"data-active":t.activeScheduleIndex===R,onClick:V=>l.checkedSchedule(R,m)},[Qc,a("span",{title:m},b(m),9,Zc)],8,Jc))),128))])],512),[[U,t.showScheduleList]]),a("div",eh,[a("table",th,[a("tr",null,[(h(!0),u(T,null,F(t.linListTable.cols,m=>(h(),u("th",{style:$({width:m.width})},[C(b(m.label)+" ",1),m.icon?(h(),u("i",{key:0,onClick:s[3]||(s[3]=R=>t.linAddRecordShow=!t.linAddRecordShow),class:"lin-ic-add"})):k("",!0),m.tooltip?v((h(),u("i",sh,null,512)),[[M,m.tooltip]]):k("",!0),m.type?(h(),u("input",lh)):k("",!0)],4))),256)),v(a("div",ih,[a("div",{onClick:s[4]||(s[4]=m=>t.chooseLinSignalShow=!t.chooseLinSignalShow),"data-disabled":((_=(z=(L=e.$props.store)==null?void 0:L.sendRecord)==null?void 0:z.otherFrames)==null?void 0:_.length)===0||t.isDeploying},"从DBC中导入帧",8,ah),a("div",{onClick:s[5]||(s[5]=m=>l.addFrame("LIN")),"data-disabled":((N=(x=(O=e.$props.store)==null?void 0:O.sendRecord)==null?void 0:x.otherFrames)==null?void 0:N.length)==0||t.isDeploying},"自定义帧",8,nh)],512),[[U,t.linAddRecordShow]])]),(h(!0),u(T,null,F(t.otherFrames,(m,R)=>(h(),u("tr",{onClick:V=>t.cur=R,"data-active":t.cur===R},[a("td",null,b(R+1),1),a("td",null,[a("i",{class:"ic-can","data-from":m.from,"data-cantype":m.canType,"data-valid":Object.values(e.$props.store.sendRecord.dbc.ldfChn).includes(m.channel)},null,8,rh),C(" "+b(m.name),1)]),a("td",null,[g(c,null,{default:S(()=>[v(a("input",{class:"td-input",type:"number",min:"0",max:"1000","onUpdate:modelValue":V=>m.delay=V,onChange:V=>m.dirty="delay"},null,40,dh),[[Q,m.delay,void 0,{lazy:!0}]])]),_:2},1024)]),a("td",null,[g(c,{disabled:m.from!=="LIN"},{default:S(()=>[g(p,{onError:l.onHexErr,min:0,max:2047,disabled:m.from!=="LIN",class:"td-input",modelValue:m.linId,"onUpdate:modelValue":V=>m.linId=V,onChange:V=>m.dirty="linId"},null,8,["onError","disabled","modelValue","onUpdate:modelValue","onChange"])]),_:2},1032,["disabled"])]),a("td",null,[g(c,{disabled:!0},{default:S(()=>[v(a("select",{disabled:!0,class:"td-input","onUpdate:modelValue":V=>m.channel=V,onChange:V=>m.dirty="channel"},[(h(!0),u(T,null,F(e.$props.store.sendRecord.dbc.ldfChn,(V,Y)=>(h(),u("option",{value:V},"LIN2",8,hh))),256))],40,ch),[[re,m.channel,void 0,{lazy:!0}]])]),_:2},1024)]),a("td",null,[g(c,null,{default:S(()=>[v(a("select",{class:"td-input","onUpdate:modelValue":V=>m.dir=V,onChange:V=>m.dirty="dir"},fh,40,uh),[[re,m.dir]])]),_:2},1024)]),a("td",null,[g(c,{disabled:m.from!=="LIN"},{default:S(()=>[v(a("input",{disabled:m.from!=="LIN",class:"td-input",type:"number",min:"0",max:"8","onUpdate:modelValue":V=>m.dlc=V,onChange:V=>m.dirty="dlc"},null,40,gh),[[Q,m.dlc,void 0,{lazy:!0}]])]),_:2},1032,["disabled"])]),a("td",null,[t.mode!=="schedule"?(h(),u("i",{key:0,class:"ic-play","data-disable":Object.values(e.$props.store.sendRecord.dbc.ldfChn).includes(m.channel),"data-recording":e.$props.store.sendRecord.isRecording,"data-active":m.isSending,onClick:V=>l.togglePlay(m,R)},null,8,bh)):k("",!0),C("  "),a("i",{class:"ic-del","data-disable":t.isDeploying,onClick:A(V=>l.delFrame(R),["stop"])},null,8,_h)])],8,oh))),256))]),t.otherFrames.length==0?(h(),u("div",yh,[a("div",wh,[C("暂无内容，请先"),a("span",{class:"empty-btn",onClick:s[6]||(s[6]=m=>t.linAddRecordShow=!t.linAddRecordShow)},"导入帧")])])):k("",!0)]),v(a("div",vh,[t.chooseLinSignalShow?(h(),P(f,{key:0,filledOptions:e.$props.store.sendRecord.otherFrames,checkedOptions:l.checkedOptions,onSignalsChange:l.updateFrame,onCancel:s[7]||(s[7]=()=>{t.chooseLinSignalShow=!1})},null,8,["filledOptions","checkedOptions","onSignalsChange"])):k("",!0)],512),[[U,t.chooseLinSignalShow]])]),a("div",Ch,[(h(),u("table",{class:"sig-table",key:"sig"+t.cur},[a("tr",null,[(h(!0),u(T,null,F(t.linSigTable.cols,m=>(h(),u("th",{style:$({width:m.width})},b(m.label),5))),256))]),((I=t.otherFrames[t.cur])==null?void 0:I.name)!==""?(h(!0),u(T,{key:0},F((se=t.otherFrames[t.cur])==null?void 0:se.children,m=>(h(),u("tr",null,[v((h(),u("td",null,[C(b(m.text)+" ",1)])),[[M,{content:"".concat(m.text,"<hr/>phys:").concat(m.minPhys," ~ ").concat(m.maxPhys,"<br/>raw:").concat(m.minRaw?"0x"+m.minRaw.toString(16):""," ~ ").concat(m.maxRaw?"0x"+m.maxRaw.toString(16):"","<br/>Start Bit:").concat(m.startBit,"<br>Length:").concat(m.length,"<br>Phys Step:").concat(m.physStep),html:!0},void 0,{"top-start":!0}]]),a("td",null,[g(c,null,{default:S(()=>[g(p,{watch:!0,onError:l.onHexErr,min:m.minRaw,max:m.maxRaw,class:"td-input",modelValue:m.rawValue,"onUpdate:modelValue":R=>m.rawValue=R,modelModifiers:{lazy:!0},onChange:s[8]||(s[8]=R=>t.otherFrames[t.cur].dirty="raw")},null,8,["onError","min","max","modelValue","onUpdate:modelValue"])]),_:2},1024)]),a("td",null,[g(c,null,{default:S(()=>[g(y,{watch:!0,min:m.minPhys,max:m.maxPhys,class:"td-input",step:m.physStep,modelValue:m.physValue,"onUpdate:modelValue":R=>m.physValue=R,enum:m.selectPhys?m.selectPhys:"",onChange:s[9]||(s[9]=R=>t.otherFrames[t.cur].dirty="phys")},null,8,["min","max","step","modelValue","onUpdate:modelValue","enum"])]),_:2},1024)]),a("td",null,b(m.unit),1)]))),256)):k("",!0)]))]),a("div",kh,[(h(),u("table",{class:"lin-hex-table",key:"hex"+t.cur},[a("tr",null,[Sh,(h(),u(T,null,F([0,1,2,3,4,5,6,7],m=>a("th",Th,b(m),1)),64))]),(K=t.otherFrames[t.cur])!=null&&K.rawData?(h(),u(T,{key:0},F([0,8,16,24,32,40,48,56,64],(m,R)=>(h(),u(T,null,[t.otherFrames[t.cur].rawData.length>m?(h(),u("tr",Dh,[a("td",null,[a("b",null,b(m),1)]),(h(),u(T,null,F(8,V=>a("td",null,[e.isHexMulti&&m+V-1<t.otherFrames[t.cur].rawData.length?v((h(),u("input",{key:0,type:"checkbox",class:"radio","onUpdate:modelValue":s[10]||(s[10]=Y=>t.hexs=Y),value:m+V-1},null,8,Vh)),[[ee,t.hexs]]):k("",!0),m+V-1<t.otherFrames[t.cur].rawData.length?(h(),P(c,{key:1},{default:S(()=>[g(p,{watch:!0,onError:l.onHexErr,min:0,max:255,class:"td-input",style:{width:"calc(100%)","text-indent":"20px"},modelValue:t.otherFrames[t.cur].rawData[m+V-1],"onUpdate:modelValue":Y=>t.otherFrames[t.cur].rawData[m+V-1]=Y,modelModifiers:{lazy:!0},onChange:s[11]||(s[11]=Y=>t.otherFrames[t.cur].dirty="data")},null,8,["onError","modelValue","onUpdate:modelValue"])]),_:2},1024)):k("",!0)])),64))])):k("",!0)],64))),64)):k("",!0)])),a("div",xh,[t.linIsHexMulti?(h(),u(T,{key:1},[C(" 批量修改:("+b(t.hexs.length)+"个)  ",1),g(d,{style:{float:"right",height:"23px","margin-left":"8px"},onClick:s[13]||(s[13]=m=>{t.hexs=[],t.linIsHexMulti=!1})},{default:S(()=>[C("退出")]),_:1}),g(d,{style:{float:"right",height:"23px"},type:"primary"},{default:S(()=>[C("修改")]),_:1}),a("div",Ih,[g(p,{onError:l.onHexErr,min:0,max:255,modelValue:e.hexMultiValue,"onUpdate:modelValue":s[14]||(s[14]=m=>e.hexMultiValue=m)},null,8,["onError","modelValue"])])],64)):(h(),u("div",{key:0,class:"hex-footer-full-btn",onClick:s[12]||(s[12]=m=>t.linIsHexMulti=!t.linIsHexMulti)},"进入批量修改"))])])])}const Fh=E(Ac,[["render",Lh],["__scopeId","data-v-ec94f9f4"]]);const Rh={props:["theme","modelValue","options","position","closeable"],emits:["update:modelValue","close"],data(){return{value:this.$props.modelValue}},watch:{value(e){e!==this.modelValue&&this.$emit("update:modelValue",e)},modelValue(e){this.value=e}},methods:{onWheel(e){let s=0;e.deltaY>0||e.deltaX>0?s=100:s=-100;const i=this.$refs.rootRef;let o=i.scrollLeft+s;o<0?o=0:o+i.clientWidth>=i.scrollWidth&&(o=i.scrollWidth-i.clientWidth),console.log("nextD",i,o),i.scrollLeft=o}}},Mh=["data-theme","data-position"],Eh={class:"tab"},$h=["value"],Ah=["data-dirty","onClick"];function Nh(e,s,i,o,t,l){return h(),u("div",{class:"tab-er","data-theme":i.theme||"default","data-position":i.position,ref:"rootRef",onWheel:s[1]||(s[1]=(...n)=>l.onWheel&&l.onWheel(...n))},[(h(!0),u(T,null,F(i.options,n=>(h(),u("label",Eh,[a("span",null,b(n.label),1),v(a("input",{type:"radio","onUpdate:modelValue":s[0]||(s[0]=r=>t.value=r),value:n.value},null,8,$h),[[bt,t.value]]),i.closeable?(h(),u("i",{key:0,class:"ic-close","data-dirty":n.dirty,onClick:r=>e.$emit("close",n.value)},null,8,Ah)):k("",!0)]))),256)),ut(e.$slots,"default",{},void 0,!0)],40,Mh)}const Oh=E(Rh,[["render",Nh],["__scopeId","data-v-a2a581b5"]]);let nt=0,Ph=0,Uh=0,ot=[];const Hh={props:["store","setStore","closeFlag"],emits:["connect","showMessage","getCarCode"],components:{Button:G,Header:rt,FrameRecord:Kn,LinRecord:or,ChartRecord:$a,EditModal:os,FiveChannelEditModal:ml,TwelveChannelEditModal:Hl,SendRecord:fd,Message:Z,LinSendRecord:kc,LinOtherSendRecord:Fh,Tabs:Oh},data(){return{system:ct,isHardwareChecked:!1,expandKeys:new Set,visibleStartIndex:0,visibleEndIndex:0,bottomPadding:0,recordLoading:!1,startTime:0,editModal:{title:"配置",editVisible:!1},mode:"all",dbcVal:"",sliderValue:-1,channelOne:"",channelTwo:"",channelThree:"",channelFour:"",channelFive:"",channelSix:"",channelSeven:"",channelEight:"",channelNine:"",channelTen:"",channelEleven:"",channelTwelve:"",linChannelVal:"",linChannelValTwo:"",filePath:"",comments:["","","","","","","","","","","","","","","",""],message:{visible:!1,level:"",content:""},seconds:0,rowData:[],isRecording:!1,startSqlId:0,endSqlId:0,isLock:!1,isScrollEnd:!0,isAddData:!0,secondConfirm:!1,topLock:!1,bottomLock:!1,openFlag:!1,mlist:[{key:"lookRecord",name:"CAN帧查看",icon:"box"},{key:"supeRecord",name:"图像查看",icon:"setting"},{key:"sendRecord",name:"CAN发送报文",icon:"send"},{key:"linSendRecord",name:"LIN发送报文",icon:"send"},{key:"linRecord",name:"LIN帧查看",icon:"box"}],cur:"lookRecord",recordShow:!1,linRecordShow:!0,colFilterShow:!1,recordChart:"RecordChart",recordTime:"00:00:00",frames:[],timeData:Object.freeze([]),showSignalsList:[],updateSignalData:{},dbcLoading:!1,sendRecordShow:!1,linSendRecordShow:!1,lookRecord:!0,isEditModalLoading:!1,sn:"--",sw:"--",frameType:"canFrame",sdb:"E4U3_1115",dbcChn:[],ldfChn:[],linSendInfo:[],channelValList:[],linChannelValList:[],chartTableData:[],btnActionStyle:"",curFileIdx:0,mainTabs:[],activeTab:0,activeLinData:{},nodeOpt:[],deployDisable:!0,changeDbcLoading:!1}},watch:{mode(e,s){this.topPadding=0,this.$refs.table.scrollToItem(0),this.expandKeys.clear(),this.rowData=[],this.isRecording&&this.resumeScroll()},frames(e){this.$props.setStore("sendRecord",{frames:e})},isRecording(e){this.$props.setStore("sendRecord",{isRecording:e})},curFileIdx(e){this.activeTab=this.ldfChn[e],console.log("newVal",e,this.ldfChn,this.activeTab),this.activeTab===0?(this.nodeOpt=[],console.log("111111")):this.changeTabOption(this.activeTab)}},computed:{quitConfirm(){return!!(this.dbcVal||this.channelOne||this.channelTwo||this.channelThree||this.filePath)}},methods:{chartTableFun(e){this.chartTableData=e==null?void 0:e.filter(s=>s.values.length>0),this.chartTableData.length!==0?ot=this.chartTableData:this.chartTableData=ot,console.log(this.chartTableData,1212121212121)},updateTimeData(e){var s;(s=this.$refs.chartRecordRef)==null||s.upTimeData(e)},recordTimeChange(e){this.recordTime=e},async colFilterChange(){this.editModal.editVisible=!0,this.changeDbcLoading=!0,await D.blfLogging.checkHardware().then(async e=>{var s,i,o;((s=e==null?void 0:e.data)==null?void 0:s.code)===1?(this.showMessage({timeout:5e3,level:"success",content:((i=e.data)==null?void 0:i.msg)||"硬件连接成功"}),this.sn=e.data.data.sn,this.sw=e.data.data.sw,this.isHardwareChecked=!0):(this.isHardwareChecked=!1,this.showMessage({timeout:5e3,level:"error",content:((o=e.data)==null?void 0:o.msg)||"硬件连接失败"}))}).catch(e=>{this.isHardwareChecked=!1,this.showMessage({timeout:5e3,level:"error",content:"硬件连接失败"})}).finally(()=>{this.isEditModalLoading=!1,this.changeDbcLoading=!1})},async startRecord(){var e,s,i,o;this.updateSignalData=(e=this.$refs.chartRecordRef)==null?void 0:e.view,(i=this.$refs.chartRecordRef)==null||i.updateSignal((s=this.updateSignalData)==null?void 0:s.children,"1"),(o=this.$refs.chartRecordRef)==null||o.clearTimeData(),this.btnActionStyle="normal",this.$refs.frameRecordRef.startRecord(this.btnActionStyle),this.$refs.linRecordRef.startRecord(),this.isRecording=!0,this.deployDisable=!1,ye.report("track","click",{element_name:"开始录制",tip:"1174.18.0.1.33199"})},async startListen(){this.btnActionStyle="listen",this.$refs.frameRecordRef.startRecord(this.btnActionStyle),this.isRecording=!0,this.deployDisable=!1},endRecord(){this.$refs.frameRecordRef.endRecord(),this.isRecording=!1,this.deployDisable=!0,ye.report("track","click",{element_name:"停止录制",tip:"1174.18.0.1.33203"})},choose(e){this.cur=e,e=="supeRecord"?(this.recordShow=!0,this.sendRecordShow=!0,this.linSendRecordShow=!0,this.lookRecord=!1,this.linRecordShow=!0):e=="lookRecord"?(this.recordShow=!1,this.sendRecordShow=!0,this.linSendRecordShow=!0,this.lookRecord=!0,this.frameType="canFrame",this.linRecordShow=!0):e=="sendRecord"?(this.recordShow=!0,this.lookRecord=!0,this.sendRecordShow=!1,this.linSendRecordShow=!0,this.linRecordShow=!0):e=="linRecord"?(this.linRecordShow=!1,this.recordShow=!0,this.sendRecordShow=!0,this.lookRecord=!0,this.linSendRecordShow=!0,this.frameType="linFrame"):e=="linSendRecord"&&(this.recordShow=!0,this.lookRecord=!0,this.sendRecordShow=!0,this.linSendRecordShow=!1,this.linRecordShow=!0)},updateBocks(e){this.dbcVal=e.dbcVal,this.recordLoading=e.recordLoading,this.isRecording=e.isRecording,this.filePath=e.filePath},openEditDialog(){this.editModal.editVisible=!0,this.openFlag=!1},onCancelSelect(){this.editModal.editVisible=!1},showMessage({level:e,content:s,timeout:i}){clearTimeout(nt),e!=null&&(this.message.level=e),s!=null&&(this.message.content=s),this.message.visible=!0,i>0&&(nt=setTimeout(()=>{this.message.visible=!1},i))},async onSubmitToShow(e,s,i,o){console.log("dbcVal",e,s,i,o),this.dbcVal=e[0]==="自定义模板"?this.dbcVal="自定义模板":this.dbcVal=e[0]+"/"+e[1],this.sdb=this.dbcVal==="自定义模板"?"默认视图":this.dbcVal.split("/")[1],this.filePath=o;let t=["","","","","","","","","","","","","","","",""],l=["","","","","","","","","","","","","","","",""];this.dbcChn=s.map((d,c)=>d!=="(不加载)"?(t[c]=d.split("-").pop(),parseInt(d.split("-")[0])):0-(c+1)),console.log("this.dbcChn111",this.dbcChn),this.ldfChn=i.map((d,c)=>(console.log("item111",d),l[c]=d.split("-").pop(),d!=="(不加载)"?parseInt(d):0)),this.channelValList=s,this.linChannelValList=i,this.mainTabs=[],this.linChannelValList.forEach((d,c)=>{d!=="(不加载)"?this.mainTabs.push({label:d,value:c,dirty:"tab"}):this.mainTabs.push({label:"LIN"+(c+1),value:c,dirty:"tab"})}),console.log("mainTabs",this.mainTabs,this.linChannelValList,this.linChannelValList.some(d=>d!=="(不加载)")),this.channelOne=s[0],this.channelTwo=s[1],this.channelThree=s[2],this.linChannelVal=i[0],this.linChannelValTwo=i[1];let n={sdb:this.sdb,carType:this.dbcVal==="自定义模板"?"custom":this.dbcVal.split("/")[0],dbcChn:this.dbcChn,ldfChn:this.ldfChn,files:this.dbcVal==="自定义模板"?t:["","","","","","","","","","","","","","","",""],ldfFiles:this.dbcVal==="自定义模板"?l:["","","","","","","","","","","","","","","",""],comments:this.comments,ldfComments:this.comments};this.$props.setStore("sendRecord",{dbc:n}),this.dbcLoading=!0;let r=await D.blfLogging.getDBC(n).finally(()=>{this.dbcLoading=!1});this.frames=r,console.log(this.frames),this.isEditModalLoading=!0,this.mainTabs.length>0&&(this.linSendInfo=await D.blfLogging.get_LIN_shc().then(),console.log("this.ldfChn[this.curFileIdx]",this.ldfChn[0],this.curFileIdx),this.ldfChn[0]===0?this.nodeOpt=[]:this.changeTabOption(this.ldfChn[this.curFileIdx]),console.log("linSendInfo22222",this.linSendInfo,this.curFileIdx,this.ldfChn[this.curFileIdx],this.nodeOpt)),this.editModal.editVisible=!1},changeTabOption(e){var i;let s=(i=this.linSendInfo)==null?void 0:i.data[e];if(console.log("allNodeObj",s),Object.keys(s||{}).length!==0){let o=Object.keys(s.master).map(l=>({value:l,label:l+"[主节点]",parentNode:"master"})),t=Object.keys(s.slaves).map(l=>({value:l,label:l+"[从节点]",parentNode:"slaves"}));this.nodeOpt=[...o,...t]}}},mounted(){ye.report("trackPage",{page:"报文录制",tip:"1174.18.0.1.33191"}),D.blfLogging.removeSql()},unmounted(){D.blfLogging.removeSql(),clearInterval(Ph),clearInterval(Uh)}},te=e=>(j("data-v-c21b53f4"),e=e(),q(),e),Bh=["data-loading"],jh={style:{position:"absolute",left:"1em",display:"flex","column-gap":"6px","align-items":"center"}},qh=te(()=>a("i",{class:"lead-icon"},null,-1)),zh={class:"o-pul-record-btn"},Kh=te(()=>a("i",{class:"play-icon"},null,-1)),Wh=te(()=>a("i",{class:"stop-icon"},null,-1)),Gh={class:"o-pul-record-btn"},Xh=te(()=>a("i",{class:"play-icon"},null,-1)),Yh={key:0,class:"o-pul-record-time"},Jh={key:1,class:"o-pul-record-time"},Qh={style:{display:"flex"}},Zh={class:"record-header-message",style:{display:"flex","align-items":"center"}},eu={class:"record-header-message-imp"},tu=te(()=>a("span",{style:{color:"#D9D9D9","font-size":"16px",margin:"0 10px"}},"|",-1)),su={class:"record-header-message",style:{"margin-right":"8px"}},lu={class:"record-header-message-imp"},iu={class:"o-pul-er"},au={class:"o-menu"},nu={style:{position:"relative"}},ou=["data-active"],ru=te(()=>a("i",{class:"supe-look-record"},null,-1)),du=["data-active"],cu=te(()=>a("i",{class:"supe-record"},null,-1)),hu=["data-active"],uu=te(()=>a("i",{class:"send-record"},null,-1)),pu=["data-active"],mu=te(()=>a("i",{class:"send-record"},null,-1)),fu=["data-active"],gu=te(()=>a("i",{class:"supe-lin-record"},null,-1)),bu=["data-hidden"],_u=["data-hidden"],yu=["data-hidden"],wu=["data-hidden"],vu=["data-hidden"],Cu={key:0,class:"bdy-tabs"},ku=te(()=>a("div",{style:{width:"54px",display:"inline-block"}},null,-1));function Su(e,s,i,o,t,l){const n=w("Button"),r=w("Header"),d=w("FrameRecord"),c=w("LinRecord"),p=w("ChartRecord"),f=w("SendRecord"),y=w("Tabs"),M=w("LinSendRecord"),L=w("LinOtherSendRecord"),z=w("EditModal"),_=w("FiveChannelEditModal"),O=w("TwelveChannelEditModal"),x=w("Message");return h(),u(T,null,[a("div",{class:"record-page-er","data-loading":t.changeDbcLoading},[g(r,{title:"报文录制",quitConfirm:l.quitConfirm,showRight:!1,recentTest:e.$props.store.connectCar.latest,connectStatus:e.$props.store.connectCar.status},{default:S(()=>[a("div",jh,[g(n,{type:"primary",class:"header-import-btn",disabled:t.isRecording,onClick:l.colFilterChange},{default:S(()=>[qh,C("连接设备")]),_:1},8,["disabled","onClick"]),a("div",zh,[t.isRecording?(h(),P(n,{key:1,type:"primary",onClick:l.endRecord,loading:t.recordLoading,progress:"100%"},{default:S(()=>[Wh,C("停止")]),_:1},8,["onClick","loading"])):(h(),P(n,{key:0,type:"primary",loading:t.recordLoading,disabled:t.dbcLoading||!t.dbcVal||!t.filePath||!t.isHardwareChecked,progress:"100%",onClick:l.startRecord},{default:S(()=>[Kh,C("监控并录制 ")]),_:1},8,["loading","disabled","onClick"]))]),a("div",Gh,[t.isRecording?k("",!0):(h(),P(n,{key:0,type:"primary",loading:t.recordLoading,disabled:t.dbcLoading||!t.dbcVal||!t.filePath||!t.isHardwareChecked,progress:"100%",onClick:l.startListen},{default:S(()=>[Xh,C("仅监控 ")]),_:1},8,["loading","disabled","onClick"]))]),t.btnActionStyle=="listen"?(h(),u("div",Yh,"监控时间: "+b(t.recordTime),1)):(h(),u("div",Jh,"录制时间: "+b(t.recordTime),1))]),a("template",Qh,[a("span",Zh,[C(" 设备名称： "),a("span",eu,b(t.sn),1)]),tu,a("span",su,[C(" 版本号："),a("span",lu,b(t.sw),1)])])]),_:1},8,["quitConfirm","recentTest","connectStatus"]),a("div",iu,[a("div",au,[a("div",nu,[a("div",{class:"o-menu-it","data-active":t.cur==t.mlist[0].key||t.mlist[0].active,onClick:s[0]||(s[0]=N=>l.choose(t.mlist[0].key))},[ru,C(" "+b(t.mlist[0].name),1)],8,ou),t.system!="mac"?(h(),u("div",{key:0,class:"o-menu-it","data-active":t.cur==t.mlist[1].key||t.mlist[1].active,onClick:s[1]||(s[1]=N=>l.choose(t.mlist[1].key))},[cu,C(" "+b(t.mlist[1].name),1)],8,du)):k("",!0),a("div",{class:"o-menu-it","data-active":t.cur==t.mlist[2].key||t.mlist[2].active,onClick:s[2]||(s[2]=N=>l.choose(t.mlist[2].key))},[uu,C(" "+b(t.mlist[2].name),1)],8,hu),t.sn.includes("CR3")?(h(),u("div",{key:1,class:"o-menu-it","data-active":t.cur==t.mlist[3].key||t.mlist[3].active,onClick:s[3]||(s[3]=N=>l.choose(t.mlist[3].key))},[mu,C(" "+b(t.mlist[3].name),1)],8,pu)):k("",!0),t.sn.includes("CR3")?(h(),u("div",{key:2,class:"o-menu-it","data-active":t.cur==t.mlist[4].key||t.mlist[4].active,onClick:s[4]||(s[4]=N=>l.choose(t.mlist[4].key))},[gu,C(" "+b(t.mlist[4].name),1)],8,fu)):k("",!0)])]),a("div",{class:"rec-body","data-hidden":t.recordShow},[g(d,{onUpdateBock:l.updateBocks,onUpdateTimeData:l.updateTimeData,ref:"frameRecordRef",onChartTableFun:l.chartTableFun,frameType:t.frameType,sn:t.sn,dbcChn:t.dbcChn,ldfChn:t.ldfChn,channelValList:t.channelValList,linChannelValList:t.linChannelValList,channelOne:t.channelOne,channelTwo:t.channelTwo,channelThree:t.channelThree,linChannelVal:t.linChannelVal,linChannelValTwo:t.linChannelValTwo,filePath:t.filePath,onRecordTimeChange:l.recordTimeChange,dbcVal:t.dbcVal,colFilterShow:t.colFilterShow,onStartTimeChange:s[5]||(s[5]=N=>{t.startTime=N}),startTime:t.startTime},null,8,["onUpdateBock","onUpdateTimeData","onChartTableFun","frameType","sn","dbcChn","ldfChn","channelValList","linChannelValList","channelOne","channelTwo","channelThree","linChannelVal","linChannelValTwo","filePath","onRecordTimeChange","dbcVal","colFilterShow","startTime"])],8,bu),t.sn.includes("CR3")?(h(),u("div",{key:0,class:"rec-body","data-hidden":t.linRecordShow},[g(c,{onUpdateBock:l.updateBocks,onUpdateTimeData:l.updateTimeData,ref:"linRecordRef",channelOne:t.channelOne,channelTwo:t.channelTwo,channelThree:t.channelThree,linChannelVal:t.linChannelVal,linChannelValTwo:t.linChannelValTwo,filePath:t.filePath,dbcVal:t.dbcVal,colFilterShow:t.colFilterShow,onStartTimeChange:s[6]||(s[6]=N=>{t.startTime=N}),startTime:t.startTime},null,8,["onUpdateBock","onUpdateTimeData","channelOne","channelTwo","channelThree","linChannelVal","linChannelValTwo","filePath","dbcVal","colFilterShow","startTime"])],8,_u)):k("",!0),t.system!=="mac"?(h(),u("div",{key:1,class:"rec-body","data-hidden":t.lookRecord},[g(p,{ref:"chartRecordRef",chartTableData:t.chartTableData,sdb:t.sdb,dbcChn:t.dbcChn,ldfChn:t.ldfChn,dbcVal:t.dbcVal,getDbcData:t.frames},null,8,["chartTableData","sdb","dbcChn","ldfChn","dbcVal","getDbcData"])],8,yu)):k("",!0),a("div",{class:"rec-body","data-hidden":t.sendRecordShow},[g(f,{store:e.$props.store,setStore:e.$props.setStore},null,8,["store","setStore"])],8,wu),t.sn.includes("CR3")?(h(),u("div",{key:2,class:"rec-body","data-hidden":t.linSendRecordShow},[t.mainTabs.length>0?(h(),u("div",Cu,[g(y,{position:"top",closeable:!1,options:t.mainTabs,modelValue:t.curFileIdx,"onUpdate:modelValue":s[7]||(s[7]=N=>t.curFileIdx=N)},{default:S(()=>[ku]),_:1},8,["options","modelValue"])])):k("",!0),v(g(M,{activeTab:t.activeTab,linSendInfo:t.linSendInfo,nodeOpt:t.nodeOpt,curFileIdx:t.curFileIdx,ldfChn:t.ldfChn,deployDisable:t.deployDisable,store:e.$props.store,setStore:e.$props.setStore},null,8,["activeTab","linSendInfo","nodeOpt","curFileIdx","ldfChn","deployDisable","store","setStore"]),[[U,t.curFileIdx===0]]),v(g(L,{activeTab:t.activeTab,linSendInfo:t.linSendInfo,nodeOpt:t.nodeOpt,curFileIdx:t.curFileIdx,ldfChn:t.ldfChn,deployDisable:t.deployDisable,store:e.$props.store,setStore:e.$props.setStore},null,8,["activeTab","linSendInfo","nodeOpt","curFileIdx","ldfChn","deployDisable","store","setStore"]),[[U,t.curFileIdx===1]])],8,vu)):k("",!0),v(g(z,{loading:t.isEditModalLoading,title:t.editModal.title,onCancel:l.onCancelSelect,onSubmitToShow:l.onSubmitToShow},null,8,["loading","title","onCancel","onSubmitToShow"]),[[U,t.editModal.editVisible&&t.sn.includes("CR2")&&!t.changeDbcLoading]]),v(g(_,{loading:t.isEditModalLoading,title:t.editModal.title,onCancel:l.onCancelSelect,onSubmitFiveToShow:l.onSubmitToShow},null,8,["loading","title","onCancel","onSubmitFiveToShow"]),[[U,t.editModal.editVisible&&t.sn.includes("CR3")&&!t.changeDbcLoading]]),v(g(O,{loading:t.isEditModalLoading,title:t.editModal.title,onCancel:l.onCancelSelect,onSubmitTwelveToShow:l.onSubmitToShow},null,8,["loading","title","onCancel","onSubmitTwelveToShow"]),[[U,t.editModal.editVisible&&t.sn.includes("DR4")&&!t.changeDbcLoading]])])],8,Bh),g(x,{message:t.message},null,8,["message"])],64)}const Uu=E(Hh,[["render",Su],["__scopeId","data-v-c21b53f4"]]);export{Uu as default};
