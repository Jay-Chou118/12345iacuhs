System.register(["./Header-legacy-c1bbc3dd.js","./CopyPath-legacy-842665f8.js","./Button-legacy-e57cd1da.js","./Message-legacy-2a8c9483.js","./index-legacy-0403042b.js","./index-legacy-7a6e66a4.js"],(function(e,t){"use strict";var s,o,r,a,i,l,c,n,d,h,p,u,y,g,m,f,C,v,D,k,T,b,x;return{setters:[e=>{s=e.H},e=>{o=e.C},e=>{r=e.B},e=>{a=e.M},e=>{i=e._,l=e.k,c=e.e,n=e.r,d=e.c,h=e.h,p=e.d,u=e.i,y=e.a,g=e.F,m=e.m,f=e.t,C=e.f,v=e.w,D=e.v,k=e.o,T=e.p,b=e.b},e=>{x=e.n}],execute:function(){let t=0;const S={props:["store"],components:{Button:r,Header:s,CopyPath:o,Message:a},data:()=>({consoleText:"",errorNumber:0,directory:"",onFlag:!0,chartDataLoaded:!0,fileDirectory:[],fileDirectoryStr:"",inputFiles:[],fileTypesList:[],dbcCheckValid:!1,recLoading:!1,recLoadingProgress:"",showWaitWarn:!1,showWaitWarnMsg:"",consoleText:"",respData:[],message:{visible:!1,level:"",content:""}}),watch:{chartDataLoaded(e,t){e?(document.querySelector("#app").style.cursor="",document.querySelector(".back-icon").style.pointerEvents="",document.querySelector(".record-header").style.cursor="",document.querySelector(".o-pul-er").style.pointerEvents="",document.querySelector(".o-menu").style.pointerEvents=""):(document.querySelector("#app").style.cursor="wait",document.querySelector(".back-icon").style.pointerEvents="none",document.querySelector(".o-pul-er").style.pointerEvents="none",document.querySelector(".o-menu").style.pointerEvents="none")}},computed:{quitConfirm(){return!!this.directory.trim()}},mounted(){},methods:{choosePath(){let e=[];const t=this.directory.split("/").slice(0,-1).join("/");this.fileTypesList=["DBC文件 (*.dbc;*.DBC)"],l.choosePath({directory:t,dialogType:"OPEN_DIALOG",fileTypes:this.fileTypesList,allow_multiple:!0}).then((t=>{t.data.directory&&(this.fileDirectory=t.data.directory.sort(((e,t)=>e.split("/").pop()>t.split("/").pop()?1:-1)).map((e=>x(e))),this.fileDirectoryStr=this.fileDirectory.join(","),this.fileDirectoryStr=this.fileDirectoryStr.toString().replace(/[,]/g,"$&\r\n"),this.fileDirectory.forEach(((t,s)=>{let o={file_name:t};e.push(o)})),console.log("this.inputFiles",e),this.inputFiles=e,this.dbcCheckValid=!0,this.consoleText="")}))},async startCheck(){console.log("导入文件",this.fileDirectory),this.dbcCheckValid=!1,this.consoleText="检测中...\n",await c.DBCCheck.start_check({dbc_paths:this.fileDirectory}).then((e=>{this.dbcCheckValid=!0,this.consoleText="",this.respData=e.data.data,console.log("res>>",this.respData),this.respData&&this.respData.forEach((e=>{this.consoleText+=e+"\n"}))}))},async exportResult(){let e=this.fileDirectory[0].split("/").slice(0,-1).join("/");console.log("this.directory2222222",e),await l.choosePath({directory:e,dialogType:"SAVE_DIALOG",saveFilename:"check_result.txt",fileTypes:["所有文件 (*.*)"],allow_multiple:!1}).then((e=>{e.data.directory&&c.DBCCheck.export({data:this.respData,path:e.data.directory}).then((e=>{console.log("res111",e.data),"0"==e.data.code&&this.showMessage({timeout:5e3,level:"success",content:"导出成功"})}))}))},showMessage({level:e,content:s,timeout:o}){clearTimeout(t),null!=e&&(this.message.level=e),null!=s&&(this.message.content=s),this.message.visible=!0,o>0&&(t=setTimeout((()=>{console.log(t,"msgTimer"),this.message.visible=!1}),o))}}},w=e=>(T("data-v-7bd2e333"),e=e(),b(),e),_={class:"diagnostics-data"},q={class:"o-pul-er",id:"el-record-form"},L=w((()=>p("div",{class:"o-pul-title"},"文件导入配置",-1))),E={class:"o-pul-p"},P=w((()=>p("span",{style:{color:"red"}},"* ",-1))),j=w((()=>p("span",{class:"record-header-message"},"对象文件：",-1))),B={key:0,class:"o-warn"},M=w((()=>p("i",{class:"warn-icon"},null,-1))),W={key:0,class:"o-pul-p start-rec"},F=w((()=>p("i",{class:"play-icon"},null,-1))),V=["data-empty"],N={class:"o-console-wrap"},H=w((()=>p("div",{class:"o-console-title"},"检测结果",-1))),$=["data-loading"];e("default",i(S,[["render",function(e,t,s,o,r,a){const i=n("Header"),l=n("Button"),c=n("CopyPath"),T=n("Message");return k(),d("div",_,[h(i,{title:"DBC检查",quitConfirm:a.quitConfirm,showRight:!0,carNum:e.$props.store.connectCar.carNum,connectStatus:e.$props.store.connectCar.status,recentTest:e.$props.store.connectCar.latest},null,8,["quitConfirm","carNum","connectStatus","recentTest"]),p("div",q,[L,p("div",E,[P,j,h(l,{onClick:a.choosePath,class:"choose-path"},{default:u((()=>[y("选择文件")])),_:1},8,["onClick"]),y("  "),(k(!0),d(g,null,m(r.fileDirectory,((e,t)=>(k(),d("div",{class:"o-pul-file",key:t},[h(c,{path:e,length:60},null,8,["path"])])))),128)),r.showWaitWarn?(k(),d("div",B,[M,y(f(r.showWaitWarnMsg),1)])):C("",!0)]),r.onFlag?(k(),d("div",W,[h(l,{type:"primary",disabled:!r.dbcCheckValid,progress:r.recLoadingProgress,loading:r.recLoading,onClick:a.startCheck},{default:u((()=>[F,y("开始检测")])),_:1},8,["disabled","progress","loading","onClick"])])):C("",!0)]),p("div",{class:"o-console-er","data-empty":""===r.consoleText,id:"el-record-console"},[p("div",N,[H,v(h(l,{onClick:t[0]||(t[0]=e=>a.exportResult()),class:"export-result"},{default:u((()=>[y("导出结果")])),_:1},512),[[D,r.consoleText]])]),v(p("div",{class:"o-console-body","data-loading":!r.chartDataLoaded},f(r.consoleText),9,$),[[D,r.consoleText]])],8,V),h(T,{message:r.message},null,8,["message"])])}],["__scopeId","data-v-7bd2e333"]]))}}}));
